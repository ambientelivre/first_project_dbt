

============================== 2022-06-04 13:42:14.394739 | 12c3f934-c105-44b3-b20c-6d0e457d43bf ==============================
13:42:14.394755 [info ] [MainThread]: Running with dbt=1.1.0
13:42:14.395246 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
13:42:14.395399 [debug] [MainThread]: Tracking: tracking
13:42:14.400731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca282a940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca282ab80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca282a9d0>]}
13:42:14.472582 [debug] [MainThread]: Executing "git --help"
13:42:14.492407 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
13:42:14.492883 [debug] [MainThread]: STDERR: "b''"
13:42:14.497256 [debug] [MainThread]: Acquiring new postgres connection "debug"
13:42:14.497722 [debug] [MainThread]: Using postgres connection "debug"
13:42:14.497845 [debug] [MainThread]: On debug: select 1 as id
13:42:14.497983 [debug] [MainThread]: Opening a new connection, currently in state init
13:42:14.509518 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
13:42:14.510692 [debug] [MainThread]: On debug: Close
13:42:14.511216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca101e250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca102c520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3ca102cb80>]}
13:42:15.280241 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-04 14:18:08.188246 | bc3d3061-79ea-4bdd-9618-121031ecccaf ==============================
14:18:08.188265 [info ] [MainThread]: Running with dbt=1.1.0
14:18:08.188862 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:18:08.189044 [debug] [MainThread]: Tracking: tracking
14:18:08.192718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ebc74820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ebc74fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ebc74d30>]}
14:18:08.208633 [info ] [MainThread]: Partial parse save file not found. Starting full parse.
14:18:08.208987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ebc216a0>]}
14:18:08.222134 [debug] [MainThread]: Parsing macros/catalog.sql
14:18:08.225454 [debug] [MainThread]: Parsing macros/relations.sql
14:18:08.226893 [debug] [MainThread]: Parsing macros/adapters.sql
14:18:08.251030 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
14:18:08.252964 [debug] [MainThread]: Parsing macros/materializations/configs.sql
14:18:08.255473 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
14:18:08.259492 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
14:18:08.271268 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
14:18:08.288314 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
14:18:08.308356 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
14:18:08.313340 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
14:18:08.315133 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
14:18:08.316717 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
14:18:08.319299 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
14:18:08.322350 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
14:18:08.329555 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
14:18:08.336812 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
14:18:08.339739 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
14:18:08.356066 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
14:18:08.364000 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
14:18:08.366589 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
14:18:08.371334 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
14:18:08.373257 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
14:18:08.386856 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
14:18:08.407020 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
14:18:08.419936 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
14:18:08.422588 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
14:18:08.425329 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
14:18:08.427016 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
14:18:08.428604 [debug] [MainThread]: Parsing macros/adapters/columns.sql
14:18:08.439044 [debug] [MainThread]: Parsing macros/adapters/relation.sql
14:18:08.448852 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
14:18:08.451945 [debug] [MainThread]: Parsing macros/adapters/schema.sql
14:18:08.454338 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
14:18:08.457090 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
14:18:08.464892 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
14:18:08.469892 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
14:18:08.470882 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
14:18:08.471898 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
14:18:08.472734 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
14:18:08.474144 [debug] [MainThread]: Parsing macros/etc/datetime.sql
14:18:08.483566 [debug] [MainThread]: Parsing macros/etc/statement.sql
14:18:08.488182 [debug] [MainThread]: Parsing tests/generic/builtin.sql
14:18:08.705010 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:18:08.717806 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
14:18:08.720542 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
14:18:08.779482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2eb77c0d0>]}
14:18:08.784813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ede484c0>]}
14:18:08.785142 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:18:08.785412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ede48190>]}
14:18:08.786815 [info ] [MainThread]: 
14:18:08.787392 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:08.788370 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:18:08.799702 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:18:08.799968 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:18:08.800094 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:18:08.808377 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:18:08.809655 [debug] [ThreadPool]: On list_erp_oltp: Close
14:18:08.810930 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:18:08.824012 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:08.824301 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:18:08.824424 [debug] [ThreadPool]: Opening a new connection, currently in state closed
14:18:08.838616 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:18:08.838876 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:18:08.839064 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:18:08.842771 [debug] [ThreadPool]: SQL status: SELECT 8 in 0.0 seconds
14:18:08.844185 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:18:08.844503 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:18:08.848198 [debug] [MainThread]: Using postgres connection "master"
14:18:08.848548 [debug] [MainThread]: On master: BEGIN
14:18:08.848695 [debug] [MainThread]: Opening a new connection, currently in state init
14:18:08.854634 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:18:08.854862 [debug] [MainThread]: Using postgres connection "master"
14:18:08.854972 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:18:08.867145 [debug] [MainThread]: SQL status: SELECT 0 in 0.01 seconds
14:18:08.868312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2edde9af0>]}
14:18:08.868612 [debug] [MainThread]: On master: ROLLBACK
14:18:08.869000 [debug] [MainThread]: Using postgres connection "master"
14:18:08.869155 [debug] [MainThread]: On master: BEGIN
14:18:08.869560 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:18:08.869722 [debug] [MainThread]: On master: COMMIT
14:18:08.869846 [debug] [MainThread]: Using postgres connection "master"
14:18:08.869939 [debug] [MainThread]: On master: COMMIT
14:18:08.870171 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:08.870304 [debug] [MainThread]: On master: Close
14:18:08.870673 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:18:08.870998 [info ] [MainThread]: 
14:18:08.876850 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:18:08.877140 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:18:08.877580 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:18:08.877707 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:18:08.877820 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:18:08.878874 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:18:08.879294 [debug] [Thread-1  ]: finished collecting timing info
14:18:08.879424 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:18:08.890776 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:18:08.891131 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:18:08.891582 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:18:08.891720 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:18:08.891823 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:18:08.894586 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:18:08.896997 [debug] [Thread-2  ]: finished collecting timing info
14:18:08.897242 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:18:08.911508 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:18:08.928860 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:18:08.929458 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:08.929724 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:18:08.929932 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:18:08.930329 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:08.930510 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:18:08.931287 [debug] [Thread-2  ]: Opening a new connection, currently in state init
14:18:08.937441 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:18:08.937768 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:08.937947 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name
  from erp_oltp.public.clientes
)
select * from customers
  );
14:18:08.938425 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:18:08.938606 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:08.938773 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:18:08.944766 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
14:18:08.950339 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:08.950564 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:18:08.950772 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:18:08.953776 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:08.953973 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:18:08.954138 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:08.959721 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:18:08.963614 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:08.965617 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:08.966015 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:08.966305 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:08.966514 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:18:08.966711 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:18:08.984204 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
14:18:08.988855 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:18:08.989065 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:18:08.989570 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
14:18:08.990771 [debug] [Thread-2  ]: finished collecting timing info
14:18:08.990982 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:18:08.992582 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e8692a90>]}
14:18:08.993121 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
14:18:08.992835 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
14:18:08.994600 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:18:08.995026 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:18:08.994928 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:18:08.995727 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:18:08.995949 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:18:08.996291 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:18:08.996472 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:08.996606 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:18:08.997494 [debug] [Thread-1  ]: finished collecting timing info
14:18:08.997689 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:18:08.997865 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:18:09.000016 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:18:09.000520 [debug] [Thread-4  ]: finished collecting timing info
14:18:09.000643 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:18:09.002996 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:18:09.003450 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2eb6fff40>]}
14:18:09.003773 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.13s]
14:18:09.003932 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:09.004237 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:18:09.004321 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:18:09.005774 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:18:09.014475 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:18:09.014769 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:09.014902 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:18:09.016954 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:18:09.020137 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:09.020407 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:18:09.022072 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:18:09.023447 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:09.025553 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:09.025708 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:18:09.032113 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
14:18:09.033755 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:18:09.033950 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:18:09.034359 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:18:09.035408 [debug] [Thread-4  ]: finished collecting timing info
14:18:09.035587 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:18:09.037722 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bc3d3061-79ea-4bdd-9618-121031ecccaf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ebc5fca0>]}
14:18:09.038092 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
14:18:09.038519 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:18:09.039957 [debug] [MainThread]: Acquiring new postgres connection "master"
14:18:09.040144 [debug] [MainThread]: Using postgres connection "master"
14:18:09.040243 [debug] [MainThread]: On master: BEGIN
14:18:09.040328 [debug] [MainThread]: Opening a new connection, currently in state closed
14:18:09.047641 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:18:09.047919 [debug] [MainThread]: On master: COMMIT
14:18:09.048031 [debug] [MainThread]: Using postgres connection "master"
14:18:09.048129 [debug] [MainThread]: On master: COMMIT
14:18:09.048406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:18:09.048616 [debug] [MainThread]: On master: Close
14:18:09.049035 [info ] [MainThread]: 
14:18:09.049281 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.26s.
14:18:09.049455 [debug] [MainThread]: Connection 'master' was properly closed.
14:18:09.049544 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:18:09.049636 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:18:09.049749 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:18:09.055115 [info ] [MainThread]: 
14:18:09.055426 [info ] [MainThread]: [32mCompleted successfully[0m
14:18:09.058054 [info ] [MainThread]: 
14:18:09.058236 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:18:09.058714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2e8658850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2ebc7a550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2eb74e730>]}


============================== 2022-06-04 14:30:44.975698 | bae1480f-022b-44f3-b865-245f2f7bdea0 ==============================
14:30:44.975726 [info ] [MainThread]: Running with dbt=1.1.0
14:30:44.976527 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:30:44.976702 [debug] [MainThread]: Tracking: tracking
14:30:44.982383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb8ddfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb8ddfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb8ddd60>]}
14:30:45.023219 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:30:45.023696 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:30:45.051879 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:30:45.071693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bae1480f-022b-44f3-b865-245f2f7bdea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb3a20d0>]}
14:30:45.078228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bae1480f-022b-44f3-b865-245f2f7bdea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb8df9a0>]}
14:30:45.078587 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:30:45.078837 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae1480f-022b-44f3-b865-245f2f7bdea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb8df6a0>]}
14:30:45.080329 [info ] [MainThread]: 
14:30:45.080891 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:45.093448 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:30:45.122575 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:30:45.122864 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:30:45.122999 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:45.165892 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.04 seconds
14:30:45.167466 [debug] [ThreadPool]: On list_erp_oltp: Close
14:30:45.180469 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:30:45.190804 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:45.196815 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:30:45.199706 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:30:45.228483 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
14:30:45.228767 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:30:45.228883 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:30:45.231465 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:30:45.232838 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:30:45.233230 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:30:45.305048 [debug] [MainThread]: Using postgres connection "master"
14:30:45.305306 [debug] [MainThread]: On master: BEGIN
14:30:45.305424 [debug] [MainThread]: Opening a new connection, currently in state init
14:30:45.311928 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:45.312177 [debug] [MainThread]: Using postgres connection "master"
14:30:45.312484 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:30:45.326274 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:30:45.327626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bae1480f-022b-44f3-b865-245f2f7bdea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb824640>]}
14:30:45.328228 [debug] [MainThread]: On master: ROLLBACK
14:30:45.328601 [debug] [MainThread]: Using postgres connection "master"
14:30:45.328742 [debug] [MainThread]: On master: BEGIN
14:30:45.329246 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:30:45.329438 [debug] [MainThread]: On master: COMMIT
14:30:45.329552 [debug] [MainThread]: Using postgres connection "master"
14:30:45.329654 [debug] [MainThread]: On master: COMMIT
14:30:45.329877 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:45.330048 [debug] [MainThread]: On master: Close
14:30:45.330541 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:30:45.330788 [info ] [MainThread]: 
14:30:45.334757 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:30:45.335081 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:30:45.335534 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:30:45.335701 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:30:45.335874 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:30:45.336057 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:30:45.336323 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:30:45.337574 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:30:45.338101 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:30:45.338456 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:30:45.338599 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:30:45.338839 [debug] [Thread-1  ]: finished collecting timing info
14:30:45.341441 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:30:45.341200 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:30:45.353779 [debug] [Thread-2  ]: finished collecting timing info
14:30:45.354053 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:30:45.388989 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:30:45.392614 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:30:45.393424 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:45.393631 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:45.393770 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:30:45.393928 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:30:45.394068 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:30:45.394248 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:30:45.400889 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:30:45.401155 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:45.401274 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
14:30:45.402252 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:30:45.402422 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:45.402516 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:30:45.403705 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:45.403899 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
14:30:45.409539 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:45.411555 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:45.412035 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:30:45.412511 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:45.411826 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:30:45.414241 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:45.414527 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:30:45.414868 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:45.415048 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:45.417102 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:45.429041 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:45.429422 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:30:45.429674 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:45.429937 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:30:45.430420 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:45.431626 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:45.431778 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:45.431884 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:30:45.444038 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
14:30:45.448775 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:30:45.448993 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:30:45.449917 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
14:30:45.451903 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:30:45.452949 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:30:45.460726 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
14:30:45.462272 [debug] [Thread-2  ]: finished collecting timing info
14:30:45.462486 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:30:45.463537 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae1480f-022b-44f3-b865-245f2f7bdea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb376d60>]}
14:30:45.463884 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
14:30:45.464322 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:30:45.464701 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:30:45.464893 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:30:45.465236 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:30:45.465354 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:30:45.465448 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:30:45.467142 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:30:45.467461 [debug] [Thread-4  ]: finished collecting timing info
14:30:45.467603 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:30:45.469330 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:30:45.469619 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:45.469743 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:30:45.469830 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:30:45.470784 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.02 seconds
14:30:45.471678 [debug] [Thread-1  ]: finished collecting timing info
14:30:45.471820 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:30:45.473145 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae1480f-022b-44f3-b865-245f2f7bdea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb343d30>]}
14:30:45.473808 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.14s]
14:30:45.474170 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:30:45.481504 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:30:45.481788 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:45.481913 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:30:45.484061 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:30:45.486346 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:45.486570 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:30:45.487269 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:30:45.488435 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:45.488610 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:45.488709 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:30:45.497381 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
14:30:45.499058 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:30:45.499279 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:30:45.502017 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:30:45.503556 [debug] [Thread-4  ]: finished collecting timing info
14:30:45.503771 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:30:45.504241 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bae1480f-022b-44f3-b865-245f2f7bdea0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fb369ac0>]}
14:30:45.504592 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
14:30:45.504949 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:30:45.506344 [debug] [MainThread]: Acquiring new postgres connection "master"
14:30:45.506514 [debug] [MainThread]: Using postgres connection "master"
14:30:45.506613 [debug] [MainThread]: On master: BEGIN
14:30:45.506697 [debug] [MainThread]: Opening a new connection, currently in state closed
14:30:45.513265 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:30:45.513598 [debug] [MainThread]: On master: COMMIT
14:30:45.513745 [debug] [MainThread]: Using postgres connection "master"
14:30:45.513847 [debug] [MainThread]: On master: COMMIT
14:30:45.514066 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:30:45.514211 [debug] [MainThread]: On master: Close
14:30:45.514673 [info ] [MainThread]: 
14:30:45.514992 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.43s.
14:30:45.515273 [debug] [MainThread]: Connection 'master' was properly closed.
14:30:45.515374 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:30:45.515459 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:30:45.515546 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:30:45.519902 [info ] [MainThread]: 
14:30:45.520273 [info ] [MainThread]: [32mCompleted successfully[0m
14:30:45.520560 [info ] [MainThread]: 
14:30:45.520771 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:30:45.521063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fd6cf730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fd6cd2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f23fda4edf0>]}


============================== 2022-06-04 14:46:30.991924 | 3b4a8ee2-cb04-4e81-b834-28318e9658d1 ==============================
14:46:30.991947 [info ] [MainThread]: Running with dbt=1.1.0
14:46:30.992549 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
14:46:30.993159 [debug] [MainThread]: Tracking: tracking
14:46:30.997348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eac292a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eac292af0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eac292ee0>]}
14:46:31.035383 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
14:46:31.035860 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
14:46:31.070900 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
14:46:31.104987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b4a8ee2-cb04-4e81-b834-28318e9658d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eabd5d0d0>]}
14:46:31.109986 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b4a8ee2-cb04-4e81-b834-28318e9658d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eac225e80>]}
14:46:31.110357 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
14:46:31.110710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b4a8ee2-cb04-4e81-b834-28318e9658d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eac225df0>]}
14:46:31.114042 [info ] [MainThread]: 
14:46:31.114794 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:31.115748 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
14:46:31.126769 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
14:46:31.127225 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
14:46:31.127415 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:31.137388 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
14:46:31.139161 [debug] [ThreadPool]: On list_erp_oltp: Close
14:46:31.145001 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
14:46:31.153297 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:31.153589 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
14:46:31.153774 [debug] [ThreadPool]: Opening a new connection, currently in state init
14:46:31.160232 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
14:46:31.160483 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
14:46:31.160595 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
14:46:31.163001 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
14:46:31.164544 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
14:46:31.164881 [debug] [ThreadPool]: On list_erp_oltp_public: Close
14:46:31.201802 [debug] [MainThread]: Using postgres connection "master"
14:46:31.202072 [debug] [MainThread]: On master: BEGIN
14:46:31.202185 [debug] [MainThread]: Opening a new connection, currently in state init
14:46:31.209023 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:31.209353 [debug] [MainThread]: Using postgres connection "master"
14:46:31.209553 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
14:46:31.223818 [debug] [MainThread]: SQL status: SELECT 2 in 0.01 seconds
14:46:31.225542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b4a8ee2-cb04-4e81-b834-28318e9658d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eac1df5b0>]}
14:46:31.225887 [debug] [MainThread]: On master: ROLLBACK
14:46:31.226272 [debug] [MainThread]: Using postgres connection "master"
14:46:31.226421 [debug] [MainThread]: On master: BEGIN
14:46:31.226749 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
14:46:31.226901 [debug] [MainThread]: On master: COMMIT
14:46:31.227007 [debug] [MainThread]: Using postgres connection "master"
14:46:31.227105 [debug] [MainThread]: On master: COMMIT
14:46:31.227348 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:31.227568 [debug] [MainThread]: On master: Close
14:46:31.227995 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
14:46:31.228333 [info ] [MainThread]: 
14:46:31.233037 [debug] [Thread-1  ]: Began running node model.first_project.customers
14:46:31.233340 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
14:46:31.233768 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
14:46:31.233903 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
14:46:31.234027 [debug] [Thread-1  ]: Compiling model.first_project.customers
14:46:31.235479 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
14:46:31.235743 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
14:46:31.236135 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
14:46:31.236557 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
14:46:31.236807 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
14:46:31.236975 [debug] [Thread-1  ]: finished collecting timing info
14:46:31.237139 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
14:46:31.237322 [debug] [Thread-1  ]: Began executing node model.first_project.customers
14:46:31.240390 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
14:46:31.269091 [debug] [Thread-2  ]: finished collecting timing info
14:46:31.269458 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
14:46:31.285196 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
14:46:31.285767 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:31.285967 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
14:46:31.286169 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
14:46:31.296788 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
14:46:31.297541 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:31.297755 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
14:46:31.297901 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
14:46:31.299928 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
14:46:31.300128 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:31.300237 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
14:46:31.305197 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
14:46:31.305460 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:31.305599 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
14:46:31.305902 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
14:46:31.311954 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:31.312220 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
14:46:31.312982 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
14:46:31.315174 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:31.315708 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
14:46:31.315887 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:31.317983 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:31.318378 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:31.318542 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
14:46:31.320314 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:31.320625 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
14:46:31.320970 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:31.326427 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
14:46:31.332082 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:31.333333 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:31.333569 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:31.333865 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:31.334033 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
14:46:31.334263 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
14:46:31.343271 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
14:46:31.349275 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
14:46:31.349505 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
14:46:31.351191 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
14:46:31.352832 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
14:46:31.353025 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
14:46:31.357087 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
14:46:31.358260 [debug] [Thread-2  ]: finished collecting timing info
14:46:31.358447 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
14:46:31.359581 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b4a8ee2-cb04-4e81-b834-28318e9658d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eabce1e50>]}
14:46:31.359957 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
14:46:31.360520 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
14:46:31.361005 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
14:46:31.361257 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
14:46:31.361645 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
14:46:31.361778 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
14:46:31.361893 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
14:46:31.364561 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
14:46:31.364784 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
14:46:31.365963 [debug] [Thread-1  ]: finished collecting timing info
14:46:31.366221 [debug] [Thread-1  ]: On model.first_project.customers: Close
14:46:31.366441 [debug] [Thread-4  ]: finished collecting timing info
14:46:31.366741 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
14:46:31.368822 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
14:46:31.370013 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:31.370203 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
14:46:31.370313 [debug] [Thread-4  ]: Opening a new connection, currently in state init
14:46:31.369577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b4a8ee2-cb04-4e81-b834-28318e9658d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eabd1fd00>]}
14:46:31.371550 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.14s]
14:46:31.376478 [debug] [Thread-1  ]: Finished running node model.first_project.customers
14:46:31.381107 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
14:46:31.381369 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:31.381531 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
14:46:31.382843 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
14:46:31.385081 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:31.385247 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
14:46:31.385766 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
14:46:31.391643 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:31.392990 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:31.393261 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
14:46:31.399387 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
14:46:31.401302 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
14:46:31.401623 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
14:46:31.402050 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
14:46:31.403046 [debug] [Thread-4  ]: finished collecting timing info
14:46:31.403220 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
14:46:31.405329 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3b4a8ee2-cb04-4e81-b834-28318e9658d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eac17fb80>]}
14:46:31.405717 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
14:46:31.407202 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
14:46:31.408584 [debug] [MainThread]: Acquiring new postgres connection "master"
14:46:31.408923 [debug] [MainThread]: Using postgres connection "master"
14:46:31.409242 [debug] [MainThread]: On master: BEGIN
14:46:31.409482 [debug] [MainThread]: Opening a new connection, currently in state closed
14:46:31.419574 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
14:46:31.419954 [debug] [MainThread]: On master: COMMIT
14:46:31.420137 [debug] [MainThread]: Using postgres connection "master"
14:46:31.420307 [debug] [MainThread]: On master: COMMIT
14:46:31.420619 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
14:46:31.420836 [debug] [MainThread]: On master: Close
14:46:31.421454 [info ] [MainThread]: 
14:46:31.421812 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.31s.
14:46:31.424201 [debug] [MainThread]: Connection 'master' was properly closed.
14:46:31.424405 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
14:46:31.424545 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
14:46:31.424677 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
14:46:31.430002 [info ] [MainThread]: 
14:46:31.430378 [info ] [MainThread]: [32mCompleted successfully[0m
14:46:31.430747 [info ] [MainThread]: 
14:46:31.430977 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
14:46:31.431357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eadb1f0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eae088100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1eae4099a0>]}


============================== 2022-06-04 16:30:02.541164 | bd3b2551-c743-45cc-9263-3df7420cecf8 ==============================
16:30:02.541179 [info ] [MainThread]: Running with dbt=1.1.0
16:30:02.542255 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:30:02.542393 [debug] [MainThread]: Tracking: tracking
16:30:02.545880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec90e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec90e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec90e2b0>]}
16:30:02.562632 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:30:02.563032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec916790>]}
16:30:02.586555 [debug] [MainThread]: Parsing macros/catalog.sql
16:30:02.588966 [debug] [MainThread]: Parsing macros/relations.sql
16:30:02.590092 [debug] [MainThread]: Parsing macros/adapters.sql
16:30:02.609003 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:30:02.610557 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:30:02.612542 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:30:02.615798 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:30:02.624361 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:30:02.638509 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:30:02.653154 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:30:02.656959 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:30:02.658371 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:30:02.659476 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:30:02.661499 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:30:02.663749 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:30:02.669493 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:30:02.675712 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:30:02.678104 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:30:02.692085 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:30:02.697194 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:30:02.698672 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:30:02.702258 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:30:02.703763 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:30:02.714194 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:30:02.728042 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:30:02.737100 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:30:02.738566 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:30:02.740577 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:30:02.741986 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:30:02.743177 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:30:02.751102 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:30:02.758860 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:30:02.761288 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:30:02.763169 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:30:02.765426 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:30:02.771085 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:30:02.774724 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:30:02.775411 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:30:02.776111 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:30:02.776685 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:30:02.777862 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:30:02.784771 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:30:02.788563 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:30:02.966548 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:30:02.976661 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:30:02.978779 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:30:03.021261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ee1d0ac0>]}
16:30:03.024809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec8cc5b0>]}
16:30:03.025085 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:30:03.025362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ee1d0d60>]}
16:30:03.026368 [info ] [MainThread]: 
16:30:03.026791 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:03.028315 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:30:03.035780 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:30:03.036619 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:30:03.036846 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:03.057973 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
16:30:03.059172 [debug] [ThreadPool]: On list_erp_oltp: Close
16:30:03.061287 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:30:03.066496 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:03.066706 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:30:03.066801 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:30:03.071621 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:30:03.071830 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:30:03.071924 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:30:03.074639 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:30:03.075738 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:30:03.076046 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:30:03.080211 [debug] [MainThread]: Using postgres connection "master"
16:30:03.080367 [debug] [MainThread]: On master: BEGIN
16:30:03.080514 [debug] [MainThread]: Opening a new connection, currently in state init
16:30:03.086076 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:30:03.086286 [debug] [MainThread]: Using postgres connection "master"
16:30:03.086413 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:30:03.096817 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:30:03.098230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec89bee0>]}
16:30:03.098849 [debug] [MainThread]: On master: ROLLBACK
16:30:03.099188 [debug] [MainThread]: Using postgres connection "master"
16:30:03.099339 [debug] [MainThread]: On master: BEGIN
16:30:03.099831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:03.100003 [debug] [MainThread]: On master: COMMIT
16:30:03.100119 [debug] [MainThread]: Using postgres connection "master"
16:30:03.100232 [debug] [MainThread]: On master: COMMIT
16:30:03.100469 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:03.100626 [debug] [MainThread]: On master: Close
16:30:03.101107 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:30:03.101521 [info ] [MainThread]: 
16:30:03.107171 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:30:03.107575 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:30:03.107994 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:30:03.108137 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:30:03.108250 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:30:03.109848 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:30:03.110071 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:30:03.110402 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:30:03.110986 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:30:03.111131 [debug] [Thread-1  ]: finished collecting timing info
16:30:03.111283 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:30:03.111449 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:30:03.111595 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:30:03.130973 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:30:03.148702 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:30:03.149295 [debug] [Thread-2  ]: finished collecting timing info
16:30:03.149603 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:03.149765 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:30:03.149910 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:30:03.151972 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:30:03.152148 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:30:03.152846 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:03.153011 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:30:03.153148 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:30:03.160517 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:30:03.160709 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:03.160856 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:30:03.161204 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:30:03.161338 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:03.161421 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:30:03.167632 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
16:30:03.174390 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:03.174566 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
16:30:03.174697 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:30:03.176584 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:03.176823 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:30:03.177227 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:03.178897 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:03.179035 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:03.179153 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:30:03.180543 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:03.180772 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:30:03.181051 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:03.181297 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:03.190137 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:03.191476 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:03.191725 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:03.191878 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:03.192028 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:30:03.192157 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:30:03.200768 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:30:03.201058 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:30:03.204719 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:30:03.205943 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:30:03.206160 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:30:03.206297 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:30:03.217255 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
16:30:03.218677 [debug] [Thread-1  ]: finished collecting timing info
16:30:03.218897 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:30:03.220885 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec40d310>]}
16:30:03.221178 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.11s]
16:30:03.221500 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:30:03.223125 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.02 seconds
16:30:03.223898 [debug] [Thread-2  ]: finished collecting timing info
16:30:03.224036 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:30:03.224341 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec40d760>]}
16:30:03.224552 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
16:30:03.224832 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:30:03.225308 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:30:03.225466 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:30:03.225739 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:30:03.225830 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:30:03.225915 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:30:03.227319 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:30:03.227579 [debug] [Thread-4  ]: finished collecting timing info
16:30:03.227724 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:30:03.243670 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:30:03.244853 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:03.245039 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:30:03.245134 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:30:03.252944 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:30:03.253171 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:03.253268 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:30:03.254993 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:30:03.256909 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:03.257086 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:30:03.257429 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:30:03.258346 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:03.258475 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:03.258575 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:30:03.266946 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
16:30:03.269453 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:30:03.269646 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:30:03.270000 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:30:03.270796 [debug] [Thread-4  ]: finished collecting timing info
16:30:03.270930 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:30:03.271263 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd3b2551-c743-45cc-9263-3df7420cecf8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec30d550>]}
16:30:03.271509 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
16:30:03.271773 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:30:03.272946 [debug] [MainThread]: Acquiring new postgres connection "master"
16:30:03.273083 [debug] [MainThread]: Using postgres connection "master"
16:30:03.273171 [debug] [MainThread]: On master: BEGIN
16:30:03.273246 [debug] [MainThread]: Opening a new connection, currently in state closed
16:30:03.277790 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:30:03.277978 [debug] [MainThread]: On master: COMMIT
16:30:03.278057 [debug] [MainThread]: Using postgres connection "master"
16:30:03.278125 [debug] [MainThread]: On master: COMMIT
16:30:03.278294 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:30:03.278407 [debug] [MainThread]: On master: Close
16:30:03.278683 [info ] [MainThread]: 
16:30:03.278880 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.25s.
16:30:03.278999 [debug] [MainThread]: Connection 'master' was properly closed.
16:30:03.279060 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:30:03.279118 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:30:03.279173 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:30:03.282380 [info ] [MainThread]: 
16:30:03.282930 [info ] [MainThread]: [32mCompleted successfully[0m
16:30:03.285080 [info ] [MainThread]: 
16:30:03.287876 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:30:03.288269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec89ba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec385e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33ec385cd0>]}


============================== 2022-06-04 16:35:13.725369 | 9596db60-5d0a-4739-a002-e075089fcf74 ==============================
16:35:13.725386 [info ] [MainThread]: Running with dbt=1.1.0
16:35:13.725849 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:35:13.725972 [debug] [MainThread]: Tracking: tracking
16:35:13.728847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1deafac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1deaf8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1deafbe0>]}
16:35:13.744490 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:35:13.745002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1dec0940>]}
16:35:13.754875 [debug] [MainThread]: Parsing macros/catalog.sql
16:35:13.757431 [debug] [MainThread]: Parsing macros/relations.sql
16:35:13.758568 [debug] [MainThread]: Parsing macros/adapters.sql
16:35:13.777510 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:35:13.779001 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:35:13.781023 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:35:13.784157 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:35:13.792033 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:35:13.804576 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:35:13.817382 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:35:13.820865 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:35:13.822071 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:35:13.823088 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:35:13.824927 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:35:13.827025 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:35:13.832382 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:35:13.838138 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:35:13.840497 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:35:13.853031 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:35:13.857813 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:35:13.859224 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:35:13.862640 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:35:13.863998 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:35:13.873690 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:35:13.886404 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:35:13.894441 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:35:13.895733 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:35:13.897547 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:35:13.898701 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:35:13.899816 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:35:13.907092 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:35:13.914272 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:35:13.916509 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:35:13.918246 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:35:13.920227 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:35:13.925548 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:35:13.928882 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:35:13.929506 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:35:13.930135 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:35:13.930669 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:35:13.931674 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:35:13.938056 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:35:13.941398 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:35:14.102190 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:35:14.112674 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:35:14.114691 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:35:14.153768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea20090160>]}
16:35:14.157409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1deaf4c0>]}
16:35:14.157659 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:35:14.157873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea200906d0>]}
16:35:14.158964 [info ] [MainThread]: 
16:35:14.159338 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:14.160065 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:35:14.168172 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:35:14.168318 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:35:14.168970 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:14.178510 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:35:14.179656 [debug] [ThreadPool]: On list_erp_oltp: Close
16:35:14.180875 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:35:14.186653 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:14.186840 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:35:14.186932 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:35:14.193642 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:35:14.194606 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:35:14.194742 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:35:14.196872 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:35:14.197969 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:35:14.198276 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:35:14.202387 [debug] [MainThread]: Using postgres connection "master"
16:35:14.202534 [debug] [MainThread]: On master: BEGIN
16:35:14.202615 [debug] [MainThread]: Opening a new connection, currently in state init
16:35:14.207426 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:35:14.207601 [debug] [MainThread]: Using postgres connection "master"
16:35:14.207683 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:35:14.216600 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:35:14.217688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea20af8910>]}
16:35:14.217916 [debug] [MainThread]: On master: ROLLBACK
16:35:14.218128 [debug] [MainThread]: Using postgres connection "master"
16:35:14.218236 [debug] [MainThread]: On master: BEGIN
16:35:14.218454 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:35:14.218556 [debug] [MainThread]: On master: COMMIT
16:35:14.218631 [debug] [MainThread]: Using postgres connection "master"
16:35:14.218696 [debug] [MainThread]: On master: COMMIT
16:35:14.218899 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:14.219003 [debug] [MainThread]: On master: Close
16:35:14.219285 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:35:14.219455 [info ] [MainThread]: 
16:35:14.223398 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:35:14.223620 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
16:35:14.223930 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:35:14.224028 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:35:14.224115 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:35:14.225366 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:35:14.225590 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:35:14.225819 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:35:14.226115 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:35:14.226214 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:35:14.226318 [debug] [Thread-1  ]: finished collecting timing info
16:35:14.226433 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:35:14.226552 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:35:14.228018 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:35:14.241495 [debug] [Thread-2  ]: finished collecting timing info
16:35:14.241878 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:35:14.274085 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:35:14.278721 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:35:14.278927 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:14.279190 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:35:14.279276 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:35:14.279657 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:14.280217 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:35:14.280298 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:35:14.283799 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
16:35:14.283948 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:14.284029 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:35:14.288200 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:35:14.288364 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:14.288447 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:35:14.289304 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:35:14.294541 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:14.294694 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:35:14.295129 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:14.296584 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:14.296696 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:35:14.297091 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:14.304332 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:14.304709 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.02 seconds
16:35:14.304890 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:14.306789 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:14.307243 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:35:14.307069 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:35:14.307753 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:14.309503 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:14.309629 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:35:14.310077 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:35:14.311039 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:14.311149 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:14.311237 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:35:14.315737 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:35:14.319028 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:35:14.319157 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:35:14.321164 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:35:14.322345 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:35:14.322467 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:35:14.328843 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
16:35:14.329711 [debug] [Thread-2  ]: finished collecting timing info
16:35:14.329838 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:35:14.331427 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1c0cad30>]}
16:35:14.331683 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.11s]
16:35:14.332112 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:35:14.332514 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:35:14.332726 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:35:14.333117 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:35:14.333227 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:35:14.333314 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:35:14.335055 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:35:14.335317 [debug] [Thread-4  ]: finished collecting timing info
16:35:14.335457 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:35:14.337321 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:35:14.337626 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:14.337720 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:35:14.337789 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:35:14.338444 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
16:35:14.339164 [debug] [Thread-1  ]: finished collecting timing info
16:35:14.339283 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:35:14.339599 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1c09eee0>]}
16:35:14.339835 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.12s]
16:35:14.340132 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:35:14.344795 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:35:14.345072 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:14.345176 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:35:14.346404 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:35:14.349237 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:14.349499 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:35:14.355455 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
16:35:14.356864 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:14.357067 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:14.357156 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:35:14.369772 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
16:35:14.371176 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:35:14.371403 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:35:14.371712 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:35:14.372497 [debug] [Thread-4  ]: finished collecting timing info
16:35:14.372623 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:35:14.374661 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9596db60-5d0a-4739-a002-e075089fcf74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1c0b0610>]}
16:35:14.375029 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
16:35:14.375374 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:35:14.376717 [debug] [MainThread]: Acquiring new postgres connection "master"
16:35:14.376917 [debug] [MainThread]: Using postgres connection "master"
16:35:14.377008 [debug] [MainThread]: On master: BEGIN
16:35:14.377103 [debug] [MainThread]: Opening a new connection, currently in state closed
16:35:14.381851 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:35:14.382054 [debug] [MainThread]: On master: COMMIT
16:35:14.382141 [debug] [MainThread]: Using postgres connection "master"
16:35:14.382217 [debug] [MainThread]: On master: COMMIT
16:35:14.382369 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:35:14.382471 [debug] [MainThread]: On master: Close
16:35:14.382786 [info ] [MainThread]: 
16:35:14.383042 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.22s.
16:35:14.383204 [debug] [MainThread]: Connection 'master' was properly closed.
16:35:14.383273 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:35:14.383346 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:35:14.384419 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:35:14.387538 [info ] [MainThread]: 
16:35:14.387837 [info ] [MainThread]: [32mCompleted successfully[0m
16:35:14.388046 [info ] [MainThread]: 
16:35:14.388211 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:35:14.388439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1c0d6b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1c0d6b80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fea1c0d6790>]}


============================== 2022-06-04 16:36:21.553655 | d5dff21f-e1df-4fe3-9160-d052c53e5882 ==============================
16:36:21.553673 [info ] [MainThread]: Running with dbt=1.1.0
16:36:21.554243 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:36:21.554393 [debug] [MainThread]: Tracking: tracking
16:36:21.558290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05189c8fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05189c8fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05189c8d60>]}
16:36:21.574313 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:36:21.574713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05189c4880>]}
16:36:21.582339 [debug] [MainThread]: Parsing macros/catalog.sql
16:36:21.584991 [debug] [MainThread]: Parsing macros/relations.sql
16:36:21.586122 [debug] [MainThread]: Parsing macros/adapters.sql
16:36:21.607770 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:36:21.609164 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:36:21.611085 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:36:21.614540 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:36:21.623978 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:36:21.636414 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:36:21.650543 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:36:21.654362 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:36:21.655647 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:36:21.656791 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:36:21.658696 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:36:21.660780 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:36:21.666337 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:36:21.671996 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:36:21.674471 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:36:21.687198 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:36:21.692405 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:36:21.694384 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:36:21.698088 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:36:21.699596 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:36:21.709587 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:36:21.722740 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:36:21.730921 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:36:21.732280 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:36:21.734163 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:36:21.735376 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:36:21.736502 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:36:21.743888 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:36:21.750798 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:36:21.753124 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:36:21.754885 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:36:21.758220 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:36:21.764202 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:36:21.768055 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:36:21.768783 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:36:21.769495 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:36:21.770047 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:36:21.771143 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:36:21.777544 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:36:21.781207 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:36:21.948277 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:36:21.958203 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:36:21.960385 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:36:21.998406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051a27da30>]}
16:36:22.002067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05189795e0>]}
16:36:22.002300 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:36:22.002562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f051a27d9a0>]}
16:36:22.003545 [info ] [MainThread]: 
16:36:22.003932 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:22.005059 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:36:22.012725 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:36:22.012982 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:36:22.013081 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:36:22.022296 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:36:22.024233 [debug] [ThreadPool]: On list_erp_oltp: Close
16:36:22.032562 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:36:22.037103 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:22.037312 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:36:22.037401 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:36:22.048597 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:36:22.048804 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:22.048913 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:36:22.050641 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:36:22.051702 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:36:22.051907 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:36:22.054993 [debug] [MainThread]: Using postgres connection "master"
16:36:22.055314 [debug] [MainThread]: On master: BEGIN
16:36:22.055426 [debug] [MainThread]: Opening a new connection, currently in state init
16:36:22.059953 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:22.060148 [debug] [MainThread]: Using postgres connection "master"
16:36:22.060229 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:36:22.069730 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:36:22.070914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0518952280>]}
16:36:22.071173 [debug] [MainThread]: On master: ROLLBACK
16:36:22.071419 [debug] [MainThread]: Using postgres connection "master"
16:36:22.071529 [debug] [MainThread]: On master: BEGIN
16:36:22.071762 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:22.071875 [debug] [MainThread]: On master: COMMIT
16:36:22.071955 [debug] [MainThread]: Using postgres connection "master"
16:36:22.072027 [debug] [MainThread]: On master: COMMIT
16:36:22.072180 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:22.072297 [debug] [MainThread]: On master: Close
16:36:22.073266 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:36:22.073522 [info ] [MainThread]: 
16:36:22.077587 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:36:22.077899 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:36:22.078291 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:36:22.078419 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:36:22.078533 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:36:22.080053 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:36:22.080467 [debug] [Thread-1  ]: finished collecting timing info
16:36:22.080670 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:36:22.089217 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:36:22.101201 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:36:22.107079 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:36:22.107260 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:36:22.107360 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:36:22.109164 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:36:22.109480 [debug] [Thread-2  ]: finished collecting timing info
16:36:22.109641 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:36:22.142699 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:36:22.143130 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:22.143288 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:36:22.143368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:36:22.148207 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
16:36:22.148418 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:22.148506 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:36:22.151537 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:36:22.151846 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
16:36:22.156885 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:22.157164 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:36:22.157406 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:22.157589 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:36:22.157719 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
16:36:22.157885 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:22.160768 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:22.161069 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:36:22.161469 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:22.169892 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:22.170088 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:22.170209 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:22.170592 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:36:22.170724 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:22.170798 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:36:22.171813 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:36:22.173516 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:22.173633 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:36:22.173961 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:22.175431 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:22.175596 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:36:22.175959 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:22.176886 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:22.176996 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:22.177123 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:22.178488 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:36:22.182057 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:22.182253 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:36:22.183793 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:36:22.185051 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:22.185175 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:36:22.192529 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
16:36:22.193570 [debug] [Thread-1  ]: finished collecting timing info
16:36:22.193824 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:36:22.194185 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0518932610>]}
16:36:22.194456 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.12s]
16:36:22.194804 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:36:22.198082 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
16:36:22.198899 [debug] [Thread-2  ]: finished collecting timing info
16:36:22.199018 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:36:22.199318 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05189c8d60>]}
16:36:22.199530 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.09s]
16:36:22.199762 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:36:22.200152 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:36:22.200336 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:36:22.200637 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:36:22.200745 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:36:22.200830 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:36:22.202316 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:36:22.202723 [debug] [Thread-4  ]: finished collecting timing info
16:36:22.202851 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:36:22.215347 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:36:22.215889 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:22.216047 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:36:22.216130 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:36:22.223939 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:36:22.224247 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:22.224371 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:36:22.225705 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:36:22.227852 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:22.228022 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:36:22.236111 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
16:36:22.237624 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:22.237834 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:22.237945 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:22.246880 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
16:36:22.248379 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:22.248564 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:36:22.248943 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:36:22.249751 [debug] [Thread-4  ]: finished collecting timing info
16:36:22.249888 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:36:22.250219 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd5dff21f-e1df-4fe3-9160-d052c53e5882', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05183f8b50>]}
16:36:22.250477 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
16:36:22.250775 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:36:22.251889 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:22.252025 [debug] [MainThread]: Using postgres connection "master"
16:36:22.252105 [debug] [MainThread]: On master: BEGIN
16:36:22.252175 [debug] [MainThread]: Opening a new connection, currently in state closed
16:36:22.266512 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:36:22.266765 [debug] [MainThread]: On master: COMMIT
16:36:22.266886 [debug] [MainThread]: Using postgres connection "master"
16:36:22.266980 [debug] [MainThread]: On master: COMMIT
16:36:22.267239 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:22.267399 [debug] [MainThread]: On master: Close
16:36:22.267782 [info ] [MainThread]: 
16:36:22.268004 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.26s.
16:36:22.268140 [debug] [MainThread]: Connection 'master' was properly closed.
16:36:22.268209 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:36:22.268276 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:36:22.268348 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:36:22.271523 [info ] [MainThread]: 
16:36:22.271760 [info ] [MainThread]: [32mCompleted successfully[0m
16:36:22.271979 [info ] [MainThread]: 
16:36:22.272184 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:36:22.272449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05189523d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0518432dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0518432d00>]}


============================== 2022-06-04 16:36:48.090414 | ac1128fb-b1f0-4f7e-8e5b-490572def40f ==============================
16:36:48.090438 [info ] [MainThread]: Running with dbt=1.1.0
16:36:48.090936 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:36:48.091061 [debug] [MainThread]: Tracking: tracking
16:36:48.094546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9c4ac400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9c4ac5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9c4ac2e0>]}
16:36:48.110805 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
16:36:48.111126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9c4be3a0>]}
16:36:48.117988 [debug] [MainThread]: Parsing macros/catalog.sql
16:36:48.120683 [debug] [MainThread]: Parsing macros/relations.sql
16:36:48.121984 [debug] [MainThread]: Parsing macros/adapters.sql
16:36:48.148875 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
16:36:48.150503 [debug] [MainThread]: Parsing macros/materializations/configs.sql
16:36:48.152547 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
16:36:48.155727 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
16:36:48.164249 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
16:36:48.177305 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
16:36:48.191046 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
16:36:48.194970 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
16:36:48.196260 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
16:36:48.197336 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
16:36:48.199253 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
16:36:48.201437 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
16:36:48.207279 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
16:36:48.213176 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
16:36:48.215437 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
16:36:48.228883 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
16:36:48.233793 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
16:36:48.235241 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
16:36:48.238819 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
16:36:48.240453 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
16:36:48.251065 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
16:36:48.264934 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
16:36:48.273519 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
16:36:48.274985 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
16:36:48.276988 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
16:36:48.278225 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
16:36:48.279363 [debug] [MainThread]: Parsing macros/adapters/columns.sql
16:36:48.287158 [debug] [MainThread]: Parsing macros/adapters/relation.sql
16:36:48.294771 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
16:36:48.297240 [debug] [MainThread]: Parsing macros/adapters/schema.sql
16:36:48.299029 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
16:36:48.301403 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
16:36:48.307188 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
16:36:48.311016 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
16:36:48.311714 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
16:36:48.312393 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
16:36:48.312944 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
16:36:48.314065 [debug] [MainThread]: Parsing macros/etc/datetime.sql
16:36:48.321009 [debug] [MainThread]: Parsing macros/etc/statement.sql
16:36:48.326075 [debug] [MainThread]: Parsing tests/generic/builtin.sql
16:36:48.504003 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:36:48.514962 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
16:36:48.517001 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
16:36:48.556121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9e68fc10>]}
16:36:48.559972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9c4aca00>]}
16:36:48.560233 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:36:48.560433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9e68fc70>]}
16:36:48.561524 [info ] [MainThread]: 
16:36:48.561913 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:48.562663 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:36:48.570883 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:36:48.571072 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:36:48.571161 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:36:48.585177 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:36:48.586367 [debug] [ThreadPool]: On list_erp_oltp: Close
16:36:48.587402 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:36:48.594776 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:48.594982 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:36:48.595067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:36:48.599456 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
16:36:48.599634 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:36:48.599718 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:36:48.601440 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:36:48.608746 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:36:48.609286 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:36:48.612277 [debug] [MainThread]: Using postgres connection "master"
16:36:48.612523 [debug] [MainThread]: On master: BEGIN
16:36:48.612623 [debug] [MainThread]: Opening a new connection, currently in state init
16:36:48.617172 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:48.617353 [debug] [MainThread]: Using postgres connection "master"
16:36:48.617436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:36:48.627665 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:36:48.628695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9f0f7c10>]}
16:36:48.629051 [debug] [MainThread]: On master: ROLLBACK
16:36:48.629326 [debug] [MainThread]: Using postgres connection "master"
16:36:48.629441 [debug] [MainThread]: On master: BEGIN
16:36:48.629685 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:48.629840 [debug] [MainThread]: On master: COMMIT
16:36:48.629925 [debug] [MainThread]: Using postgres connection "master"
16:36:48.630000 [debug] [MainThread]: On master: COMMIT
16:36:48.630149 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:48.630261 [debug] [MainThread]: On master: Close
16:36:48.630570 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:36:48.632075 [info ] [MainThread]: 
16:36:48.640366 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:36:48.640710 [info ] [Thread-1  ]: 1 of 3 START view model public.customers ....................................... [RUN]
16:36:48.641173 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:36:48.641362 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:36:48.641489 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:36:48.643350 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:36:48.643815 [debug] [Thread-1  ]: finished collecting timing info
16:36:48.643969 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:36:48.649586 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:36:48.649857 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:36:48.650204 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:36:48.650305 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:36:48.650395 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:36:48.651954 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:36:48.652220 [debug] [Thread-2  ]: finished collecting timing info
16:36:48.652337 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:36:48.692401 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:36:48.692783 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:36:48.693178 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:48.693323 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:36:48.693448 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:48.693550 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:36:48.694458 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:36:48.694827 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:36:48.699670 [debug] [Thread-2  ]: SQL status: BEGIN in 0.0 seconds
16:36:48.699851 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:36:48.699982 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:48.700156 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:48.700285 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:36:48.700393 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:36:48.701629 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:36:48.706349 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:48.706515 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:36:48.707488 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:48.709037 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:48.709742 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:36:48.709913 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
16:36:48.711451 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:48.711566 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:36:48.711920 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:48.712052 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:48.714432 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:48.722548 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:48.722766 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:36:48.722953 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:48.723694 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:36:48.724486 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:48.725642 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:48.725802 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:48.725898 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:36:48.733090 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:36:48.736803 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:36:48.737015 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:36:48.740665 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:36:48.742184 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:36:48.742332 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:36:48.746257 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
16:36:48.747176 [debug] [Thread-2  ]: finished collecting timing info
16:36:48.747320 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:36:48.747665 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d986c5fd0>]}
16:36:48.747917 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.10s]
16:36:48.748210 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:36:48.748548 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:36:48.748738 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:36:48.749013 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:36:48.749099 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:36:48.749176 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:36:48.751291 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:36:48.751598 [debug] [Thread-4  ]: finished collecting timing info
16:36:48.751736 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:36:48.754405 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:36:48.754705 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:48.754842 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
16:36:48.754957 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:36:48.755840 [debug] [Thread-1  ]: finished collecting timing info
16:36:48.756016 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:36:48.756162 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:36:48.756716 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9dd2ee20>]}
16:36:48.757002 [info ] [Thread-1  ]: 1 of 3 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.12s]
16:36:48.757335 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:36:48.769274 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:36:48.769506 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:48.769655 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:36:48.770735 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:36:48.772313 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:48.772445 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:36:48.772781 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:36:48.773683 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:48.773803 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:48.773880 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:36:48.781503 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
16:36:48.782993 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:36:48.783134 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:36:48.784411 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:36:48.785340 [debug] [Thread-4  ]: finished collecting timing info
16:36:48.792470 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:36:48.793173 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ac1128fb-b1f0-4f7e-8e5b-490572def40f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9bfcd760>]}
16:36:48.793486 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
16:36:48.793805 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:36:48.796451 [debug] [MainThread]: Acquiring new postgres connection "master"
16:36:48.796675 [debug] [MainThread]: Using postgres connection "master"
16:36:48.796777 [debug] [MainThread]: On master: BEGIN
16:36:48.796854 [debug] [MainThread]: Opening a new connection, currently in state closed
16:36:48.801469 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:36:48.801790 [debug] [MainThread]: On master: COMMIT
16:36:48.801939 [debug] [MainThread]: Using postgres connection "master"
16:36:48.802058 [debug] [MainThread]: On master: COMMIT
16:36:48.802305 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:36:48.802421 [debug] [MainThread]: On master: Close
16:36:48.802755 [info ] [MainThread]: 
16:36:48.802941 [info ] [MainThread]: Finished running 1 table model, 2 view models in 0.24s.
16:36:48.803098 [debug] [MainThread]: Connection 'master' was properly closed.
16:36:48.803172 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:36:48.803234 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:36:48.803297 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:36:48.808186 [info ] [MainThread]: 
16:36:48.808571 [info ] [MainThread]: [32mCompleted successfully[0m
16:36:48.808769 [info ] [MainThread]: 
16:36:48.808942 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:36:48.809162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9bf2afd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9bf2ad00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9d9bf2ab80>]}


============================== 2022-06-04 16:39:20.856353 | 8b678536-e587-4921-bd48-a828929fb55a ==============================
16:39:20.856370 [info ] [MainThread]: Running with dbt=1.1.0
16:39:20.856834 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:39:20.856958 [debug] [MainThread]: Tracking: tracking
16:39:20.860459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645cf1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645cf1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645cf1e20>]}
16:39:20.885126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
16:39:20.885546 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
16:39:20.904839 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:39:20.922120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b678536-e587-4921-bd48-a828929fb55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f76457c50d0>]}
16:39:20.926279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b678536-e587-4921-bd48-a828929fb55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645c93eb0>]}
16:39:20.926692 [info ] [MainThread]: Found 3 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:39:20.926927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b678536-e587-4921-bd48-a828929fb55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645c93ca0>]}
16:39:20.928110 [info ] [MainThread]: 
16:39:20.928531 [debug] [MainThread]: Acquiring new postgres connection "master"
16:39:20.929936 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:39:20.940639 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:39:20.940912 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:39:20.941029 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:39:20.948049 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:39:20.949274 [debug] [ThreadPool]: On list_erp_oltp: Close
16:39:20.965691 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:39:20.979342 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:39:20.979584 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:39:20.979667 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:39:20.984976 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
16:39:20.985153 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:39:20.985234 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:39:20.986820 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:39:20.987794 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:39:20.988009 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:39:21.018465 [debug] [MainThread]: Using postgres connection "master"
16:39:21.018689 [debug] [MainThread]: On master: BEGIN
16:39:21.018776 [debug] [MainThread]: Opening a new connection, currently in state init
16:39:21.023324 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:39:21.023527 [debug] [MainThread]: Using postgres connection "master"
16:39:21.023641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:39:21.032669 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
16:39:21.033919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b678536-e587-4921-bd48-a828929fb55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764758cf40>]}
16:39:21.034177 [debug] [MainThread]: On master: ROLLBACK
16:39:21.034437 [debug] [MainThread]: Using postgres connection "master"
16:39:21.034545 [debug] [MainThread]: On master: BEGIN
16:39:21.034774 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:39:21.034888 [debug] [MainThread]: On master: COMMIT
16:39:21.034967 [debug] [MainThread]: Using postgres connection "master"
16:39:21.035039 [debug] [MainThread]: On master: COMMIT
16:39:21.035183 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:39:21.035292 [debug] [MainThread]: On master: Close
16:39:21.035606 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:39:21.035804 [info ] [MainThread]: 
16:39:21.040488 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:39:21.040842 [info ] [Thread-1  ]: 1 of 3 START table model public.customers ...................................... [RUN]
16:39:21.041280 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:39:21.041404 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:39:21.041506 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:39:21.043296 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:39:21.043639 [debug] [Thread-1  ]: finished collecting timing info
16:39:21.043822 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:39:21.064636 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:39:21.075724 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
16:39:21.076462 [info ] [Thread-2  ]: 2 of 3 START table model public.my_first_dbt_model ............................. [RUN]
16:39:21.077003 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:39:21.077181 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
16:39:21.077285 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
16:39:21.079744 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:39:21.081200 [debug] [Thread-2  ]: finished collecting timing info
16:39:21.089158 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
16:39:21.092516 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:39:21.093051 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.093260 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:39:21.093370 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:39:21.094646 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.095250 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
16:39:21.095340 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:39:21.099212 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
16:39:21.099383 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.099473 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */


  create  table "erp_oltp"."public"."customers__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:39:21.101385 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
16:39:21.101544 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:39:21.116812 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.117088 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:39:21.117238 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.117489 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:39:21.118251 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.120212 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.120428 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.0 seconds
16:39:21.120569 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:39:21.122332 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.122583 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:39:21.122884 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.130970 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:39:21.131215 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.131359 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:39:21.131477 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
16:39:21.134327 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.134472 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:39:21.134838 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.135889 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:39:21.135997 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.136078 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
16:39:21.139660 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:39:21.143867 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:39:21.144010 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:39:21.145081 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:39:21.147099 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:39:21.147217 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:39:21.152878 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
16:39:21.153879 [debug] [Thread-1  ]: finished collecting timing info
16:39:21.154045 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:39:21.155926 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b678536-e587-4921-bd48-a828929fb55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764578d340>]}
16:39:21.156309 [info ] [Thread-1  ]: 1 of 3 OK created table model public.customers ................................. [[32mSELECT 100[0m in 0.11s]
16:39:21.156730 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:39:21.158445 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
16:39:21.159463 [debug] [Thread-2  ]: finished collecting timing info
16:39:21.159641 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
16:39:21.161175 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b678536-e587-4921-bd48-a828929fb55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764578b1c0>]}
16:39:21.161438 [info ] [Thread-2  ]: 2 of 3 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
16:39:21.161781 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
16:39:21.162217 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
16:39:21.162401 [info ] [Thread-4  ]: 3 of 3 START view model public.my_second_dbt_model ............................. [RUN]
16:39:21.162683 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:39:21.162773 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
16:39:21.162854 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
16:39:21.164326 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:39:21.165168 [debug] [Thread-4  ]: finished collecting timing info
16:39:21.165292 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
16:39:21.195723 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:39:21.196421 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.196595 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
16:39:21.196690 [debug] [Thread-4  ]: Opening a new connection, currently in state init
16:39:21.202902 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
16:39:21.203142 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.203260 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:39:21.204544 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
16:39:21.206786 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.206972 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:39:21.207452 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
16:39:21.208596 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:39:21.208798 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.208944 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
16:39:21.216926 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
16:39:21.218289 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:39:21.218441 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:39:21.218759 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
16:39:21.219666 [debug] [Thread-4  ]: finished collecting timing info
16:39:21.219813 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
16:39:21.220191 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8b678536-e587-4921-bd48-a828929fb55a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7645bfa7c0>]}
16:39:21.220457 [info ] [Thread-4  ]: 3 of 3 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
16:39:21.220806 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
16:39:21.222307 [debug] [MainThread]: Acquiring new postgres connection "master"
16:39:21.222461 [debug] [MainThread]: Using postgres connection "master"
16:39:21.222548 [debug] [MainThread]: On master: BEGIN
16:39:21.222641 [debug] [MainThread]: Opening a new connection, currently in state closed
16:39:21.228144 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
16:39:21.228406 [debug] [MainThread]: On master: COMMIT
16:39:21.228512 [debug] [MainThread]: Using postgres connection "master"
16:39:21.228600 [debug] [MainThread]: On master: COMMIT
16:39:21.228809 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:39:21.228998 [debug] [MainThread]: On master: Close
16:39:21.229426 [info ] [MainThread]: 
16:39:21.229652 [info ] [MainThread]: Finished running 2 table models, 1 view model in 0.30s.
16:39:21.229830 [debug] [MainThread]: Connection 'master' was properly closed.
16:39:21.229911 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:39:21.229983 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:39:21.230053 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:39:21.233374 [info ] [MainThread]: 
16:39:21.233657 [info ] [MainThread]: [32mCompleted successfully[0m
16:39:21.233869 [info ] [MainThread]: 
16:39:21.234038 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
16:39:21.234677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f764758c0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647af5250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7647e76c40>]}


============================== 2022-06-04 16:41:58.468787 | 41973d94-fbb3-4b8d-81b6-6e57100f3c16 ==============================
16:41:58.468805 [info ] [MainThread]: Running with dbt=1.1.0
16:41:58.469757 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
16:41:58.469891 [debug] [MainThread]: Tracking: tracking
16:41:58.473267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f79c1550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f79c1730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f79c1430>]}
16:41:58.501214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
16:41:58.501567 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/customers2.sql
16:41:58.501795 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
16:41:58.510744 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
16:41:58.522027 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
16:41:58.529630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f748fee0>]}
16:41:58.533662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f7960f10>]}
16:41:58.533928 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 0 sources, 0 exposures, 0 metrics
16:41:58.534196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f7960eb0>]}
16:41:58.535390 [info ] [MainThread]: 
16:41:58.535834 [debug] [MainThread]: Acquiring new postgres connection "master"
16:41:58.536669 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
16:41:58.544538 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
16:41:58.545035 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
16:41:58.545222 [debug] [ThreadPool]: Opening a new connection, currently in state init
16:41:58.551600 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
16:41:58.552759 [debug] [ThreadPool]: On list_erp_oltp: Close
16:41:58.561566 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
16:41:58.569796 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:41:58.569999 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
16:41:58.570086 [debug] [ThreadPool]: Opening a new connection, currently in state closed
16:41:58.585132 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
16:41:58.585358 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
16:41:58.585475 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
16:41:58.587161 [debug] [ThreadPool]: SQL status: SELECT 11 in 0.0 seconds
16:41:58.588408 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
16:41:58.588681 [debug] [ThreadPool]: On list_erp_oltp_public: Close
16:41:58.591765 [debug] [MainThread]: Using postgres connection "master"
16:41:58.591902 [debug] [MainThread]: On master: BEGIN
16:41:58.621946 [debug] [MainThread]: Opening a new connection, currently in state init
16:41:58.626575 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:41:58.626783 [debug] [MainThread]: Using postgres connection "master"
16:41:58.626880 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
16:41:58.635485 [debug] [MainThread]: SQL status: SELECT 1 in 0.01 seconds
16:41:58.636556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f9ba44c0>]}
16:41:58.636864 [debug] [MainThread]: On master: ROLLBACK
16:41:58.637134 [debug] [MainThread]: Using postgres connection "master"
16:41:58.637239 [debug] [MainThread]: On master: BEGIN
16:41:58.637456 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:41:58.637571 [debug] [MainThread]: On master: COMMIT
16:41:58.637646 [debug] [MainThread]: Using postgres connection "master"
16:41:58.637720 [debug] [MainThread]: On master: COMMIT
16:41:58.637875 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:41:58.637979 [debug] [MainThread]: On master: Close
16:41:58.638352 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
16:41:58.638535 [info ] [MainThread]: 
16:41:58.641592 [debug] [Thread-1  ]: Began running node model.first_project.customers
16:41:58.641815 [info ] [Thread-1  ]: 1 of 4 START view model public.customers ....................................... [RUN]
16:41:58.642134 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
16:41:58.642283 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
16:41:58.642397 [debug] [Thread-1  ]: Compiling model.first_project.customers
16:41:58.643225 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
16:41:58.643489 [debug] [Thread-1  ]: finished collecting timing info
16:41:58.643601 [debug] [Thread-1  ]: Began executing node model.first_project.customers
16:41:58.658230 [debug] [Thread-2  ]: Began running node model.first_project.customers2
16:41:58.658512 [info ] [Thread-2  ]: 2 of 4 START table model public.customers2 ..................................... [RUN]
16:41:58.658898 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
16:41:58.659024 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
16:41:58.659112 [debug] [Thread-2  ]: Compiling model.first_project.customers2
16:41:58.660781 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
16:41:58.661069 [debug] [Thread-2  ]: finished collecting timing info
16:41:58.661179 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
16:41:58.677949 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
16:41:58.680397 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
16:41:58.683210 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
16:41:58.683664 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
16:41:58.684202 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:41:58.684342 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
16:41:58.684663 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
16:41:58.684906 [debug] [Thread-2  ]: Opening a new connection, currently in state init
16:41:58.685105 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
16:41:58.685655 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
16:41:58.688356 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
16:41:58.685296 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:41:58.688666 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
16:41:58.688815 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
16:41:58.690022 [debug] [Thread-3  ]: finished collecting timing info
16:41:58.690197 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
16:41:58.692283 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
16:41:58.692746 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
16:41:58.692954 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:41:58.693079 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:41:58.693283 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:41:58.694338 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
16:41:58.694467 [debug] [Thread-3  ]: Opening a new connection, currently in state init
16:41:58.695113 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
16:41:58.704231 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:41:58.704661 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
16:41:58.705063 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
16:41:58.705234 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:41:58.705330 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
16:41:58.706390 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
16:41:58.712497 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:41:58.712757 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
16:41:58.716978 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
16:41:58.717278 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:41:58.727723 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
16:41:58.727951 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
16:41:58.731237 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:41:58.731076 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:41:58.731339 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
16:41:58.730826 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:41:58.731463 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
16:41:58.732981 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
16:41:58.734625 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
16:41:58.735879 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:41:58.736011 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:41:58.736102 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
16:41:58.736485 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.0 seconds
16:41:58.738179 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:41:58.738306 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
16:41:58.738768 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
16:41:58.743321 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
16:41:58.743567 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
16:41:58.743938 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.0 seconds
16:41:58.744861 [debug] [Thread-2  ]: finished collecting timing info
16:41:58.745054 [debug] [Thread-2  ]: On model.first_project.customers2: Close
16:41:58.745172 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
16:41:58.747294 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:41:58.747772 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f7459d00>]}
16:41:58.747913 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
16:41:58.748028 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
16:41:58.750913 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
16:41:58.748955 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
16:41:58.748368 [info ] [Thread-2  ]: 2 of 4 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.09s]
16:41:58.751254 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
16:41:58.752324 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:41:58.753010 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
16:41:58.755371 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:41:58.755835 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
16:41:58.760951 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
16:41:58.761962 [debug] [Thread-3  ]: finished collecting timing info
16:41:58.762120 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
16:41:58.762560 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f741d250>]}
16:41:58.762883 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.08s]
16:41:58.764505 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
16:41:58.765019 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
16:41:58.765218 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
16:41:58.765555 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
16:41:58.765658 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
16:41:58.765747 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
16:41:58.767480 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
16:41:58.767750 [debug] [Thread-5  ]: finished collecting timing info
16:41:58.767878 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
16:41:58.769755 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
16:41:58.769959 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
16:41:58.771013 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
16:41:58.771144 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop table if exists "erp_oltp"."public"."customers__dbt_backup" cascade
16:41:58.771339 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:41:58.771442 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
16:41:58.771520 [debug] [Thread-5  ]: Opening a new connection, currently in state init
16:41:58.787426 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
16:41:58.788491 [debug] [Thread-1  ]: finished collecting timing info
16:41:58.788655 [debug] [Thread-1  ]: On model.first_project.customers: Close
16:41:58.789069 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f79b94c0>]}
16:41:58.789436 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
16:41:58.790728 [info ] [Thread-1  ]: 1 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.15s]
16:41:58.790892 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:41:58.791168 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
16:41:58.791386 [debug] [Thread-1  ]: Finished running node model.first_project.customers
16:41:58.792579 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
16:41:58.794291 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:41:58.794416 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
16:41:58.794848 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
16:41:58.795772 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:41:58.795898 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:41:58.795981 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
16:41:58.813362 [debug] [Thread-5  ]: SQL status: COMMIT in 0.02 seconds
16:41:58.814826 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
16:41:58.814975 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
16:41:58.815284 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
16:41:58.816195 [debug] [Thread-5  ]: finished collecting timing info
16:41:58.816342 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
16:41:58.817539 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41973d94-fbb3-4b8d-81b6-6e57100f3c16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f7413e20>]}
16:41:58.824751 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
16:41:58.825249 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
16:41:58.826902 [debug] [MainThread]: Acquiring new postgres connection "master"
16:41:58.827092 [debug] [MainThread]: Using postgres connection "master"
16:41:58.827182 [debug] [MainThread]: On master: BEGIN
16:41:58.827253 [debug] [MainThread]: Opening a new connection, currently in state closed
16:41:58.832042 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
16:41:58.832242 [debug] [MainThread]: On master: COMMIT
16:41:58.832352 [debug] [MainThread]: Using postgres connection "master"
16:41:58.832426 [debug] [MainThread]: On master: COMMIT
16:41:58.832599 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
16:41:58.832770 [debug] [MainThread]: On master: Close
16:41:58.833117 [info ] [MainThread]: 
16:41:58.833313 [info ] [MainThread]: Finished running 2 table models, 2 view models in 0.30s.
16:41:58.833448 [debug] [MainThread]: Connection 'master' was properly closed.
16:41:58.833560 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
16:41:58.833644 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
16:41:58.833706 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
16:41:58.833766 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
16:41:58.836990 [info ] [MainThread]: 
16:41:58.837195 [info ] [MainThread]: [32mCompleted successfully[0m
16:41:58.837400 [info ] [MainThread]: 
16:41:58.837554 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
16:41:58.837755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f9ba4c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f9ba43a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58f98ecfd0>]}


============================== 2022-06-04 17:02:23.238299 | cf1ca259-403f-40e1-bd12-fc940b527bff ==============================
17:02:23.238317 [info ] [MainThread]: Running with dbt=1.1.0
17:02:23.238840 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:02:23.238969 [debug] [MainThread]: Tracking: tracking
17:02:23.242393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef39ca4520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef39ca4760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef39ca41f0>]}
17:02:23.260016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef39ca4be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef39c0b9a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef39c0b880>]}


============================== 2022-06-04 17:03:04.757887 | f51bfb0e-a885-4d3a-9e37-67fdac5433cf ==============================
17:03:04.757914 [info ] [MainThread]: Running with dbt=1.1.0
17:03:04.758690 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:03:04.758910 [debug] [MainThread]: Tracking: tracking
17:03:04.764108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb41e84c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb41e8d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb41e86d0>]}
17:03:04.787774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb41ec8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb414ea90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fbdb414e970>]}


============================== 2022-06-04 17:03:37.808265 | d7588eb0-edbb-4432-8b91-94ed594f98c3 ==============================
17:03:37.808285 [info ] [MainThread]: Running with dbt=1.1.0
17:03:37.808853 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:03:37.809033 [debug] [MainThread]: Tracking: tracking
17:03:37.813006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b36e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b36e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b36e2b0>]}
17:03:37.856298 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:03:37.857050 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/schema.yml
17:03:37.877622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b24cf10>]}
17:03:37.882544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b2d1f10>]}
17:03:37.882886 [info ] [MainThread]: Found 4 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:03:37.883240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b2d1880>]}
17:03:37.884765 [info ] [MainThread]: 
17:03:37.885292 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:37.886277 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:03:37.895104 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:03:37.895322 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:03:37.902773 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:03:37.913700 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:03:37.914944 [debug] [ThreadPool]: On list_erp_oltp: Close
17:03:37.916208 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:03:37.920682 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:37.920819 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:03:37.920960 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:03:37.932190 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:03:37.932395 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:03:37.932479 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:03:37.934109 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:03:37.935234 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:03:37.935474 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:03:37.939217 [debug] [MainThread]: Using postgres connection "master"
17:03:37.939384 [debug] [MainThread]: On master: BEGIN
17:03:37.939460 [debug] [MainThread]: Opening a new connection, currently in state init
17:03:37.943766 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:03:37.944000 [debug] [MainThread]: Using postgres connection "master"
17:03:37.944082 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:03:37.954638 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:03:37.955820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b1e9850>]}
17:03:37.956101 [debug] [MainThread]: On master: ROLLBACK
17:03:37.956387 [debug] [MainThread]: Using postgres connection "master"
17:03:37.956506 [debug] [MainThread]: On master: BEGIN
17:03:37.956896 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:03:37.957011 [debug] [MainThread]: On master: COMMIT
17:03:37.957093 [debug] [MainThread]: Using postgres connection "master"
17:03:37.957163 [debug] [MainThread]: On master: COMMIT
17:03:37.957406 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:37.957518 [debug] [MainThread]: On master: Close
17:03:37.957842 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:03:37.958089 [info ] [MainThread]: 
17:03:37.998951 [debug] [Thread-1  ]: Began running node model.first_project.customers
17:03:37.999288 [info ] [Thread-1  ]: 1 of 4 START view model public.customers ....................................... [RUN]
17:03:37.999652 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
17:03:37.999772 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
17:03:37.999886 [debug] [Thread-1  ]: Compiling model.first_project.customers
17:03:38.000856 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
17:03:38.001080 [debug] [Thread-2  ]: Began running node model.first_project.customers2
17:03:38.001242 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:03:38.001439 [info ] [Thread-2  ]: 2 of 4 START table model public.customers2 ..................................... [RUN]
17:03:38.001623 [info ] [Thread-3  ]: 3 of 4 START table model public.my_first_dbt_model ............................. [RUN]
17:03:38.002006 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
17:03:38.002315 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:03:38.002445 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
17:03:38.002593 [debug] [Thread-1  ]: finished collecting timing info
17:03:38.002943 [debug] [Thread-1  ]: Began executing node model.first_project.customers
17:03:38.002811 [debug] [Thread-2  ]: Compiling model.first_project.customers2
17:03:38.002700 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:03:38.015481 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
17:03:38.026720 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:03:38.037208 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:03:38.034976 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
17:03:38.037649 [debug] [Thread-3  ]: finished collecting timing info
17:03:38.037860 [debug] [Thread-2  ]: finished collecting timing info
17:03:38.038143 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:03:38.038361 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
17:03:38.072589 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:03:38.073264 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:03:38.073419 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
17:03:38.073506 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:03:38.075526 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
17:03:38.075895 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:38.076097 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:03:38.076221 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:03:38.076361 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
17:03:38.076481 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:03:38.076624 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:03:38.082138 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:03:38.082347 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:03:38.082436 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:03:38.082653 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:03:38.082821 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:38.082915 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:03:38.084502 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
17:03:38.090950 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:38.091254 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:03:38.091605 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:03:38.093613 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:03:38.093748 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:03:38.091747 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:03:38.093919 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:03:38.094008 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:03:38.094609 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:38.094755 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:38.096352 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:38.098719 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
17:03:38.098590 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:03:38.101621 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:03:38.101297 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:03:38.101812 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:03:38.102208 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:38.098887 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:03:38.102334 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:38.108417 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:03:38.110439 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:03:38.111385 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:03:38.111221 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:03:38.111559 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:03:38.111754 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:38.116128 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:03:38.116284 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:03:38.116369 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:03:38.111060 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:38.117588 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:38.117802 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:38.117910 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:03:38.119980 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:03:38.123673 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:03:38.124455 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:03:38.125520 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:03:38.125735 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:03:38.126951 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:03:38.128078 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:03:38.128213 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:03:38.128360 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:03:38.133562 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
17:03:38.134549 [debug] [Thread-1  ]: finished collecting timing info
17:03:38.134701 [debug] [Thread-1  ]: On model.first_project.customers: Close
17:03:38.135067 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131cc10eb0>]}
17:03:38.135340 [info ] [Thread-1  ]: 1 of 4 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.14s]
17:03:38.135700 [debug] [Thread-1  ]: Finished running node model.first_project.customers
17:03:38.139335 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
17:03:38.140221 [debug] [Thread-2  ]: finished collecting timing info
17:03:38.140353 [debug] [Thread-2  ]: On model.first_project.customers2: Close
17:03:38.140666 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b2372e0>]}
17:03:38.140942 [info ] [Thread-2  ]: 2 of 4 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.14s]
17:03:38.141223 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
17:03:38.142348 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
17:03:38.143153 [debug] [Thread-3  ]: finished collecting timing info
17:03:38.143303 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:03:38.143644 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b1c3dc0>]}
17:03:38.143875 [info ] [Thread-3  ]: 3 of 4 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
17:03:38.144133 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:03:38.144890 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:03:38.145105 [info ] [Thread-5  ]: 4 of 4 START view model public.my_second_dbt_model ............................. [RUN]
17:03:38.145465 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:03:38.145602 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:03:38.145693 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:03:38.153694 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:03:38.154124 [debug] [Thread-5  ]: finished collecting timing info
17:03:38.154455 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:03:38.156633 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:03:38.157072 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:38.157207 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:03:38.157289 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:03:38.163848 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:03:38.164132 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:38.164228 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:03:38.165453 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:03:38.167351 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:38.167502 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:03:38.167851 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:03:38.169046 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:38.169178 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:38.169267 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:03:38.183574 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:03:38.185744 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:03:38.185993 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:03:38.186557 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:03:38.187861 [debug] [Thread-5  ]: finished collecting timing info
17:03:38.188064 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:03:38.188480 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7588eb0-edbb-4432-8b91-94ed594f98c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1318171100>]}
17:03:38.188814 [info ] [Thread-5  ]: 4 of 4 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:03:38.189178 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:03:38.190363 [debug] [MainThread]: Acquiring new postgres connection "master"
17:03:38.190503 [debug] [MainThread]: Using postgres connection "master"
17:03:38.190583 [debug] [MainThread]: On master: BEGIN
17:03:38.190654 [debug] [MainThread]: Opening a new connection, currently in state closed
17:03:38.196507 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:03:38.196733 [debug] [MainThread]: On master: COMMIT
17:03:38.196821 [debug] [MainThread]: Using postgres connection "master"
17:03:38.196898 [debug] [MainThread]: On master: COMMIT
17:03:38.197163 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:03:38.197290 [debug] [MainThread]: On master: Close
17:03:38.197680 [info ] [MainThread]: 
17:03:38.197862 [info ] [MainThread]: Finished running 2 view models, 2 table models in 0.31s.
17:03:38.197997 [debug] [MainThread]: Connection 'master' was properly closed.
17:03:38.198067 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:03:38.198132 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:03:38.198194 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:03:38.198258 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:03:38.201590 [info ] [MainThread]: 
17:03:38.201800 [info ] [MainThread]: [32mCompleted successfully[0m
17:03:38.201979 [info ] [MainThread]: 
17:03:38.202116 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
17:03:38.202337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131d53fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b1f5e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f131b1fa790>]}


============================== 2022-06-04 17:10:13.891773 | 90c724e4-9cc5-4bda-ad06-18904bef25fb ==============================
17:10:13.891791 [info ] [MainThread]: Running with dbt=1.1.0
17:10:13.892296 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:10:13.892427 [debug] [MainThread]: Tracking: tracking
17:10:13.901384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a648c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a648c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a648c2b0>]}
17:10:13.927228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:10:13.927692 [debug] [MainThread]: Partial parsing: added file: first_project://models/postgres_sample_source/postgres_sample_source_customers.sql
17:10:13.937270 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
17:10:13.954407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5f5d0d0>]}
17:10:13.958898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a63f0d90>]}
17:10:13.959218 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:10:13.959472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a63f0fa0>]}
17:10:13.960923 [info ] [MainThread]: 
17:10:13.961358 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:13.962266 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:10:13.972501 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:10:13.972742 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:10:13.972875 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:10:13.981136 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:10:13.982343 [debug] [ThreadPool]: On list_erp_oltp: Close
17:10:13.984809 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:10:13.990409 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:13.990563 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:10:13.990660 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:10:13.997142 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:10:13.997379 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:10:13.997467 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:10:13.999307 [debug] [ThreadPool]: SQL status: SELECT 12 in 0.0 seconds
17:10:14.000412 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:10:14.000631 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:10:14.031875 [debug] [MainThread]: Using postgres connection "master"
17:10:14.032080 [debug] [MainThread]: On master: BEGIN
17:10:14.032164 [debug] [MainThread]: Opening a new connection, currently in state init
17:10:14.037971 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:10:14.038266 [debug] [MainThread]: Using postgres connection "master"
17:10:14.038391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:10:14.051256 [debug] [MainThread]: SQL status: SELECT 3 in 0.01 seconds
17:10:14.052521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a6393fd0>]}
17:10:14.052832 [debug] [MainThread]: On master: ROLLBACK
17:10:14.053145 [debug] [MainThread]: Using postgres connection "master"
17:10:14.053264 [debug] [MainThread]: On master: BEGIN
17:10:14.053546 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:14.053663 [debug] [MainThread]: On master: COMMIT
17:10:14.053743 [debug] [MainThread]: Using postgres connection "master"
17:10:14.053821 [debug] [MainThread]: On master: COMMIT
17:10:14.054450 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:14.054617 [debug] [MainThread]: On master: Close
17:10:14.054978 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:10:14.055203 [info ] [MainThread]: 
17:10:14.058703 [debug] [Thread-1  ]: Began running node model.first_project.customers
17:10:14.058958 [info ] [Thread-1  ]: 1 of 5 START view model public.customers ....................................... [RUN]
17:10:14.059292 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
17:10:14.059398 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
17:10:14.059494 [debug] [Thread-1  ]: Compiling model.first_project.customers
17:10:14.060423 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
17:10:14.060737 [debug] [Thread-1  ]: finished collecting timing info
17:10:14.060897 [debug] [Thread-1  ]: Began executing node model.first_project.customers
17:10:14.077306 [debug] [Thread-2  ]: Began running node model.first_project.customers2
17:10:14.077556 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:10:14.077716 [debug] [Thread-4  ]: Began running node model.first_project.postgres_sample_source_customers
17:10:14.078551 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
17:10:14.079341 [info ] [Thread-2  ]: 2 of 5 START table model public.customers2 ..................................... [RUN]
17:10:14.079614 [info ] [Thread-3  ]: 3 of 5 START table model public.my_first_dbt_model ............................. [RUN]
17:10:14.079840 [info ] [Thread-4  ]: 4 of 5 START view model public.postgres_sample_source_customers ................ [RUN]
17:10:14.080588 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
17:10:14.080817 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
17:10:14.081118 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:10:14.081596 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:10:14.081753 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:10:14.081916 [debug] [Thread-2  ]: Compiling model.first_project.customers2
17:10:14.082083 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:10:14.084366 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:10:14.082228 [debug] [Thread-4  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:10:14.086126 [debug] [Thread-4  ]: Compiling model.first_project.postgres_sample_source_customers
17:10:14.087655 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:10:14.087948 [debug] [Thread-4  ]: finished collecting timing info
17:10:14.088061 [debug] [Thread-4  ]: Began executing node model.first_project.postgres_sample_source_customers
17:10:14.085900 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:10:14.090806 [debug] [Thread-3  ]: finished collecting timing info
17:10:14.084104 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
17:10:14.091250 [debug] [Thread-2  ]: finished collecting timing info
17:10:14.090959 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:10:14.082348 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
17:10:14.091431 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
17:10:14.114493 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
17:10:14.114930 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:10:14.115103 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
17:10:14.115211 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:10:14.090338 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:10:14.109432 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:10:14.112146 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:10:14.116952 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:14.117321 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:14.117993 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:10:14.118148 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:10:14.118329 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:10:14.118525 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:10:14.128831 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:10:14.129077 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:10:14.129300 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:14.129516 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:14.129662 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:10:14.129814 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:10:14.130097 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:10:14.130210 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:10:14.130285 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:10:14.132625 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
17:10:14.138089 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:14.138269 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:10:14.138925 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.01 seconds
17:10:14.140832 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:10:14.141008 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:10:14.141511 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.143129 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:14.143399 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.143542 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:10:14.146005 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:10:14.146171 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:10:14.146438 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:10:14.146524 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:10:14.146341 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:10:14.148307 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.148441 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.154388 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:10:14.160019 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:10:14.157056 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:14.160138 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:10:14.154514 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
17:10:14.158358 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:10:14.162400 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:10:14.161855 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:14.160276 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:14.162527 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.162634 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:10:14.162751 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:10:14.162871 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:10:14.165795 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.166829 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:14.165209 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:10:14.166947 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:14.167079 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:10:14.167217 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:10:14.167694 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.168522 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:10:14.168671 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:10:14.168768 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:10:14.176147 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:10:14.180015 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:10:14.180193 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:10:14.186487 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
17:10:14.186654 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
17:10:14.186765 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
17:10:14.191069 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:10:14.190032 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:10:14.188007 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:10:14.191406 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:10:14.191300 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:10:14.191197 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:10:14.192448 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
17:10:14.192576 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:14.193689 [debug] [Thread-2  ]: finished collecting timing info
17:10:14.195467 [debug] [Thread-4  ]: finished collecting timing info
17:10:14.195729 [debug] [Thread-2  ]: On model.first_project.customers2: Close
17:10:14.195948 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: Close
17:10:14.198654 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5ebdaf0>]}
17:10:14.198860 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
17:10:14.198994 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
17:10:14.201509 [debug] [Thread-1  ]: finished collecting timing info
17:10:14.200222 [debug] [Thread-3  ]: finished collecting timing info
17:10:14.201905 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:10:14.201669 [debug] [Thread-1  ]: On model.first_project.customers: Close
17:10:14.199303 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a466e760>]}
17:10:14.203697 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5ed0fa0>]}
17:10:14.204029 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a5f28790>]}
17:10:14.200534 [info ] [Thread-4  ]: 4 of 5 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:10:14.204394 [info ] [Thread-2  ]: 2 of 5 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.12s]
17:10:14.204691 [info ] [Thread-3  ]: 3 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:10:14.204979 [info ] [Thread-1  ]: 1 of 5 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.14s]
17:10:14.205411 [debug] [Thread-4  ]: Finished running node model.first_project.postgres_sample_source_customers
17:10:14.205690 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
17:10:14.205929 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:10:14.206192 [debug] [Thread-1  ]: Finished running node model.first_project.customers
17:10:14.206739 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:10:14.206882 [info ] [Thread-6  ]: 5 of 5 START view model public.my_second_dbt_model ............................. [RUN]
17:10:14.207142 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:10:14.207225 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:10:14.207300 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:10:14.208734 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:10:14.209121 [debug] [Thread-6  ]: finished collecting timing info
17:10:14.209270 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:10:14.210761 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:10:14.211083 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:14.211188 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:10:14.211260 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:10:14.215691 [debug] [Thread-6  ]: SQL status: BEGIN in 0.0 seconds
17:10:14.215858 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:14.215929 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:10:14.216823 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:10:14.218514 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:14.218650 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:10:14.219139 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:10:14.220071 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:14.220189 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:14.220262 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:10:14.225940 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
17:10:14.228662 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:10:14.228811 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:10:14.229149 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:10:14.232593 [debug] [Thread-6  ]: finished collecting timing info
17:10:14.232790 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:10:14.234794 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '90c724e4-9cc5-4bda-ad06-18904bef25fb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a866fcd0>]}
17:10:14.235164 [info ] [Thread-6  ]: 5 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.03s]
17:10:14.235470 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:10:14.236791 [debug] [MainThread]: Acquiring new postgres connection "master"
17:10:14.237015 [debug] [MainThread]: Using postgres connection "master"
17:10:14.237104 [debug] [MainThread]: On master: BEGIN
17:10:14.237170 [debug] [MainThread]: Opening a new connection, currently in state closed
17:10:14.241773 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:10:14.241974 [debug] [MainThread]: On master: COMMIT
17:10:14.242072 [debug] [MainThread]: Using postgres connection "master"
17:10:14.242191 [debug] [MainThread]: On master: COMMIT
17:10:14.242414 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:10:14.242530 [debug] [MainThread]: On master: Close
17:10:14.242989 [info ] [MainThread]: 
17:10:14.243269 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0.28s.
17:10:14.243449 [debug] [MainThread]: Connection 'master' was properly closed.
17:10:14.244352 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:10:14.244720 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:10:14.244798 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:10:14.244902 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:10:14.244975 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:10:14.250879 [info ] [MainThread]: 
17:10:14.251166 [info ] [MainThread]: [32mCompleted successfully[0m
17:10:14.251380 [info ] [MainThread]: 
17:10:14.251534 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
17:10:14.251776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a83b36d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a8609bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb4a8609d90>]}


============================== 2022-06-04 17:12:08.770709 | defc67db-d406-46c1-9225-bed128aceabc ==============================
17:12:08.770730 [info ] [MainThread]: Running with dbt=1.1.0
17:12:08.771286 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:12:08.771427 [debug] [MainThread]: Tracking: tracking
17:12:08.775419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087189f400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087189f5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f087189f2e0>]}
17:12:08.802758 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:12:08.803222 [debug] [MainThread]: Partial parsing: updated file: first_project://models/postgres_sample_source/postgres_sample_source_customers.sql
17:12:08.814809 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
17:12:08.825766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f08717a23a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0871362c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0871362ca0>]}


============================== 2022-06-04 17:12:41.415828 | 1b6b3f1f-ca98-43e6-b89e-1c4aca140fcc ==============================
17:12:41.415847 [info ] [MainThread]: Running with dbt=1.1.0
17:12:41.416517 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:12:41.416654 [debug] [MainThread]: Tracking: tracking
17:12:41.420421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffcc77b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffcc77190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffcc77940>]}
17:12:41.444576 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:12:41.446060 [debug] [MainThread]: Partial parsing: deleted source source.first_project.postgres_sample_source.clientes
17:12:41.446252 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/postgres_sample_source/schema.yml
17:12:41.456554 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
17:12:41.477666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffcb7f7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffc754e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7efffc75b250>]}


============================== 2022-06-04 17:12:58.573584 | 554bcbd9-bcd8-430e-8037-bf259a4b7ebd ==============================
17:12:58.573604 [info ] [MainThread]: Running with dbt=1.1.0
17:12:58.574236 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:12:58.574393 [debug] [MainThread]: Tracking: tracking
17:12:58.577683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcca3a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcca3ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcca3ae20>]}
17:12:58.596336 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcca4e4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcc9a9fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3dcc9e1070>]}


============================== 2022-06-04 17:13:16.913541 | 9d60e3bc-ef4c-46f1-95b2-b725c3703d22 ==============================
17:13:16.913558 [info ] [MainThread]: Running with dbt=1.1.0
17:13:16.914023 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:13:16.914140 [debug] [MainThread]: Tracking: tracking
17:13:16.917880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493cc2070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493cc2040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493cc22b0>]}
17:13:16.953597 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:13:16.953809 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:13:16.960938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493be10d0>]}
17:13:16.972851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493c31b80>]}
17:13:16.973345 [info ] [MainThread]: Found 5 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:13:16.973656 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493c31b20>]}
17:13:16.975755 [info ] [MainThread]: 
17:13:16.976320 [debug] [MainThread]: Acquiring new postgres connection "master"
17:13:16.977451 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:13:16.985647 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:13:16.985887 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:13:16.985995 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:13:16.993272 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:13:17.000105 [debug] [ThreadPool]: On list_erp_oltp: Close
17:13:17.004704 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:13:17.020353 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:13:17.020601 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:13:17.020703 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:13:17.025634 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:13:17.025839 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:13:17.025924 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:13:17.027965 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:13:17.029557 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:13:17.029908 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:13:17.033265 [debug] [MainThread]: Using postgres connection "master"
17:13:17.033458 [debug] [MainThread]: On master: BEGIN
17:13:17.033544 [debug] [MainThread]: Opening a new connection, currently in state init
17:13:17.038170 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:13:17.038336 [debug] [MainThread]: Using postgres connection "master"
17:13:17.038410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:13:17.048807 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:13:17.050476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493c31700>]}
17:13:17.050764 [debug] [MainThread]: On master: ROLLBACK
17:13:17.051081 [debug] [MainThread]: Using postgres connection "master"
17:13:17.051225 [debug] [MainThread]: On master: BEGIN
17:13:17.051513 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:13:17.051633 [debug] [MainThread]: On master: COMMIT
17:13:17.051717 [debug] [MainThread]: Using postgres connection "master"
17:13:17.051803 [debug] [MainThread]: On master: COMMIT
17:13:17.051980 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:13:17.052086 [debug] [MainThread]: On master: Close
17:13:17.052482 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:13:17.052789 [info ] [MainThread]: 
17:13:17.056258 [debug] [Thread-1  ]: Began running node model.first_project.customers
17:13:17.056516 [info ] [Thread-1  ]: 1 of 5 START view model public.customers ....................................... [RUN]
17:13:17.056913 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
17:13:17.057089 [debug] [Thread-2  ]: Began running node model.first_project.customers2
17:13:17.057232 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
17:13:17.057825 [debug] [Thread-1  ]: Compiling model.first_project.customers
17:13:17.058833 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
17:13:17.057648 [info ] [Thread-2  ]: 2 of 5 START table model public.customers2 ..................................... [RUN]
17:13:17.057332 [debug] [Thread-3  ]: Began running node model.first_project.my_first_dbt_model
17:13:17.059550 [info ] [Thread-3  ]: 3 of 5 START table model public.my_first_dbt_model ............................. [RUN]
17:13:17.059312 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
17:13:17.059936 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:13:17.060470 [debug] [Thread-3  ]: Began compiling node model.first_project.my_first_dbt_model
17:13:17.060127 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
17:13:17.060355 [debug] [Thread-1  ]: finished collecting timing info
17:13:17.060846 [debug] [Thread-1  ]: Began executing node model.first_project.customers
17:13:17.057427 [debug] [Thread-4  ]: Began running node model.first_project.postgres_sample_source_customers
17:13:17.060714 [debug] [Thread-2  ]: Compiling model.first_project.customers2
17:13:17.060559 [debug] [Thread-3  ]: Compiling model.first_project.my_first_dbt_model
17:13:17.077590 [info ] [Thread-4  ]: 4 of 5 START view model public.postgres_sample_source_customers ................ [RUN]
17:13:17.077920 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers"
17:13:17.080478 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
17:13:17.119690 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:13:17.120276 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:13:17.120786 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:13:17.120940 [debug] [Thread-2  ]: finished collecting timing info
17:13:17.121391 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
17:13:17.121249 [debug] [Thread-1  ]: On model.first_project.customers: BEGIN
17:13:17.121134 [debug] [Thread-4  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:13:17.121491 [debug] [Thread-3  ]: finished collecting timing info
17:13:17.138012 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:13:17.145029 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
17:13:17.146532 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:13:17.145783 [debug] [Thread-3  ]: Began executing node model.first_project.my_first_dbt_model
17:13:17.145367 [debug] [Thread-4  ]: Compiling model.first_project.postgres_sample_source_customers
17:13:17.148935 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:13:17.151192 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:13:17.151365 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: BEGIN
17:13:17.151457 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:13:17.150744 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:13:17.146668 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
17:13:17.152023 [debug] [Thread-4  ]: finished collecting timing info
17:13:17.152469 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:13:17.152663 [debug] [Thread-4  ]: Began executing node model.first_project.postgres_sample_source_customers
17:13:17.154724 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:13:17.155085 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:13:17.155229 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:13:17.155319 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:13:17.157091 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:13:17.157253 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:13:17.157339 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:13:17.157755 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:13:17.157894 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:13:17.157985 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:13:17.159123 [debug] [Thread-3  ]: SQL status: SELECT 2 in 0.0 seconds
17:13:17.164848 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:13:17.165064 [debug] [Thread-1  ]: SQL status: CREATE VIEW in 0.01 seconds
17:13:17.165256 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:13:17.167090 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:13:17.167357 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:13:17.167566 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:13:17.169619 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:13:17.169775 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:13:17.170018 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:13:17.171725 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:13:17.170147 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:13:17.171919 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:13:17.169919 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:13:17.172131 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:13:17.172509 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:13:17.172629 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:13:17.172235 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:13:17.172863 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:13:17.178954 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:13:17.179217 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:13:17.183207 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:13:17.183390 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:13:17.183511 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: COMMIT
17:13:17.179328 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:13:17.184361 [debug] [Thread-1  ]: On model.first_project.customers: COMMIT
17:13:17.185555 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.01 seconds
17:13:17.187588 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:13:17.187780 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
17:13:17.187971 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:13:17.189879 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:13:17.190221 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:13:17.190533 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:13:17.194411 [debug] [Thread-3  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:13:17.194602 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:13:17.197133 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:13:17.197307 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:13:17.194782 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:13:17.197483 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
17:13:17.199258 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:13:17.199381 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:13:17.200113 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:13:17.201264 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers"
17:13:17.201443 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:13:17.201587 [debug] [Thread-1  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:13:17.202667 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:13:17.203408 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:13:17.203515 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
17:13:17.203814 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:13:17.205124 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:13:17.205240 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:13:17.205322 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:13:17.206125 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
17:13:17.206896 [debug] [Thread-3  ]: finished collecting timing info
17:13:17.207027 [debug] [Thread-3  ]: On model.first_project.my_first_dbt_model: Close
17:13:17.207366 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1492b257f0>]}
17:13:17.207666 [info ] [Thread-3  ]: 3 of 5 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
17:13:17.208041 [debug] [Thread-3  ]: Finished running node model.first_project.my_first_dbt_model
17:13:17.208398 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
17:13:17.208604 [info ] [Thread-6  ]: 5 of 5 START view model public.my_second_dbt_model ............................. [RUN]
17:13:17.208951 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:13:17.209061 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
17:13:17.209151 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
17:13:17.210932 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:13:17.211239 [debug] [Thread-6  ]: finished collecting timing info
17:13:17.211358 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
17:13:17.212955 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:13:17.213238 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:13:17.213339 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
17:13:17.213515 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:13:17.214954 [debug] [Thread-1  ]: SQL status: DROP VIEW in 0.01 seconds
17:13:17.215138 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
17:13:17.215977 [debug] [Thread-1  ]: finished collecting timing info
17:13:17.216113 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:13:17.218585 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
17:13:17.217524 [debug] [Thread-1  ]: On model.first_project.customers: Close
17:13:17.218707 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:13:17.217359 [debug] [Thread-4  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:13:17.221717 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:13:17.221151 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1492b1dfd0>]}
17:13:17.222992 [info ] [Thread-1  ]: 1 of 5 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.16s]
17:13:17.223338 [debug] [Thread-1  ]: Finished running node model.first_project.customers
17:13:17.223787 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:13:17.223924 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:13:17.224005 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:13:17.225158 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
17:13:17.227127 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:13:17.227376 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:13:17.228088 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:13:17.229901 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:13:17.230061 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:13:17.230192 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
17:13:17.230334 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
17:13:17.231703 [debug] [Thread-2  ]: finished collecting timing info
17:13:17.232084 [debug] [Thread-2  ]: On model.first_project.customers2: Close
17:13:17.232759 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1492b25a00>]}
17:13:17.233223 [info ] [Thread-2  ]: 2 of 5 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.17s]
17:13:17.234795 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
17:13:17.237971 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
17:13:17.239315 [debug] [Thread-4  ]: finished collecting timing info
17:13:17.239497 [debug] [Thread-4  ]: On model.first_project.postgres_sample_source_customers: Close
17:13:17.239976 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493bd2640>]}
17:13:17.240310 [info ] [Thread-4  ]: 4 of 5 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:13:17.240712 [debug] [Thread-4  ]: Finished running node model.first_project.postgres_sample_source_customers
17:13:17.253264 [debug] [Thread-6  ]: SQL status: COMMIT in 0.02 seconds
17:13:17.255185 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:13:17.255378 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:13:17.255760 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
17:13:17.256857 [debug] [Thread-6  ]: finished collecting timing info
17:13:17.257027 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
17:13:17.257482 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d60e3bc-ef4c-46f1-95b2-b725c3703d22', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493b5a3a0>]}
17:13:17.257788 [info ] [Thread-6  ]: 5 of 5 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
17:13:17.260073 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
17:13:17.262041 [debug] [MainThread]: Acquiring new postgres connection "master"
17:13:17.262315 [debug] [MainThread]: Using postgres connection "master"
17:13:17.262471 [debug] [MainThread]: On master: BEGIN
17:13:17.262563 [debug] [MainThread]: Opening a new connection, currently in state closed
17:13:17.278017 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:13:17.278283 [debug] [MainThread]: On master: COMMIT
17:13:17.278397 [debug] [MainThread]: Using postgres connection "master"
17:13:17.278497 [debug] [MainThread]: On master: COMMIT
17:13:17.278781 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:13:17.278953 [debug] [MainThread]: On master: Close
17:13:17.279446 [info ] [MainThread]: 
17:13:17.279668 [info ] [MainThread]: Finished running 2 table models, 3 view models in 0.30s.
17:13:17.279830 [debug] [MainThread]: Connection 'master' was properly closed.
17:13:17.279925 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:13:17.280004 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:13:17.280083 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:13:17.280160 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:13:17.280236 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:13:17.284385 [info ] [MainThread]: 
17:13:17.284644 [info ] [MainThread]: [32mCompleted successfully[0m
17:13:17.284896 [info ] [MainThread]: 
17:13:17.285652 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
17:13:17.285920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1493be16a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1492af7be0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1492af7ac0>]}


============================== 2022-06-04 17:20:08.237773 | c636ca88-3cf9-4c86-937b-4e4e999c1e53 ==============================
17:20:08.237797 [info ] [MainThread]: Running with dbt=1.1.0
17:20:08.238980 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:20:08.239262 [debug] [MainThread]: Tracking: tracking
17:20:08.245496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221ae12e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221ae12340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221ae12220>]}
17:20:08.271087 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
17:20:08.271448 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_customer.sql
17:20:08.271676 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:20:08.282258 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customer.sql
17:20:08.293579 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:20:08.295205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221ad19a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221ad242b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f221a8dd4f0>]}


============================== 2022-06-04 17:21:05.895385 | 6c5f8b8b-4c79-4304-9958-fe5e11962d20 ==============================
17:21:05.895410 [info ] [MainThread]: Running with dbt=1.1.0
17:21:05.896005 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:21:05.896142 [debug] [MainThread]: Tracking: tracking
17:21:05.900685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb885fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb8850a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb885fa0>]}
17:21:05.927598 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
17:21:05.928030 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_customers.sql
17:21:05.928279 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:21:05.938517 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:21:05.952243 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:21:05.962996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb35d0d0>]}
17:21:05.967918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb779b20>]}
17:21:05.968228 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:21:05.968475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb779c40>]}
17:21:05.969938 [info ] [MainThread]: 
17:21:05.970376 [debug] [MainThread]: Acquiring new postgres connection "master"
17:21:05.971389 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:21:05.980261 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:21:05.980488 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:21:05.981678 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:21:05.991779 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:21:05.993163 [debug] [ThreadPool]: On list_erp_oltp: Close
17:21:05.995820 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:21:06.001312 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:21:06.002623 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:21:06.002766 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:21:06.009328 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:21:06.009594 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:21:06.009725 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:21:06.012283 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:21:06.013567 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:21:06.013851 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:21:06.046870 [debug] [MainThread]: Using postgres connection "master"
17:21:06.047258 [debug] [MainThread]: On master: BEGIN
17:21:06.047363 [debug] [MainThread]: Opening a new connection, currently in state init
17:21:06.051874 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:21:06.052071 [debug] [MainThread]: Using postgres connection "master"
17:21:06.052161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:21:06.064426 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:21:06.065930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefd11d2e0>]}
17:21:06.066248 [debug] [MainThread]: On master: ROLLBACK
17:21:06.066570 [debug] [MainThread]: Using postgres connection "master"
17:21:06.066723 [debug] [MainThread]: On master: BEGIN
17:21:06.067030 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:21:06.067165 [debug] [MainThread]: On master: COMMIT
17:21:06.067276 [debug] [MainThread]: Using postgres connection "master"
17:21:06.067420 [debug] [MainThread]: On master: COMMIT
17:21:06.067735 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:21:06.067871 [debug] [MainThread]: On master: Close
17:21:06.068264 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:21:06.068585 [info ] [MainThread]: 
17:21:06.072678 [debug] [Thread-1  ]: Began running node model.first_project.customers2
17:21:06.073042 [info ] [Thread-1  ]: 1 of 6 START table model public.customers2 ..................................... [RUN]
17:21:06.073466 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
17:21:06.073687 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
17:21:06.073819 [debug] [Thread-1  ]: Compiling model.first_project.customers2
17:21:06.075874 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
17:21:06.076313 [debug] [Thread-1  ]: finished collecting timing info
17:21:06.076474 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
17:21:06.093249 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:21:06.093622 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:21:06.094069 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:21:06.094203 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:21:06.094306 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:21:06.096693 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:21:06.097410 [debug] [Thread-2  ]: finished collecting timing info
17:21:06.097620 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:21:06.111153 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:21:06.113525 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers2"
17:21:06.113879 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:21:06.114714 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:21:06.115227 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:21:06.115639 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:21:06.115415 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:21:06.114055 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:21:06.116303 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:21:06.116015 [debug] [Thread-1  ]: On model.first_project.customers2: BEGIN
17:21:06.115811 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:21:06.119432 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:21:06.116706 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:21:06.117025 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:21:06.119795 [debug] [Thread-3  ]: finished collecting timing info
17:21:06.125056 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:21:06.123083 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:21:06.141592 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:21:06.141239 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:21:06.142905 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:21:06.147213 [debug] [Thread-4  ]: finished collecting timing info
17:21:06.143519 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:21:06.147656 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:21:06.147776 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:21:06.147484 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:21:06.150556 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:21:06.116914 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:21:06.151055 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:21:06.151167 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:21:06.154386 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:21:06.154743 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:21:06.154909 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:21:06.155069 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:21:06.155224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
17:21:06.156489 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:21:06.156588 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:21:06.155583 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:21:06.156765 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:21:06.159161 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:21:06.166430 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:21:06.166692 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.01 seconds
17:21:06.168780 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:21:06.169167 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:21:06.169034 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
17:21:06.166914 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:21:06.169393 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:21:06.169763 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:21:06.169875 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
select * from customers
  );
17:21:06.171485 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:21:06.171894 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:21:06.171719 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:21:06.171610 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:21:06.172061 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:21:06.173479 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:21:06.174478 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:21:06.174622 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:21:06.174760 [debug] [Thread-4  ]: Postgres adapter: Postgres error: syntax error at or near "select"
LINE 12: select * from customers
         ^

17:21:06.183585 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
17:21:06.174923 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:21:06.184155 [debug] [Thread-4  ]: On model.first_project.stg_customers: ROLLBACK
17:21:06.184394 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:21:06.184899 [debug] [Thread-4  ]: finished collecting timing info
17:21:06.185099 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:21:06.186459 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:21:06.185422 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:21:06.186580 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:21:06.186758 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:21:06.185243 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
17:21:06.187152 [debug] [Thread-4  ]: Database Error in model stg_customers (models/erp/stg_customers.sql)
  syntax error at or near "select"
  LINE 12: select * from customers
           ^
  compiled SQL at target/run/first_project/models/erp/stg_customers.sql
17:21:06.187661 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef821ac10>]}
17:21:06.188079 [error] [Thread-4  ]: 4 of 6 ERROR creating view model public.stg_customers .......................... [[31mERROR[0m in 0.07s]
17:21:06.188791 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:21:06.189316 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:21:06.189499 [info ] [Thread-6  ]: 5 of 6 SKIP relation public.customers .......................................... [[33mSKIP[0m]
17:21:06.189782 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:21:06.191556 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.01 seconds
17:21:06.193901 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:21:06.194056 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:21:06.194498 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:21:06.196150 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:21:06.196275 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:21:06.196387 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:21:06.200113 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:21:06.200469 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:21:06.200371 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:21:06.200574 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:21:06.202525 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:21:06.204718 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:21:06.204985 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:21:06.205136 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:21:06.205716 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:21:06.207742 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:21:06.209979 [debug] [Thread-3  ]: finished collecting timing info
17:21:06.210330 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:21:06.210880 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb2e1700>]}
17:21:06.211213 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
17:21:06.211627 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:21:06.214379 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:21:06.215499 [debug] [Thread-1  ]: finished collecting timing info
17:21:06.215636 [debug] [Thread-1  ]: On model.first_project.customers2: Close
17:21:06.216584 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:21:06.217940 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:21:06.218076 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:21:06.218363 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb328220>]}
17:21:06.218725 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.15s]
17:21:06.219001 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
17:21:06.227603 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
17:21:06.228782 [debug] [Thread-2  ]: finished collecting timing info
17:21:06.229049 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:21:06.229450 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb2b77c0>]}
17:21:06.231124 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.14s]
17:21:06.231516 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:21:06.231930 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:21:06.232128 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:21:06.232439 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:21:06.232532 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:21:06.232625 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:21:06.234304 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:21:06.234827 [debug] [Thread-8  ]: finished collecting timing info
17:21:06.234941 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:21:06.236410 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:21:06.236723 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:21:06.236824 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:21:06.236922 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:21:06.241234 [debug] [Thread-8  ]: SQL status: BEGIN in 0.0 seconds
17:21:06.241423 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:21:06.241509 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:21:06.242503 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:21:06.244186 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:21:06.244306 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:21:06.244971 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:21:06.245895 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:21:06.246016 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:21:06.246120 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:21:06.251725 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
17:21:06.253179 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:21:06.253323 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:21:06.253599 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:21:06.254564 [debug] [Thread-8  ]: finished collecting timing info
17:21:06.254746 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:21:06.256850 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6c5f8b8b-4c79-4304-9958-fe5e11962d20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb2dcc70>]}
17:21:06.257321 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.02s]
17:21:06.257718 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:21:06.259380 [debug] [MainThread]: Acquiring new postgres connection "master"
17:21:06.259715 [debug] [MainThread]: Using postgres connection "master"
17:21:06.259812 [debug] [MainThread]: On master: BEGIN
17:21:06.259890 [debug] [MainThread]: Opening a new connection, currently in state closed
17:21:06.265209 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:21:06.265436 [debug] [MainThread]: On master: COMMIT
17:21:06.265525 [debug] [MainThread]: Using postgres connection "master"
17:21:06.265656 [debug] [MainThread]: On master: COMMIT
17:21:06.265844 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:21:06.265965 [debug] [MainThread]: On master: Close
17:21:06.266336 [info ] [MainThread]: 
17:21:06.266528 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.30s.
17:21:06.266682 [debug] [MainThread]: Connection 'master' was properly closed.
17:21:06.266763 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:21:06.266827 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:21:06.266891 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:21:06.266964 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:21:06.267026 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:21:06.271579 [info ] [MainThread]: 
17:21:06.271842 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:21:06.272045 [info ] [MainThread]: 
17:21:06.272211 [error] [MainThread]: [33mDatabase Error in model stg_customers (models/erp/stg_customers.sql)[0m
17:21:06.272369 [error] [MainThread]:   syntax error at or near "select"
17:21:06.272515 [error] [MainThread]:   LINE 12: select * from customers
17:21:06.272670 [error] [MainThread]:            ^
17:21:06.272814 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/stg_customers.sql
17:21:06.273043 [info ] [MainThread]: 
17:21:06.273211 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=1 TOTAL=6
17:21:06.273437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefb35d250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faefd0a6040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faef81e0670>]}


============================== 2022-06-04 17:22:15.676672 | 1a1dd26a-3ba6-47f8-ae66-000590ae7b1e ==============================
17:22:15.676691 [info ] [MainThread]: Running with dbt=1.1.0
17:22:15.677209 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:22:15.677368 [debug] [MainThread]: Tracking: tracking
17:22:15.680743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad684ae550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad684ae730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad684ae430>]}
17:22:15.715930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:22:15.716652 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
17:22:15.726491 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:22:15.743272 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad67f830d0>]}
17:22:15.747967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad68421d90>]}
17:22:15.748283 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:22:15.748541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad68421e20>]}
17:22:15.750024 [info ] [MainThread]: 
17:22:15.750801 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:15.751844 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:22:15.761552 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:22:15.761778 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:22:15.761893 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:22:15.770565 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:22:15.779145 [debug] [ThreadPool]: On list_erp_oltp: Close
17:22:15.782395 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:22:15.788135 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:15.788335 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:22:15.788428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:22:15.793639 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:22:15.793859 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:22:15.793958 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:22:15.795658 [debug] [ThreadPool]: SQL status: SELECT 13 in 0.0 seconds
17:22:15.796764 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:22:15.796994 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:22:15.830872 [debug] [MainThread]: Using postgres connection "master"
17:22:15.831087 [debug] [MainThread]: On master: BEGIN
17:22:15.831178 [debug] [MainThread]: Opening a new connection, currently in state init
17:22:15.835997 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:15.836172 [debug] [MainThread]: Using postgres connection "master"
17:22:15.836255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:22:15.847125 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
17:22:15.848270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad67f83b50>]}
17:22:15.848583 [debug] [MainThread]: On master: ROLLBACK
17:22:15.848871 [debug] [MainThread]: Using postgres connection "master"
17:22:15.849010 [debug] [MainThread]: On master: BEGIN
17:22:15.849279 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:22:15.849438 [debug] [MainThread]: On master: COMMIT
17:22:15.849538 [debug] [MainThread]: Using postgres connection "master"
17:22:15.849622 [debug] [MainThread]: On master: COMMIT
17:22:15.849795 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:15.849918 [debug] [MainThread]: On master: Close
17:22:15.850251 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:22:15.850558 [info ] [MainThread]: 
17:22:15.854734 [debug] [Thread-1  ]: Began running node model.first_project.customers2
17:22:15.855021 [info ] [Thread-1  ]: 1 of 6 START table model public.customers2 ..................................... [RUN]
17:22:15.855387 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
17:22:15.855516 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
17:22:15.855630 [debug] [Thread-1  ]: Compiling model.first_project.customers2
17:22:15.857500 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
17:22:15.857689 [debug] [Thread-2  ]: Began running node model.first_project.my_first_dbt_model
17:22:15.857845 [debug] [Thread-3  ]: Began running node model.first_project.postgres_sample_source_customers
17:22:15.858429 [info ] [Thread-3  ]: 3 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:22:15.858199 [info ] [Thread-2  ]: 2 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:22:15.858766 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:22:15.859308 [debug] [Thread-3  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:22:15.859131 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:22:15.859418 [debug] [Thread-3  ]: Compiling model.first_project.postgres_sample_source_customers
17:22:15.857949 [debug] [Thread-4  ]: Began running node model.first_project.stg_customers
17:22:15.859578 [debug] [Thread-2  ]: Began compiling node model.first_project.my_first_dbt_model
17:22:15.862783 [info ] [Thread-4  ]: 4 of 6 START view model public.stg_customers ................................... [RUN]
17:22:15.863510 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:22:15.862990 [debug] [Thread-2  ]: Compiling model.first_project.my_first_dbt_model
17:22:15.862456 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:22:15.863635 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_customers
17:22:15.865770 [debug] [Thread-4  ]: Compiling model.first_project.stg_customers
17:22:15.865553 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:22:15.866553 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:22:15.863121 [debug] [Thread-1  ]: finished collecting timing info
17:22:15.867042 [debug] [Thread-2  ]: finished collecting timing info
17:22:15.867150 [debug] [Thread-4  ]: finished collecting timing info
17:22:15.867731 [debug] [Thread-4  ]: Began executing node model.first_project.stg_customers
17:22:15.867308 [debug] [Thread-3  ]: finished collecting timing info
17:22:15.874170 [debug] [Thread-3  ]: Began executing node model.first_project.postgres_sample_source_customers
17:22:15.867613 [debug] [Thread-2  ]: Began executing node model.first_project.my_first_dbt_model
17:22:15.867481 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
17:22:15.926601 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:22:15.947033 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:15.947209 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:22:15.946514 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.customers2"
17:22:15.938035 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:22:15.947303 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:22:15.947829 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:15.943315 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:22:15.948009 [debug] [Thread-4  ]: On model.first_project.stg_customers: BEGIN
17:22:15.948631 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:22:15.948280 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:15.949053 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:15.949637 [debug] [Thread-1  ]: On model.first_project.customers2: BEGIN
17:22:15.950010 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:22:15.949833 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: BEGIN
17:22:15.950264 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:22:15.955908 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:22:15.956121 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:15.956231 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:22:15.958515 [debug] [Thread-1  ]: SQL status: SELECT 100 in 0.0 seconds
17:22:15.963620 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:15.963800 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:22:15.964005 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:22:15.964115 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:15.964201 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
17:22:15.964325 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:15.965933 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:15.966406 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:22:15.968476 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:15.967977 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:15.970880 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:15.968597 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:22:15.966705 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:22:15.971426 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:15.971584 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:22:15.971095 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:22:15.968285 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:22:15.972959 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:15.979197 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:15.979362 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:15.979627 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:15.989027 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
17:22:15.989185 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.02 seconds
17:22:15.989297 [debug] [Thread-2  ]: SQL status: SELECT 2 in 0.02 seconds
17:22:15.989447 [debug] [Thread-4  ]: On model.first_project.stg_customers: COMMIT
17:22:15.989673 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:15.991580 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:15.994358 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:22:15.993345 [debug] [Thread-1  ]: On model.first_project.customers2: COMMIT
17:22:15.993103 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:15.994708 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:22:15.994822 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:15.996341 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:15.996483 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:15.996632 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:22:15.998189 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:15.998458 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:22:15.998694 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:15.998819 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:15.999630 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:16.000691 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:16.000856 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:16.001012 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:16.001131 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:22:16.001236 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: COMMIT
17:22:16.008620 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
17:22:16.011817 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_customers"
17:22:16.011940 [debug] [Thread-4  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:22:16.012203 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:16.013000 [debug] [Thread-4  ]: finished collecting timing info
17:22:16.013125 [debug] [Thread-4  ]: On model.first_project.stg_customers: Close
17:22:16.013432 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad67f451f0>]}
17:22:16.013681 [info ] [Thread-4  ]: 4 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.15s]
17:22:16.014025 [debug] [Thread-4  ]: Finished running node model.first_project.stg_customers
17:22:16.014336 [debug] [Thread-6  ]: Began running node model.first_project.customers
17:22:16.014551 [info ] [Thread-6  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:22:16.014934 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
17:22:16.015063 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
17:22:16.015183 [debug] [Thread-6  ]: Compiling model.first_project.customers
17:22:16.017422 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
17:22:16.017724 [debug] [Thread-6  ]: finished collecting timing info
17:22:16.017849 [debug] [Thread-6  ]: Began executing node model.first_project.customers
17:22:16.020211 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
17:22:16.020381 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
17:22:16.021912 [debug] [Thread-2  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:22:16.020616 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
17:22:16.022045 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:22:16.020464 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
17:22:16.023188 [debug] [Thread-3  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:22:16.026598 [debug] [Thread-1  ]: Using postgres connection "model.first_project.customers2"
17:22:16.026930 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:22:16.027142 [debug] [Thread-1  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:22:16.027350 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:16.027508 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
17:22:16.027614 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:22:16.033129 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:22:16.033312 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:16.033404 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:22:16.037534 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
17:22:16.038568 [debug] [Thread-2  ]: finished collecting timing info
17:22:16.038732 [debug] [Thread-2  ]: On model.first_project.my_first_dbt_model: Close
17:22:16.039097 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad64677160>]}
17:22:16.039368 [info ] [Thread-2  ]: 2 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.18s]
17:22:16.039681 [debug] [Thread-2  ]: Finished running node model.first_project.my_first_dbt_model
17:22:16.041625 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:22:16.041852 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:22:16.042190 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:22:16.042295 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:22:16.042388 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:22:16.044068 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:22:16.044353 [debug] [Thread-8  ]: finished collecting timing info
17:22:16.044473 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:22:16.046230 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:22:16.046497 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:16.046603 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:22:16.046688 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:22:16.047920 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.02 seconds
17:22:16.048846 [debug] [Thread-3  ]: finished collecting timing info
17:22:16.049041 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
17:22:16.052386 [debug] [Thread-1  ]: finished collecting timing info
17:22:16.052586 [debug] [Thread-1  ]: On model.first_project.customers2: Close
17:22:16.053022 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad6461e520>]}
17:22:16.053389 [info ] [Thread-1  ]: 1 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.20s]
17:22:16.053796 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
17:22:16.049188 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.02 seconds
17:22:16.050871 [debug] [Thread-3  ]: On model.first_project.postgres_sample_source_customers: Close
17:22:16.055917 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:16.056912 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers" rename to "customers__dbt_backup"
17:22:16.058265 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:22:16.058424 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:16.058578 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:22:16.059022 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad67ef2fd0>]}
17:22:16.059341 [info ] [Thread-3  ]: 3 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.20s]
17:22:16.059696 [debug] [Thread-3  ]: Finished running node model.first_project.postgres_sample_source_customers
17:22:16.059885 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:22:16.062195 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:16.062358 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:22:16.068823 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:16.071997 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:16.072278 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:22:16.072823 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
17:22:16.074100 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:16.074298 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:16.074399 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:22:16.074574 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:22:16.075660 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:16.075813 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:16.075922 [debug] [Thread-6  ]: On model.first_project.customers: COMMIT
17:22:16.082528 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
17:22:16.084327 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:22:16.084552 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:22:16.085038 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:22:16.086233 [debug] [Thread-8  ]: finished collecting timing info
17:22:16.086417 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:22:16.086840 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad64661760>]}
17:22:16.087146 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:22:16.087486 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:22:16.090005 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
17:22:16.091647 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
17:22:16.091813 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:22:16.099089 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.01 seconds
17:22:16.100281 [debug] [Thread-6  ]: finished collecting timing info
17:22:16.100497 [debug] [Thread-6  ]: On model.first_project.customers: Close
17:22:16.101069 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1dd26a-3ba6-47f8-ae66-000590ae7b1e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad6466fcd0>]}
17:22:16.101390 [info ] [Thread-6  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
17:22:16.101725 [debug] [Thread-6  ]: Finished running node model.first_project.customers
17:22:16.103615 [debug] [MainThread]: Acquiring new postgres connection "master"
17:22:16.103788 [debug] [MainThread]: Using postgres connection "master"
17:22:16.103886 [debug] [MainThread]: On master: BEGIN
17:22:16.103970 [debug] [MainThread]: Opening a new connection, currently in state closed
17:22:16.109857 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:22:16.110210 [debug] [MainThread]: On master: COMMIT
17:22:16.110353 [debug] [MainThread]: Using postgres connection "master"
17:22:16.110455 [debug] [MainThread]: On master: COMMIT
17:22:16.110754 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:22:16.110923 [debug] [MainThread]: On master: Close
17:22:16.111378 [info ] [MainThread]: 
17:22:16.111611 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.36s.
17:22:16.111774 [debug] [MainThread]: Connection 'master' was properly closed.
17:22:16.111856 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:22:16.111934 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:22:16.112009 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:22:16.112084 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:22:16.112160 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:22:16.112234 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:22:16.116004 [info ] [MainThread]: 
17:22:16.116224 [info ] [MainThread]: [32mCompleted successfully[0m
17:22:16.116424 [info ] [MainThread]: 
17:22:16.116603 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:22:16.116841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad6a3d95e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad6a630b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fad6a630b80>]}


============================== 2022-06-04 17:26:24.944102 | 31fe9cc7-3551-49e1-82fd-931badc4eaf5 ==============================
17:26:24.944133 [info ] [MainThread]: Running with dbt=1.1.0
17:26:24.945188 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:26:24.945404 [debug] [MainThread]: Tracking: tracking
17:26:24.950143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a7393f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a7393400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a73931f0>]}
17:26:24.982679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:26:24.983157 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers2.sql
17:26:24.995758 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
17:26:25.014651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a6e6f0d0>]}
17:26:25.020735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a7309e50>]}
17:26:25.021344 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:26:25.022003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a7309e20>]}
17:26:25.023988 [info ] [MainThread]: 
17:26:25.024595 [debug] [MainThread]: Acquiring new postgres connection "master"
17:26:25.025720 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:26:25.036170 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:26:25.036400 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:26:25.036515 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:26:25.047768 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:26:25.050171 [debug] [ThreadPool]: On list_erp_oltp: Close
17:26:25.051540 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:26:25.056504 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:26:25.056670 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:26:25.056765 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:26:25.063744 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:26:25.063977 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:26:25.064075 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:26:25.066215 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:26:25.067432 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:26:25.068040 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:26:25.098969 [debug] [MainThread]: Using postgres connection "master"
17:26:25.099261 [debug] [MainThread]: On master: BEGIN
17:26:25.099349 [debug] [MainThread]: Opening a new connection, currently in state init
17:26:25.104977 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:26:25.105180 [debug] [MainThread]: Using postgres connection "master"
17:26:25.105274 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:26:25.117724 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:26:25.118969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a8c2ebe0>]}
17:26:25.119306 [debug] [MainThread]: On master: ROLLBACK
17:26:25.119591 [debug] [MainThread]: Using postgres connection "master"
17:26:25.119707 [debug] [MainThread]: On master: BEGIN
17:26:25.120102 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:26:25.120229 [debug] [MainThread]: On master: COMMIT
17:26:25.120315 [debug] [MainThread]: Using postgres connection "master"
17:26:25.120395 [debug] [MainThread]: On master: COMMIT
17:26:25.120561 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:26:25.120743 [debug] [MainThread]: On master: Close
17:26:25.121183 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:26:25.121464 [info ] [MainThread]: 
17:26:25.126297 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:26:25.126574 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:26:25.126944 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:26:25.127062 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:26:25.127177 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:26:25.129073 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:26:25.129394 [debug] [Thread-1  ]: finished collecting timing info
17:26:25.129597 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:26:25.150566 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:26:25.150867 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:26:25.151267 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:26:25.151431 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:26:25.151588 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:26:25.154537 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:26:25.154362 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:26:25.156090 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:26:25.154089 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:26:25.156617 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:26:25.156833 [debug] [Thread-2  ]: finished collecting timing info
17:26:25.157106 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:26:25.157272 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:26:25.157406 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:26:25.170622 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:26:25.174505 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:26:25.174198 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:26:25.175084 [debug] [Thread-3  ]: finished collecting timing info
17:26:25.174687 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:26:25.175303 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:26:25.177629 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:26:25.170327 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:26:25.178189 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:26:25.178323 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:26:25.178410 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:26:25.179026 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:26:25.179234 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:26:25.179332 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:26:25.184416 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:26:25.184646 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:26:25.184743 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:26:25.186255 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:26:25.191164 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:26:25.191339 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:26:25.191710 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.191874 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:26:25.193505 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:26:25.193675 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:26:25.193888 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:26:25.194060 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:26:25.194471 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.201619 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:26:25.203584 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:26:25.204365 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:26:25.204932 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
17:26:25.204497 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:26:25.204716 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:26:25.207415 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:26:25.207603 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:26:25.207765 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:26:25.208359 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.210238 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:26:25.210365 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
17:26:25.212645 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:26:25.212775 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:26:25.210490 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:26:25.213362 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.216039 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:26:25.216245 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:26:25.216394 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.223489 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:26:25.221823 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:26:25.216564 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:26:25.223679 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:26:25.224772 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:26:25.224496 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:26:25.225253 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.226359 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:26:25.226494 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:26:25.226581 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:26:25.230853 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:26:25.232378 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:26:25.232554 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:26:25.238619 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:26:25.238825 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:26:25.240083 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:26:25.241191 [debug] [Thread-1  ]: finished collecting timing info
17:26:25.241389 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:26:25.241566 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:26:25.243225 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a6e42370>]}
17:26:25.244977 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.12s]
17:26:25.244651 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
17:26:25.246009 [debug] [Thread-2  ]: finished collecting timing info
17:26:25.246146 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:26:25.247846 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a6dd0250>]}
17:26:25.248121 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.10s]
17:26:25.248371 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:26:25.248737 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:26:25.249083 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:26:25.249258 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:26:25.249547 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:26:25.249642 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:26:25.249728 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:26:25.251385 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:26:25.251642 [debug] [Thread-5  ]: finished collecting timing info
17:26:25.251760 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:26:25.253454 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:26:25.253760 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:26:25.253854 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:26:25.253962 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:26:25.254363 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:26:25.255147 [debug] [Thread-3  ]: finished collecting timing info
17:26:25.255276 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:26:25.257207 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a6dd9340>]}
17:26:25.258068 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.10s]
17:26:25.258421 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:26:25.260504 [debug] [Thread-7  ]: Began running node model.first_project.customers
17:26:25.260704 [info ] [Thread-7  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:26:25.261080 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
17:26:25.261197 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
17:26:25.261284 [debug] [Thread-7  ]: Compiling model.first_project.customers
17:26:25.262942 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
17:26:25.263243 [debug] [Thread-7  ]: finished collecting timing info
17:26:25.263394 [debug] [Thread-7  ]: Began executing node model.first_project.customers
17:26:25.265174 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
17:26:25.265304 [debug] [Thread-8  ]: Began running node model.first_project.customers2
17:26:25.265538 [info ] [Thread-8  ]: 6 of 6 START table model public.customers2 ..................................... [RUN]
17:26:25.266216 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
17:26:25.266351 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
17:26:25.266447 [debug] [Thread-8  ]: Compiling model.first_project.customers2
17:26:25.268558 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
17:26:25.268895 [debug] [Thread-8  ]: finished collecting timing info
17:26:25.269408 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
17:26:25.269577 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:26:25.269744 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:26:25.271720 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:26:25.271996 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:26:25.271859 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
17:26:25.271588 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
17:26:25.272141 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:26:25.272612 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:26:25.272726 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
17:26:25.272803 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:26:25.275517 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:26:25.278426 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:26:25.278605 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:26:25.279194 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.280157 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:26:25.280279 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:26:25.280360 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:26:25.281620 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:26:25.281764 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:26:25.281856 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:26:25.286513 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:26:25.288076 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:26:25.288250 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:26:25.291662 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:26:25.292909 [debug] [Thread-5  ]: finished collecting timing info
17:26:25.293601 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:26:25.293214 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.01 seconds
17:26:25.294210 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a957ffa0>]}
17:26:25.303693 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.04s]
17:26:25.304069 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:26:25.303228 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:26:25.309968 [debug] [Thread-7  ]: SQL status: BEGIN in 0.04 seconds
17:26:25.310185 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:26:25.312422 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:26:25.312699 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:26:25.315120 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
17:26:25.319460 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:26:25.319680 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:26:25.320369 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.321731 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:26:25.321905 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:26:25.322072 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:26:25.323386 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
17:26:25.325603 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:26:25.325764 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:26:25.326954 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:26:25.328459 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:26:25.328647 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:26:25.328755 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:26:25.330555 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
17:26:25.332556 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:26:25.332831 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:26:25.334217 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
17:26:25.335371 [debug] [Thread-7  ]: finished collecting timing info
17:26:25.335572 [debug] [Thread-7  ]: On model.first_project.customers: Close
17:26:25.336119 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a45317c0>]}
17:26:25.336478 [info ] [Thread-7  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
17:26:25.338646 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
17:26:25.340472 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:26:25.340631 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:26:25.341802 [debug] [Thread-7  ]: Finished running node model.first_project.customers
17:26:25.349591 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.01 seconds
17:26:25.350944 [debug] [Thread-8  ]: finished collecting timing info
17:26:25.351213 [debug] [Thread-8  ]: On model.first_project.customers2: Close
17:26:25.351690 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '31fe9cc7-3551-49e1-82fd-931badc4eaf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a44efcd0>]}
17:26:25.352023 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.09s]
17:26:25.352433 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
17:26:25.356031 [debug] [MainThread]: Acquiring new postgres connection "master"
17:26:25.356264 [debug] [MainThread]: Using postgres connection "master"
17:26:25.356381 [debug] [MainThread]: On master: BEGIN
17:26:25.356622 [debug] [MainThread]: Opening a new connection, currently in state closed
17:26:25.394162 [debug] [MainThread]: SQL status: BEGIN in 0.04 seconds
17:26:25.394454 [debug] [MainThread]: On master: COMMIT
17:26:25.394573 [debug] [MainThread]: Using postgres connection "master"
17:26:25.394674 [debug] [MainThread]: On master: COMMIT
17:26:25.394903 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:26:25.395058 [debug] [MainThread]: On master: Close
17:26:25.395643 [info ] [MainThread]: 
17:26:25.395934 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0.37s.
17:26:25.396108 [debug] [MainThread]: Connection 'master' was properly closed.
17:26:25.396200 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:26:25.396286 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:26:25.396372 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:26:25.396457 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:26:25.396545 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:26:25.396656 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:26:25.408224 [info ] [MainThread]: 
17:26:25.416958 [info ] [MainThread]: [32mCompleted successfully[0m
17:26:25.418778 [info ] [MainThread]: 
17:26:25.418990 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:26:25.421489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a7359670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a73098b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f60a9589f40>]}


============================== 2022-06-04 17:37:57.585584 | de9e75ff-6a02-4727-9d42-d5bb72061833 ==============================
17:37:57.585604 [info ] [MainThread]: Running with dbt=1.1.0
17:37:57.586187 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:37:57.586316 [debug] [MainThread]: Tracking: tracking
17:37:57.589520 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ee2cb50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ee2c190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ee2c940>]}
17:37:57.615448 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:37:57.615691 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:37:57.620530 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ed580d0>]}
17:37:57.624768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ed26f10>]}
17:37:57.625033 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:37:57.625249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ed26ee0>]}
17:37:57.628425 [info ] [MainThread]: 
17:37:57.628987 [debug] [MainThread]: Acquiring new postgres connection "master"
17:37:57.630236 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:37:57.638603 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:37:57.638803 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:37:57.638927 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:37:57.644638 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:37:57.645771 [debug] [ThreadPool]: On list_erp_oltp: Close
17:37:57.648030 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:37:57.652414 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:37:57.652569 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:37:57.652647 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:37:57.659139 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:37:57.659329 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:37:57.659434 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:37:57.661029 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:37:57.662037 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:37:57.662295 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:37:57.667020 [debug] [MainThread]: Using postgres connection "master"
17:37:57.667236 [debug] [MainThread]: On master: BEGIN
17:37:57.667323 [debug] [MainThread]: Opening a new connection, currently in state init
17:37:57.672127 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:37:57.672332 [debug] [MainThread]: Using postgres connection "master"
17:37:57.672415 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:37:57.683775 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:37:57.685213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ed26a90>]}
17:37:57.685520 [debug] [MainThread]: On master: ROLLBACK
17:37:57.685818 [debug] [MainThread]: Using postgres connection "master"
17:37:57.685943 [debug] [MainThread]: On master: BEGIN
17:37:57.686285 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:37:57.686446 [debug] [MainThread]: On master: COMMIT
17:37:57.686532 [debug] [MainThread]: Using postgres connection "master"
17:37:57.686611 [debug] [MainThread]: On master: COMMIT
17:37:57.686769 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:37:57.686876 [debug] [MainThread]: On master: Close
17:37:57.687210 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:37:57.687423 [info ] [MainThread]: 
17:37:57.691425 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:37:57.691697 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:37:57.692065 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:37:57.692195 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:37:57.692300 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:37:57.695118 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:37:57.695415 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:37:57.695624 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:37:57.695948 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:37:57.696242 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:37:57.696855 [debug] [Thread-1  ]: finished collecting timing info
17:37:57.697176 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:37:57.697510 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:37:57.698030 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:37:57.697874 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:37:57.698150 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:37:57.699304 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:37:57.698285 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:37:57.697676 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:37:57.701339 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:37:57.707330 [debug] [Thread-2  ]: finished collecting timing info
17:37:57.701705 [debug] [Thread-3  ]: finished collecting timing info
17:37:57.707597 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:37:57.725524 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:37:57.768990 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:37:57.766929 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:37:57.774794 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:37:57.775453 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:37:57.775763 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:37:57.775905 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:37:57.776260 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:37:57.776999 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:37:57.777102 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:37:57.776906 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:37:57.777363 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:37:57.777450 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
17:37:57.780884 [debug] [Thread-3  ]: SQL status: BEGIN in 0.0 seconds
17:37:57.781102 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:37:57.781194 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
17:37:57.782357 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:37:57.787106 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:37:57.787351 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:37:57.787635 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:37:57.787794 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.787921 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:37:57.789502 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:37:57.789659 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:37:57.789854 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:37:57.790291 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.795153 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:37:57.795333 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:37:57.795432 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:37:57.795718 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:37:57.797813 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:37:57.797952 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:37:57.798157 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:37:57.798272 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:37:57.798067 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:37:57.798827 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.800521 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:37:57.800635 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
17:37:57.802196 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:37:57.802319 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:37:57.800742 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:37:57.802658 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.802772 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.808873 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:37:57.809017 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:37:57.807507 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:37:57.809168 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:37:57.809251 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:37:57.809441 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.810402 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:37:57.810523 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:37:57.810623 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:37:57.840582 [debug] [Thread-3  ]: SQL status: COMMIT in 0.05 seconds
17:37:57.846239 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:37:57.846513 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:37:57.847062 [debug] [Thread-2  ]: SQL status: COMMIT in 0.04 seconds
17:37:57.846760 [debug] [Thread-1  ]: SQL status: COMMIT in 0.04 seconds
17:37:57.848737 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:37:57.851903 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:37:57.851669 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:37:57.852179 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:37:57.860612 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:37:57.862013 [debug] [Thread-3  ]: finished collecting timing info
17:37:57.862214 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:37:57.864550 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13ee27c70>]}
17:37:57.865153 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.17s]
17:37:57.865628 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:37:57.866112 [debug] [Thread-5  ]: Began running node model.first_project.customers
17:37:57.866353 [info ] [Thread-5  ]: 4 of 6 START view model public.customers ....................................... [RUN]
17:37:57.866523 [debug] [Thread-6  ]: Began running node model.first_project.customers2
17:37:57.866945 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
17:37:57.867186 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
17:37:57.867358 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
17:37:57.867746 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
17:37:57.867918 [debug] [Thread-5  ]: Compiling model.first_project.customers
17:37:57.868081 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
17:37:57.871270 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
17:37:57.871501 [debug] [Thread-6  ]: Compiling model.first_project.customers2
17:37:57.871671 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
17:37:57.873988 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
17:37:57.875100 [debug] [Thread-2  ]: finished collecting timing info
17:37:57.875571 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:37:57.875908 [debug] [Thread-6  ]: finished collecting timing info
17:37:57.876190 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
17:37:57.880277 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
17:37:57.880688 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe140fa5730>]}
17:37:57.881569 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.18s]
17:37:57.882010 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:37:57.880900 [debug] [Thread-5  ]: finished collecting timing info
17:37:57.882511 [debug] [Thread-5  ]: Began executing node model.first_project.customers
17:37:57.882189 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:37:57.888982 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
17:37:57.889219 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:37:57.881079 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.03 seconds
17:37:57.891208 [debug] [Thread-1  ]: finished collecting timing info
17:37:57.891404 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:37:57.903608 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
17:37:57.904131 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:37:57.905012 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
17:37:57.905169 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:37:57.904726 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13c4018b0>]}
17:37:57.905969 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.21s]
17:37:57.906387 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:37:57.906764 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:37:57.907008 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:37:57.907363 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:37:57.907474 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:37:57.907569 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:37:57.909504 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:37:57.909854 [debug] [Thread-8  ]: finished collecting timing info
17:37:57.910002 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:37:57.911833 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:37:57.912141 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:37:57.912272 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:37:57.912362 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:37:57.915398 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:37:57.915611 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:37:57.915710 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:37:57.916365 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
17:37:57.916530 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:37:57.916620 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:37:57.918547 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:37:57.920476 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:37:57.920609 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:37:57.920746 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
17:37:57.922470 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:37:57.922655 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:37:57.923016 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.923149 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:37:57.925086 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:37:57.925230 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:37:57.924957 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.927686 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:37:57.928205 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:37:57.928045 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:37:57.928334 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:37:57.924811 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:37:57.930222 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:37:57.930633 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:37:57.930868 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:37:57.931412 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.933033 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:37:57.933194 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:37:57.934318 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:37:57.935429 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:37:57.935651 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:37:57.935809 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:37:57.936021 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:37:57.948215 [debug] [Thread-5  ]: SQL status: COMMIT in 0.02 seconds
17:37:57.949814 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:37:57.949977 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:37:57.950311 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:37:57.951306 [debug] [Thread-5  ]: finished collecting timing info
17:37:57.951449 [debug] [Thread-5  ]: On model.first_project.customers: Close
17:37:57.951807 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13c3fad90>]}
17:37:57.952077 [info ] [Thread-5  ]: 4 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
17:37:57.952422 [debug] [Thread-5  ]: Finished running node model.first_project.customers
17:37:57.956122 [debug] [Thread-8  ]: SQL status: COMMIT in 0.02 seconds
17:37:57.956264 [debug] [Thread-6  ]: SQL status: COMMIT in 0.02 seconds
17:37:57.957502 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:37:57.961009 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:37:57.961331 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:37:57.961498 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:37:57.962616 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:37:57.963582 [debug] [Thread-8  ]: finished collecting timing info
17:37:57.963720 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:37:57.965471 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13c429670>]}
17:37:57.965854 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
17:37:57.967008 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:37:57.971655 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
17:37:57.972883 [debug] [Thread-6  ]: finished collecting timing info
17:37:57.973117 [debug] [Thread-6  ]: On model.first_project.customers2: Close
17:37:57.973691 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'de9e75ff-6a02-4727-9d42-d5bb72061833', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13c40ffd0>]}
17:37:57.974153 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.11s]
17:37:57.974689 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
17:37:57.976102 [debug] [MainThread]: Acquiring new postgres connection "master"
17:37:57.976255 [debug] [MainThread]: Using postgres connection "master"
17:37:57.976348 [debug] [MainThread]: On master: BEGIN
17:37:57.976421 [debug] [MainThread]: Opening a new connection, currently in state closed
17:37:57.980809 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:37:57.981032 [debug] [MainThread]: On master: COMMIT
17:37:57.981118 [debug] [MainThread]: Using postgres connection "master"
17:37:57.981208 [debug] [MainThread]: On master: COMMIT
17:37:57.981378 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:37:57.981484 [debug] [MainThread]: On master: Close
17:37:57.981818 [info ] [MainThread]: 
17:37:57.981991 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.35s.
17:37:57.982115 [debug] [MainThread]: Connection 'master' was properly closed.
17:37:57.982182 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:37:57.982244 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:37:57.982306 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:37:57.982367 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:37:57.982428 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:37:57.982514 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:37:57.989059 [info ] [MainThread]: 
17:37:57.989330 [info ] [MainThread]: [32mCompleted successfully[0m
17:37:57.989553 [info ] [MainThread]: 
17:37:57.989707 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:37:57.990278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe1406d5ee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13c3b2a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe13c3b2a00>]}


============================== 2022-06-04 17:38:14.502163 | 25c298e9-76bb-4282-91eb-14ab10fe34c9 ==============================
17:38:14.502183 [info ] [MainThread]: Running with dbt=1.1.0
17:38:14.502649 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:38:14.502771 [debug] [MainThread]: Tracking: tracking
17:38:14.506043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19acca4ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19acca48e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19acca4be0>]}
17:38:14.529983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:38:14.530184 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:38:14.535632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '25c298e9-76bb-4282-91eb-14ab10fe34c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19acbcd0d0>]}
17:38:14.540087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '25c298e9-76bb-4282-91eb-14ab10fe34c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19acb9ae50>]}
17:38:14.540372 [info ] [MainThread]: Found 6 models, 4 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:38:14.540577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c298e9-76bb-4282-91eb-14ab10fe34c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19acb9ae20>]}
17:38:14.541873 [info ] [MainThread]: 
17:38:14.543374 [debug] [MainThread]: Acquiring new postgres connection "master"
17:38:14.544609 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:38:14.553279 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:38:14.553528 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:38:14.553683 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:38:14.560090 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:38:14.560289 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:38:14.560382 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:38:14.562206 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:38:14.563575 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:38:14.563819 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:38:14.567382 [debug] [MainThread]: Using postgres connection "master"
17:38:14.567559 [debug] [MainThread]: On master: BEGIN
17:38:14.567663 [debug] [MainThread]: Opening a new connection, currently in state init
17:38:14.576317 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:38:14.576535 [debug] [MainThread]: Using postgres connection "master"
17:38:14.576626 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:38:14.589747 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:38:14.590935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '25c298e9-76bb-4282-91eb-14ab10fe34c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19acb9abb0>]}
17:38:14.591217 [debug] [MainThread]: On master: ROLLBACK
17:38:14.592711 [debug] [MainThread]: Using postgres connection "master"
17:38:14.592855 [debug] [MainThread]: On master: BEGIN
17:38:14.593200 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:38:14.593354 [debug] [MainThread]: On master: COMMIT
17:38:14.593486 [debug] [MainThread]: Using postgres connection "master"
17:38:14.593561 [debug] [MainThread]: On master: COMMIT
17:38:14.593755 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:38:14.593881 [debug] [MainThread]: On master: Close
17:38:14.594251 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:38:14.594456 [info ] [MainThread]: 
17:38:14.598285 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:14.598496 [info ] [Thread-1  ]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:38:14.598848 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:14.598960 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:14.599074 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:14.604379 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:14.604644 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:14.604845 [info ] [Thread-2  ]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:38:14.612983 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:14.613098 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:14.612546 [info ] [Thread-3  ]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
17:38:14.613199 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:14.612257 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:14.625087 [info ] [Thread-4  ]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
17:38:14.617491 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:14.625650 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:14.625454 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:14.625994 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:14.626272 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:14.625805 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:14.634779 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:14.635419 [debug] [Thread-3  ]: finished collecting timing info
17:38:14.631092 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:14.635616 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:14.624585 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:14.612103 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:14.677725 [debug] [Thread-4  ]: finished collecting timing info
17:38:14.677918 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:14.688598 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:14.689074 [debug] [Thread-1  ]: finished collecting timing info
17:38:14.689778 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:14.690994 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:14.691244 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:14.691499 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:38:14.691604 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:38:14.691366 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:14.691806 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:38:14.688960 [debug] [Thread-2  ]: finished collecting timing info
17:38:14.692533 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:14.692389 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:38:14.693646 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:14.694126 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:14.694212 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:38:14.694274 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:38:14.689532 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:14.694752 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:14.694857 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:38:14.694920 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:38:14.699319 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:38:14.699526 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:38:14.699614 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:38:14.700463 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:14.702036 [debug] [Thread-1  ]: finished collecting timing info
17:38:14.702244 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:38:14.702475 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:38:14.702827 [error] [Thread-1  ]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.10s]
17:38:14.703233 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:38:14.705429 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:38:14.705569 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:38:14.705666 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:38:14.706303 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:38:14.706423 [debug] [Thread-3  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:38:14.706503 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:38:14.706625 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:14.707586 [debug] [Thread-2  ]: finished collecting timing info
17:38:14.707722 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:38:14.707851 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:14.708755 [debug] [Thread-3  ]: finished collecting timing info
17:38:14.708931 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:38:14.709057 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:38:14.709375 [info ] [Thread-2  ]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
17:38:14.709647 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:38:14.709894 [debug] [Thread-3  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:38:14.710185 [info ] [Thread-3  ]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.09s]
17:38:14.710492 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:38:14.711445 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:38:14.711592 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:38:14.711689 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:38:14.712551 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:38:14.713540 [debug] [Thread-4  ]: finished collecting timing info
17:38:14.713678 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:38:14.715419 [debug] [Thread-4  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:38:14.715797 [info ] [Thread-4  ]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.09s]
17:38:14.716094 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:38:14.717440 [debug] [MainThread]: Acquiring new postgres connection "master"
17:38:14.717600 [debug] [MainThread]: Using postgres connection "master"
17:38:14.717684 [debug] [MainThread]: On master: BEGIN
17:38:14.717776 [debug] [MainThread]: Opening a new connection, currently in state closed
17:38:14.722477 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:38:14.722687 [debug] [MainThread]: On master: COMMIT
17:38:14.722791 [debug] [MainThread]: Using postgres connection "master"
17:38:14.722873 [debug] [MainThread]: On master: COMMIT
17:38:14.723431 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:38:14.723575 [debug] [MainThread]: On master: Close
17:38:14.723905 [info ] [MainThread]: 
17:38:14.724091 [info ] [MainThread]: Finished running 4 tests in 0.18s.
17:38:14.724228 [debug] [MainThread]: Connection 'master' was properly closed.
17:38:14.724298 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:38:14.724376 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:38:14.724442 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:38:14.724508 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:38:14.727977 [info ] [MainThread]: 
17:38:14.728179 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:38:14.728346 [info ] [MainThread]: 
17:38:14.728490 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:38:14.728636 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:38:14.728766 [info ] [MainThread]: 
17:38:14.728898 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:38:14.729037 [info ] [MainThread]: 
17:38:14.729168 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
17:38:14.729374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19aeb4f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ac2ddf70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f19ac3116d0>]}


============================== 2022-06-04 17:46:36.978405 | 8b4de64e-13e6-40d0-a463-222e33d464a5 ==============================
17:46:36.978425 [info ] [MainThread]: Running with dbt=1.1.0
17:46:36.978887 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:46:36.979008 [debug] [MainThread]: Tracking: tracking
17:46:36.982236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f6e2ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f6e28e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f6e2be0>]}
17:46:37.007889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
17:46:37.008378 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/schema.yml
17:46:37.044149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b4de64e-13e6-40d0-a463-222e33d464a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f5640d0>]}
17:46:37.049041 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b4de64e-13e6-40d0-a463-222e33d464a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f5d9f10>]}
17:46:37.049326 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:46:37.049554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b4de64e-13e6-40d0-a463-222e33d464a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f5d9be0>]}
17:46:37.050942 [info ] [MainThread]: 
17:46:37.051362 [debug] [MainThread]: Acquiring new postgres connection "master"
17:46:37.052501 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:46:37.062502 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:46:37.062802 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:46:37.062919 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:46:37.070752 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:46:37.070988 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:46:37.071087 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:46:37.072848 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:46:37.074231 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:46:37.074510 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:46:37.078344 [debug] [MainThread]: Using postgres connection "master"
17:46:37.078516 [debug] [MainThread]: On master: BEGIN
17:46:37.078603 [debug] [MainThread]: Opening a new connection, currently in state init
17:46:37.085129 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:46:37.085490 [debug] [MainThread]: Using postgres connection "master"
17:46:37.085704 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:46:37.099690 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:46:37.100898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b4de64e-13e6-40d0-a463-222e33d464a5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f5dd5e0>]}
17:46:37.101254 [debug] [MainThread]: On master: ROLLBACK
17:46:37.101532 [debug] [MainThread]: Using postgres connection "master"
17:46:37.101687 [debug] [MainThread]: On master: BEGIN
17:46:37.101993 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:46:37.102141 [debug] [MainThread]: On master: COMMIT
17:46:37.102338 [debug] [MainThread]: Using postgres connection "master"
17:46:37.102421 [debug] [MainThread]: On master: COMMIT
17:46:37.102591 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:46:37.102707 [debug] [MainThread]: On master: Close
17:46:37.103049 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:46:37.104099 [info ] [MainThread]: 
17:46:37.140353 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_custumer_id.c564f3d13f
17:46:37.140587 [info ] [Thread-1  ]: 1 of 5 START test not_null_customers_custumer_id ............................... [RUN]
17:46:37.140962 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_custumer_id.c564f3d13f"
17:46:37.141095 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_custumer_id.c564f3d13f
17:46:37.141194 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_custumer_id.c564f3d13f
17:46:37.150842 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_custumer_id.c564f3d13f"
17:46:37.151158 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:46:37.151751 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:46:37.151273 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:46:37.151438 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:46:37.152556 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:46:37.152933 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:46:37.153040 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:46:37.153127 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:46:37.152354 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:46:37.159417 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:46:37.151354 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:46:37.152099 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:46:37.158414 [debug] [Thread-1  ]: finished collecting timing info
17:46:37.159701 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:46:37.159949 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:46:37.161073 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:46:37.160142 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:46:37.160395 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_custumer_id.c564f3d13f
17:46:37.160665 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:46:37.161195 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:46:37.179906 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:46:37.182863 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:46:37.161338 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:46:37.186388 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:46:37.183206 [debug] [Thread-4  ]: finished collecting timing info
17:46:37.179617 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:46:37.176414 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_custumer_id.c564f3d13f"
17:46:37.158082 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:46:37.186763 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:46:37.187016 [debug] [Thread-2  ]: finished collecting timing info
17:46:37.190087 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:46:37.188118 [debug] [Thread-5  ]: finished collecting timing info
17:46:37.191697 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:46:37.191503 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:46:37.187632 [debug] [Thread-3  ]: finished collecting timing info
17:46:37.193396 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:46:37.193028 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:46:37.189733 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:46:37.195734 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:46:37.195105 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:46:37.195416 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:46:37.193570 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_custumer_id.c564f3d13f"
17:46:37.195918 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:46:37.196110 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:46:37.196901 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:46:37.196686 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:46:37.196560 [debug] [Thread-1  ]: On test.first_project.not_null_customers_custumer_id.c564f3d13f: BEGIN
17:46:37.196377 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:46:37.198520 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:46:37.197154 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:46:37.199058 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:46:37.199168 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:46:37.198355 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:46:37.197030 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:46:37.209030 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:46:37.209249 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:46:37.209352 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:46:37.210383 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:46:37.213398 [debug] [Thread-5  ]: finished collecting timing info
17:46:37.213599 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:46:37.214536 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:46:37.214731 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:46:37.215329 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:46:37.215464 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:46:37.215180 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
17:46:37.216189 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:46:37.217278 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:46:37.217412 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_custumer_id.c564f3d13f"
17:46:37.217505 [debug] [Thread-1  ]: On test.first_project.not_null_customers_custumer_id.c564f3d13f: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_custumer_id.c564f3d13f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select custumer_id
from "erp_oltp"."public"."customers"
where custumer_id is null



      
    ) dbt_internal_test
17:46:37.217722 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:46:37.218844 [debug] [Thread-4  ]: finished collecting timing info
17:46:37.219003 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:46:37.219137 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "custumer_id" does not exist
LINE 13: select custumer_id
                ^
HINT:  Perhaps you meant to reference the column "customers.customer_id".

17:46:37.219429 [debug] [Thread-1  ]: On test.first_project.not_null_customers_custumer_id.c564f3d13f: ROLLBACK
17:46:37.219621 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:46:37.219903 [debug] [Thread-1  ]: finished collecting timing info
17:46:37.220073 [debug] [Thread-1  ]: On test.first_project.not_null_customers_custumer_id.c564f3d13f: Close
17:46:37.220407 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:46:37.220688 [debug] [Thread-1  ]: Database Error in test not_null_customers_custumer_id (models/erp/schema.yml)
  column "custumer_id" does not exist
  LINE 13: select custumer_id
                  ^
  HINT:  Perhaps you meant to reference the column "customers.customer_id".
  compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_customers_custumer_id.sql
17:46:37.221250 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:46:37.221681 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:46:37.221786 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:46:37.221510 [error] [Thread-1  ]: 1 of 5 ERROR not_null_customers_custumer_id .................................... [[31mERROR[0m in 0.08s]
17:46:37.221330 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:46:37.222280 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:46:37.222113 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_custumer_id.c564f3d13f
17:46:37.222384 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:46:37.221100 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:46:37.223246 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:46:37.224278 [debug] [Thread-3  ]: finished collecting timing info
17:46:37.224426 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:46:37.224579 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:46:37.225618 [debug] [Thread-2  ]: finished collecting timing info
17:46:37.225770 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:46:37.225909 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:46:37.226271 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.07s]
17:46:37.226571 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:46:37.231284 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:46:37.232029 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:46:37.232602 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:46:37.235069 [debug] [MainThread]: Acquiring new postgres connection "master"
17:46:37.235409 [debug] [MainThread]: Using postgres connection "master"
17:46:37.235531 [debug] [MainThread]: On master: BEGIN
17:46:37.235622 [debug] [MainThread]: Opening a new connection, currently in state closed
17:46:37.242037 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:46:37.242276 [debug] [MainThread]: On master: COMMIT
17:46:37.242372 [debug] [MainThread]: Using postgres connection "master"
17:46:37.242458 [debug] [MainThread]: On master: COMMIT
17:46:37.242680 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:46:37.242847 [debug] [MainThread]: On master: Close
17:46:37.243204 [info ] [MainThread]: 
17:46:37.243426 [info ] [MainThread]: Finished running 5 tests in 0.19s.
17:46:37.243658 [debug] [MainThread]: Connection 'master' was properly closed.
17:46:37.243735 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_custumer_id.c564f3d13f' was properly closed.
17:46:37.243804 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:46:37.243871 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:46:37.243939 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:46:37.244005 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:46:37.248344 [info ] [MainThread]: 
17:46:37.248643 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:46:37.248836 [info ] [MainThread]: 
17:46:37.249047 [error] [MainThread]: [33mDatabase Error in test not_null_customers_custumer_id (models/erp/schema.yml)[0m
17:46:37.249206 [error] [MainThread]:   column "custumer_id" does not exist
17:46:37.249341 [error] [MainThread]:   LINE 13: select custumer_id
17:46:37.249473 [error] [MainThread]:                   ^
17:46:37.249607 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "customers.customer_id".
17:46:37.249743 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_customers_custumer_id.sql
17:46:37.249879 [info ] [MainThread]: 
17:46:37.250019 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:46:37.250173 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:46:37.250310 [info ] [MainThread]: 
17:46:37.250450 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:46:37.250598 [info ] [MainThread]: 
17:46:37.250737 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
17:46:37.250960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f6a5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f6a55e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd17f4fb730>]}


============================== 2022-06-04 17:47:25.253016 | cd3e78bf-c378-410b-8def-d3996138bd8b ==============================
17:47:25.253035 [info ] [MainThread]: Running with dbt=1.1.0
17:47:25.253669 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:47:25.253832 [debug] [MainThread]: Tracking: tracking
17:47:25.258065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5c3d1100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5c3d1c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5c3d1e20>]}
17:47:25.286200 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:47:25.286836 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:47:25.297936 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:47:25.334648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'cd3e78bf-c378-410b-8def-d3996138bd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5be05f40>]}
17:47:25.339925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'cd3e78bf-c378-410b-8def-d3996138bd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5beb06a0>]}
17:47:25.340238 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:47:25.340601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3e78bf-c378-410b-8def-d3996138bd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5beb05b0>]}
17:47:25.342038 [info ] [MainThread]: 
17:47:25.342500 [debug] [MainThread]: Acquiring new postgres connection "master"
17:47:25.343643 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:47:25.381735 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:47:25.382029 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:47:25.382177 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:47:25.389638 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:47:25.389850 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:47:25.389947 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:47:25.391868 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:47:25.393485 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:47:25.393792 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:47:25.397773 [debug] [MainThread]: Using postgres connection "master"
17:47:25.398171 [debug] [MainThread]: On master: BEGIN
17:47:25.398310 [debug] [MainThread]: Opening a new connection, currently in state init
17:47:25.405065 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:47:25.405284 [debug] [MainThread]: Using postgres connection "master"
17:47:25.405391 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:47:25.420932 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
17:47:25.422316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'cd3e78bf-c378-410b-8def-d3996138bd8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5bea8490>]}
17:47:25.422658 [debug] [MainThread]: On master: ROLLBACK
17:47:25.423143 [debug] [MainThread]: Using postgres connection "master"
17:47:25.423305 [debug] [MainThread]: On master: BEGIN
17:47:25.423589 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:47:25.423726 [debug] [MainThread]: On master: COMMIT
17:47:25.423896 [debug] [MainThread]: Using postgres connection "master"
17:47:25.424012 [debug] [MainThread]: On master: COMMIT
17:47:25.424234 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:47:25.424390 [debug] [MainThread]: On master: Close
17:47:25.424764 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:47:25.425086 [info ] [MainThread]: 
17:47:25.437117 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_costumer_id.6a3126efc5
17:47:25.437356 [info ] [Thread-1  ]: 1 of 5 START test not_null_customers_costumer_id ............................... [RUN]
17:47:25.437758 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_costumer_id.6a3126efc5"
17:47:25.437942 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_costumer_id.6a3126efc5
17:47:25.438058 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_costumer_id.6a3126efc5
17:47:25.447847 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:25.448090 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:47:25.448614 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:25.448761 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:25.448947 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:25.455625 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:25.455860 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:25.460149 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:47:25.458397 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:25.458620 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:47:25.455977 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:25.460562 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:25.459900 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_costumer_id.6a3126efc5"
17:47:25.461021 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:47:25.462115 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:25.461480 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:25.462302 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:25.463112 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:25.461336 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:25.462961 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:25.472236 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:25.469018 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:25.462613 [debug] [Thread-2  ]: finished collecting timing info
17:47:25.473053 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:25.472578 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:25.472814 [debug] [Thread-4  ]: finished collecting timing info
17:47:25.468709 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:25.484133 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:25.484471 [debug] [Thread-1  ]: finished collecting timing info
17:47:25.488653 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:25.489053 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:25.492330 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:25.489711 [debug] [Thread-5  ]: finished collecting timing info
17:47:25.489942 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:25.489495 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_costumer_id.6a3126efc5
17:47:25.492660 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:25.492967 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:25.496074 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:47:25.496189 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:47:25.495811 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:25.495936 [debug] [Thread-3  ]: finished collecting timing info
17:47:25.496564 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:25.497582 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:25.497818 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:25.498289 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:47:25.498374 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:47:25.498096 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:25.498848 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:47:25.498942 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:47:25.494334 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_costumer_id.6a3126efc5"
17:47:25.501117 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_costumer_id.6a3126efc5"
17:47:25.501218 [debug] [Thread-1  ]: On test.first_project.not_null_customers_costumer_id.6a3126efc5: BEGIN
17:47:25.501295 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:47:25.493106 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:47:25.501493 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:47:25.510654 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:47:25.510858 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:47:25.510945 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:47:25.511125 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:47:25.511226 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_costumer_id.6a3126efc5"
17:47:25.511295 [debug] [Thread-1  ]: On test.first_project.not_null_customers_costumer_id.6a3126efc5: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_costumer_id.6a3126efc5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select costumer_id
from "erp_oltp"."public"."customers"
where costumer_id is null



      
    ) dbt_internal_test
17:47:25.512092 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:25.514464 [debug] [Thread-5  ]: finished collecting timing info
17:47:25.514814 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:47:25.514966 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:47:25.515097 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:47:25.515337 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:47:25.515815 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:47:25.515681 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:47:25.515915 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:47:25.515552 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:47:25.516026 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:47:25.516211 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:47:25.516439 [debug] [Thread-1  ]: Postgres adapter: Postgres error: column "costumer_id" does not exist
LINE 13: select costumer_id
                ^
HINT:  Perhaps you meant to reference the column "customers.customer_id".

17:47:25.516604 [debug] [Thread-1  ]: On test.first_project.not_null_customers_costumer_id.6a3126efc5: ROLLBACK
17:47:25.516842 [debug] [Thread-1  ]: finished collecting timing info
17:47:25.516982 [debug] [Thread-1  ]: On test.first_project.not_null_customers_costumer_id.6a3126efc5: Close
17:47:25.517301 [debug] [Thread-1  ]: Database Error in test not_null_customers_costumer_id (models/erp/schema.yml)
  column "costumer_id" does not exist
  LINE 13: select costumer_id
                  ^
  HINT:  Perhaps you meant to reference the column "customers.customer_id".
  compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_customers_costumer_id.sql
17:47:25.517559 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:25.517757 [error] [Thread-1  ]: 1 of 5 ERROR not_null_customers_costumer_id .................................... [[31mERROR[0m in 0.08s]
17:47:25.518829 [debug] [Thread-2  ]: finished collecting timing info
17:47:25.519226 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:47:25.519473 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_costumer_id.6a3126efc5
17:47:25.519562 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:47:25.520175 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
17:47:25.520319 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:47:25.520662 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:47:25.520886 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:25.522088 [debug] [Thread-4  ]: finished collecting timing info
17:47:25.522652 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:47:25.522429 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.07s]
17:47:25.520995 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:47:25.523113 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:47:25.524135 [debug] [Thread-3  ]: finished collecting timing info
17:47:25.524469 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:47:25.524610 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:47:25.524961 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.06s]
17:47:25.525232 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:47:25.525393 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:47:25.525675 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.06s]
17:47:25.525922 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:47:25.527050 [debug] [MainThread]: Acquiring new postgres connection "master"
17:47:25.527192 [debug] [MainThread]: Using postgres connection "master"
17:47:25.527285 [debug] [MainThread]: On master: BEGIN
17:47:25.527360 [debug] [MainThread]: Opening a new connection, currently in state closed
17:47:25.533286 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:47:25.533620 [debug] [MainThread]: On master: COMMIT
17:47:25.533744 [debug] [MainThread]: Using postgres connection "master"
17:47:25.533840 [debug] [MainThread]: On master: COMMIT
17:47:25.535048 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:47:25.535254 [debug] [MainThread]: On master: Close
17:47:25.535691 [info ] [MainThread]: 
17:47:25.535921 [info ] [MainThread]: Finished running 5 tests in 0.19s.
17:47:25.536088 [debug] [MainThread]: Connection 'master' was properly closed.
17:47:25.536173 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_costumer_id.6a3126efc5' was properly closed.
17:47:25.536251 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:47:25.536324 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:47:25.536410 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:47:25.536484 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:47:25.543518 [info ] [MainThread]: 
17:47:25.543992 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:47:25.544199 [info ] [MainThread]: 
17:47:25.544383 [error] [MainThread]: [33mDatabase Error in test not_null_customers_costumer_id (models/erp/schema.yml)[0m
17:47:25.544543 [error] [MainThread]:   column "costumer_id" does not exist
17:47:25.544681 [error] [MainThread]:   LINE 13: select costumer_id
17:47:25.544976 [error] [MainThread]:                   ^
17:47:25.545148 [error] [MainThread]:   HINT:  Perhaps you meant to reference the column "customers.customer_id".
17:47:25.545332 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/schema.yml/not_null_customers_costumer_id.sql
17:47:25.545532 [info ] [MainThread]: 
17:47:25.545791 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:47:25.545986 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:47:25.546128 [info ] [MainThread]: 
17:47:25.546260 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:47:25.547518 [info ] [MainThread]: 
17:47:25.547769 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
17:47:25.548015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5c3d19d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac5dc76dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac585ce850>]}


============================== 2022-06-04 17:48:28.537336 | d4d7d60d-0c35-467a-8610-ea1ef1483548 ==============================
17:48:28.537355 [info ] [MainThread]: Running with dbt=1.1.0
17:48:28.537949 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:48:28.538100 [debug] [MainThread]: Tracking: tracking
17:48:28.541544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2b58fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2b58fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2b58d60>]}
17:48:28.568669 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:48:28.569334 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:48:28.579246 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:48:28.615940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4d7d60d-0c35-467a-8610-ea1ef1483548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2579f10>]}
17:48:28.621048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4d7d60d-0c35-467a-8610-ea1ef1483548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2b4d490>]}
17:48:28.621350 [info ] [MainThread]: Found 6 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:48:28.621581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4d7d60d-0c35-467a-8610-ea1ef1483548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2626af0>]}
17:48:28.623076 [info ] [MainThread]: 
17:48:28.623550 [debug] [MainThread]: Acquiring new postgres connection "master"
17:48:28.624557 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:48:28.664803 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:48:28.665147 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:48:28.665438 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:48:28.671664 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:48:28.671853 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:48:28.671965 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:48:28.673771 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:48:28.675045 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:48:28.675377 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:48:28.678734 [debug] [MainThread]: Using postgres connection "master"
17:48:28.678949 [debug] [MainThread]: On master: BEGIN
17:48:28.679053 [debug] [MainThread]: Opening a new connection, currently in state init
17:48:28.684891 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:48:28.685093 [debug] [MainThread]: Using postgres connection "master"
17:48:28.685183 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:48:28.698440 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:48:28.699640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4d7d60d-0c35-467a-8610-ea1ef1483548', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab2626910>]}
17:48:28.699931 [debug] [MainThread]: On master: ROLLBACK
17:48:28.700222 [debug] [MainThread]: Using postgres connection "master"
17:48:28.700351 [debug] [MainThread]: On master: BEGIN
17:48:28.700611 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:48:28.700729 [debug] [MainThread]: On master: COMMIT
17:48:28.700816 [debug] [MainThread]: Using postgres connection "master"
17:48:28.700927 [debug] [MainThread]: On master: COMMIT
17:48:28.701175 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:48:28.701288 [debug] [MainThread]: On master: Close
17:48:28.701675 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:48:28.701877 [info ] [MainThread]: 
17:48:28.705458 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:48:28.705628 [info ] [Thread-1  ]: 1 of 5 START test not_null_customers_customer_id ............................... [RUN]
17:48:28.705942 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:48:28.706050 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:48:28.706150 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:48:28.718034 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:48:28.718262 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:28.718736 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:48:28.719104 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:28.719229 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:28.719319 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:28.718538 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:28.722702 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
17:48:28.718454 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:28.724589 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
17:48:28.723226 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:28.725505 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:28.725689 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:28.725255 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:28.735674 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:28.722467 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:28.731358 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:28.723544 [debug] [Thread-1  ]: finished collecting timing info
17:48:28.718369 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:28.735830 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:28.736239 [debug] [Thread-2  ]: finished collecting timing info
17:48:28.740478 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:28.736778 [debug] [Thread-5  ]: finished collecting timing info
17:48:28.754275 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:28.740156 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:28.736623 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:48:28.755598 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:28.736986 [info ] [Thread-3  ]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:48:28.758752 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:28.758954 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:28.758150 [debug] [Thread-4  ]: finished collecting timing info
17:48:28.757833 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:48:28.759719 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:48:28.759849 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:48:28.759292 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:28.761215 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:28.759939 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:48:28.759069 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:28.759449 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:28.754004 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:28.765209 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:28.765464 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:48:28.765806 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:48:28.766170 [debug] [Thread-3  ]: finished collecting timing info
17:48:28.766311 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:28.767563 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:28.767867 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:28.767970 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:48:28.768047 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:48:28.768596 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:28.768726 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:48:28.768825 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:48:28.761732 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:28.769231 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:48:28.769327 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:48:28.773433 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:48:28.773637 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:48:28.773731 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:48:28.774900 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:28.776672 [debug] [Thread-1  ]: finished collecting timing info
17:48:28.776875 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:48:28.777648 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:48:28.778040 [info ] [Thread-1  ]: 1 of 5 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.07s]
17:48:28.778373 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:48:28.778979 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:48:28.779118 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:48:28.779210 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:48:28.782834 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:28.784624 [debug] [Thread-5  ]: finished collecting timing info
17:48:28.784950 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:48:28.785298 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:48:28.785445 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:48:28.785538 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:48:28.786001 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:48:28.786199 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
17:48:28.786406 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:48:28.786568 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:48:28.786893 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
17:48:28.787366 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:48:28.788339 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:28.789768 [debug] [Thread-4  ]: finished collecting timing info
17:48:28.790017 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:48:28.790233 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:28.791327 [debug] [Thread-3  ]: finished collecting timing info
17:48:28.791539 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:48:28.791852 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:48:28.792374 [info ] [Thread-3  ]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.03s]
17:48:28.792758 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:48:28.793200 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
17:48:28.793324 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
17:48:28.793716 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:48:28.793816 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:48:28.793506 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:48:28.794166 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:48:28.798286 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:48:28.800235 [debug] [Thread-2  ]: finished collecting timing info
17:48:28.800454 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:48:28.800731 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:48:28.801153 [error] [Thread-2  ]: 2 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:48:28.801573 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:48:28.805011 [debug] [MainThread]: Acquiring new postgres connection "master"
17:48:28.805194 [debug] [MainThread]: Using postgres connection "master"
17:48:28.805285 [debug] [MainThread]: On master: BEGIN
17:48:28.805362 [debug] [MainThread]: Opening a new connection, currently in state closed
17:48:28.810949 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:48:28.811171 [debug] [MainThread]: On master: COMMIT
17:48:28.811261 [debug] [MainThread]: Using postgres connection "master"
17:48:28.811341 [debug] [MainThread]: On master: COMMIT
17:48:28.811530 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:48:28.811655 [debug] [MainThread]: On master: Close
17:48:28.811991 [info ] [MainThread]: 
17:48:28.812205 [info ] [MainThread]: Finished running 5 tests in 0.19s.
17:48:28.812393 [debug] [MainThread]: Connection 'master' was properly closed.
17:48:28.812467 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:48:28.812533 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:48:28.812598 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:48:28.812661 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:48:28.812724 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:48:28.816552 [info ] [MainThread]: 
17:48:28.816773 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
17:48:28.817012 [info ] [MainThread]: 
17:48:28.817155 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:48:28.817302 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:48:28.817429 [info ] [MainThread]: 
17:48:28.817558 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:48:28.817695 [info ] [MainThread]: 
17:48:28.817824 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
17:48:28.818027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab26078b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab4367d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ab25849a0>]}


============================== 2022-06-04 17:49:55.571923 | 3c23ffcb-4209-4749-a9c3-e3dc7d461a8b ==============================
17:49:55.571942 [info ] [MainThread]: Running with dbt=1.1.0
17:49:55.572503 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
17:49:55.572670 [debug] [MainThread]: Tracking: tracking
17:49:55.576143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8ce9070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8ce9040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8ce92b0>]}
17:49:55.605740 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:49:55.606500 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:49:55.617245 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:49:55.653694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3c23ffcb-4209-4749-a9c3-e3dc7d461a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8778f40>]}
17:49:55.659390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3c23ffcb-4209-4749-a9c3-e3dc7d461a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8ceb880>]}
17:49:55.659721 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:49:55.659963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c23ffcb-4209-4749-a9c3-e3dc7d461a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f87c5af0>]}
17:49:55.661510 [info ] [MainThread]: 
17:49:55.661952 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:55.663191 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:49:55.704337 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:49:55.704552 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:49:55.704642 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:49:55.710291 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:49:55.710489 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:49:55.710573 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:49:55.712243 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:49:55.713506 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:49:55.713783 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:49:55.717333 [debug] [MainThread]: Using postgres connection "master"
17:49:55.717514 [debug] [MainThread]: On master: BEGIN
17:49:55.717601 [debug] [MainThread]: Opening a new connection, currently in state init
17:49:55.722755 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:49:55.722991 [debug] [MainThread]: Using postgres connection "master"
17:49:55.723097 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:49:55.737625 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:49:55.739083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3c23ffcb-4209-4749-a9c3-e3dc7d461a8b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f8bfdb80>]}
17:49:55.739429 [debug] [MainThread]: On master: ROLLBACK
17:49:55.739793 [debug] [MainThread]: Using postgres connection "master"
17:49:55.739933 [debug] [MainThread]: On master: BEGIN
17:49:55.740275 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:49:55.740442 [debug] [MainThread]: On master: COMMIT
17:49:55.740552 [debug] [MainThread]: Using postgres connection "master"
17:49:55.740648 [debug] [MainThread]: On master: COMMIT
17:49:55.740964 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:55.741144 [debug] [MainThread]: On master: Close
17:49:55.741534 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:49:55.741791 [info ] [MainThread]: 
17:49:55.746491 [debug] [Thread-1  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:55.746715 [info ] [Thread-1  ]: 1 of 6 START test not_null_customers_customer_id ............................... [RUN]
17:49:55.747109 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:55.747245 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:55.747358 [debug] [Thread-1  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:55.754612 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:55.754916 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:55.761096 [info ] [Thread-3  ]: 3 of 6 START test not_null_my_second_dbt_model_id .............................. [RUN]
17:49:55.761483 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:55.761603 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:55.760840 [info ] [Thread-2  ]: 2 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
17:49:55.755081 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:55.755464 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:55.755595 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:55.767003 [info ] [Thread-6  ]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
17:49:55.766462 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:55.767485 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:55.766664 [info ] [Thread-4  ]: 4 of 6 START test unique_customers_customer_id ................................. [RUN]
17:49:55.766856 [info ] [Thread-5  ]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
17:49:55.769213 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:55.769323 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:55.769420 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:55.761703 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:55.767941 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:55.767609 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:55.764301 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:55.767339 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:55.775143 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:55.778090 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:55.778354 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:55.780970 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:55.784618 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:55.785000 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:55.789973 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:55.790283 [debug] [Thread-4  ]: finished collecting timing info
17:49:55.790430 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:55.786101 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:55.804374 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:55.785316 [debug] [Thread-5  ]: finished collecting timing info
17:49:55.812933 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:55.814277 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:55.807709 [debug] [Thread-2  ]: finished collecting timing info
17:49:55.814530 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:55.815679 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:55.785692 [debug] [Thread-3  ]: finished collecting timing info
17:49:55.816175 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:55.785884 [debug] [Thread-1  ]: finished collecting timing info
17:49:55.811565 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:55.815972 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:55.812030 [debug] [Thread-6  ]: finished collecting timing info
17:49:55.818943 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:55.817794 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:55.818520 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:55.818756 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
17:49:55.820203 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:55.822806 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:55.821831 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:55.822129 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
17:49:55.823228 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:49:55.822469 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:49:55.822996 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
17:49:55.824968 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:49:55.817451 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:55.825650 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:55.825812 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
17:49:55.825920 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:49:55.822360 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:55.826449 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
17:49:55.826542 [debug] [Thread-4  ]: Opening a new connection, currently in state init
17:49:55.826050 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:55.826727 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
17:49:55.826873 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:49:55.831383 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:49:55.831579 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
17:49:55.831665 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:49:55.834669 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
17:49:55.834851 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
17:49:55.834934 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
17:49:55.835031 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:55.835172 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:49:55.837088 [debug] [Thread-5  ]: finished collecting timing info
17:49:55.837254 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
17:49:55.837783 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
17:49:55.837463 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:55.837617 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
17:49:55.838725 [debug] [Thread-6  ]: finished collecting timing info
17:49:55.838978 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
17:49:55.839069 [debug] [Thread-5  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
17:49:55.839434 [info ] [Thread-5  ]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.07s]
17:49:55.839804 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
17:49:55.839937 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:55.841068 [debug] [Thread-2  ]: finished collecting timing info
17:49:55.841243 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
17:49:55.840068 [debug] [Thread-6  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
17:49:55.841699 [info ] [Thread-6  ]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
17:49:55.842004 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
17:49:55.842253 [debug] [Thread-2  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
17:49:55.842536 [error] [Thread-2  ]: 2 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.08s]
17:49:55.842866 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
17:49:55.847781 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:49:55.847966 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
17:49:55.848146 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
17:49:55.848292 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
17:49:55.848416 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
17:49:55.848525 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
17:49:55.849263 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:55.850230 [debug] [Thread-3  ]: finished collecting timing info
17:49:55.850408 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
17:49:55.850547 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:55.851655 [debug] [Thread-1  ]: finished collecting timing info
17:49:55.851827 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
17:49:55.852746 [debug] [Thread-1  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
17:49:55.853193 [info ] [Thread-1  ]: 1 of 6 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.11s]
17:49:55.853343 [debug] [Thread-3  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
17:49:55.853687 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
17:49:55.856002 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
17:49:55.856955 [info ] [Thread-3  ]: 3 of 6 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.10s]
17:49:55.859667 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
17:49:55.857305 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
17:49:55.859847 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
17:49:55.861571 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
17:49:55.862630 [debug] [Thread-4  ]: finished collecting timing info
17:49:55.862774 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
17:49:55.862985 [debug] [Thread-4  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
17:49:55.863329 [error] [Thread-4  ]: 4 of 6 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.10s]
17:49:55.863630 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
17:49:55.865357 [debug] [MainThread]: Acquiring new postgres connection "master"
17:49:55.865575 [debug] [MainThread]: Using postgres connection "master"
17:49:55.865688 [debug] [MainThread]: On master: BEGIN
17:49:55.865763 [debug] [MainThread]: Opening a new connection, currently in state closed
17:49:55.872899 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:49:55.873216 [debug] [MainThread]: On master: COMMIT
17:49:55.873369 [debug] [MainThread]: Using postgres connection "master"
17:49:55.873484 [debug] [MainThread]: On master: COMMIT
17:49:55.873726 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:49:55.873859 [debug] [MainThread]: On master: Close
17:49:55.874216 [info ] [MainThread]: 
17:49:55.874398 [info ] [MainThread]: Finished running 6 tests in 0.21s.
17:49:55.874540 [debug] [MainThread]: Connection 'master' was properly closed.
17:49:55.874611 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
17:49:55.874679 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
17:49:55.874748 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
17:49:55.874824 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
17:49:55.874888 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
17:49:55.874951 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
17:49:55.879384 [info ] [MainThread]: 
17:49:55.879658 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
17:49:55.879885 [info ] [MainThread]: 
17:49:55.880052 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
17:49:55.880264 [error] [MainThread]:   Got 1 result, configured to fail if != 0
17:49:55.880415 [info ] [MainThread]: 
17:49:55.880561 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
17:49:55.880708 [info ] [MainThread]: 
17:49:55.880849 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
17:49:55.881099 [error] [MainThread]:   Got 50 results, configured to fail if != 0
17:49:55.881309 [info ] [MainThread]: 
17:49:55.881460 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
17:49:55.881613 [info ] [MainThread]: 
17:49:55.881758 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
17:49:55.881985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fa5068b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43fa506e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f43f879bfa0>]}


============================== 2022-06-04 17:50:17.801959 | c60a27c7-3fb8-4445-8ad6-0b44062e1bda ==============================
17:50:17.801978 [info ] [MainThread]: Running with dbt=1.1.0
17:50:17.802851 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:50:17.803069 [debug] [MainThread]: Tracking: tracking
17:50:17.807506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62819c4b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62819c4190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62819c4940>]}
17:50:17.833257 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
17:50:17.833647 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
17:50:17.842852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62818f10d0>]}
17:50:17.847668 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281945550>]}
17:50:17.847943 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:50:17.848143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62819454c0>]}
17:50:17.849497 [info ] [MainThread]: 
17:50:17.849878 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:17.850738 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:50:17.858726 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:50:17.858898 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:50:17.858999 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:50:17.907504 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.05 seconds
17:50:17.908786 [debug] [ThreadPool]: On list_erp_oltp: Close
17:50:17.911521 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:50:17.916893 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:17.917104 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:50:17.917200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:50:17.949386 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
17:50:17.949728 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:50:17.949879 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:50:17.951789 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:50:17.953009 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:50:17.953261 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:50:17.957215 [debug] [MainThread]: Using postgres connection "master"
17:50:17.957401 [debug] [MainThread]: On master: BEGIN
17:50:17.957498 [debug] [MainThread]: Opening a new connection, currently in state init
17:50:17.973332 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
17:50:17.973631 [debug] [MainThread]: Using postgres connection "master"
17:50:17.973780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:50:18.007842 [debug] [MainThread]: SQL status: SELECT 5 in 0.03 seconds
17:50:18.009135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62818bee20>]}
17:50:18.009451 [debug] [MainThread]: On master: ROLLBACK
17:50:18.021050 [debug] [MainThread]: Using postgres connection "master"
17:50:18.021306 [debug] [MainThread]: On master: BEGIN
17:50:18.021637 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:50:18.021789 [debug] [MainThread]: On master: COMMIT
17:50:18.021885 [debug] [MainThread]: Using postgres connection "master"
17:50:18.021983 [debug] [MainThread]: On master: COMMIT
17:50:18.022158 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:18.022284 [debug] [MainThread]: On master: Close
17:50:18.022658 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:50:18.022884 [info ] [MainThread]: 
17:50:18.151418 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:50:18.151682 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:50:18.152178 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:50:18.153458 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:50:18.152726 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:50:18.153608 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:50:18.154243 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:50:18.154052 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:50:18.156326 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:50:18.152381 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:50:18.156533 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:50:18.156842 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:50:18.157027 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:50:18.157457 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:50:18.159561 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:50:18.159790 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:50:18.160129 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:50:18.161762 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:50:18.162047 [debug] [Thread-1  ]: finished collecting timing info
17:50:18.162284 [debug] [Thread-2  ]: finished collecting timing info
17:50:18.162529 [debug] [Thread-3  ]: finished collecting timing info
17:50:18.163038 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:50:18.162858 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:50:18.162705 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:50:18.289117 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:50:18.314492 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:18.314785 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:50:18.314917 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:50:18.289555 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:50:18.315765 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:50:18.315927 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:50:18.316018 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:50:18.325567 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:50:18.326036 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
17:50:18.326907 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:50:18.327037 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code
  from erp_oltp.public.clientes
)
select * from customers
  );
17:50:18.328010 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:50:18.328174 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:18.328265 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:50:18.329614 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:50:18.339066 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:50:18.339325 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:50:18.339542 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:18.341188 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:50:18.341560 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:50:18.343757 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:18.344040 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:50:18.344277 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:50:18.344393 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.347299 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:50:18.349588 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.350038 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:50:18.352636 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:18.353015 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:50:18.352823 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:18.350854 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:50:18.353191 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:50:18.353528 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.359732 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:50:18.359942 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
17:50:18.361140 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:50:18.360201 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
17:50:18.362951 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:18.361282 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:50:18.363203 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:50:18.363072 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:50:18.360070 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:18.363498 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:50:18.364505 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.366517 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:18.366695 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:50:18.367177 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.371608 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:50:18.371763 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:18.371855 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:50:18.377112 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:50:18.377275 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:50:18.381165 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:50:18.382455 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:50:18.382653 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:50:18.382795 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:50:18.382894 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:50:18.385605 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:50:18.385745 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:50:18.390216 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
17:50:18.391132 [debug] [Thread-2  ]: finished collecting timing info
17:50:18.391299 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:50:18.392283 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281870be0>]}
17:50:18.392566 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.24s]
17:50:18.392853 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:50:18.394472 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:50:18.395347 [debug] [Thread-3  ]: finished collecting timing info
17:50:18.395509 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:50:18.395629 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:50:18.396436 [debug] [Thread-1  ]: finished collecting timing info
17:50:18.396558 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:50:18.396878 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62818a8af0>]}
17:50:18.397342 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6281870bb0>]}
17:50:18.398358 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.24s]
17:50:18.398619 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.24s]
17:50:18.399065 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:50:18.399333 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:50:18.399609 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:50:18.399774 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:50:18.400034 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:50:18.400136 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:50:18.400213 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:50:18.401656 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:50:18.401978 [debug] [Thread-7  ]: Began running node model.first_project.customers
17:50:18.402139 [info ] [Thread-7  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:50:18.402399 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
17:50:18.402488 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
17:50:18.402565 [debug] [Thread-7  ]: Compiling model.first_project.customers
17:50:18.404123 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
17:50:18.404392 [debug] [Thread-7  ]: finished collecting timing info
17:50:18.404540 [debug] [Thread-7  ]: Began executing node model.first_project.customers
17:50:18.407102 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
17:50:18.407389 [debug] [Thread-8  ]: Began running node model.first_project.customers2
17:50:18.407870 [info ] [Thread-8  ]: 6 of 6 START table model public.customers2 ..................................... [RUN]
17:50:18.408281 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:50:18.408661 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
17:50:18.415175 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
17:50:18.415420 [debug] [Thread-8  ]: Compiling model.first_project.customers2
17:50:18.417724 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
17:50:18.417918 [debug] [Thread-5  ]: finished collecting timing info
17:50:18.419782 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:50:18.419595 [debug] [Thread-8  ]: finished collecting timing info
17:50:18.425119 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
17:50:18.408857 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
17:50:18.428376 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:50:18.424786 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:50:18.429746 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:18.429889 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:50:18.429981 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:50:18.428177 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
17:50:18.433921 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:50:18.434636 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
17:50:18.439666 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:50:18.441906 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
17:50:18.442110 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:50:18.442221 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:50:18.444495 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
17:50:18.446778 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:50:18.446948 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:50:18.447499 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.448670 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:50:18.448819 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:50:18.448937 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:50:18.450556 [debug] [Thread-5  ]: SQL status: BEGIN in 0.02 seconds
17:50:18.450702 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:18.450804 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:50:18.452019 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:50:18.454062 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:18.454268 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:50:18.454897 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.456123 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:50:18.456287 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:18.456397 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:50:18.456649 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
17:50:18.457469 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:50:18.457096 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
17:50:18.457609 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:50:18.459414 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:50:18.459704 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:50:18.460109 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:18.461311 [debug] [Thread-7  ]: finished collecting timing info
17:50:18.461490 [debug] [Thread-7  ]: On model.first_project.customers: Close
17:50:18.461934 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6270783af0>]}
17:50:18.462307 [info ] [Thread-7  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.06s]
17:50:18.462678 [debug] [Thread-7  ]: Finished running node model.first_project.customers
17:50:18.466280 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.01 seconds
17:50:18.468410 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:50:18.468713 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:50:18.468941 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:50:18.470315 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:50:18.470459 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:50:18.470591 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.472470 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:50:18.472633 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:50:18.472785 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:50:18.473714 [debug] [Thread-5  ]: finished collecting timing info
17:50:18.473872 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:50:18.474361 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6283245970>]}
17:50:18.474818 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
17:50:18.475069 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:50:18.482579 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:50:18.486970 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:50:18.487543 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:50:18.487674 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:50:18.493031 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
17:50:18.494587 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:50:18.494736 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:50:18.502048 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.01 seconds
17:50:18.503184 [debug] [Thread-8  ]: finished collecting timing info
17:50:18.503378 [debug] [Thread-8  ]: On model.first_project.customers2: Close
17:50:18.503777 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c60a27c7-3fb8-4445-8ad6-0b44062e1bda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62707f2eb0>]}
17:50:18.504086 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.10s]
17:50:18.506222 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
17:50:18.507827 [debug] [MainThread]: Acquiring new postgres connection "master"
17:50:18.508141 [debug] [MainThread]: Using postgres connection "master"
17:50:18.508378 [debug] [MainThread]: On master: BEGIN
17:50:18.508577 [debug] [MainThread]: Opening a new connection, currently in state closed
17:50:18.514928 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:50:18.515189 [debug] [MainThread]: On master: COMMIT
17:50:18.515285 [debug] [MainThread]: Using postgres connection "master"
17:50:18.515367 [debug] [MainThread]: On master: COMMIT
17:50:18.515533 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:50:18.515657 [debug] [MainThread]: On master: Close
17:50:18.516021 [info ] [MainThread]: 
17:50:18.516302 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.67s.
17:50:18.516480 [debug] [MainThread]: Connection 'master' was properly closed.
17:50:18.516560 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:50:18.516629 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:50:18.516698 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:50:18.516763 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:50:18.516841 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:50:18.516934 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:50:18.522881 [info ] [MainThread]: 
17:50:18.523150 [info ] [MainThread]: [32mCompleted successfully[0m
17:50:18.523365 [info ] [MainThread]: 
17:50:18.524327 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:50:18.524643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62707be0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f628183c100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f62818494c0>]}


============================== 2022-06-04 17:52:48.693693 | aac39d8f-605d-4791-83e4-f3d7617d6e78 ==============================
17:52:48.693716 [info ] [MainThread]: Running with dbt=1.1.0
17:52:48.694239 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:52:48.694382 [debug] [MainThread]: Tracking: tracking
17:52:48.698083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed9a8070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed9a8040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed9a82b0>]}
17:52:48.724692 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:52:48.725225 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/stg_customers.sql
17:52:48.737037 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
17:52:48.756249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed424fa0>]}
17:52:48.762575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed896e80>]}
17:52:48.762929 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:52:48.763195 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed89ffd0>]}
17:52:48.764774 [info ] [MainThread]: 
17:52:48.765352 [debug] [MainThread]: Acquiring new postgres connection "master"
17:52:48.766396 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:52:48.775128 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:52:48.775600 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:52:48.776284 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:52:48.783518 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:52:48.785722 [debug] [ThreadPool]: On list_erp_oltp: Close
17:52:48.787959 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:52:48.795098 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:52:48.795308 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:52:48.795404 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:52:48.800077 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:52:48.800264 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:52:48.800359 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:52:48.803274 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:52:48.804470 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:52:48.804853 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:52:48.840195 [debug] [MainThread]: Using postgres connection "master"
17:52:48.840493 [debug] [MainThread]: On master: BEGIN
17:52:48.840602 [debug] [MainThread]: Opening a new connection, currently in state init
17:52:48.846099 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:52:48.846296 [debug] [MainThread]: Using postgres connection "master"
17:52:48.846384 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:52:48.858858 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:52:48.860440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed9a82b0>]}
17:52:48.860893 [debug] [MainThread]: On master: ROLLBACK
17:52:48.861561 [debug] [MainThread]: Using postgres connection "master"
17:52:48.861692 [debug] [MainThread]: On master: BEGIN
17:52:48.862000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:52:48.862132 [debug] [MainThread]: On master: COMMIT
17:52:48.862231 [debug] [MainThread]: Using postgres connection "master"
17:52:48.862323 [debug] [MainThread]: On master: COMMIT
17:52:48.862574 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:52:48.862694 [debug] [MainThread]: On master: Close
17:52:48.863063 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:52:48.863372 [info ] [MainThread]: 
17:52:48.867440 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:52:48.867741 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:52:48.868218 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:52:48.868369 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:52:48.868551 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:52:48.870636 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:52:48.870997 [debug] [Thread-1  ]: finished collecting timing info
17:52:48.871165 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:52:48.879522 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:52:48.879837 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:52:48.880392 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:52:48.891261 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:52:48.902170 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:52:48.907381 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:52:48.907149 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:52:48.907540 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:52:48.909624 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:52:48.907712 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:52:48.906480 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:52:48.909925 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:52:48.910139 [debug] [Thread-2  ]: finished collecting timing info
17:52:48.911391 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:52:48.911618 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:52:48.917154 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:52:48.917324 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:52:48.917480 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:52:48.917785 [debug] [Thread-3  ]: finished collecting timing info
17:52:48.917963 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:52:48.951436 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:52:48.951760 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
17:52:48.953937 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:52:48.954063 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:52:48.953632 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:52:48.954797 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:52:48.955401 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:52:48.955670 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:52:48.955806 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:52:48.961672 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:52:48.961371 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:52:48.955989 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:52:48.962343 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:52:48.962051 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:52:48.963491 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:48.966130 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:52:48.966295 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:52:48.966660 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:48.975520 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:52:48.975763 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:52:48.976060 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:52:48.976498 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:52:48.976649 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:52:48.976762 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:52:48.977078 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:52:48.977195 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:52:48.977275 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
17:52:48.978444 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:52:48.980396 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:52:48.980525 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:52:48.980662 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
17:52:48.982333 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:52:48.982453 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:52:48.982891 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:48.983069 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:48.984806 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:52:48.986465 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:52:48.986867 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:52:48.986729 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:52:48.986590 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:52:48.987269 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:48.987395 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:48.990993 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:52:48.993099 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:52:48.992938 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:52:48.994058 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:52:48.994228 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:52:48.991984 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:52:48.994409 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:52:48.994560 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:52:49.000120 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:52:49.001046 [debug] [Thread-1  ]: finished collecting timing info
17:52:49.001197 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:52:49.001552 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9efb85520>]}
17:52:49.001817 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
17:52:49.002211 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:52:49.002567 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:52:49.002747 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:52:49.003073 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:52:49.003174 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:52:49.003269 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:52:49.005080 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:52:49.005346 [debug] [Thread-5  ]: finished collecting timing info
17:52:49.005454 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:52:49.007091 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:52:49.007330 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:52:49.007425 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:52:49.007500 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:52:49.007960 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:52:49.008117 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:52:49.009156 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:52:49.010704 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:52:49.010852 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:52:49.011014 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:52:49.015074 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
17:52:49.015238 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:52:49.015328 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:52:49.016363 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:52:49.018438 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:52:49.018630 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:52:49.019020 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:52:49.020445 [debug] [Thread-3  ]: finished collecting timing info
17:52:49.020754 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:52:49.021343 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed3c3be0>]}
17:52:49.021735 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
17:52:49.022677 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:52:49.023259 [debug] [Thread-7  ]: Began running node model.first_project.customers
17:52:49.023584 [info ] [Thread-7  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:52:49.023774 [debug] [Thread-8  ]: Began running node model.first_project.customers2
17:52:49.024736 [info ] [Thread-8  ]: 6 of 6 START table model public.customers2 ..................................... [RUN]
17:52:49.024460 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
17:52:49.025355 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
17:52:49.025529 [debug] [Thread-7  ]: Compiling model.first_project.customers
17:52:49.023932 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:49.025189 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
17:52:49.031593 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
17:52:49.034119 [debug] [Thread-7  ]: finished collecting timing info
17:52:49.034282 [debug] [Thread-7  ]: Began executing node model.first_project.customers
17:52:49.033319 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
17:52:49.039027 [debug] [Thread-8  ]: Compiling model.first_project.customers2
17:52:49.031938 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
17:52:49.038762 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
17:52:49.033122 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:52:49.041122 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
17:52:49.042493 [debug] [Thread-2  ]: finished collecting timing info
17:52:49.043283 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:52:49.043711 [debug] [Thread-8  ]: finished collecting timing info
17:52:49.043875 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
17:52:49.043007 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:52:49.047340 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
17:52:49.047758 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ec2d4a60>]}
17:52:49.047930 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:52:49.048374 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
17:52:49.048795 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:52:49.049567 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
17:52:49.049419 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:52:49.049721 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:52:49.048976 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:52:49.050840 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
17:52:49.050977 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:52:49.054247 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:52:49.055647 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:52:49.055793 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:52:49.056155 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:52:49.057045 [debug] [Thread-5  ]: finished collecting timing info
17:52:49.057180 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:52:49.058144 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed44eb20>]}
17:52:49.058444 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.06s]
17:52:49.058741 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:52:49.064721 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
17:52:49.065139 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:52:49.065501 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:52:49.068062 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
17:52:49.070136 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:52:49.070348 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:52:49.070522 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
17:52:49.070643 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:52:49.070724 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:52:49.071062 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:49.072528 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:52:49.072769 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:52:49.072863 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
17:52:49.077600 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:52:49.079388 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:52:49.080103 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.01 seconds
17:52:49.081428 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:52:49.081530 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
17:52:49.082567 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:52:49.082688 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:52:49.082775 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:52:49.081640 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:52:49.082918 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:52:49.091406 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
17:52:49.093368 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:52:49.093594 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:52:49.094051 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
17:52:49.097461 [debug] [Thread-7  ]: finished collecting timing info
17:52:49.097853 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
17:52:49.098038 [debug] [Thread-7  ]: On model.first_project.customers: Close
17:52:49.099426 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:52:49.099661 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:52:49.102050 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ec360ca0>]}
17:52:49.102408 [info ] [Thread-7  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
17:52:49.102777 [debug] [Thread-7  ]: Finished running node model.first_project.customers
17:52:49.108370 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.01 seconds
17:52:49.109424 [debug] [Thread-8  ]: finished collecting timing info
17:52:49.109575 [debug] [Thread-8  ]: On model.first_project.customers2: Close
17:52:49.109939 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aac39d8f-605d-4791-83e4-f3d7617d6e78', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ec2e30d0>]}
17:52:49.110196 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
17:52:49.110605 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
17:52:49.116142 [debug] [MainThread]: Acquiring new postgres connection "master"
17:52:49.116359 [debug] [MainThread]: Using postgres connection "master"
17:52:49.116449 [debug] [MainThread]: On master: BEGIN
17:52:49.116523 [debug] [MainThread]: Opening a new connection, currently in state closed
17:52:49.122976 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:52:49.123239 [debug] [MainThread]: On master: COMMIT
17:52:49.123364 [debug] [MainThread]: Using postgres connection "master"
17:52:49.123452 [debug] [MainThread]: On master: COMMIT
17:52:49.123653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:52:49.123770 [debug] [MainThread]: On master: Close
17:52:49.124273 [info ] [MainThread]: 
17:52:49.124526 [info ] [MainThread]: Finished running 2 table models, 4 view models in 0.36s.
17:52:49.124706 [debug] [MainThread]: Connection 'master' was properly closed.
17:52:49.124790 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:52:49.124936 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:52:49.125016 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:52:49.125084 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:52:49.125151 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:52:49.125217 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:52:49.128595 [info ] [MainThread]: 
17:52:49.130132 [info ] [MainThread]: [32mCompleted successfully[0m
17:52:49.130404 [info ] [MainThread]: 
17:52:49.130643 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:52:49.130990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ed89fbe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9ef1c5130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe9efb96d90>]}


============================== 2022-06-04 17:55:23.074345 | f1bc374b-8aad-4495-906d-aeca07130cdc ==============================
17:55:23.074398 [info ] [MainThread]: Running with dbt=1.1.0
17:55:23.074927 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:55:23.075065 [debug] [MainThread]: Tracking: tracking
17:55:23.078672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90e3e070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90e3e040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90e3e2b0>]}
17:55:23.106278 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:55:23.106876 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
17:55:23.118184 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:55:23.161584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90d4c520>]}
17:55:23.194274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9301b310>]}
17:55:23.194596 [info ] [MainThread]: Found 6 models, 6 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:55:23.194815 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9301b340>]}
17:55:23.196030 [info ] [MainThread]: 
17:55:23.196419 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:23.197390 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:55:23.205908 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:55:23.206064 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:55:23.208381 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:55:23.214614 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:55:23.215673 [debug] [ThreadPool]: On list_erp_oltp: Close
17:55:23.216855 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:55:23.221064 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:23.221205 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:55:23.221291 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:55:23.226188 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
17:55:23.226400 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:55:23.226488 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:55:23.228418 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:55:23.229685 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:55:23.229956 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:55:23.233410 [debug] [MainThread]: Using postgres connection "master"
17:55:23.233571 [debug] [MainThread]: On master: BEGIN
17:55:23.233669 [debug] [MainThread]: Opening a new connection, currently in state init
17:55:23.245145 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:23.245394 [debug] [MainThread]: Using postgres connection "master"
17:55:23.245499 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:55:23.262351 [debug] [MainThread]: SQL status: SELECT 5 in 0.02 seconds
17:55:23.264027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9301b430>]}
17:55:23.264358 [debug] [MainThread]: On master: ROLLBACK
17:55:23.264678 [debug] [MainThread]: Using postgres connection "master"
17:55:23.264814 [debug] [MainThread]: On master: BEGIN
17:55:23.274928 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:55:23.275249 [debug] [MainThread]: On master: COMMIT
17:55:23.275366 [debug] [MainThread]: Using postgres connection "master"
17:55:23.275467 [debug] [MainThread]: On master: COMMIT
17:55:23.276030 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:23.276269 [debug] [MainThread]: On master: Close
17:55:23.277154 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:55:23.277861 [info ] [MainThread]: 
17:55:23.282652 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:55:23.282971 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:55:23.283363 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:55:23.283520 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:55:23.283648 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:55:23.285617 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:55:23.285956 [debug] [Thread-1  ]: finished collecting timing info
17:55:23.286120 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:55:23.294134 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:55:23.294504 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:55:23.295225 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:55:23.295530 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:55:23.309115 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:55:23.309660 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:55:23.317215 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:55:23.335949 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:55:23.339242 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:55:23.346751 [debug] [Thread-2  ]: finished collecting timing info
17:55:23.346250 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:55:23.346999 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:55:23.347200 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:55:23.345890 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:55:23.357911 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:55:23.358633 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:23.363228 [debug] [Thread-3  ]: finished collecting timing info
17:55:23.373161 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:55:23.373527 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:55:23.373796 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:55:23.408275 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:55:23.412951 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:23.413100 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:55:23.413207 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:55:23.412451 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:55:23.413853 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:23.413990 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:55:23.414088 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:55:23.414896 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
17:55:23.415039 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:23.415128 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:55:23.416343 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:55:23.422441 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:23.422655 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:55:23.423118 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.425103 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:23.425279 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:55:23.425690 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.450082 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:23.450321 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:23.450449 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:55:23.454854 [debug] [Thread-2  ]: SQL status: BEGIN in 0.04 seconds
17:55:23.455102 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:23.455221 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:55:23.458926 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
17:55:23.459176 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:23.459293 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
17:55:23.460794 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:55:23.461065 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:23.461862 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:55:23.470301 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:23.468347 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:23.470459 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:55:23.470621 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:55:23.471318 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.473175 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:23.473411 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:55:23.473792 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.475551 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:23.475692 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:55:23.476166 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.476353 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.477627 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:23.478727 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:55:23.478907 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:23.479082 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:23.479228 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:55:23.479378 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:55:23.485803 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:55:23.486083 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:55:23.489083 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:55:23.489235 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:55:23.487667 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:55:23.490728 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:55:23.466199 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:55:23.491024 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:55:23.496495 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:55:23.498119 [debug] [Thread-3  ]: finished collecting timing info
17:55:23.498520 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:55:23.499310 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a92fb0400>]}
17:55:23.499897 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.16s]
17:55:23.501472 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:55:23.502046 [debug] [Thread-5  ]: Began running node model.first_project.customers
17:55:23.502348 [info ] [Thread-5  ]: 4 of 6 START view model public.customers ....................................... [RUN]
17:55:23.502900 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
17:55:23.503063 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
17:55:23.503173 [debug] [Thread-5  ]: Compiling model.first_project.customers
17:55:23.505814 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
17:55:23.506017 [debug] [Thread-6  ]: Began running node model.first_project.customers2
17:55:23.506667 [info ] [Thread-6  ]: 5 of 6 START table model public.customers2 ..................................... [RUN]
17:55:23.507138 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
17:55:23.507260 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
17:55:23.507368 [debug] [Thread-6  ]: Compiling model.first_project.customers2
17:55:23.510509 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
17:55:23.511004 [debug] [Thread-6  ]: finished collecting timing info
17:55:23.511176 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
17:55:23.513426 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
17:55:23.513771 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:55:23.513919 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
17:55:23.514018 [debug] [Thread-6  ]: Opening a new connection, currently in state init
17:55:23.506164 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
17:55:23.515841 [debug] [Thread-2  ]: finished collecting timing info
17:55:23.516016 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:55:23.516459 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90e409a0>]}
17:55:23.516820 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.22s]
17:55:23.517186 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:55:23.506281 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
17:55:23.518332 [debug] [Thread-1  ]: finished collecting timing info
17:55:23.518539 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:55:23.519010 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90e34490>]}
17:55:23.519320 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.24s]
17:55:23.519672 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:55:23.521954 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
17:55:23.522260 [info ] [Thread-8  ]: 6 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:55:23.522732 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:55:23.522877 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
17:55:23.523050 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
17:55:23.525332 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:55:23.525723 [debug] [Thread-8  ]: finished collecting timing info
17:55:23.525887 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
17:55:23.532478 [debug] [Thread-5  ]: finished collecting timing info
17:55:23.532768 [debug] [Thread-5  ]: Began executing node model.first_project.customers
17:55:23.535141 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.customers"
17:55:23.535570 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:55:23.535717 [debug] [Thread-5  ]: On model.first_project.customers: BEGIN
17:55:23.535816 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:55:23.538294 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:55:23.538666 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:23.538869 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
17:55:23.538985 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:55:23.562290 [debug] [Thread-6  ]: SQL status: BEGIN in 0.05 seconds
17:55:23.570522 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:55:23.570765 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:55:23.573666 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
17:55:23.576558 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:55:23.576740 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:55:23.577175 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.579883 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:55:23.580044 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:55:23.580440 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.581768 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:55:23.581905 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:55:23.581998 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
17:55:23.590070 [debug] [Thread-5  ]: SQL status: BEGIN in 0.05 seconds
17:55:23.590362 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:55:23.590516 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:55:23.591806 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
17:55:23.593443 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
17:55:23.593681 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:55:23.594697 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:23.596920 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:55:23.597084 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:55:23.597288 [debug] [Thread-8  ]: SQL status: BEGIN in 0.06 seconds
17:55:23.597401 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:23.597497 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:55:23.597882 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.599077 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:55:23.599218 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:55:23.599311 [debug] [Thread-5  ]: On model.first_project.customers: COMMIT
17:55:23.599450 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
17:55:23.601385 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:23.601546 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:55:23.602078 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:55:23.603689 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:23.603839 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:23.603945 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
17:55:23.604085 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
17:55:23.605389 [debug] [Thread-6  ]: finished collecting timing info
17:55:23.605565 [debug] [Thread-6  ]: On model.first_project.customers2: Close
17:55:23.607674 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a807cf280>]}
17:55:23.608012 [info ] [Thread-6  ]: 5 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.10s]
17:55:23.608415 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
17:55:23.610970 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:55:23.612645 [debug] [Thread-5  ]: Using postgres connection "model.first_project.customers"
17:55:23.612858 [debug] [Thread-5  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:55:23.613282 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:23.614298 [debug] [Thread-5  ]: finished collecting timing info
17:55:23.614455 [debug] [Thread-5  ]: On model.first_project.customers: Close
17:55:23.614856 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90e42c70>]}
17:55:23.615159 [info ] [Thread-5  ]: 4 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
17:55:23.615504 [debug] [Thread-5  ]: Finished running node model.first_project.customers
17:55:23.616410 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
17:55:23.617936 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:55:23.618072 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:55:23.618396 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
17:55:23.619345 [debug] [Thread-8  ]: finished collecting timing info
17:55:23.619506 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
17:55:23.619987 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f1bc374b-8aad-4495-906d-aeca07130cdc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a908fca60>]}
17:55:23.620311 [info ] [Thread-8  ]: 6 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.10s]
17:55:23.620639 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
17:55:23.625999 [debug] [MainThread]: Acquiring new postgres connection "master"
17:55:23.626282 [debug] [MainThread]: Using postgres connection "master"
17:55:23.626397 [debug] [MainThread]: On master: BEGIN
17:55:23.626489 [debug] [MainThread]: Opening a new connection, currently in state closed
17:55:23.677536 [debug] [MainThread]: SQL status: BEGIN in 0.05 seconds
17:55:23.677875 [debug] [MainThread]: On master: COMMIT
17:55:23.677988 [debug] [MainThread]: Using postgres connection "master"
17:55:23.678085 [debug] [MainThread]: On master: COMMIT
17:55:23.678329 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:55:23.678491 [debug] [MainThread]: On master: Close
17:55:23.678944 [info ] [MainThread]: 
17:55:23.679176 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.48s.
17:55:23.679357 [debug] [MainThread]: Connection 'master' was properly closed.
17:55:23.679445 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:55:23.679528 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:55:23.679621 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:55:23.679702 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:55:23.679781 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:55:23.679858 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:55:23.684079 [info ] [MainThread]: 
17:55:23.684341 [info ] [MainThread]: [32mCompleted successfully[0m
17:55:23.684559 [info ] [MainThread]: 
17:55:23.684719 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:55:23.684962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a9302c0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a90d36fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8a926d2340>]}


============================== 2022-06-04 17:59:34.300119 | fb2a6fbd-d382-4e87-b164-525ac5fdd0c8 ==============================
17:59:34.300136 [info ] [MainThread]: Running with dbt=1.1.0
17:59:34.300685 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
17:59:34.300824 [debug] [MainThread]: Tracking: tracking
17:59:34.304025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d6a7eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d6a7f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d6a7e80>]}
17:59:34.341808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
17:59:34.342363 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
17:59:34.353157 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
17:59:34.439808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61eec5f40>]}
17:59:34.444712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d5a2f40>]}
17:59:34.445009 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
17:59:34.445277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d5a28b0>]}
17:59:34.446593 [info ] [MainThread]: 
17:59:34.447029 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:34.447884 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
17:59:34.457454 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
17:59:34.457723 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
17:59:34.457843 [debug] [ThreadPool]: Opening a new connection, currently in state init
17:59:34.470808 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
17:59:34.472481 [debug] [ThreadPool]: On list_erp_oltp: Close
17:59:34.474641 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
17:59:34.480096 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:34.480343 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
17:59:34.480449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
17:59:34.488231 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
17:59:34.488481 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
17:59:34.488586 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
17:59:34.490716 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
17:59:34.491951 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
17:59:34.492303 [debug] [ThreadPool]: On list_erp_oltp_public: Close
17:59:34.496071 [debug] [MainThread]: Using postgres connection "master"
17:59:34.496247 [debug] [MainThread]: On master: BEGIN
17:59:34.496356 [debug] [MainThread]: Opening a new connection, currently in state init
17:59:34.501511 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:59:34.501699 [debug] [MainThread]: Using postgres connection "master"
17:59:34.501809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
17:59:34.514415 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
17:59:34.515706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d5a2b80>]}
17:59:34.516012 [debug] [MainThread]: On master: ROLLBACK
17:59:34.516325 [debug] [MainThread]: Using postgres connection "master"
17:59:34.516477 [debug] [MainThread]: On master: BEGIN
17:59:34.516771 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
17:59:34.516943 [debug] [MainThread]: On master: COMMIT
17:59:34.517044 [debug] [MainThread]: Using postgres connection "master"
17:59:34.517132 [debug] [MainThread]: On master: COMMIT
17:59:34.517352 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:34.517473 [debug] [MainThread]: On master: Close
17:59:34.517889 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
17:59:34.518112 [info ] [MainThread]: 
17:59:34.522100 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
17:59:34.522388 [info ] [Thread-1  ]: 1 of 6 START table model public.my_first_dbt_model ............................. [RUN]
17:59:34.522787 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
17:59:34.522921 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
17:59:34.523067 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
17:59:34.525743 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
17:59:34.526092 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
17:59:34.526364 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
17:59:34.526756 [info ] [Thread-2  ]: 2 of 6 START view model public.postgres_sample_source_customers ................ [RUN]
17:59:34.527068 [info ] [Thread-3  ]: 3 of 6 START view model public.stg_customers ................................... [RUN]
17:59:34.527748 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
17:59:34.528626 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
17:59:34.528758 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
17:59:34.528457 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
17:59:34.530992 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
17:59:34.530609 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
17:59:34.531127 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
17:59:34.532302 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
17:59:34.527968 [debug] [Thread-1  ]: finished collecting timing info
17:59:34.532632 [debug] [Thread-2  ]: finished collecting timing info
17:59:34.532777 [debug] [Thread-3  ]: finished collecting timing info
17:59:34.533378 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
17:59:34.533205 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
17:59:34.533039 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
17:59:34.560277 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
17:59:34.562570 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
17:59:34.578481 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
17:59:34.579893 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:34.580222 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:34.580393 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
17:59:34.580631 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:34.581054 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
17:59:34.580913 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
17:59:34.580785 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
17:59:34.581437 [debug] [Thread-2  ]: Opening a new connection, currently in state init
17:59:34.581179 [debug] [Thread-3  ]: Opening a new connection, currently in state init
17:59:34.586911 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
17:59:34.587102 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:34.587222 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
17:59:34.588138 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
17:59:34.588304 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:34.588403 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
17:59:34.588563 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
17:59:34.594056 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:34.594411 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
17:59:34.594720 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
17:59:34.596822 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:34.597414 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
17:59:34.597567 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.599266 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:34.599435 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.599870 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
17:59:34.601678 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:34.602051 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
17:59:34.602195 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.602364 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
17:59:34.611265 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:34.611396 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
17:59:34.610950 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:34.611796 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:34.611950 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
17:59:34.611598 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
17:59:34.613965 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:34.614164 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:34.614309 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
17:59:34.614482 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:34.616681 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:34.616893 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
17:59:34.617416 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.619063 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:34.619263 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
17:59:34.619730 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.621508 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:34.621733 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:34.621893 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
17:59:34.622046 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
17:59:34.627983 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
17:59:34.629894 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
17:59:34.630052 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
17:59:34.628387 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
17:59:34.631005 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
17:59:34.636628 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
17:59:34.637874 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
17:59:34.641375 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
17:59:34.642301 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
17:59:34.643557 [debug] [Thread-1  ]: finished collecting timing info
17:59:34.643749 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
17:59:34.643979 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
17:59:34.644891 [debug] [Thread-2  ]: finished collecting timing info
17:59:34.645165 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
17:59:34.645559 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61f80a910>]}
17:59:34.645887 [info ] [Thread-2  ]: 2 of 6 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.12s]
17:59:34.646261 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
17:59:34.648767 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61c05a3a0>]}
17:59:34.649349 [info ] [Thread-1  ]: 1 of 6 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.13s]
17:59:34.650159 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
17:59:34.650697 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
17:59:34.650891 [info ] [Thread-5  ]: 4 of 6 START view model public.my_second_dbt_model ............................. [RUN]
17:59:34.651251 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
17:59:34.651376 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
17:59:34.651468 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
17:59:34.653118 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
17:59:34.653442 [debug] [Thread-5  ]: finished collecting timing info
17:59:34.653607 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
17:59:34.656278 [debug] [Thread-5  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
17:59:34.656450 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
17:59:34.657406 [debug] [Thread-3  ]: finished collecting timing info
17:59:34.657614 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
17:59:34.658038 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61f80afa0>]}
17:59:34.658320 [info ] [Thread-3  ]: 3 of 6 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.13s]
17:59:34.658640 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
17:59:34.659117 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:34.659276 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: BEGIN
17:59:34.663853 [debug] [Thread-7  ]: Began running node model.first_project.customers
17:59:34.664022 [debug] [Thread-8  ]: Began running node model.first_project.customers2
17:59:34.664906 [info ] [Thread-8  ]: 6 of 6 START table model public.customers2 ..................................... [RUN]
17:59:34.664168 [debug] [Thread-5  ]: Opening a new connection, currently in state init
17:59:34.664526 [info ] [Thread-7  ]: 5 of 6 START view model public.customers ....................................... [RUN]
17:59:34.665339 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
17:59:34.666330 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
17:59:34.666577 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
17:59:34.667129 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
17:59:34.667302 [debug] [Thread-8  ]: Compiling model.first_project.customers2
17:59:34.667446 [debug] [Thread-7  ]: Compiling model.first_project.customers
17:59:34.669711 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
17:59:34.671650 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
17:59:34.672118 [debug] [Thread-8  ]: finished collecting timing info
17:59:34.672327 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
17:59:34.672515 [debug] [Thread-7  ]: finished collecting timing info
17:59:34.674695 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
17:59:34.674927 [debug] [Thread-7  ]: Began executing node model.first_project.customers
17:59:34.677125 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
17:59:34.677806 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:34.683014 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
17:59:34.684518 [debug] [Thread-8  ]: Opening a new connection, currently in state init
17:59:34.682804 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:59:34.687070 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
17:59:34.687235 [debug] [Thread-7  ]: Opening a new connection, currently in state init
17:59:34.693373 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
17:59:34.693717 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:34.693877 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
17:59:34.695595 [debug] [Thread-5  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:34.697949 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:34.698224 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
17:59:34.698754 [debug] [Thread-5  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.698921 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
17:59:34.700249 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:59:34.700365 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:59:34.700580 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
17:59:34.700707 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:34.700801 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
17:59:34.700041 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:34.701007 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:34.701110 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: COMMIT
17:59:34.702757 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
17:59:34.704681 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:59:34.705030 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
17:59:34.704869 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
17:59:34.707035 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:34.707488 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
17:59:34.707402 [debug] [Thread-5  ]: SQL status: COMMIT in 0.01 seconds
17:59:34.708755 [debug] [Thread-5  ]: Using postgres connection "model.first_project.my_second_dbt_model"
17:59:34.707297 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.708936 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.710254 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:59:34.713778 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:59:34.713928 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
17:59:34.709132 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
17:59:34.714387 [debug] [Thread-5  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:34.713487 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:34.715429 [debug] [Thread-5  ]: finished collecting timing info
17:59:34.715656 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
17:59:34.715889 [debug] [Thread-5  ]: On model.first_project.my_second_dbt_model: Close
17:59:34.716353 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
17:59:34.717607 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:59:34.717999 [debug] [Thread-5  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61c0ba430>]}
17:59:34.718182 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:34.718534 [info ] [Thread-5  ]: 4 of 6 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
17:59:34.718720 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
17:59:34.719259 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
17:59:34.722460 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
17:59:34.724288 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
17:59:34.724482 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
17:59:34.724887 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
17:59:34.725841 [debug] [Thread-7  ]: finished collecting timing info
17:59:34.726045 [debug] [Thread-7  ]: On model.first_project.customers: Close
17:59:34.726714 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61c04c220>]}
17:59:34.727212 [info ] [Thread-7  ]: 5 of 6 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.06s]
17:59:34.727772 [debug] [Thread-7  ]: Finished running node model.first_project.customers
17:59:34.728673 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
17:59:34.730073 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
17:59:34.730215 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
17:59:34.740042 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.01 seconds
17:59:34.745892 [debug] [Thread-8  ]: finished collecting timing info
17:59:34.747456 [debug] [Thread-8  ]: On model.first_project.customers2: Close
17:59:34.748253 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb2a6fbd-d382-4e87-b164-525ac5fdd0c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d110460>]}
17:59:34.748748 [info ] [Thread-8  ]: 6 of 6 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
17:59:34.749331 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
17:59:34.750850 [debug] [MainThread]: Acquiring new postgres connection "master"
17:59:34.751040 [debug] [MainThread]: Using postgres connection "master"
17:59:34.751200 [debug] [MainThread]: On master: BEGIN
17:59:34.751344 [debug] [MainThread]: Opening a new connection, currently in state closed
17:59:34.759260 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
17:59:34.759598 [debug] [MainThread]: On master: COMMIT
17:59:34.759736 [debug] [MainThread]: Using postgres connection "master"
17:59:34.759875 [debug] [MainThread]: On master: COMMIT
17:59:34.760169 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
17:59:34.760351 [debug] [MainThread]: On master: Close
17:59:34.761022 [info ] [MainThread]: 
17:59:34.761665 [info ] [MainThread]: Finished running 4 view models, 2 table models in 0.31s.
17:59:34.762049 [debug] [MainThread]: Connection 'master' was properly closed.
17:59:34.762199 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
17:59:34.762332 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
17:59:34.762455 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
17:59:34.762581 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
17:59:34.762704 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
17:59:34.762822 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
17:59:34.768191 [info ] [MainThread]: 
17:59:34.768538 [info ] [MainThread]: [32mCompleted successfully[0m
17:59:34.768837 [info ] [MainThread]: 
17:59:34.769112 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
17:59:34.769434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61f4a8610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61f4a88e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd61d5a2a30>]}


============================== 2022-06-04 18:00:01.165885 | 7e339bc3-50de-45e2-94d6-5a4baa649796 ==============================
18:00:01.165905 [info ] [MainThread]: Running with dbt=1.1.0
18:00:01.166474 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:00:01.166620 [debug] [MainThread]: Tracking: tracking
18:00:01.169947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c2106fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c2106fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c2106d60>]}
18:00:01.201726 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:00:01.201948 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:00:01.207586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e339bc3-50de-45e2-94d6-5a4baa649796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c1fa60d0>]}
18:00:01.212731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e339bc3-50de-45e2-94d6-5a4baa649796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c1ff5760>]}
18:00:01.213115 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:00:01.213435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e339bc3-50de-45e2-94d6-5a4baa649796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c1ff56a0>]}
18:00:01.214993 [info ] [MainThread]: 
18:00:01.215532 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:01.216692 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:00:01.225109 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:01.225596 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:00:01.225822 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:00:01.234734 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:00:01.235410 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:00:01.235772 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:00:01.238171 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:00:01.239887 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:00:01.240283 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:00:01.243672 [debug] [MainThread]: Using postgres connection "master"
18:00:01.243913 [debug] [MainThread]: On master: BEGIN
18:00:01.243998 [debug] [MainThread]: Opening a new connection, currently in state init
18:00:01.253786 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:01.254004 [debug] [MainThread]: Using postgres connection "master"
18:00:01.254098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:00:01.266579 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:00:01.268016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e339bc3-50de-45e2-94d6-5a4baa649796', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c1ff1fd0>]}
18:00:01.268326 [debug] [MainThread]: On master: ROLLBACK
18:00:01.268672 [debug] [MainThread]: Using postgres connection "master"
18:00:01.268827 [debug] [MainThread]: On master: BEGIN
18:00:01.269169 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:00:01.269301 [debug] [MainThread]: On master: COMMIT
18:00:01.269392 [debug] [MainThread]: Using postgres connection "master"
18:00:01.269477 [debug] [MainThread]: On master: COMMIT
18:00:01.269653 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:01.269775 [debug] [MainThread]: On master: Close
18:00:01.270187 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:00:01.270504 [info ] [MainThread]: 
18:00:01.275561 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:01.275827 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:00:01.276219 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:01.276353 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:01.276466 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:01.290038 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:01.290470 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:01.290635 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:00:01.291010 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:01.291157 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:01.291262 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:01.297547 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:01.304479 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:00:01.304765 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:01.305939 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:00:01.306313 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:01.306440 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:01.306556 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:01.305654 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:01.345188 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:00:01.345657 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:01.345778 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:01.345872 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:01.304210 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:01.351477 [debug] [Thread-2  ]: finished collecting timing info
18:00:01.305761 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:01.305529 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:01.305313 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:01.350980 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:01.304890 [debug] [Thread-1  ]: finished collecting timing info
18:00:01.351643 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:01.353474 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:01.353664 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:00:01.353865 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:00:01.366339 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:01.366466 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:01.366565 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:01.354015 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:01.370185 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:01.373096 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:01.365812 [debug] [Thread-6  ]: finished collecting timing info
18:00:01.354258 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:01.369968 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:01.365452 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:01.373614 [debug] [Thread-4  ]: finished collecting timing info
18:00:01.379497 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:01.377967 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:01.378150 [debug] [Thread-3  ]: finished collecting timing info
18:00:01.378519 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:01.382682 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:01.385788 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:01.381079 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:01.382238 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:01.382528 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:01.392953 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: BEGIN
18:00:01.393086 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:00:01.389024 [debug] [Thread-5  ]: finished collecting timing info
18:00:01.393799 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:01.389911 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:01.395358 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:00:01.395163 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:01.390187 [debug] [Thread-7  ]: finished collecting timing info
18:00:01.395765 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:01.374405 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:01.395478 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:00:01.400689 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:01.379334 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:01.401248 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:01.401402 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:00:01.400912 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:00:01.401655 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:00:01.397178 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:01.392564 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:01.400001 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:01.402085 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:01.408224 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:00:01.402789 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:01.401497 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:00:01.408434 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:00:01.408648 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:00:01.410794 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:00:01.411173 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:01.411630 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:00:01.411792 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:00:01.416622 [debug] [Thread-5  ]: SQL status: BEGIN in 0.01 seconds
18:00:01.416938 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:00:01.417054 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:00:01.418924 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:01.421510 [debug] [Thread-5  ]: finished collecting timing info
18:00:01.421741 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:00:01.422401 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:00:01.422574 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:00:01.422681 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:01.423558 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:01.424854 [debug] [Thread-4  ]: finished collecting timing info
18:00:01.425111 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:00:01.428497 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:00:01.429031 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.06s]
18:00:01.429565 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:00:01.430856 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:00:01.431326 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.13s]
18:00:01.432189 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:00:01.432593 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
18:00:01.432767 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:00:01.432880 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:00:01.435660 [debug] [Thread-7  ]: SQL status: BEGIN in 0.03 seconds
18:00:01.435910 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:00:01.436024 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:01.437479 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:01.439039 [debug] [Thread-7  ]: finished collecting timing info
18:00:01.439364 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:00:01.445124 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:00:01.445973 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.08s]
18:00:01.446653 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:00:01.447229 [debug] [Thread-2  ]: SQL status: BEGIN in 0.05 seconds
18:00:01.447425 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:00:01.447531 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:00:01.448803 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.02 seconds
18:00:01.450175 [debug] [Thread-1  ]: finished collecting timing info
18:00:01.450363 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
18:00:01.450536 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:01.453761 [debug] [Thread-2  ]: finished collecting timing info
18:00:01.450867 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:00:01.454097 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:00:01.450706 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: ROLLBACK
18:00:01.454336 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:00:01.455576 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:01.457267 [debug] [Thread-3  ]: finished collecting timing info
18:00:01.457818 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: Close
18:00:01.458329 [debug] [Thread-6  ]: SQL status: BEGIN in 0.05 seconds
18:00:01.462753 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:00:01.462450 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.19s]
18:00:01.462910 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:00:01.463235 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:00:01.464462 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.17s]
18:00:01.463787 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:00:01.465007 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:00:01.461774 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:00:01.465571 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:00:01.466724 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:00:01.467987 [debug] [Thread-6  ]: finished collecting timing info
18:00:01.468160 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:00:01.468992 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:00:01.469495 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.12s]
18:00:01.470909 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.17s]
18:00:01.474449 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:00:01.471481 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:00:01.486212 [debug] [MainThread]: Acquiring new postgres connection "master"
18:00:01.486470 [debug] [MainThread]: Using postgres connection "master"
18:00:01.486626 [debug] [MainThread]: On master: BEGIN
18:00:01.486735 [debug] [MainThread]: Opening a new connection, currently in state closed
18:00:01.496901 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:00:01.497171 [debug] [MainThread]: On master: COMMIT
18:00:01.497284 [debug] [MainThread]: Using postgres connection "master"
18:00:01.497382 [debug] [MainThread]: On master: COMMIT
18:00:01.497578 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:00:01.497722 [debug] [MainThread]: On master: Close
18:00:01.498118 [info ] [MainThread]: 
18:00:01.498350 [info ] [MainThread]: Finished running 7 tests in 0.28s.
18:00:01.498518 [debug] [MainThread]: Connection 'master' was properly closed.
18:00:01.498612 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09' was properly closed.
18:00:01.498694 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:00:01.498775 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:00:01.498855 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:00:01.498935 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:00:01.499014 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:00:01.499092 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:00:01.504550 [info ] [MainThread]: 
18:00:01.504813 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:00:01.505006 [info ] [MainThread]: 
18:00:01.505159 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:00:01.505322 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:00:01.505467 [info ] [MainThread]: 
18:00:01.505613 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:00:01.505805 [info ] [MainThread]: 
18:00:01.505986 [error] [MainThread]: [31mFailure in test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:00:01.506173 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:00:01.506321 [info ] [MainThread]: 
18:00:01.508465 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_customers_78814b7ce7fca4528a65518db3449206.sql
18:00:01.508637 [info ] [MainThread]: 
18:00:01.508797 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:00:01.508974 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:00:01.509149 [info ] [MainThread]: 
18:00:01.509303 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:00:01.509499 [info ] [MainThread]: 
18:00:01.509661 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:00:01.510025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c1f6bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c1f7f700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f73c1f736a0>]}


============================== 2022-06-04 18:03:44.490069 | a75a5847-ec7d-4b27-81fb-90d87e731418 ==============================
18:03:44.490089 [info ] [MainThread]: Running with dbt=1.1.0
18:03:44.490708 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:03:44.490884 [debug] [MainThread]: Tracking: tracking
18:03:44.494363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5beb400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5beb5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5beb2e0>]}
18:03:44.523832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:03:44.524093 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:03:44.531677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a75a5847-ec7d-4b27-81fb-90d87e731418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5a9c0d0>]}
18:03:44.537084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a75a5847-ec7d-4b27-81fb-90d87e731418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5b66700>]}
18:03:44.537398 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:03:44.537754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a75a5847-ec7d-4b27-81fb-90d87e731418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5b66640>]}
18:03:44.539291 [info ] [MainThread]: 
18:03:44.539729 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:44.541147 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:03:44.553400 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:03:44.554179 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:03:44.554315 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:03:44.563662 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:03:44.563901 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:03:44.564001 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:03:44.566100 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:03:44.567464 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:03:44.567708 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:03:44.572044 [debug] [MainThread]: Using postgres connection "master"
18:03:44.572247 [debug] [MainThread]: On master: BEGIN
18:03:44.572345 [debug] [MainThread]: Opening a new connection, currently in state init
18:03:44.577901 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:03:44.578101 [debug] [MainThread]: Using postgres connection "master"
18:03:44.578194 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:03:44.590664 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:03:44.592323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a75a5847-ec7d-4b27-81fb-90d87e731418', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5ae8eb0>]}
18:03:44.592772 [debug] [MainThread]: On master: ROLLBACK
18:03:44.593272 [debug] [MainThread]: Using postgres connection "master"
18:03:44.593448 [debug] [MainThread]: On master: BEGIN
18:03:44.594738 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:03:44.594919 [debug] [MainThread]: On master: COMMIT
18:03:44.595027 [debug] [MainThread]: Using postgres connection "master"
18:03:44.595120 [debug] [MainThread]: On master: COMMIT
18:03:44.595319 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:44.595447 [debug] [MainThread]: On master: Close
18:03:44.595899 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:03:44.596203 [info ] [MainThread]: 
18:03:44.600312 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:03:44.600513 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:03:44.600859 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:03:44.601034 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:03:44.601148 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:03:44.612633 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:03:44.612904 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:03:44.613236 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:03:44.613347 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:03:44.613492 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:44.617089 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:03:44.617457 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:44.617582 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:44.617670 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:44.615370 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:03:44.616749 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:03:44.669053 [debug] [Thread-1  ]: finished collecting timing info
18:03:44.669302 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:03:44.613634 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:44.613807 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:44.625503 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:44.668638 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:03:44.613718 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:03:44.614003 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:44.681852 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:03:44.682202 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:44.680789 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:03:44.680411 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:03:44.681399 [debug] [Thread-3  ]: finished collecting timing info
18:03:44.681675 [debug] [Thread-2  ]: finished collecting timing info
18:03:44.682313 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:44.683279 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:44.682672 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:44.688517 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:44.682929 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:44.683130 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:03:44.678865 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:03:44.688257 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:44.681200 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:03:44.693346 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:03:44.693494 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:03:44.693588 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:03:44.692480 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:44.692943 [debug] [Thread-7  ]: finished collecting timing info
18:03:44.690465 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:44.696356 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:03:44.688689 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:44.699819 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:44.696634 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:44.696827 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:03:44.700918 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: BEGIN
18:03:44.692006 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:03:44.700113 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:44.700337 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:44.700603 [debug] [Thread-6  ]: finished collecting timing info
18:03:44.700781 [debug] [Thread-5  ]: finished collecting timing info
18:03:44.701022 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:03:44.697020 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:44.703815 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:44.707307 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:03:44.713248 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:03:44.707606 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:44.707807 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:03:44.712757 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:44.716486 [debug] [Thread-4  ]: finished collecting timing info
18:03:44.714808 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:44.716156 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:03:44.716638 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:44.718507 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:44.716847 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:44.719218 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:03:44.719311 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:03:44.718881 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:03:44.719686 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:03:44.722673 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:03:44.719056 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:03:44.723856 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:03:44.723300 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:44.724124 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:03:44.724245 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:03:44.708318 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:03:44.724649 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:03:44.724752 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:03:44.717271 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:44.725447 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:03:44.725565 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:03:44.723984 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:03:44.729074 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:44.730841 [debug] [Thread-1  ]: finished collecting timing info
18:03:44.731067 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: ROLLBACK
18:03:44.731362 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: Close
18:03:44.731732 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.13s]
18:03:44.732132 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:03:44.741850 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:03:44.742124 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:03:44.742242 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:03:44.743234 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:03:44.743473 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:03:44.743580 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:03:44.744274 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:44.744460 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:44.747936 [debug] [Thread-7  ]: finished collecting timing info
18:03:44.748180 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:03:44.748994 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:03:44.746343 [debug] [Thread-3  ]: finished collecting timing info
18:03:44.749680 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.07s]
18:03:44.749940 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:03:44.750450 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:03:44.751582 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:03:44.751992 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.13s]
18:03:44.754972 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:03:44.758486 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:03:44.758702 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:03:44.758817 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:03:44.759028 [debug] [Thread-5  ]: SQL status: BEGIN in 0.04 seconds
18:03:44.759139 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:03:44.759224 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:03:44.760167 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:44.761452 [debug] [Thread-2  ]: finished collecting timing info
18:03:44.761580 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:44.762854 [debug] [Thread-5  ]: finished collecting timing info
18:03:44.762998 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:03:44.761729 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:03:44.763256 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:03:44.763635 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.07s]
18:03:44.763984 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:03:44.764230 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:03:44.764668 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.15s]
18:03:44.765176 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:03:44.767207 [debug] [Thread-4  ]: SQL status: BEGIN in 0.04 seconds
18:03:44.767384 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:03:44.767485 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:03:44.768816 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:44.770061 [debug] [Thread-4  ]: finished collecting timing info
18:03:44.770228 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:03:44.771621 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:03:44.772033 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.08s]
18:03:44.772406 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:03:44.777936 [debug] [Thread-6  ]: SQL status: BEGIN in 0.05 seconds
18:03:44.778238 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:03:44.778379 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:03:44.779578 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:03:44.780991 [debug] [Thread-6  ]: finished collecting timing info
18:03:44.781224 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:03:44.785433 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:03:44.785952 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
18:03:44.786319 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:03:44.788221 [debug] [MainThread]: Acquiring new postgres connection "master"
18:03:44.788440 [debug] [MainThread]: Using postgres connection "master"
18:03:44.788550 [debug] [MainThread]: On master: BEGIN
18:03:44.788638 [debug] [MainThread]: Opening a new connection, currently in state closed
18:03:44.796186 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:03:44.796453 [debug] [MainThread]: On master: COMMIT
18:03:44.796568 [debug] [MainThread]: Using postgres connection "master"
18:03:44.796665 [debug] [MainThread]: On master: COMMIT
18:03:44.796983 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:03:44.797161 [debug] [MainThread]: On master: Close
18:03:44.797588 [info ] [MainThread]: 
18:03:44.797860 [info ] [MainThread]: Finished running 7 tests in 0.26s.
18:03:44.798048 [debug] [MainThread]: Connection 'master' was properly closed.
18:03:44.798135 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09' was properly closed.
18:03:44.798218 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:03:44.798309 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:03:44.798388 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:03:44.798464 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:03:44.798542 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:03:44.798619 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:03:44.804814 [info ] [MainThread]: 
18:03:44.805153 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:03:44.805377 [info ] [MainThread]: 
18:03:44.805628 [error] [MainThread]: [31mFailure in test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:03:44.806098 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:03:44.806324 [info ] [MainThread]: 
18:03:44.806510 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_customers_78814b7ce7fca4528a65518db3449206.sql
18:03:44.806688 [info ] [MainThread]: 
18:03:44.806856 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:03:44.807050 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:03:44.807229 [info ] [MainThread]: 
18:03:44.807405 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:03:44.807568 [info ] [MainThread]: 
18:03:44.810132 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:03:44.810592 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:03:44.810816 [info ] [MainThread]: 
18:03:44.810989 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:03:44.811178 [info ] [MainThread]: 
18:03:44.811342 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:03:44.811610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5b660d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5a76c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f0fb5a76940>]}


============================== 2022-06-04 18:07:59.874754 | a1f3ec56-47ea-473c-b0d7-630e7302e687 ==============================
18:07:59.874824 [info ] [MainThread]: Running with dbt=1.1.0
18:07:59.875438 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:07:59.875648 [debug] [MainThread]: Tracking: tracking
18:07:59.887705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b164100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b164c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b164e20>]}
18:07:59.920119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:07:59.920446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:07:59.927371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a1f3ec56-47ea-473c-b0d7-630e7302e687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b0180d0>]}
18:07:59.932504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a1f3ec56-47ea-473c-b0d7-630e7302e687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b0fe760>]}
18:07:59.932892 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:07:59.933144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f3ec56-47ea-473c-b0d7-630e7302e687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b0fe6a0>]}
18:07:59.938018 [info ] [MainThread]: 
18:07:59.938622 [debug] [MainThread]: Acquiring new postgres connection "master"
18:07:59.940052 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:07:59.952967 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:07:59.953232 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:07:59.953395 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:07:59.960397 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:07:59.960611 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:07:59.960704 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:07:59.962551 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:07:59.965088 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:07:59.965437 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:07:59.977644 [debug] [MainThread]: Using postgres connection "master"
18:07:59.977905 [debug] [MainThread]: On master: BEGIN
18:07:59.978028 [debug] [MainThread]: Opening a new connection, currently in state init
18:07:59.982831 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:07:59.983002 [debug] [MainThread]: Using postgres connection "master"
18:07:59.983083 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:07:59.995769 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:07:59.997442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a1f3ec56-47ea-473c-b0d7-630e7302e687', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b062f70>]}
18:07:59.997761 [debug] [MainThread]: On master: ROLLBACK
18:07:59.998036 [debug] [MainThread]: Using postgres connection "master"
18:07:59.998175 [debug] [MainThread]: On master: BEGIN
18:07:59.998435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:07:59.998573 [debug] [MainThread]: On master: COMMIT
18:07:59.998667 [debug] [MainThread]: Using postgres connection "master"
18:07:59.998754 [debug] [MainThread]: On master: COMMIT
18:07:59.998936 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:07:59.999060 [debug] [MainThread]: On master: Close
18:07:59.999420 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:07:59.999668 [info ] [MainThread]: 
18:08:00.004664 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:08:00.004958 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [RUN]
18:08:00.005370 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:08:00.005509 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:08:00.005629 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:08:00.014842 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:00.015101 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:08:00.015505 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:00.015636 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:00.015733 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:00.029092 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:00.029331 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:08:00.029697 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:00.029819 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:00.029923 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:00.060727 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:00.061088 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:00.076191 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:08:00.061318 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:08:00.077330 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:00.077508 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:00.077663 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:00.075883 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:00.081455 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:08:00.076634 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:00.075718 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:00.082282 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:08:00.082639 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:00.082759 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:00.082875 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:00.081886 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:00.082019 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:00.090417 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:00.068174 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:08:00.099037 [debug] [Thread-1  ]: finished collecting timing info
18:08:00.099248 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:08:00.090159 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:00.114517 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:00.123931 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:00.098525 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:00.081245 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:00.073191 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:00.075447 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:00.127639 [debug] [Thread-2  ]: finished collecting timing info
18:08:00.126982 [debug] [Thread-5  ]: finished collecting timing info
18:08:00.130425 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:00.127329 [debug] [Thread-3  ]: finished collecting timing info
18:08:00.135207 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:00.136779 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:00.137219 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:00.126381 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:08:00.130641 [debug] [Thread-7  ]: finished collecting timing info
18:08:00.133270 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:00.089811 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:00.137392 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:08:00.127820 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:00.139657 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:00.130121 [debug] [Thread-4  ]: finished collecting timing info
18:08:00.140417 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:00.140623 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:00.140275 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:00.142943 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:08:00.143126 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:00.143694 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:08:00.142471 [debug] [Thread-6  ]: finished collecting timing info
18:08:00.144043 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:00.137741 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:00.147634 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:00.148071 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:00.145705 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:00.148668 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:00.148813 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:08:00.148231 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:08:00.149184 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:08:00.142202 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:00.148997 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:00.150519 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:00.142679 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:08:00.150837 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:00.143879 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: BEGIN
18:08:00.151335 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:00.138192 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:00.150677 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:08:00.152349 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:08:00.156602 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:08:00.156837 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:00.156943 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:08:00.160061 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:00.162607 [debug] [Thread-2  ]: finished collecting timing info
18:08:00.163039 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:08:00.164143 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:08:00.164604 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.15s]
18:08:00.164970 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:00.169009 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:08:00.169199 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:00.169299 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:00.170194 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:08:00.170376 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:00.170473 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:00.170634 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:00.171902 [debug] [Thread-7  ]: finished collecting timing info
18:08:00.172115 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:08:00.172286 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:00.173399 [debug] [Thread-3  ]: finished collecting timing info
18:08:00.173632 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:08:00.173779 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:08:00.174256 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.09s]
18:08:00.174823 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:00.175211 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:08:00.175605 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.15s]
18:08:00.175994 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:00.178196 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
18:08:00.178356 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:00.178462 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:00.179477 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:00.180705 [debug] [Thread-4  ]: finished collecting timing info
18:08:00.180929 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:08:00.181111 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:08:00.181255 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:08:00.181862 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:00.181974 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:08:00.181676 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:08:00.182282 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"
18:08:00.182075 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:08:00.182390 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT'
)



      
    ) dbt_internal_test
18:08:00.181466 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:00.182823 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.11s]
18:08:00.183041 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:00.183459 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:00.192651 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:00.193930 [debug] [Thread-6  ]: finished collecting timing info
18:08:00.194147 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:08:00.194330 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:00.195290 [debug] [Thread-5  ]: finished collecting timing info
18:08:00.195426 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:08:00.195574 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:00.196466 [debug] [Thread-1  ]: finished collecting timing info
18:08:00.196603 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: ROLLBACK
18:08:00.197227 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:08:00.197711 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.12s]
18:08:00.198022 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:00.198322 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09: Close
18:08:00.198662 [error] [Thread-1  ]: 1 of 7 FAIL 3 accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT  [[31mFAIL 3[0m in 0.19s]
18:08:00.198938 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09
18:08:00.199254 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:08:00.199546 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.12s]
18:08:00.199928 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:00.201546 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:00.201722 [debug] [MainThread]: Using postgres connection "master"
18:08:00.201835 [debug] [MainThread]: On master: BEGIN
18:08:00.201920 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:00.217923 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:08:00.218271 [debug] [MainThread]: On master: COMMIT
18:08:00.218405 [debug] [MainThread]: Using postgres connection "master"
18:08:00.218508 [debug] [MainThread]: On master: COMMIT
18:08:00.218716 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:00.218911 [debug] [MainThread]: On master: Close
18:08:00.219387 [info ] [MainThread]: 
18:08:00.219651 [info ] [MainThread]: Finished running 7 tests in 0.28s.
18:08:00.219902 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:00.220021 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT.a41c33ab09' was properly closed.
18:08:00.220159 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:08:00.220282 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:08:00.220367 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:08:00.220449 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:08:00.220531 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:08:00.220622 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:08:00.227558 [info ] [MainThread]: 
18:08:00.227858 [info ] [MainThread]: [31mCompleted with 3 errors and 0 warnings:[0m
18:08:00.228054 [info ] [MainThread]: 
18:08:00.228228 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:08:00.228393 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:08:00.228533 [info ] [MainThread]: 
18:08:00.228676 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:08:00.228820 [info ] [MainThread]: 
18:08:00.229007 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:08:00.229160 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:08:00.229299 [info ] [MainThread]: 
18:08:00.229440 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:08:00.229598 [info ] [MainThread]: 
18:08:00.229739 [error] [MainThread]: [31mFailure in test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT (models/erp/schema.yml)[0m
18:08:00.229889 [error] [MainThread]:   Got 3 results, configured to fail if != 0
18:08:00.230025 [info ] [MainThread]: 
18:08:00.230250 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/accepted_values_customers_78814b7ce7fca4528a65518db3449206.sql
18:08:00.230418 [info ] [MainThread]: 
18:08:00.230560 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=3 SKIP=0 TOTAL=7
18:08:00.230840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71b0fe190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71aff2f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe71aff2b50>]}


============================== 2022-06-04 18:08:15.572046 | e5fcc80c-98f1-4b83-93a4-2370bd5cf670 ==============================
18:08:15.572065 [info ] [MainThread]: Running with dbt=1.1.0
18:08:15.572566 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:08:15.572738 [debug] [MainThread]: Tracking: tracking
18:08:15.576092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e887fe100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e887fec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e887fee20>]}
18:08:15.607690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:08:15.608485 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:08:15.619329 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:08:15.709969 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5fcc80c-98f1-4b83-93a4-2370bd5cf670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a01a850>]}
18:08:15.714348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5fcc80c-98f1-4b83-93a4-2370bd5cf670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e886f8fd0>]}
18:08:15.714603 [info ] [MainThread]: Found 6 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:08:15.714830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fcc80c-98f1-4b83-93a4-2370bd5cf670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e886f8880>]}
18:08:15.716209 [info ] [MainThread]: 
18:08:15.716664 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:15.717930 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:08:15.727098 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:15.728438 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:08:15.728937 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:08:15.736086 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:08:15.736316 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:08:15.736411 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:08:15.738165 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:08:15.739580 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:08:15.739908 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:08:15.744505 [debug] [MainThread]: Using postgres connection "master"
18:08:15.744682 [debug] [MainThread]: On master: BEGIN
18:08:15.744773 [debug] [MainThread]: Opening a new connection, currently in state init
18:08:15.751356 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:15.751581 [debug] [MainThread]: Using postgres connection "master"
18:08:15.751676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:08:15.765043 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:08:15.766278 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5fcc80c-98f1-4b83-93a4-2370bd5cf670', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e886f8c10>]}
18:08:15.766565 [debug] [MainThread]: On master: ROLLBACK
18:08:15.766873 [debug] [MainThread]: Using postgres connection "master"
18:08:15.767063 [debug] [MainThread]: On master: BEGIN
18:08:15.767359 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:08:15.767473 [debug] [MainThread]: On master: COMMIT
18:08:15.767563 [debug] [MainThread]: Using postgres connection "master"
18:08:15.767643 [debug] [MainThread]: On master: COMMIT
18:08:15.767822 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:15.767930 [debug] [MainThread]: On master: Close
18:08:15.768264 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:08:15.768519 [info ] [MainThread]: 
18:08:15.773391 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:15.773593 [info ] [Thread-1  ]: 1 of 7 START test accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [RUN]
18:08:15.774005 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:15.774145 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:15.774247 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:15.780582 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:15.780880 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:15.781031 [info ] [Thread-2  ]: 2 of 7 START test not_null_customers_customer_id ............................... [RUN]
18:08:15.781276 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:15.781434 [info ] [Thread-3  ]: 3 of 7 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:08:15.781612 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:15.781701 [info ] [Thread-4  ]: 4 of 7 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:08:15.781853 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:15.781936 [info ] [Thread-5  ]: 5 of 7 START test unique_customers_customer_id ................................. [RUN]
18:08:15.782085 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:15.782296 [info ] [Thread-6  ]: 6 of 7 START test unique_my_first_dbt_model_id ................................. [RUN]
18:08:15.782455 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:15.782534 [info ] [Thread-7  ]: 7 of 7 START test unique_my_second_dbt_model_id ................................ [RUN]
18:08:15.783658 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:15.784118 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:15.784680 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:15.785113 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:15.786420 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:15.786539 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:15.785788 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:15.785975 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:15.792046 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:15.786286 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:15.800785 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:15.785579 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:15.813990 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:15.791888 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:15.819374 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:15.800100 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:15.785360 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:15.819893 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:15.820101 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:15.814218 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:15.786166 [debug] [Thread-1  ]: finished collecting timing info
18:08:15.791631 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:15.828233 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:15.841926 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:15.811899 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:15.842575 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:15.843261 [debug] [Thread-5  ]: finished collecting timing info
18:08:15.850779 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:15.862559 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:15.845151 [debug] [Thread-6  ]: finished collecting timing info
18:08:15.843467 [debug] [Thread-3  ]: finished collecting timing info
18:08:15.863524 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:15.851305 [debug] [Thread-4  ]: finished collecting timing info
18:08:15.844798 [debug] [Thread-7  ]: finished collecting timing info
18:08:15.865245 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:15.862962 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:15.864865 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:15.868049 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:15.868177 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:08:15.865081 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:15.866349 [debug] [Thread-7  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:15.869846 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:15.867637 [debug] [Thread-6  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:15.868276 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:08:15.851036 [debug] [Thread-2  ]: finished collecting timing info
18:08:15.870352 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:15.869474 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:15.869956 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:08:15.872288 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:08:15.871554 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:15.873295 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:15.873522 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: BEGIN
18:08:15.872153 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:15.873881 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:08:15.874183 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:08:15.871760 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:15.875232 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:08:15.875335 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:08:15.863353 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:15.881482 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: BEGIN
18:08:15.882251 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:08:15.873627 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:08:15.860784 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:15.885769 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:15.885991 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: BEGIN
18:08:15.886120 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:08:15.891359 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:08:15.891610 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:08:15.891770 [debug] [Thread-7  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:08:15.892210 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:15.892058 [debug] [Thread-4  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:08:15.891893 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:08:15.892534 [debug] [Thread-3  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:08:15.892638 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:15.892389 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:08:15.896124 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:15.898003 [debug] [Thread-4  ]: finished collecting timing info
18:08:15.898233 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:08:15.898608 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:15.899892 [debug] [Thread-3  ]: finished collecting timing info
18:08:15.900051 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:08:15.900186 [debug] [Thread-4  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:08:15.900625 [info ] [Thread-4  ]: 4 of 7 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.12s]
18:08:15.900791 [debug] [Thread-7  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:15.903976 [debug] [Thread-7  ]: finished collecting timing info
18:08:15.904140 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:08:15.901380 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:08:15.902673 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:08:15.904323 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
18:08:15.904930 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_customers_customer_id.5c9bf9911d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from "erp_oltp"."public"."customers"
where customer_id is null



      
    ) dbt_internal_test
18:08:15.901168 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:08:15.905119 [debug] [Thread-6  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:08:15.905214 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:08:15.901030 [debug] [Thread-3  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:08:15.905646 [error] [Thread-3  ]: 3 of 7 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
18:08:15.906219 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:08:15.904499 [debug] [Thread-7  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:08:15.907106 [info ] [Thread-7  ]: 7 of 7 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.12s]
18:08:15.907525 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:08:15.908642 [debug] [Thread-6  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:15.910052 [debug] [Thread-6  ]: finished collecting timing info
18:08:15.910675 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:08:15.912127 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:15.913324 [debug] [Thread-2  ]: finished collecting timing info
18:08:15.913510 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: ROLLBACK
18:08:15.913930 [debug] [Thread-2  ]: On test.first_project.not_null_customers_customer_id.5c9bf9911d: Close
18:08:15.914557 [info ] [Thread-2  ]: 2 of 7 PASS not_null_customers_customer_id ..................................... [[32mPASS[0m in 0.13s]
18:08:15.914954 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
18:08:15.916220 [debug] [Thread-6  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:08:15.916654 [info ] [Thread-6  ]: 6 of 7 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.13s]
18:08:15.917150 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:08:15.925434 [debug] [Thread-1  ]: SQL status: BEGIN in 0.04 seconds
18:08:15.925681 [debug] [Thread-1  ]: Using postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
18:08:15.925818 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        state as value_field,
        count(*) as n_records

    from "erp_oltp"."public"."customers"
    group by state

)

select *
from all_values
where value_field not in (
    'PR','SC','RS','RJ','AL','BA','SP','RO','MT','GO','DF','PA'
)



      
    ) dbt_internal_test
18:08:15.926062 [debug] [Thread-5  ]: SQL status: BEGIN in 0.04 seconds
18:08:15.926201 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
18:08:15.926295 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_customers_customer_id.c5af1ff4b1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    customer_id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."customers"
where customer_id is not null
group by customer_id
having count(*) > 1



      
    ) dbt_internal_test
18:08:15.930301 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:08:15.932000 [debug] [Thread-5  ]: finished collecting timing info
18:08:15.932214 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: ROLLBACK
18:08:15.934316 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.01 seconds
18:08:15.936175 [debug] [Thread-1  ]: finished collecting timing info
18:08:15.936404 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: ROLLBACK
18:08:15.936714 [debug] [Thread-5  ]: On test.first_project.unique_customers_customer_id.c5af1ff4b1: Close
18:08:15.937401 [error] [Thread-5  ]: 5 of 7 FAIL 50 unique_customers_customer_id .................................... [[31mFAIL 50[0m in 0.15s]
18:08:15.938137 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
18:08:15.937648 [debug] [Thread-1  ]: On test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a: Close
18:08:15.939039 [info ] [Thread-1  ]: 1 of 7 PASS accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA  [[32mPASS[0m in 0.17s]
18:08:15.939431 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
18:08:15.945398 [debug] [MainThread]: Acquiring new postgres connection "master"
18:08:15.945691 [debug] [MainThread]: Using postgres connection "master"
18:08:15.945822 [debug] [MainThread]: On master: BEGIN
18:08:15.945927 [debug] [MainThread]: Opening a new connection, currently in state closed
18:08:15.960121 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:08:15.960413 [debug] [MainThread]: On master: COMMIT
18:08:15.960530 [debug] [MainThread]: Using postgres connection "master"
18:08:15.960636 [debug] [MainThread]: On master: COMMIT
18:08:15.960992 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:08:15.961179 [debug] [MainThread]: On master: Close
18:08:15.961597 [info ] [MainThread]: 
18:08:15.961855 [info ] [MainThread]: Finished running 7 tests in 0.25s.
18:08:15.962057 [debug] [MainThread]: Connection 'master' was properly closed.
18:08:15.962154 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
18:08:15.962239 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
18:08:15.962323 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:08:15.962406 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:08:15.962488 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
18:08:15.962568 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:08:15.962662 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:08:15.969484 [info ] [MainThread]: 
18:08:15.969897 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:08:15.970219 [info ] [MainThread]: 
18:08:15.970434 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:08:15.970936 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:08:15.971438 [info ] [MainThread]: 
18:08:15.971698 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:08:15.971938 [info ] [MainThread]: 
18:08:15.972156 [error] [MainThread]: [31mFailure in test unique_customers_customer_id (models/erp/schema.yml)[0m
18:08:15.972380 [error] [MainThread]:   Got 50 results, configured to fail if != 0
18:08:15.972590 [info ] [MainThread]: 
18:08:15.972828 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/unique_customers_customer_id.sql
18:08:15.973147 [info ] [MainThread]: 
18:08:15.973364 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
18:08:15.973695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a07ffa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e8a0956a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6e881dffa0>]}


============================== 2022-06-04 18:14:25.535500 | ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5 ==============================
18:14:25.535518 [info ] [MainThread]: Running with dbt=1.1.0
18:14:25.536039 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:14:25.536179 [debug] [MainThread]: Tracking: tracking
18:14:25.539533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61487a100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61487ac10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61487ae20>]}
18:14:25.564978 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
18:14:25.565391 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/stg_orders.sql
18:14:25.565726 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:14:25.578482 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
18:14:25.591935 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:14:25.667006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6160fb730>]}
18:14:25.671368 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc614775fa0>]}
18:14:25.671630 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:14:25.671825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc614775eb0>]}
18:14:25.673127 [info ] [MainThread]: 
18:14:25.673566 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:25.674735 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:14:25.682195 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:14:25.682365 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:14:25.682491 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:14:25.692006 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:14:25.693363 [debug] [ThreadPool]: On list_erp_oltp: Close
18:14:25.694907 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:14:25.699756 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:25.699942 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:14:25.700152 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:14:25.708523 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:14:25.708834 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:14:25.708992 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:14:25.711109 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:14:25.712473 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:14:25.712973 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:14:25.716740 [debug] [MainThread]: Using postgres connection "master"
18:14:25.716994 [debug] [MainThread]: On master: BEGIN
18:14:25.717117 [debug] [MainThread]: Opening a new connection, currently in state init
18:14:25.722326 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:14:25.722551 [debug] [MainThread]: Using postgres connection "master"
18:14:25.722675 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:14:25.736514 [debug] [MainThread]: SQL status: SELECT 5 in 0.01 seconds
18:14:25.737976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc614775c10>]}
18:14:25.738340 [debug] [MainThread]: On master: ROLLBACK
18:14:25.738667 [debug] [MainThread]: Using postgres connection "master"
18:14:25.738805 [debug] [MainThread]: On master: BEGIN
18:14:25.739135 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:14:25.739272 [debug] [MainThread]: On master: COMMIT
18:14:25.739378 [debug] [MainThread]: Using postgres connection "master"
18:14:25.739476 [debug] [MainThread]: On master: COMMIT
18:14:25.739761 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:25.740004 [debug] [MainThread]: On master: Close
18:14:25.740459 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:14:25.740739 [info ] [MainThread]: 
18:14:25.745085 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:14:25.745404 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:14:25.745999 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:14:25.746164 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:14:25.746292 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:14:25.748375 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:14:25.748740 [debug] [Thread-1  ]: finished collecting timing info
18:14:25.748961 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:14:25.749291 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:14:25.749639 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:14:25.749758 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:14:25.749858 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:14:25.752176 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:14:25.750007 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:14:25.752345 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:14:25.752925 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:14:25.752662 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:14:25.753773 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:14:25.753885 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:14:25.753973 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:14:25.753304 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:14:25.755010 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:14:25.754818 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:14:25.755122 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:14:25.756292 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:14:25.749111 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:14:25.756598 [debug] [Thread-3  ]: finished collecting timing info
18:14:25.756723 [debug] [Thread-4  ]: finished collecting timing info
18:14:25.756830 [debug] [Thread-2  ]: finished collecting timing info
18:14:25.774950 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:14:25.769481 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:14:25.769244 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:14:25.790875 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:14:25.793259 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:14:25.806554 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:25.806680 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:14:25.806783 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:14:25.806113 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:25.807130 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:14:25.807276 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:14:25.805481 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:14:25.795230 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:14:25.808484 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:25.808611 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:14:25.808691 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:14:25.813976 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:14:25.814177 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:25.814276 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:14:25.815483 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:14:25.807959 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:25.821132 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:25.821465 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:14:25.821735 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:14:25.821858 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:14:25.822171 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:25.822366 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:14:25.822014 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:14:25.823793 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.830542 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:25.830379 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:14:25.834370 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:25.834869 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:14:25.835446 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:14:25.836360 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:25.836460 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:14:25.836215 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:25.836626 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:14:25.837707 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:14:25.836076 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:14:25.840422 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.839626 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:25.839861 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:14:25.844332 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:25.835949 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:25.850761 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:14:25.849088 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:14:25.842435 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:14:25.842226 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:25.858245 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:14:25.858492 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.858708 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.862846 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:25.861118 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:25.862990 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:14:25.858821 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.863139 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:14:25.864539 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:14:25.864931 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:25.865042 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:14:25.864663 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.865165 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.866144 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:14:25.870737 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:25.870898 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:14:25.870462 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:14:25.871105 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
18:14:25.871369 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:25.876040 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:14:25.876452 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:14:25.876638 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:14:25.877181 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:25.878439 [debug] [Thread-4  ]: finished collecting timing info
18:14:25.878548 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:14:25.879837 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:14:25.878694 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:14:25.879952 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:14:25.882062 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61424e1c0>]}
18:14:25.882370 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.13s]
18:14:25.882789 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:14:25.883267 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:14:25.883441 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:14:25.885116 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:14:25.886287 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:14:25.886444 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:14:25.886586 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:14:25.891138 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:14:25.892438 [debug] [Thread-2  ]: finished collecting timing info
18:14:25.892603 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:14:25.894775 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6142236a0>]}
18:14:25.895101 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
18:14:25.895435 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:14:25.897189 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:14:25.898786 [debug] [Thread-3  ]: finished collecting timing info
18:14:25.902272 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:14:25.902512 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
18:14:25.904055 [debug] [Thread-1  ]: finished collecting timing info
18:14:25.904460 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc614284460>]}
18:14:25.904680 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:14:25.905035 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.15s]
18:14:25.905445 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:14:25.905863 [debug] [Thread-6  ]: Began running node model.first_project.customers
18:14:25.906058 [info ] [Thread-6  ]: 5 of 7 START view model public.customers ....................................... [RUN]
18:14:25.906375 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
18:14:25.906479 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
18:14:25.906571 [debug] [Thread-6  ]: Compiling model.first_project.customers
18:14:25.908739 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
18:14:25.909008 [debug] [Thread-7  ]: Began running node model.first_project.customers2
18:14:25.909594 [info ] [Thread-7  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
18:14:25.909998 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6142df520>]}
18:14:25.910446 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
18:14:25.911152 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.16s]
18:14:25.911320 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
18:14:25.912189 [debug] [Thread-7  ]: Compiling model.first_project.customers2
18:14:25.911432 [debug] [Thread-6  ]: finished collecting timing info
18:14:25.917922 [debug] [Thread-6  ]: Began executing node model.first_project.customers
18:14:25.917525 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:14:25.917066 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
18:14:25.920867 [debug] [Thread-7  ]: finished collecting timing info
18:14:25.921104 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
18:14:25.920492 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
18:14:25.920020 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
18:14:25.928068 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:14:25.928216 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
18:14:25.927541 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:14:25.928308 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:14:25.927158 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers2"
18:14:25.929666 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:14:25.928904 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:14:25.929945 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
18:14:25.930075 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
18:14:25.929789 [debug] [Thread-7  ]: On model.first_project.customers2: BEGIN
18:14:25.931973 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:14:25.932160 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:14:25.932624 [debug] [Thread-9  ]: finished collecting timing info
18:14:25.933278 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
18:14:25.935183 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:14:25.935657 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
18:14:25.935819 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:14:25.935932 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
order as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:14:25.936251 [debug] [Thread-6  ]: Postgres adapter: Postgres error: syntax error at or near "order"
LINE 7: order as (
        ^

18:14:25.936389 [debug] [Thread-6  ]: On model.first_project.customers: ROLLBACK
18:14:25.936704 [debug] [Thread-6  ]: finished collecting timing info
18:14:25.937046 [debug] [Thread-6  ]: On model.first_project.customers: Close
18:14:25.936879 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:25.937231 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
18:14:25.937500 [debug] [Thread-6  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "order"
  LINE 7: order as (
          ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:14:25.937658 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:14:25.937896 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6141e0670>]}
18:14:25.938359 [error] [Thread-6  ]: 5 of 7 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.03s]
18:14:25.939137 [debug] [Thread-6  ]: Finished running node model.first_project.customers
18:14:25.948232 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
18:14:25.948481 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:25.948629 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:14:25.953806 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.01 seconds
18:14:25.956017 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:25.956194 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:14:25.956750 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.957934 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:14:25.958121 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:25.958232 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:14:25.958862 [debug] [Thread-7  ]: SQL status: BEGIN in 0.03 seconds
18:14:25.959040 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:14:25.959154 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:14:25.970952 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
18:14:25.972668 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:14:25.972952 [debug] [Thread-7  ]: SQL status: SELECT 100 in 0.01 seconds
18:14:25.974029 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:14:25.976852 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:14:25.977190 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:14:25.977433 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:14:25.977598 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.978559 [debug] [Thread-9  ]: finished collecting timing info
18:14:25.980431 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:14:25.980808 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
18:14:25.981010 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:14:25.981769 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:14:25.983223 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
18:14:25.983842 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:14:25.984033 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
18:14:25.983668 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61428fee0>]}
18:14:25.984663 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
18:14:25.985170 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
18:14:25.992323 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
18:14:25.994973 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:14:25.995153 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:14:26.001743 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.01 seconds
18:14:26.002794 [debug] [Thread-7  ]: finished collecting timing info
18:14:26.002961 [debug] [Thread-7  ]: On model.first_project.customers2: Close
18:14:26.004705 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae0b1e71-6597-41d9-b0bf-0a09ef7dd1d5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6160f8370>]}
18:14:26.006700 [info ] [Thread-7  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.09s]
18:14:26.007099 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
18:14:26.008490 [debug] [MainThread]: Acquiring new postgres connection "master"
18:14:26.008708 [debug] [MainThread]: Using postgres connection "master"
18:14:26.008811 [debug] [MainThread]: On master: BEGIN
18:14:26.008912 [debug] [MainThread]: Opening a new connection, currently in state closed
18:14:26.013858 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:14:26.014086 [debug] [MainThread]: On master: COMMIT
18:14:26.014179 [debug] [MainThread]: Using postgres connection "master"
18:14:26.014263 [debug] [MainThread]: On master: COMMIT
18:14:26.014434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:14:26.014557 [debug] [MainThread]: On master: Close
18:14:26.014910 [info ] [MainThread]: 
18:14:26.015109 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.34s.
18:14:26.015251 [debug] [MainThread]: Connection 'master' was properly closed.
18:14:26.015323 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:14:26.015393 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:14:26.015461 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:14:26.015529 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:14:26.015620 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:14:26.015694 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:14:26.015775 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:14:26.019345 [info ] [MainThread]: 
18:14:26.019578 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:14:26.019762 [info ] [MainThread]: 
18:14:26.019937 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:14:26.020078 [error] [MainThread]:   syntax error at or near "order"
18:14:26.020207 [error] [MainThread]:   LINE 7: order as (
18:14:26.020332 [error] [MainThread]:           ^
18:14:26.020456 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:14:26.020598 [info ] [MainThread]: 
18:14:26.020750 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:14:26.021051 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6169ef070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc6169ef670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc61428fee0>]}


============================== 2022-06-04 18:15:27.013179 | b863718c-fd52-44fa-a87c-0a49b3aba76c ==============================
18:15:27.013208 [info ] [MainThread]: Running with dbt=1.1.0
18:15:27.013745 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:15:27.013878 [debug] [MainThread]: Tracking: tracking
18:15:27.032396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ed3f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ed3fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ed3fe20>]}
18:15:27.060679 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:15:27.061345 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:15:27.072821 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:15:27.174509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ed47490>]}
18:15:27.179201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ec3afd0>]}
18:15:27.179511 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:15:27.179732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ec3aee0>]}
18:15:27.181161 [info ] [MainThread]: 
18:15:27.181549 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:27.182468 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:15:27.191089 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:15:27.191328 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:15:27.191495 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:15:27.207754 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
18:15:27.209123 [debug] [ThreadPool]: On list_erp_oltp: Close
18:15:27.218626 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:15:27.224984 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:15:27.225186 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:15:27.225281 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:15:27.230594 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:15:27.230834 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:15:27.230933 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:15:27.232915 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:15:27.234176 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:15:27.234423 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:15:27.239395 [debug] [MainThread]: Using postgres connection "master"
18:15:27.239561 [debug] [MainThread]: On master: BEGIN
18:15:27.239650 [debug] [MainThread]: Opening a new connection, currently in state init
18:15:27.245724 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:15:27.245945 [debug] [MainThread]: Using postgres connection "master"
18:15:27.246058 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:15:27.259443 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:15:27.260811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ec3a760>]}
18:15:27.261194 [debug] [MainThread]: On master: ROLLBACK
18:15:27.261561 [debug] [MainThread]: Using postgres connection "master"
18:15:27.261696 [debug] [MainThread]: On master: BEGIN
18:15:27.262008 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:15:27.262140 [debug] [MainThread]: On master: COMMIT
18:15:27.262240 [debug] [MainThread]: Using postgres connection "master"
18:15:27.262335 [debug] [MainThread]: On master: COMMIT
18:15:27.262519 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:27.262643 [debug] [MainThread]: On master: Close
18:15:27.263034 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:15:27.263478 [info ] [MainThread]: 
18:15:27.268220 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:15:27.268592 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:15:27.269070 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:15:27.269218 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:15:27.269334 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:15:27.271364 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:15:27.271940 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:15:27.272415 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:15:27.272058 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:15:27.273253 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:15:27.272806 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:15:27.274368 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:15:27.274510 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:15:27.272160 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:15:27.281191 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:15:27.281819 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:15:27.282021 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:15:27.282142 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:15:27.283374 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:15:27.283806 [debug] [Thread-4  ]: finished collecting timing info
18:15:27.284084 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:15:27.276522 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:15:27.276767 [debug] [Thread-1  ]: finished collecting timing info
18:15:27.273705 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:15:27.301108 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:15:27.302086 [debug] [Thread-2  ]: finished collecting timing info
18:15:27.305098 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:15:27.346271 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:15:27.334320 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:15:27.350119 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:15:27.347691 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:15:27.323617 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:15:27.345988 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:15:27.350799 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:27.350960 [debug] [Thread-3  ]: finished collecting timing info
18:15:27.351407 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:15:27.351598 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:15:27.352262 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:15:27.352049 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:15:27.352385 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:15:27.353215 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:27.353375 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:15:27.353493 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:15:27.351781 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:15:27.356686 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:15:27.357396 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:27.357558 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:15:27.357660 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:15:27.363765 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:15:27.364015 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:27.364131 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:15:27.365559 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:15:27.365758 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:15:27.365872 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:15:27.368013 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:27.373991 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:15:27.374363 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:15:27.374541 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:15:27.376965 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:27.377300 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:15:27.377515 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:15:27.378032 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:27.377874 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:27.378150 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:15:27.377719 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:15:27.378279 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:15:27.381570 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.381856 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:27.386196 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:27.384159 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:27.382033 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.386378 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:15:27.386538 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:15:27.386713 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:15:27.388475 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:15:27.390638 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:27.391336 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:15:27.391488 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.391645 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.402440 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:27.402601 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:15:27.403064 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
18:15:27.391797 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:15:27.414849 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:15:27.417819 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:15:27.417977 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:27.418269 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:15:27.416657 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:15:27.418140 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.418638 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:15:27.420519 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:15:27.420353 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:27.414652 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:15:27.420755 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:15:27.420940 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:27.421123 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:15:27.421349 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.425904 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:15:27.426069 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:27.426170 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:15:27.428216 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:15:27.432589 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:15:27.432763 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:15:27.436204 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
18:15:27.437581 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:15:27.437724 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:15:27.438485 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
18:15:27.440798 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:15:27.441358 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:15:27.441691 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:15:27.443072 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:15:27.443256 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:15:27.444668 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:15:27.445706 [debug] [Thread-3  ]: finished collecting timing info
18:15:27.445873 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:15:27.448179 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f13505bdf40>]}
18:15:27.448748 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.17s]
18:15:27.449265 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:15:27.449660 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:15:27.449854 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:15:27.450184 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:15:27.450289 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:15:27.450382 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:15:27.453105 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:15:27.453270 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
18:15:27.453438 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:15:27.454420 [debug] [Thread-4  ]: finished collecting timing info
18:15:27.455315 [debug] [Thread-2  ]: finished collecting timing info
18:15:27.455544 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:15:27.455763 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:15:27.456195 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134e792f10>]}
18:15:27.456458 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.17s]
18:15:27.456869 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:15:27.458995 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134e7a1850>]}
18:15:27.459205 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
18:15:27.468382 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:15:27.469136 [debug] [Thread-1  ]: finished collecting timing info
18:15:27.469577 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:15:27.470790 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:15:27.470932 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:15:27.470331 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:15:27.469768 [debug] [Thread-6  ]: finished collecting timing info
18:15:27.471037 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:15:27.473778 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:15:27.474196 [debug] [Thread-8  ]: finished collecting timing info
18:15:27.474758 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:15:27.471229 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:15:27.479259 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:15:27.470028 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.19s]
18:15:27.483001 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:15:27.474602 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134e7e3d60>]}
18:15:27.484170 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.21s]
18:15:27.483333 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:15:27.482004 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:15:27.485216 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:15:27.484703 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:15:27.485366 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:15:27.485724 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:15:27.485525 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:15:27.484527 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:15:27.487094 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
18:15:27.487459 [info ] [Thread-10 ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:15:27.488055 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:15:27.488243 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
18:15:27.488411 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
18:15:27.490847 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:15:27.491221 [debug] [Thread-10 ]: finished collecting timing info
18:15:27.491414 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
18:15:27.493868 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:15:27.503339 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:27.503642 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:15:27.504875 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: BEGIN
18:15:27.505159 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:15:27.505343 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:15:27.505520 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:15:27.507980 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:15:27.510164 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:15:27.510343 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:15:27.510911 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.515609 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:15:27.516085 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
18:15:27.516910 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:15:27.517092 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:27.517793 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.517965 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:15:27.519906 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:15:27.520850 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:15:27.521029 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:15:27.521566 [debug] [Thread-8  ]: SQL status: BEGIN in 0.04 seconds
18:15:27.521739 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:15:27.521857 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:15:27.522141 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
18:15:27.524266 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:27.524430 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:15:27.529479 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:15:27.531132 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:15:27.534200 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:15:27.534574 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
18:15:27.537809 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:15:27.538014 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:15:27.538498 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.01 seconds
18:15:27.539758 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:15:27.539950 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:27.540068 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: COMMIT
18:15:27.540230 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:15:27.541440 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:15:27.541634 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
18:15:27.541820 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:15:27.542889 [debug] [Thread-6  ]: finished collecting timing info
18:15:27.543091 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:15:27.543298 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:15:27.545592 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ed47940>]}
18:15:27.545957 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.10s]
18:15:27.546433 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:15:27.549648 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
18:15:27.551303 [debug] [Thread-10 ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:15:27.551469 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:15:27.551816 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
18:15:27.552759 [debug] [Thread-10 ]: finished collecting timing info
18:15:27.552953 [debug] [Thread-10 ]: On model.first_project.my_second_dbt_model: Close
18:15:27.554370 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ed372b0>]}
18:15:27.554792 [info ] [Thread-10 ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:15:27.555192 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
18:15:27.555333 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:15:27.556696 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:15:27.556831 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:15:27.558882 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:15:27.560041 [debug] [Thread-8  ]: finished collecting timing info
18:15:27.560215 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:15:27.560738 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b863718c-fd52-44fa-a87c-0a49b3aba76c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134c69ffa0>]}
18:15:27.561136 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
18:15:27.561509 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:15:27.571480 [debug] [MainThread]: Acquiring new postgres connection "master"
18:15:27.571750 [debug] [MainThread]: Using postgres connection "master"
18:15:27.571912 [debug] [MainThread]: On master: BEGIN
18:15:27.572000 [debug] [MainThread]: Opening a new connection, currently in state closed
18:15:27.586275 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:15:27.586524 [debug] [MainThread]: On master: COMMIT
18:15:27.586631 [debug] [MainThread]: Using postgres connection "master"
18:15:27.586722 [debug] [MainThread]: On master: COMMIT
18:15:27.586914 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:15:27.587040 [debug] [MainThread]: On master: Close
18:15:27.587478 [info ] [MainThread]: 
18:15:27.587694 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.41s.
18:15:27.587840 [debug] [MainThread]: Connection 'master' was properly closed.
18:15:27.587916 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:15:27.587988 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:15:27.588059 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:15:27.588127 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:15:27.588196 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:15:27.588265 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:15:27.588332 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:15:27.593025 [info ] [MainThread]: 
18:15:27.594795 [info ] [MainThread]: [32mCompleted successfully[0m
18:15:27.595083 [info ] [MainThread]: 
18:15:27.595246 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:15:27.595515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ed47550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1350605eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f134ec0ad60>]}


============================== 2022-06-04 18:16:14.996125 | 5fb4621e-6a37-4463-bee3-4a0a74f88e25 ==============================
18:16:14.996151 [info ] [MainThread]: Running with dbt=1.1.0
18:16:14.997045 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:16:14.997418 [debug] [MainThread]: Tracking: tracking
18:16:15.002268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327b13eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327b13f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327b13e80>]}
18:16:15.037417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:16:15.037664 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:16:15.043460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33279ccf10>]}
18:16:15.048802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327a92a30>]}
18:16:15.049133 [info ] [MainThread]: Found 7 models, 7 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:16:15.049454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327a92a00>]}
18:16:15.051676 [info ] [MainThread]: 
18:16:15.052364 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:15.054715 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:16:15.075712 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:16:15.076161 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:16:15.076314 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:16:15.084961 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:16:15.086318 [debug] [ThreadPool]: On list_erp_oltp: Close
18:16:15.087728 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:16:15.092591 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:16:15.092783 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:16:15.092916 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:16:15.098324 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:16:15.098550 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:16:15.098655 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:16:15.100791 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:16:15.102073 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:16:15.102349 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:16:15.106487 [debug] [MainThread]: Using postgres connection "master"
18:16:15.106744 [debug] [MainThread]: On master: BEGIN
18:16:15.106887 [debug] [MainThread]: Opening a new connection, currently in state init
18:16:15.114859 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:16:15.115117 [debug] [MainThread]: Using postgres connection "master"
18:16:15.115242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:16:15.130539 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
18:16:15.132069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327b186a0>]}
18:16:15.132421 [debug] [MainThread]: On master: ROLLBACK
18:16:15.132874 [debug] [MainThread]: Using postgres connection "master"
18:16:15.133217 [debug] [MainThread]: On master: BEGIN
18:16:15.134173 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:16:15.134437 [debug] [MainThread]: On master: COMMIT
18:16:15.134581 [debug] [MainThread]: Using postgres connection "master"
18:16:15.134701 [debug] [MainThread]: On master: COMMIT
18:16:15.134950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:15.135103 [debug] [MainThread]: On master: Close
18:16:15.135532 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:16:15.135848 [info ] [MainThread]: 
18:16:15.141785 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:16:15.142112 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:16:15.142527 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:16:15.142668 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:16:15.142792 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:16:15.145034 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:16:15.145206 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:16:15.145398 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:16:15.145624 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:16:15.146500 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:16:15.146931 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:16:15.147059 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:16:15.147163 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:16:15.146200 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:16:15.153442 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:16:15.153618 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:16:15.153725 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:16:15.145882 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:16:15.194822 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:16:15.195578 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:16:15.196568 [debug] [Thread-1  ]: finished collecting timing info
18:16:15.197042 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:16:15.196702 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:16:15.196880 [debug] [Thread-4  ]: finished collecting timing info
18:16:15.196440 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:16:15.210208 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:16:15.221491 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:16:15.221907 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:16:15.224073 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:16:15.235935 [debug] [Thread-2  ]: finished collecting timing info
18:16:15.236122 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:16:15.235534 [debug] [Thread-3  ]: finished collecting timing info
18:16:15.251146 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:16:15.270522 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:16:15.270768 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:15.277963 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:16:15.277761 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:16:15.278101 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:16:15.278745 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:15.278877 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:16:15.278965 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:16:15.279987 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:15.280265 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:16:15.280364 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:16:15.276981 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:16:15.281489 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:15.281970 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:16:15.282078 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:16:15.285929 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
18:16:15.286135 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:15.286228 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:16:15.287910 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:16:15.294962 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:16:15.295242 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:16:15.295421 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:15.296153 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:16:15.296000 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:15.296312 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:16:15.295809 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:15.296959 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:16:15.297703 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:15.300111 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:15.300483 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:16:15.300288 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:15.302335 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:15.302472 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:16:15.302775 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:16:15.303017 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:15.303122 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:16:15.302593 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.302858 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:16:15.309148 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:15.307007 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.307208 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:15.313538 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:15.306739 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:15.311303 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:15.314374 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:16:15.309384 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:16:15.314901 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:16:15.316649 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.314684 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:16:15.319690 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:15.320871 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:16:15.320114 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.327347 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:16:15.319948 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.320737 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.327580 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
18:16:15.327783 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:15.335822 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:16:15.335446 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:16:15.336065 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:15.336185 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:16:15.335624 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:16:15.334171 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:16:15.336618 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:15.336381 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:15.339727 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:16:15.336751 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:16:15.354150 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
18:16:15.358485 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:16:15.358679 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:16:15.360367 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
18:16:15.361747 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:16:15.361903 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:16:15.362032 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:16:15.363460 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:16:15.363583 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:16:15.362166 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
18:16:15.365416 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:16:15.365557 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:16:15.368062 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:16:15.369032 [debug] [Thread-2  ]: finished collecting timing info
18:16:15.369180 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:16:15.370997 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3324149070>]}
18:16:15.371306 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.18s]
18:16:15.371622 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:16:15.374318 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:16:15.375257 [debug] [Thread-3  ]: finished collecting timing info
18:16:15.375402 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:16:15.375596 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:16:15.376447 [debug] [Thread-1  ]: finished collecting timing info
18:16:15.376697 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:16:15.378334 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33241297f0>]}
18:16:15.378617 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.23s]
18:16:15.378945 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33299d2040>]}
18:16:15.379375 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:16:15.379628 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.24s]
18:16:15.380170 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:16:15.380396 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:16:15.380759 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:16:15.381033 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:16:15.381197 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:16:15.381288 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:16:15.383674 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:16:15.383980 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
18:16:15.384115 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:16:15.385026 [debug] [Thread-4  ]: finished collecting timing info
18:16:15.385272 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:16:15.385477 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:16:15.385920 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:16:15.386040 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:16:15.386132 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:16:15.393806 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3329394640>]}
18:16:15.387668 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:16:15.394400 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.25s]
18:16:15.394546 [debug] [Thread-6  ]: finished collecting timing info
18:16:15.395107 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:16:15.395308 [debug] [Thread-8  ]: finished collecting timing info
18:16:15.395788 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:16:15.395495 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:16:15.395998 [debug] [Thread-10 ]: Began running node model.first_project.customers
18:16:15.408666 [info ] [Thread-10 ]: 7 of 7 START view model public.customers ....................................... [RUN]
18:16:15.409360 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
18:16:15.409549 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
18:16:15.409698 [debug] [Thread-10 ]: Compiling model.first_project.customers
18:16:15.402369 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:16:15.418657 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:15.418820 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:16:15.418913 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:16:15.418035 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
18:16:15.419618 [debug] [Thread-10 ]: finished collecting timing info
18:16:15.419786 [debug] [Thread-10 ]: Began executing node model.first_project.customers
18:16:15.434911 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:16:15.435355 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:16:15.435522 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:16:15.435614 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:16:15.439609 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
18:16:15.440008 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:16:15.440189 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
18:16:15.440290 [debug] [Thread-10 ]: Opening a new connection, currently in state init
18:16:15.444717 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
18:16:15.444934 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:15.445042 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:16:15.446381 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:15.449190 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:15.449424 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:16:15.452199 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.453535 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:16:15.453706 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:15.456770 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:16:15.473271 [debug] [Thread-6  ]: SQL status: BEGIN in 0.04 seconds
18:16:15.473559 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:16:15.473706 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:16:15.473919 [debug] [Thread-8  ]: SQL status: COMMIT in 0.02 seconds
18:16:15.475395 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:16:15.475549 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:16:15.475834 [debug] [Thread-10 ]: SQL status: BEGIN in 0.04 seconds
18:16:15.475970 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:16:15.476060 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:16:15.476450 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:16:15.478360 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:16:15.478505 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:16:15.478815 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
18:16:15.480524 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:16:15.480673 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:16:15.480845 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.482671 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:16:15.482865 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:16:15.483172 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
18:16:15.484316 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:16:15.484458 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:16:15.484557 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
18:16:15.488142 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.01 seconds
18:16:15.489460 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:16:15.489610 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:16:15.489716 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:16:15.489914 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.01 seconds
18:16:15.490988 [debug] [Thread-8  ]: finished collecting timing info
18:16:15.491173 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:16:15.491716 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3324085340>]}
18:16:15.491846 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
18:16:15.493457 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
18:16:15.493650 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:16:15.493997 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.11s]
18:16:15.494378 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:16:15.494982 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
18:16:15.495997 [debug] [Thread-10 ]: finished collecting timing info
18:16:15.496176 [debug] [Thread-10 ]: On model.first_project.customers: Close
18:16:15.496981 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33240905b0>]}
18:16:15.497492 [info ] [Thread-10 ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
18:16:15.497852 [debug] [Thread-10 ]: Finished running node model.first_project.customers
18:16:15.499163 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:16:15.500774 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:16:15.500966 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:16:15.507870 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
18:16:15.509576 [debug] [Thread-6  ]: finished collecting timing info
18:16:15.509844 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:16:15.512159 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb4621e-6a37-4463-bee3-4a0a74f88e25', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f33240f9df0>]}
18:16:15.512575 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.13s]
18:16:15.513018 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:16:15.516120 [debug] [MainThread]: Acquiring new postgres connection "master"
18:16:15.516345 [debug] [MainThread]: Using postgres connection "master"
18:16:15.516454 [debug] [MainThread]: On master: BEGIN
18:16:15.516541 [debug] [MainThread]: Opening a new connection, currently in state closed
18:16:15.522086 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:16:15.522309 [debug] [MainThread]: On master: COMMIT
18:16:15.522413 [debug] [MainThread]: Using postgres connection "master"
18:16:15.522504 [debug] [MainThread]: On master: COMMIT
18:16:15.522677 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:16:15.522808 [debug] [MainThread]: On master: Close
18:16:15.523220 [info ] [MainThread]: 
18:16:15.523490 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.47s.
18:16:15.523654 [debug] [MainThread]: Connection 'master' was properly closed.
18:16:15.523737 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:16:15.523815 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:16:15.523912 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:16:15.523990 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:16:15.524067 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:16:15.524143 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:16:15.524218 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:16:15.528252 [info ] [MainThread]: 
18:16:15.528489 [info ] [MainThread]: [32mCompleted successfully[0m
18:16:15.528779 [info ] [MainThread]: 
18:16:15.531260 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:16:15.531532 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327a927f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3327a92610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f332799e550>]}


============================== 2022-06-04 18:19:46.502414 | e3c9a3bb-1630-4f7e-a467-a5d954348924 ==============================
18:19:46.502435 [info ] [MainThread]: Running with dbt=1.1.0
18:19:46.502948 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:19:46.503104 [debug] [MainThread]: Tracking: tracking
18:19:46.507235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba540d070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba540d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba540d2b0>]}
18:19:46.537266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:19:46.538234 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
18:19:46.552628 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:19:46.630714 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba6c7d490>]}
18:19:46.635771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba54011c0>]}
18:19:46.636028 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:19:46.636246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba5401460>]}
18:19:46.637447 [info ] [MainThread]: 
18:19:46.639676 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:46.641298 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:19:46.656753 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:19:46.657046 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:19:46.657409 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:46.667060 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:19:46.668221 [debug] [ThreadPool]: On list_erp_oltp: Close
18:19:46.669505 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:19:46.673839 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:19:46.673980 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:19:46.674105 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:19:46.681641 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:19:46.681854 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:19:46.681943 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:19:46.683950 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:19:46.685449 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:19:46.685858 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:19:46.689860 [debug] [MainThread]: Using postgres connection "master"
18:19:46.690193 [debug] [MainThread]: On master: BEGIN
18:19:46.690324 [debug] [MainThread]: Opening a new connection, currently in state init
18:19:46.696361 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:46.696621 [debug] [MainThread]: Using postgres connection "master"
18:19:46.696735 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:19:46.709347 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:19:46.710658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba52f6f10>]}
18:19:46.710967 [debug] [MainThread]: On master: ROLLBACK
18:19:46.711351 [debug] [MainThread]: Using postgres connection "master"
18:19:46.711484 [debug] [MainThread]: On master: BEGIN
18:19:46.711923 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:19:46.712087 [debug] [MainThread]: On master: COMMIT
18:19:46.712189 [debug] [MainThread]: Using postgres connection "master"
18:19:46.712278 [debug] [MainThread]: On master: COMMIT
18:19:46.712514 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:46.712634 [debug] [MainThread]: On master: Close
18:19:46.713109 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:19:46.713359 [info ] [MainThread]: 
18:19:46.718676 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:19:46.718936 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:19:46.719298 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:19:46.719427 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:19:46.719537 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:19:46.721480 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:19:46.721729 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:19:46.721932 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:19:46.722497 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:19:46.722266 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:19:46.722956 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:19:46.723968 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:19:46.724105 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:19:46.723625 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:19:46.725245 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:19:46.725380 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:19:46.725065 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:19:46.727655 [debug] [Thread-3  ]: finished collecting timing info
18:19:46.722051 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:19:46.727801 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:19:46.728566 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:19:46.727178 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:19:46.723762 [debug] [Thread-1  ]: finished collecting timing info
18:19:46.745495 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:19:46.754641 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:19:46.746495 [debug] [Thread-2  ]: finished collecting timing info
18:19:46.746063 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:19:46.758151 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:19:46.758608 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:19:46.758856 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:19:46.771249 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:19:46.782774 [debug] [Thread-4  ]: finished collecting timing info
18:19:46.782976 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:19:46.774070 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:19:46.785402 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:19:46.786503 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:19:46.785904 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:19:46.786164 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:19:46.786918 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:19:46.787023 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:19:46.786776 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:19:46.787279 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:19:46.786625 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:19:46.788088 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:19:46.782209 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:19:46.788942 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:19:46.789056 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:19:46.789144 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:19:46.795537 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:19:46.795822 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:19:46.795930 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:19:46.797639 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:19:46.797852 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
18:19:46.798003 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:19:46.798174 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:19:46.798319 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:19:46.798457 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:19:46.800491 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:19:46.806363 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:19:46.806694 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
18:19:46.810475 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:19:46.807668 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:19:46.807224 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:19:46.811925 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:19:46.812136 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:19:46.811655 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.810758 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:19:46.807859 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
18:19:46.814643 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:19:46.816865 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:19:46.818059 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:19:46.817670 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.817882 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:19:46.820150 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:19:46.820523 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:19:46.817539 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:19:46.820289 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.822384 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:19:46.822550 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.822696 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.824739 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:19:46.824953 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:19:46.830612 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:19:46.831780 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:19:46.832001 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:19:46.832265 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:19:46.832612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.832816 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:19:46.838238 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:19:46.837613 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:19:46.838475 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:19:46.837816 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.833036 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:19:46.839647 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:19:46.840024 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.840161 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:19:46.845154 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:19:46.848801 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:19:46.848587 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:19:46.853210 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:19:46.853415 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:19:46.848944 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:19:46.853887 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:19:46.848384 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:19:46.855196 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:19:46.855590 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:19:46.863471 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:19:46.864953 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:19:46.865132 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:19:46.869111 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:19:46.869334 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:19:46.869496 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
18:19:46.871206 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:19:46.874434 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:19:46.874211 [debug] [Thread-2  ]: finished collecting timing info
18:19:46.872266 [debug] [Thread-3  ]: finished collecting timing info
18:19:46.875445 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:19:46.875697 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:19:46.876491 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba4e8c340>]}
18:19:46.878197 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.15s]
18:19:46.878743 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:19:46.879292 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba4e55bb0>]}
18:19:46.879836 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.16s]
18:19:46.880554 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:19:46.880975 [debug] [Thread-2  ]: Began running node model.first_project.customers2
18:19:46.881524 [info ] [Thread-2  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:19:46.881248 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
18:19:46.882059 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers2"
18:19:46.884058 [debug] [Thread-2  ]: Began compiling node model.first_project.customers2
18:19:46.883863 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
18:19:46.884210 [debug] [Thread-2  ]: Compiling model.first_project.customers2
18:19:46.887312 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers2"
18:19:46.885172 [debug] [Thread-4  ]: finished collecting timing info
18:19:46.883600 [debug] [Thread-1  ]: finished collecting timing info
18:19:46.887694 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:19:46.887888 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:19:46.889458 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba75dc520>]}
18:19:46.889755 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.17s]
18:19:46.890213 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba5408d30>]}
18:19:46.890460 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.14s]
18:19:46.890832 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:19:46.891074 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:19:46.888002 [debug] [Thread-2  ]: finished collecting timing info
18:19:46.891466 [debug] [Thread-2  ]: Began executing node model.first_project.customers2
18:19:46.895879 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.customers2"
18:19:46.896627 [debug] [Thread-7  ]: Began running node model.first_project.customers
18:19:46.896938 [info ] [Thread-7  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:19:46.897116 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
18:19:46.897642 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
18:19:46.898008 [info ] [Thread-8  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:19:46.898194 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
18:19:46.898664 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:19:46.898969 [debug] [Thread-7  ]: Compiling model.first_project.customers
18:19:46.898817 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
18:19:46.899109 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
18:19:46.901446 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
18:19:46.901818 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
18:19:46.903818 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:19:46.904114 [debug] [Thread-8  ]: finished collecting timing info
18:19:46.904286 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
18:19:46.908009 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:19:46.901675 [debug] [Thread-2  ]: On model.first_project.customers2: BEGIN
18:19:46.908320 [debug] [Thread-7  ]: finished collecting timing info
18:19:46.908687 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:19:46.909260 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
18:19:46.909094 [debug] [Thread-7  ]: Began executing node model.first_project.customers
18:19:46.908907 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:19:46.909378 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:19:46.912380 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers"
18:19:46.917240 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:19:46.917533 [debug] [Thread-7  ]: On model.first_project.customers: BEGIN
18:19:46.917654 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:19:46.923130 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:19:46.923385 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
18:19:46.923499 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:19:46.926414 [debug] [Thread-2  ]: SQL status: SELECT 100 in 0.0 seconds
18:19:46.928979 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
18:19:46.929227 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:19:46.930340 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.932550 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
18:19:46.932740 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:19:46.933279 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:19:46.933445 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.933594 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:19:46.935354 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
18:19:46.935672 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:19:46.935864 [debug] [Thread-7  ]: SQL status: BEGIN in 0.02 seconds
18:19:46.936016 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
18:19:46.936387 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:19:46.936549 [debug] [Thread-2  ]: On model.first_project.customers2: COMMIT
18:19:46.936706 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:19:46.939158 [debug] [Thread-7  ]: SQL status: CREATE VIEW in 0.0 seconds
18:19:46.941307 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:19:46.941482 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:19:46.942753 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
18:19:46.953027 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.01 seconds
18:19:46.953329 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
18:19:46.961126 [debug] [Thread-2  ]: Using postgres connection "model.first_project.customers2"
18:19:46.959617 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
18:19:46.961298 [debug] [Thread-2  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:19:46.958351 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:19:46.961483 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:19:46.962652 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:19:46.962892 [debug] [Thread-7  ]: On model.first_project.customers: COMMIT
18:19:46.963476 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:19:46.964770 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:19:46.964918 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:19:46.965065 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
18:19:46.968644 [debug] [Thread-2  ]: SQL status: DROP TABLE in 0.01 seconds
18:19:46.969842 [debug] [Thread-2  ]: finished collecting timing info
18:19:46.970005 [debug] [Thread-2  ]: On model.first_project.customers2: Close
18:19:46.971996 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba4e48f70>]}
18:19:46.972357 [info ] [Thread-2  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.09s]
18:19:46.972694 [debug] [Thread-2  ]: Finished running node model.first_project.customers2
18:19:46.977158 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:19:46.977323 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
18:19:46.979087 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:19:46.980494 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers"
18:19:46.980677 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:19:46.980848 [debug] [Thread-7  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:19:46.981365 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:19:46.981545 [debug] [Thread-7  ]: SQL status: DROP VIEW in 0.0 seconds
18:19:46.982476 [debug] [Thread-8  ]: finished collecting timing info
18:19:46.983605 [debug] [Thread-7  ]: finished collecting timing info
18:19:46.984249 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
18:19:46.984444 [debug] [Thread-7  ]: On model.first_project.customers: Close
18:19:46.984981 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba4611220>]}
18:19:46.985265 [info ] [Thread-7  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
18:19:46.985619 [debug] [Thread-7  ]: Finished running node model.first_project.customers
18:19:46.990675 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e3c9a3bb-1630-4f7e-a467-a5d954348924', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba4566e50>]}
18:19:46.991270 [info ] [Thread-8  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.09s]
18:19:46.991665 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
18:19:46.993175 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:46.993371 [debug] [MainThread]: Using postgres connection "master"
18:19:46.993471 [debug] [MainThread]: On master: BEGIN
18:19:46.993551 [debug] [MainThread]: Opening a new connection, currently in state closed
18:19:46.998599 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:46.998827 [debug] [MainThread]: On master: COMMIT
18:19:47.000827 [debug] [MainThread]: Using postgres connection "master"
18:19:47.000978 [debug] [MainThread]: On master: COMMIT
18:19:47.001250 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:47.001387 [debug] [MainThread]: On master: Close
18:19:47.001790 [info ] [MainThread]: 
18:19:47.001996 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.36s.
18:19:47.002161 [debug] [MainThread]: Connection 'master' was properly closed.
18:19:47.002252 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:19:47.002325 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:19:47.002394 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:19:47.002463 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:19:47.002533 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:19:47.002602 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:19:47.011234 [info ] [MainThread]: 
18:19:47.011499 [info ] [MainThread]: [32mCompleted successfully[0m
18:19:47.011691 [info ] [MainThread]: 
18:19:47.011870 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:19:47.012186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba52f6fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba53f5c10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ba4e92af0>]}


============================== 2022-06-04 18:19:59.549799 | 4b6e2311-087f-46e2-9046-9aaec23e0f02 ==============================
18:19:59.549819 [info ] [MainThread]: Running with dbt=1.1.0
18:19:59.550339 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:19:59.550468 [debug] [MainThread]: Tracking: tracking
18:19:59.553917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792f71fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792f71fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792f71d60>]}
18:19:59.582962 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:19:59.583553 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:19:59.590914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b6e2311-087f-46e2-9046-9aaec23e0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792e8d0d0>]}
18:19:59.597049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b6e2311-087f-46e2-9046-9aaec23e0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792ee2670>]}
18:19:59.597579 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:19:59.597888 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6e2311-087f-46e2-9046-9aaec23e0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792ee2700>]}
18:19:59.599774 [info ] [MainThread]: 
18:19:59.600467 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:59.601878 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:19:59.611056 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:19:59.611259 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:19:59.611373 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:19:59.620448 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:19:59.620726 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:19:59.620836 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:19:59.622709 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:19:59.624983 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:19:59.625328 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:19:59.630910 [debug] [MainThread]: Using postgres connection "master"
18:19:59.631130 [debug] [MainThread]: On master: BEGIN
18:19:59.631223 [debug] [MainThread]: Opening a new connection, currently in state init
18:19:59.636767 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:59.637007 [debug] [MainThread]: Using postgres connection "master"
18:19:59.637104 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:19:59.650874 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:19:59.652307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b6e2311-087f-46e2-9046-9aaec23e0f02', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792ee23d0>]}
18:19:59.652611 [debug] [MainThread]: On master: ROLLBACK
18:19:59.652984 [debug] [MainThread]: Using postgres connection "master"
18:19:59.653119 [debug] [MainThread]: On master: BEGIN
18:19:59.654481 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:19:59.654638 [debug] [MainThread]: On master: COMMIT
18:19:59.654733 [debug] [MainThread]: Using postgres connection "master"
18:19:59.654822 [debug] [MainThread]: On master: COMMIT
18:19:59.655024 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:59.655145 [debug] [MainThread]: On master: Close
18:19:59.655509 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:19:59.655718 [info ] [MainThread]: 
18:19:59.659935 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:19:59.660165 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:19:59.660567 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:19:59.660710 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:19:59.660835 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:19:59.661025 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:19:59.667846 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:19:59.668284 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:19:59.668441 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:19:59.668548 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:19:59.676723 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:19:59.677009 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:19:59.682337 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
18:19:59.682793 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:19:59.682983 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:19:59.683116 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:19:59.679435 [info ] [Thread-3  ]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_customers_  [RUN]
18:19:59.689967 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:19:59.690117 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:19:59.690217 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:19:59.689389 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:19:59.679265 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:19:59.682031 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:19:59.679053 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:19:59.724618 [debug] [Thread-2  ]: finished collecting timing info
18:19:59.723382 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
18:19:59.724791 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:19:59.723102 [debug] [Thread-4  ]: finished collecting timing info
18:19:59.730785 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:19:59.743609 [debug] [Thread-3  ]: finished collecting timing info
18:19:59.743755 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:19:59.742839 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:19:59.743240 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:19:59.731051 [debug] [Thread-1  ]: finished collecting timing info
18:19:59.749165 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:19:59.742363 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:19:59.746726 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:19:59.748836 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:19:59.750626 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:19:59.751655 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:19:59.751790 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:19:59.751891 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:19:59.751023 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:19:59.756162 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:19:59.746470 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:19:59.752048 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:19:59.756969 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:19:59.757095 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:19:59.757574 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:19:59.757711 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: BEGIN
18:19:59.757803 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:19:59.752501 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:19:59.758987 [debug] [Thread-5  ]: finished collecting timing info
18:19:59.759417 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:19:59.759622 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:19:59.759776 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:19:59.761707 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:19:59.763251 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:19:59.763493 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:19:59.763611 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:19:59.771174 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:19:59.771413 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:19:59.771513 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:19:59.772597 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:19:59.774561 [debug] [Thread-1  ]: finished collecting timing info
18:19:59.775053 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:19:59.775283 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:19:59.775471 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:19:59.775685 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:19:59.775934 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:19:59.776321 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
18:19:59.776717 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:19:59.777608 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:19:59.777729 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:19:59.777813 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "erp_oltp"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "erp_oltp"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
18:19:59.779849 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.0 seconds
18:19:59.781179 [debug] [Thread-3  ]: finished collecting timing info
18:19:59.781416 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.01 seconds
18:19:59.781618 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: ROLLBACK
18:19:59.783062 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: Close
18:19:59.783566 [info ] [Thread-3  ]: 3 of 5 PASS relationships_stg_orders_customer_id__customer_id__ref_customers_ .. [[32mPASS[0m in 0.09s]
18:19:59.783898 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:19:59.782724 [debug] [Thread-4  ]: finished collecting timing info
18:19:59.784745 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:19:59.787683 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:19:59.788240 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.11s]
18:19:59.788601 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:19:59.790563 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:19:59.790753 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:19:59.790860 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:19:59.797049 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.01 seconds
18:19:59.801504 [debug] [Thread-5  ]: finished collecting timing info
18:19:59.801683 [debug] [Thread-2  ]: SQL status: BEGIN in 0.04 seconds
18:19:59.801949 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:19:59.802036 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:19:59.801843 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:19:59.802361 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:19:59.803973 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:19:59.805385 [debug] [Thread-2  ]: finished collecting timing info
18:19:59.805564 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:19:59.805893 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:19:59.806359 [info ] [Thread-2  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.14s]
18:19:59.806762 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:19:59.807179 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.06s]
18:19:59.807652 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:19:59.809065 [debug] [MainThread]: Acquiring new postgres connection "master"
18:19:59.809234 [debug] [MainThread]: Using postgres connection "master"
18:19:59.809329 [debug] [MainThread]: On master: BEGIN
18:19:59.809409 [debug] [MainThread]: Opening a new connection, currently in state closed
18:19:59.816462 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:19:59.816764 [debug] [MainThread]: On master: COMMIT
18:19:59.816888 [debug] [MainThread]: Using postgres connection "master"
18:19:59.817096 [debug] [MainThread]: On master: COMMIT
18:19:59.817398 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:19:59.817546 [debug] [MainThread]: On master: Close
18:19:59.817935 [info ] [MainThread]: 
18:19:59.818193 [info ] [MainThread]: Finished running 5 tests in 0.22s.
18:19:59.818367 [debug] [MainThread]: Connection 'master' was properly closed.
18:19:59.818449 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:19:59.818524 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:19:59.818596 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:19:59.818665 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
18:19:59.818735 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:19:59.828329 [info ] [MainThread]: 
18:19:59.828682 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:19:59.828963 [info ] [MainThread]: 
18:19:59.829183 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:19:59.829385 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:19:59.829546 [info ] [MainThread]: 
18:19:59.829732 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:19:59.829907 [info ] [MainThread]: 
18:19:59.830077 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
18:19:59.830330 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792e8d520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd7947f74f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd792ded9d0>]}


============================== 2022-06-04 18:24:41.410325 | 7747e0f4-10ca-400f-b7a4-f001016f9907 ==============================
18:24:41.410407 [info ] [MainThread]: Running with dbt=1.1.0
18:24:41.411095 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:24:41.411248 [debug] [MainThread]: Tracking: tracking
18:24:41.415209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58975d4070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58975d4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58975d42b0>]}
18:24:41.453315 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:24:41.453795 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:24:41.464919 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:24:41.484440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58970540d0>]}
18:24:41.490065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58975d6220>]}
18:24:41.490447 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:24:41.490729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5898dec250>]}
18:24:41.492381 [info ] [MainThread]: 
18:24:41.492941 [debug] [MainThread]: Acquiring new postgres connection "master"
18:24:41.494629 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:24:41.504828 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:24:41.505109 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:24:41.505247 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:24:41.514651 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:24:41.516019 [debug] [ThreadPool]: On list_erp_oltp: Close
18:24:41.517403 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:24:41.522885 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:24:41.523045 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:24:41.523271 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:24:41.530974 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:24:41.531203 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:24:41.531295 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:24:41.533206 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:24:41.534371 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:24:41.534635 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:24:41.571408 [debug] [MainThread]: Using postgres connection "master"
18:24:41.571661 [debug] [MainThread]: On master: BEGIN
18:24:41.571791 [debug] [MainThread]: Opening a new connection, currently in state init
18:24:41.576846 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:24:41.577098 [debug] [MainThread]: Using postgres connection "master"
18:24:41.577217 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:24:41.590645 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:24:41.592049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58975d42b0>]}
18:24:41.592394 [debug] [MainThread]: On master: ROLLBACK
18:24:41.592756 [debug] [MainThread]: Using postgres connection "master"
18:24:41.592955 [debug] [MainThread]: On master: BEGIN
18:24:41.593341 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:24:41.593529 [debug] [MainThread]: On master: COMMIT
18:24:41.593678 [debug] [MainThread]: Using postgres connection "master"
18:24:41.593811 [debug] [MainThread]: On master: COMMIT
18:24:41.594083 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:24:41.594277 [debug] [MainThread]: On master: Close
18:24:41.594692 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:24:41.594935 [info ] [MainThread]: 
18:24:41.600807 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:24:41.601096 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:24:41.601353 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:24:41.602317 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:24:41.602474 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:24:41.601840 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:24:41.601606 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:24:41.603317 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:24:41.603707 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:24:41.603042 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:24:41.604150 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:24:41.601492 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:24:41.604577 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:24:41.603978 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:24:41.605152 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:24:41.606802 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:24:41.604331 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:24:41.604983 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:24:41.602613 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:24:41.614431 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:24:41.607359 [debug] [Thread-4  ]: finished collecting timing info
18:24:41.611862 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:24:41.614768 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:24:41.611606 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:24:41.625861 [debug] [Thread-1  ]: finished collecting timing info
18:24:41.626128 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:24:41.615018 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:24:41.638655 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:24:41.639402 [debug] [Thread-3  ]: finished collecting timing info
18:24:41.639810 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:24:41.637036 [debug] [Thread-2  ]: finished collecting timing info
18:24:41.652206 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:24:41.667549 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:24:41.665695 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:24:41.673139 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:24:41.673517 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:24:41.682128 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:24:41.674235 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:24:41.682441 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:24:41.682581 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:24:41.682282 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:24:41.681943 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:24:41.673846 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:24:41.684463 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:24:41.684696 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:24:41.685071 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:24:41.685721 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:24:41.686123 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:24:41.690047 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:24:41.690283 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:24:41.690429 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:24:41.692843 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:24:41.699009 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:24:41.699416 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:24:41.699592 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:24:41.699732 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:24:41.699820 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:24:41.699931 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.701725 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:24:41.701898 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:24:41.704214 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:24:41.702331 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:24:41.704354 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:24:41.702014 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:24:41.704644 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:24:41.704766 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:24:41.705045 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.705176 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.711183 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:24:41.711547 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
18:24:41.716287 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:24:41.714388 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:24:41.716547 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:24:41.716414 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:24:41.713557 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:24:41.716659 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:24:41.717331 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.714572 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:24:41.718903 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:24:41.719373 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:24:41.719059 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:24:41.721278 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:24:41.721416 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:24:41.716861 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:24:41.721924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.721535 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.719215 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:24:41.722069 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.723602 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:24:41.724728 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:24:41.726092 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:24:41.725926 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:24:41.725733 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:24:41.726531 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:24:41.726845 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:24:41.726675 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.726217 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:24:41.731053 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:24:41.731377 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:24:41.731472 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:24:41.733258 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:24:41.737611 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:24:41.737759 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:24:41.739215 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:24:41.740394 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:24:41.740537 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:24:41.740680 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:24:41.740787 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:24:41.742109 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:24:41.744179 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:24:41.744378 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:24:41.744527 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:24:41.747127 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:24:41.748357 [debug] [Thread-2  ]: finished collecting timing info
18:24:41.748599 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:24:41.750699 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58997b0160>]}
18:24:41.751100 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.15s]
18:24:41.751543 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:24:41.753313 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
18:24:41.754881 [debug] [Thread-4  ]: finished collecting timing info
18:24:41.755204 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:24:41.755386 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:24:41.756653 [debug] [Thread-1  ]: finished collecting timing info
18:24:41.757023 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:24:41.757513 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5896fdddf0>]}
18:24:41.757852 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.16s]
18:24:41.758325 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:24:41.759464 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:24:41.759721 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:24:41.760080 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:24:41.760188 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:24:41.760280 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:24:41.762056 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:24:41.762366 [debug] [Thread-6  ]: finished collecting timing info
18:24:41.762506 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:24:41.765976 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:24:41.766299 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.02 seconds
18:24:41.767390 [debug] [Thread-3  ]: finished collecting timing info
18:24:41.768560 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:24:41.768823 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:24:41.768994 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:24:41.769078 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:24:41.768429 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58997b0a60>]}
18:24:41.770473 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.16s]
18:24:41.771228 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:24:41.770867 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58997b0250>]}
18:24:41.771879 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.17s]
18:24:41.772246 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:24:41.772756 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:24:41.772987 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:24:41.773327 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:24:41.773434 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:24:41.773528 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:24:41.775615 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:24:41.775952 [debug] [Thread-8  ]: finished collecting timing info
18:24:41.776104 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:24:41.779123 [debug] [Thread-9  ]: Began running node model.first_project.customers2
18:24:41.782035 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
18:24:41.782431 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
18:24:41.782556 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
18:24:41.782664 [debug] [Thread-9  ]: Compiling model.first_project.customers2
18:24:41.788485 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
18:24:41.781718 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:24:41.789497 [debug] [Thread-9  ]: finished collecting timing info
18:24:41.789769 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
18:24:41.792512 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
18:24:41.792943 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:24:41.794537 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:24:41.794693 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:24:41.795134 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:24:41.794958 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
18:24:41.795475 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:24:41.795812 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:24:41.795941 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:24:41.795649 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:24:41.802051 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.01 seconds
18:24:41.804313 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:24:41.804492 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:24:41.805010 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.806329 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:24:41.806640 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:24:41.806767 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:24:41.806940 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:24:41.807171 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:24:41.807283 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
    WHERE customers.customer_id <> 63
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:24:41.812292 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
18:24:41.812544 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:24:41.812667 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:24:41.812936 [debug] [Thread-8  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 29: from customers
         ^

18:24:41.813453 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:24:41.818161 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:24:41.818350 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:24:41.815557 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.0 seconds
18:24:41.823563 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:24:41.823795 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:24:41.816160 [debug] [Thread-8  ]: On model.first_project.customers: ROLLBACK
18:24:41.824608 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.01 seconds
18:24:41.826479 [debug] [Thread-6  ]: finished collecting timing info
18:24:41.826681 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:24:41.829267 [debug] [Thread-8  ]: finished collecting timing info
18:24:41.829539 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:24:41.829980 [debug] [Thread-8  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "from"
  LINE 29: from customers
           ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:24:41.830269 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58947738b0>]}
18:24:41.830626 [error] [Thread-8  ]: 6 of 7 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.06s]
18:24:41.832514 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:24:41.833555 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5894709b20>]}
18:24:41.833963 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:24:41.834424 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:24:41.835054 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.01 seconds
18:24:41.837996 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:24:41.838207 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:24:41.838785 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:24:41.849138 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:24:41.849357 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:24:41.849514 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:24:41.856923 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
18:24:41.860453 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:24:41.860699 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:24:41.871375 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.01 seconds
18:24:41.873280 [debug] [Thread-9  ]: finished collecting timing info
18:24:41.873510 [debug] [Thread-9  ]: On model.first_project.customers2: Close
18:24:41.874054 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7747e0f4-10ca-400f-b7a4-f001016f9907', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5894763760>]}
18:24:41.874399 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.09s]
18:24:41.874946 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
18:24:41.879586 [debug] [MainThread]: Acquiring new postgres connection "master"
18:24:41.879853 [debug] [MainThread]: Using postgres connection "master"
18:24:41.879976 [debug] [MainThread]: On master: BEGIN
18:24:41.880077 [debug] [MainThread]: Opening a new connection, currently in state closed
18:24:41.887651 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:24:41.887916 [debug] [MainThread]: On master: COMMIT
18:24:41.888038 [debug] [MainThread]: Using postgres connection "master"
18:24:41.888153 [debug] [MainThread]: On master: COMMIT
18:24:41.888450 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:24:41.888629 [debug] [MainThread]: On master: Close
18:24:41.889105 [info ] [MainThread]: 
18:24:41.889360 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.40s.
18:24:41.889645 [debug] [MainThread]: Connection 'master' was properly closed.
18:24:41.889739 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:24:41.889824 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:24:41.889905 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:24:41.889987 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:24:41.890068 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:24:41.890147 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:24:41.890227 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:24:41.895058 [info ] [MainThread]: 
18:24:41.895349 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:24:41.895567 [info ] [MainThread]: 
18:24:41.895743 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:24:41.895912 [error] [MainThread]:   syntax error at or near "from"
18:24:41.896070 [error] [MainThread]:   LINE 29: from customers
18:24:41.896252 [error] [MainThread]:            ^
18:24:41.896405 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:24:41.896577 [info ] [MainThread]: 
18:24:41.896744 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:24:41.897070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5897592430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f58974cadf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f589707b1c0>]}


============================== 2022-06-04 18:25:41.123338 | 0d1dfb0b-60ec-4db9-8b99-7c7a89797617 ==============================
18:25:41.123371 [info ] [MainThread]: Running with dbt=1.1.0
18:25:41.124390 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:25:41.124604 [debug] [MainThread]: Tracking: tracking
18:25:41.136830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2750c070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2750c040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2750c2b0>]}
18:25:41.172804 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:25:41.173334 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:25:41.187114 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:25:41.208808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e26f8d0d0>]}
18:25:41.215284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2750ee20>]}
18:25:41.215714 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:25:41.216173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e28d254c0>]}
18:25:41.218000 [info ] [MainThread]: 
18:25:41.218563 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:41.219759 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:25:41.230773 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:25:41.231009 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:25:41.231134 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:25:41.261944 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.03 seconds
18:25:41.263368 [debug] [ThreadPool]: On list_erp_oltp: Close
18:25:41.265023 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:25:41.271387 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:41.271594 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:25:41.271748 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:25:41.277442 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:25:41.277682 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:25:41.277843 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:25:41.280124 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:25:41.281803 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:25:41.282273 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:25:41.317965 [debug] [MainThread]: Using postgres connection "master"
18:25:41.318177 [debug] [MainThread]: On master: BEGIN
18:25:41.318271 [debug] [MainThread]: Opening a new connection, currently in state init
18:25:41.338201 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:25:41.338438 [debug] [MainThread]: Using postgres connection "master"
18:25:41.338542 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:25:41.353141 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:25:41.354389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2750c2b0>]}
18:25:41.354762 [debug] [MainThread]: On master: ROLLBACK
18:25:41.355049 [debug] [MainThread]: Using postgres connection "master"
18:25:41.355160 [debug] [MainThread]: On master: BEGIN
18:25:41.355459 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:25:41.355578 [debug] [MainThread]: On master: COMMIT
18:25:41.355666 [debug] [MainThread]: Using postgres connection "master"
18:25:41.355747 [debug] [MainThread]: On master: COMMIT
18:25:41.355916 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:41.356333 [debug] [MainThread]: On master: Close
18:25:41.356811 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:25:41.357118 [info ] [MainThread]: 
18:25:41.360553 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:25:41.360852 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:25:41.361046 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:25:41.361432 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:25:41.362112 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:25:41.362236 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:25:41.361947 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:25:41.361708 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:25:41.365922 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:25:41.366270 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:25:41.365713 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:25:41.366385 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:25:41.366714 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:25:41.367759 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:25:41.361565 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:25:41.368367 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:25:41.366551 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:25:41.368705 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:25:41.369080 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:25:41.369184 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:25:41.368931 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:25:41.370087 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:25:41.372549 [debug] [Thread-3  ]: finished collecting timing info
18:25:41.372728 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:25:41.368089 [debug] [Thread-4  ]: finished collecting timing info
18:25:41.388482 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:25:41.371881 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:25:41.365233 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:25:41.408330 [debug] [Thread-2  ]: finished collecting timing info
18:25:41.408587 [debug] [Thread-1  ]: finished collecting timing info
18:25:41.424116 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:25:41.433443 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:25:41.429104 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:25:41.427859 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:25:41.430853 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:25:41.439431 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:41.463937 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:25:41.464242 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:41.468240 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:25:41.468768 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:41.469513 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:25:41.469254 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:25:41.469632 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:25:41.468973 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:25:41.470910 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:41.469815 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:25:41.471049 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:25:41.471476 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:25:41.478666 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:25:41.478899 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:41.479002 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:25:41.480481 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:41.487730 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:41.488311 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
18:25:41.488962 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:41.488488 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:25:41.489265 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:41.489063 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:25:41.488824 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:25:41.489389 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:25:41.488636 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:25:41.491386 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:41.491517 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:25:41.491946 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:41.494174 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:41.494334 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:25:41.494465 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:25:41.496613 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:41.494592 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:41.496811 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.501122 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:41.498901 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:41.497092 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:25:41.501296 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:25:41.496974 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
18:25:41.501480 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:25:41.503397 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:41.503612 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.504577 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.504730 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.506573 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:41.504926 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:25:41.508378 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:41.515502 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:25:41.515263 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:25:41.515922 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.515020 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:25:41.516075 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.522375 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:25:41.517871 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.518031 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:41.517756 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:25:41.523825 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:41.523950 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:25:41.523680 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:25:41.523407 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:25:41.522562 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:41.524592 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:41.524743 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:25:41.524916 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:25:41.542368 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
18:25:41.546699 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:25:41.546883 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:25:41.550241 [debug] [Thread-3  ]: SQL status: COMMIT in 0.03 seconds
18:25:41.551632 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:25:41.551793 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:25:41.552609 [debug] [Thread-2  ]: SQL status: COMMIT in 0.03 seconds
18:25:41.554854 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:25:41.555008 [debug] [Thread-1  ]: SQL status: COMMIT in 0.03 seconds
18:25:41.555143 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:25:41.556292 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:25:41.556880 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:25:41.557884 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
18:25:41.558808 [debug] [Thread-4  ]: finished collecting timing info
18:25:41.558945 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:25:41.559340 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e28d8a550>]}
18:25:41.559633 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.19s]
18:25:41.559958 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:25:41.564398 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:25:41.565976 [debug] [Thread-2  ]: finished collecting timing info
18:25:41.566228 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:25:41.566369 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:25:41.568761 [debug] [Thread-3  ]: finished collecting timing info
18:25:41.569126 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e296e9940>]}
18:25:41.569295 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:25:41.569694 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.20s]
18:25:41.570116 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:25:41.571417 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e296dcc10>]}
18:25:41.571685 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.20s]
18:25:41.571966 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:25:41.572288 [debug] [Thread-6  ]: Began running node model.first_project.customers
18:25:41.572520 [info ] [Thread-6  ]: 5 of 7 START view model public.customers ....................................... [RUN]
18:25:41.572831 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
18:25:41.572994 [debug] [Thread-7  ]: Began running node model.first_project.customers2
18:25:41.573292 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
18:25:41.573648 [debug] [Thread-6  ]: Compiling model.first_project.customers
18:25:41.573504 [info ] [Thread-7  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
18:25:41.575570 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
18:25:41.576258 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers2"
18:25:41.576448 [debug] [Thread-6  ]: finished collecting timing info
18:25:41.578079 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
18:25:41.578253 [debug] [Thread-7  ]: Began compiling node model.first_project.customers2
18:25:41.582599 [debug] [Thread-7  ]: Compiling model.first_project.customers2
18:25:41.585747 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers2"
18:25:41.582249 [debug] [Thread-1  ]: finished collecting timing info
18:25:41.586331 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:25:41.586907 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e246c8e20>]}
18:25:41.587279 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.23s]
18:25:41.586119 [debug] [Thread-7  ]: finished collecting timing info
18:25:41.587626 [debug] [Thread-7  ]: Began executing node model.first_project.customers2
18:25:41.578488 [debug] [Thread-6  ]: Began executing node model.first_project.customers
18:25:41.592504 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers"
18:25:41.592883 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:25:41.593265 [debug] [Thread-6  ]: On model.first_project.customers: BEGIN
18:25:41.593356 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:25:41.593147 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:25:41.590530 [debug] [Thread-7  ]: Writing runtime SQL for node "model.first_project.customers2"
18:25:41.594681 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
18:25:41.594912 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:25:41.595357 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:25:41.595517 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
18:25:41.595630 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
18:25:41.597657 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:25:41.597999 [debug] [Thread-9  ]: finished collecting timing info
18:25:41.598208 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
18:25:41.600707 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:25:41.601534 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:25:41.601667 [debug] [Thread-7  ]: On model.first_project.customers2: BEGIN
18:25:41.601760 [debug] [Thread-7  ]: Opening a new connection, currently in state init
18:25:41.602866 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:41.603021 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
18:25:41.603118 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:25:41.610127 [debug] [Thread-7  ]: SQL status: BEGIN in 0.01 seconds
18:25:41.610447 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:25:41.610577 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:25:41.613493 [debug] [Thread-7  ]: SQL status: SELECT 100 in 0.0 seconds
18:25:41.617056 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:25:41.617274 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:25:41.617818 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.620567 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:25:41.620755 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:25:41.621145 [debug] [Thread-7  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.622877 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
18:25:41.623046 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:25:41.623486 [debug] [Thread-7  ]: On model.first_project.customers2: COMMIT
18:25:41.630735 [debug] [Thread-7  ]: SQL status: COMMIT in 0.01 seconds
18:25:41.630992 [debug] [Thread-6  ]: SQL status: BEGIN in 0.04 seconds
18:25:41.644449 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers"
18:25:41.645421 [debug] [Thread-7  ]: Using postgres connection "model.first_project.customers2"
18:25:41.645605 [debug] [Thread-6  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
    WHERE customers.customer_id != 63
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:25:41.646141 [debug] [Thread-7  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:25:41.646300 [debug] [Thread-9  ]: SQL status: BEGIN in 0.04 seconds
18:25:41.647074 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:41.647198 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:25:41.646851 [debug] [Thread-6  ]: Postgres adapter: Postgres error: syntax error at or near "from"
LINE 29: from customers
         ^

18:25:41.648105 [debug] [Thread-6  ]: On model.first_project.customers: ROLLBACK
18:25:41.648948 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
18:25:41.651529 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:41.651706 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:25:41.652024 [debug] [Thread-6  ]: finished collecting timing info
18:25:41.652255 [debug] [Thread-6  ]: On model.first_project.customers: Close
18:25:41.652739 [debug] [Thread-6  ]: Database Error in model customers (models/erp/customers.sql)
  syntax error at or near "from"
  LINE 29: from customers
           ^
  compiled SQL at target/run/first_project/models/erp/customers.sql
18:25:41.653016 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2469a6d0>]}
18:25:41.653385 [error] [Thread-6  ]: 5 of 7 ERROR creating view model public.customers .............................. [[31mERROR[0m in 0.08s]
18:25:41.653807 [debug] [Thread-6  ]: Finished running node model.first_project.customers
18:25:41.654725 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:25:41.656771 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:25:41.665639 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:41.665985 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:25:41.656979 [debug] [Thread-7  ]: SQL status: DROP TABLE in 0.01 seconds
18:25:41.667489 [debug] [Thread-7  ]: finished collecting timing info
18:25:41.667701 [debug] [Thread-7  ]: On model.first_project.customers2: Close
18:25:41.668175 [debug] [Thread-7  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e26efb3a0>]}
18:25:41.668578 [info ] [Thread-7  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.09s]
18:25:41.671124 [debug] [Thread-7  ]: Finished running node model.first_project.customers2
18:25:41.673274 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
18:25:41.675497 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:25:41.677219 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:25:41.680730 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:25:41.682355 [debug] [Thread-9  ]: finished collecting timing info
18:25:41.682625 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
18:25:41.683419 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d1dfb0b-60ec-4db9-8b99-7c7a89797617', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e246909d0>]}
18:25:41.684041 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.09s]
18:25:41.689133 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
18:25:41.692011 [debug] [MainThread]: Acquiring new postgres connection "master"
18:25:41.692344 [debug] [MainThread]: Using postgres connection "master"
18:25:41.692578 [debug] [MainThread]: On master: BEGIN
18:25:41.692781 [debug] [MainThread]: Opening a new connection, currently in state closed
18:25:41.713579 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:25:41.713872 [debug] [MainThread]: On master: COMMIT
18:25:41.714049 [debug] [MainThread]: Using postgres connection "master"
18:25:41.714213 [debug] [MainThread]: On master: COMMIT
18:25:41.714557 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:25:41.714758 [debug] [MainThread]: On master: Close
18:25:41.715374 [info ] [MainThread]: 
18:25:41.716453 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.50s.
18:25:41.716846 [debug] [MainThread]: Connection 'master' was properly closed.
18:25:41.717054 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:25:41.717283 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:25:41.717482 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:25:41.717649 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:25:41.717798 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:25:41.717936 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:25:41.718134 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:25:41.725342 [info ] [MainThread]: 
18:25:41.725894 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
18:25:41.726323 [info ] [MainThread]: 
18:25:41.726731 [error] [MainThread]: [33mDatabase Error in model customers (models/erp/customers.sql)[0m
18:25:41.727074 [error] [MainThread]:   syntax error at or near "from"
18:25:41.727384 [error] [MainThread]:   LINE 29: from customers
18:25:41.727698 [error] [MainThread]:            ^
18:25:41.727995 [error] [MainThread]:   compiled SQL at target/run/first_project/models/erp/customers.sql
18:25:41.728347 [info ] [MainThread]: 
18:25:41.728720 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
18:25:41.729225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e29309100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e29309250>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2e2968abe0>]}


============================== 2022-06-04 18:26:18.396462 | 180811f1-de73-4b4f-9c47-a765b374a58e ==============================
18:26:18.396488 [info ] [MainThread]: Running with dbt=1.1.0
18:26:18.397444 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:26:18.397640 [debug] [MainThread]: Tracking: tracking
18:26:18.403028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f5134070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f5134040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f51342b0>]}
18:26:18.430293 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:26:18.430813 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:26:18.441544 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:26:18.461037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f4bb50d0>]}
18:26:18.466981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f5136e20>]}
18:26:18.467593 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:26:18.467887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f694c250>]}
18:26:18.469885 [info ] [MainThread]: 
18:26:18.470480 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:18.471622 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:26:18.480553 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:26:18.480871 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:26:18.481079 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:18.488602 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:26:18.489928 [debug] [ThreadPool]: On list_erp_oltp: Close
18:26:18.501350 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:26:18.511708 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:18.514004 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:26:18.514270 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:18.520155 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:26:18.520390 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:18.520491 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:18.522519 [debug] [ThreadPool]: SQL status: SELECT 14 in 0.0 seconds
18:26:18.523813 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:26:18.524085 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:26:18.556779 [debug] [MainThread]: Using postgres connection "master"
18:26:18.557048 [debug] [MainThread]: On master: BEGIN
18:26:18.557151 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:18.562000 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:18.562173 [debug] [MainThread]: Using postgres connection "master"
18:26:18.562259 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:18.574668 [debug] [MainThread]: SQL status: SELECT 4 in 0.01 seconds
18:26:18.576022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f51307c0>]}
18:26:18.576306 [debug] [MainThread]: On master: ROLLBACK
18:26:18.576595 [debug] [MainThread]: Using postgres connection "master"
18:26:18.576746 [debug] [MainThread]: On master: BEGIN
18:26:18.577054 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:18.577198 [debug] [MainThread]: On master: COMMIT
18:26:18.577296 [debug] [MainThread]: Using postgres connection "master"
18:26:18.577384 [debug] [MainThread]: On master: COMMIT
18:26:18.577551 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:18.577678 [debug] [MainThread]: On master: Close
18:26:18.578030 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:26:18.578274 [info ] [MainThread]: 
18:26:18.582458 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:26:18.582779 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:26:18.583201 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:26:18.583356 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:26:18.583477 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:26:18.585525 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:26:18.585779 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:26:18.585964 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:26:18.586614 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:26:18.586384 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:26:18.586091 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:26:18.587730 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:26:18.588065 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:26:18.587532 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:26:18.588175 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:26:18.588459 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:26:18.589472 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:26:18.589803 [debug] [Thread-4  ]: finished collecting timing info
18:26:18.589934 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:26:18.588319 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:26:18.587031 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:26:18.587137 [debug] [Thread-1  ]: finished collecting timing info
18:26:18.616978 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:26:18.617435 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:26:18.623782 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:26:18.623533 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:26:18.625178 [debug] [Thread-2  ]: finished collecting timing info
18:26:18.624817 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:26:18.625335 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:26:18.627203 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:26:18.621469 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:26:18.620074 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:26:18.638894 [debug] [Thread-3  ]: finished collecting timing info
18:26:18.645633 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:18.645939 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:18.646110 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:26:18.655249 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:26:18.650343 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:26:18.655550 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:26:18.649892 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:26:18.655991 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:18.656487 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:26:18.656613 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:26:18.652972 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:26:18.656912 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
18:26:18.656330 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:18.657189 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:26:18.657306 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:18.677318 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:26:18.677591 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:18.677700 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:26:18.679316 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:18.686698 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:18.686944 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
18:26:18.687854 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:18.687951 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:26:18.687462 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:26:18.688116 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:18.688215 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:26:18.689604 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:26:18.687606 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:26:18.691830 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:18.692032 [debug] [Thread-2  ]: SQL status: BEGIN in 0.04 seconds
18:26:18.692643 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:18.692411 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:26:18.692797 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:26:18.692167 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:18.695354 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:18.695500 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:26:18.695740 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.693001 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.697529 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:18.697669 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.697786 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:18.699445 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:18.699640 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:26:18.701434 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:18.703276 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:18.703558 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:26:18.704438 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:26:18.704717 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:26:18.705232 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.705374 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.710714 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:18.717027 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:18.719346 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:18.719062 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:18.719623 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:26:18.719492 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:18.717273 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:18.719828 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:18.719926 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:18.717156 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:18.721569 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:18.721708 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:18.721871 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:18.722020 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.723039 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:18.723165 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:18.723253 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:18.733787 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
18:26:18.737813 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:18.738062 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:26:18.741486 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
18:26:18.741753 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
18:26:18.742994 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:18.745020 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:26:18.744301 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:18.745231 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:26:18.743134 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:26:18.746784 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:18.746928 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:18.747061 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:26:18.748048 [debug] [Thread-3  ]: finished collecting timing info
18:26:18.748335 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:26:18.749281 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f4bceaf0>]}
18:26:18.749614 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.16s]
18:26:18.750316 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:26:18.750973 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:26:18.751201 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:26:18.751554 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:26:18.751658 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:26:18.751764 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:26:18.753666 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:26:18.753981 [debug] [Thread-6  ]: finished collecting timing info
18:26:18.754093 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:26:18.757406 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:26:18.757623 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:18.758738 [debug] [Thread-4  ]: finished collecting timing info
18:26:18.758925 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:26:18.757752 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:18.760841 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:18.769961 [debug] [Thread-2  ]: finished collecting timing info
18:26:18.771135 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:26:18.771617 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f425e8e0>]}
18:26:18.773211 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.18s]
18:26:18.770326 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f4261e20>]}
18:26:18.770452 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
18:26:18.775778 [debug] [Thread-1  ]: finished collecting timing info
18:26:18.775929 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:26:18.774852 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.18s]
18:26:18.777170 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:26:18.774543 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:26:18.770652 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:26:18.777338 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:26:18.776325 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f4273370>]}
18:26:18.778552 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.19s]
18:26:18.778867 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:26:18.780683 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:26:18.781035 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:26:18.781430 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:26:18.781548 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:26:18.781641 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:26:18.783763 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:26:18.784127 [debug] [Thread-8  ]: finished collecting timing info
18:26:18.784319 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:26:18.786203 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:26:18.786396 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
18:26:18.786749 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:26:18.787126 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:26:18.787244 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
18:26:18.787343 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
18:26:18.787575 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:18.789406 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:26:18.790136 [debug] [Thread-9  ]: finished collecting timing info
18:26:18.790297 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
18:26:18.789585 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:26:18.801244 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:26:18.802511 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:26:18.804592 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:26:18.804836 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:18.805035 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:26:18.805421 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:18.805570 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
18:26:18.805668 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:26:18.808527 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:26:18.810617 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:18.810776 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:26:18.813529 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
18:26:18.813777 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:18.813899 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
18:26:18.814067 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.817503 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:18.817990 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:26:18.819017 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:18.821317 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:18.821520 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.830753 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:26:18.835851 [debug] [Thread-9  ]: SQL status: BEGIN in 0.03 seconds
18:26:18.836114 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:18.836244 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:26:18.834940 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:26:18.836784 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.838572 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:18.842377 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:18.840087 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:26:18.842535 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:26:18.838787 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:18.842727 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:18.843281 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:26:18.843574 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:18.843097 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:26:18.856834 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:26:18.861394 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:18.861611 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:26:18.862352 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:18.873065 [debug] [Thread-8  ]: finished collecting timing info
18:26:18.873876 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:26:18.873352 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:26:18.857497 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:18.875525 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:18.876627 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:18.877601 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:18.877405 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:26:18.877216 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f42ac2e0>]}
18:26:18.878870 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.10s]
18:26:18.879290 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:26:18.886662 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
18:26:18.887867 [debug] [Thread-6  ]: finished collecting timing info
18:26:18.888070 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:26:18.888497 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f42c15e0>]}
18:26:18.888851 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.14s]
18:26:18.889239 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:26:18.892060 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
18:26:18.893757 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:18.893902 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:26:18.894222 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:18.895150 [debug] [Thread-9  ]: finished collecting timing info
18:26:18.895303 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
18:26:18.896304 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '180811f1-de73-4b4f-9c47-a765b374a58e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f7310670>]}
18:26:18.896617 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.11s]
18:26:18.897110 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
18:26:18.898472 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:18.898686 [debug] [MainThread]: Using postgres connection "master"
18:26:18.898798 [debug] [MainThread]: On master: BEGIN
18:26:18.898884 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:18.903864 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:18.904064 [debug] [MainThread]: On master: COMMIT
18:26:18.904182 [debug] [MainThread]: Using postgres connection "master"
18:26:18.904268 [debug] [MainThread]: On master: COMMIT
18:26:18.904484 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:18.904624 [debug] [MainThread]: On master: Close
18:26:18.905069 [info ] [MainThread]: 
18:26:18.905365 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.43s.
18:26:18.905535 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:18.905615 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:26:18.905706 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:26:18.905777 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:26:18.905847 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:26:18.905914 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:26:18.905982 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:26:18.906051 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:26:18.910273 [info ] [MainThread]: 
18:26:18.911940 [info ] [MainThread]: [32mCompleted successfully[0m
18:26:18.912224 [info ] [MainThread]: 
18:26:18.912400 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:26:18.912726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f502aca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f50f2700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f05f7322dc0>]}


============================== 2022-06-04 18:26:42.771353 | 1dc6edf7-e005-4108-9dc1-60de3e3ae829 ==============================
18:26:42.771375 [info ] [MainThread]: Running with dbt=1.1.0
18:26:42.771901 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:26:42.772046 [debug] [MainThread]: Tracking: tracking
18:26:42.775624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb2aacfa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb2aacfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb2aacd60>]}
18:26:42.802056 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:26:42.802788 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:26:42.816203 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:26:42.839042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb25200d0>]}
18:26:42.845321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb2aa1e20>]}
18:26:42.845680 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:26:42.845970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb42b8250>]}
18:26:42.847754 [info ] [MainThread]: 
18:26:42.848553 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:42.850220 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:26:42.860304 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:26:42.860621 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:26:42.860778 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:42.869007 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
18:26:42.870446 [debug] [ThreadPool]: On list_erp_oltp: Close
18:26:42.874506 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:26:42.882260 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:42.882600 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:26:42.882790 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:26:42.896849 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:26:42.897091 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:42.897227 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:42.899369 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:26:42.900740 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:26:42.901025 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:26:42.941909 [debug] [MainThread]: Using postgres connection "master"
18:26:42.942128 [debug] [MainThread]: On master: BEGIN
18:26:42.942227 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:42.958700 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
18:26:42.958932 [debug] [MainThread]: Using postgres connection "master"
18:26:42.959032 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:42.981881 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
18:26:42.983208 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb2a987c0>]}
18:26:42.983538 [debug] [MainThread]: On master: ROLLBACK
18:26:42.984476 [debug] [MainThread]: Using postgres connection "master"
18:26:42.984625 [debug] [MainThread]: On master: BEGIN
18:26:42.985300 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:42.985451 [debug] [MainThread]: On master: COMMIT
18:26:42.985548 [debug] [MainThread]: Using postgres connection "master"
18:26:42.985951 [debug] [MainThread]: On master: COMMIT
18:26:42.986178 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:42.986307 [debug] [MainThread]: On master: Close
18:26:42.986744 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:26:42.987024 [info ] [MainThread]: 
18:26:42.991405 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:26:42.991666 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:26:42.992018 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:26:42.992129 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:26:42.992229 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:26:42.995079 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:26:42.995299 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:26:42.995462 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:26:42.996074 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:26:42.995845 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:26:42.996444 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:26:42.997018 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:26:42.997131 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:26:42.996843 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:26:42.998019 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:26:42.995577 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:26:42.998189 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:26:42.998369 [debug] [Thread-1  ]: finished collecting timing info
18:26:42.998835 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:26:42.999561 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:26:42.999048 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:26:42.999676 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:26:43.001853 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:26:43.002696 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:26:43.001552 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:26:42.998626 [debug] [Thread-3  ]: finished collecting timing info
18:26:43.003011 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:26:42.999229 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:26:43.003287 [debug] [Thread-2  ]: finished collecting timing info
18:26:43.003421 [debug] [Thread-4  ]: finished collecting timing info
18:26:43.057493 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:26:43.057821 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:26:43.062796 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:26:43.063149 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:26:43.065939 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:26:43.068638 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:26:43.069384 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:43.069540 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:26:43.069654 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:26:43.070017 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:43.070775 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:26:43.070906 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:26:43.071068 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:43.072314 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:43.072480 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:26:43.073704 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:26:43.072720 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:26:43.074397 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:43.079745 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:26:43.080080 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:43.080213 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:26:43.083412 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:26:43.083627 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:43.083767 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:26:43.083941 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:43.090081 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:43.090257 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:26:43.091297 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:43.091462 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:26:43.094188 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:43.094319 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:26:43.093944 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:43.095490 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:26:43.097453 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:43.099577 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:43.100277 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.100443 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:26:43.100581 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:43.102677 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:43.105074 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:43.105324 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:26:43.105523 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.107561 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:43.108023 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:26:43.107739 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:26:43.105694 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:26:43.108225 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:43.108604 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:26:43.107902 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.115466 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:43.119451 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
18:26:43.122294 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:43.122546 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:26:43.119677 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:43.122816 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:43.123486 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.02 seconds
18:26:43.124712 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:43.124907 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:43.125045 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:43.126642 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
18:26:43.127802 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:43.127976 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:43.128079 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:43.128361 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:43.130564 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:43.130725 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:26:43.131229 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.136835 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:43.137032 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:26:43.137195 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:43.141867 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:43.142071 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
18:26:43.142372 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
18:26:43.142589 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:43.142839 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:26:43.145030 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:43.148082 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:26:43.147235 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:43.149036 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:26:43.153749 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
18:26:43.155226 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:43.155379 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:26:43.161547 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:43.162673 [debug] [Thread-2  ]: finished collecting timing info
18:26:43.162859 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
18:26:43.163040 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:26:43.164200 [debug] [Thread-4  ]: finished collecting timing info
18:26:43.164597 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:26:43.166324 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb0450160>]}
18:26:43.166678 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb4341eb0>]}
18:26:43.167040 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.17s]
18:26:43.167364 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.17s]
18:26:43.167752 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.02 seconds
18:26:43.168043 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
18:26:43.170649 [debug] [Thread-1  ]: finished collecting timing info
18:26:43.169348 [debug] [Thread-3  ]: finished collecting timing info
18:26:43.169807 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:26:43.168261 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:26:43.170814 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:26:43.170966 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:26:43.173088 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb24aad30>]}
18:26:43.173394 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb24985b0>]}
18:26:43.173687 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.18s]
18:26:43.174121 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.18s]
18:26:43.174560 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:26:43.174902 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:26:43.175310 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
18:26:43.175504 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:26:43.175827 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:26:43.175933 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
18:26:43.176027 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
18:26:43.177866 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:26:43.178175 [debug] [Thread-6  ]: finished collecting timing info
18:26:43.178302 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
18:26:43.181676 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:26:43.182122 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:43.182258 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
18:26:43.182332 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:26:43.192848 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:26:43.193199 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
18:26:43.193808 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:26:43.193993 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:26:43.194099 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:26:43.196439 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:26:43.196848 [debug] [Thread-8  ]: finished collecting timing info
18:26:43.197534 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:26:43.199623 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:26:43.199936 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:43.200059 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:26:43.200141 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:26:43.197296 [debug] [Thread-9  ]: Began running node model.first_project.customers2
18:26:43.201151 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
18:26:43.201519 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
18:26:43.201628 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
18:26:43.201724 [debug] [Thread-9  ]: Compiling model.first_project.customers2
18:26:43.203747 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
18:26:43.204536 [debug] [Thread-9  ]: finished collecting timing info
18:26:43.204685 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
18:26:43.207220 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
18:26:43.207406 [debug] [Thread-6  ]: SQL status: BEGIN in 0.03 seconds
18:26:43.207680 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:43.207836 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:26:43.209661 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:26:43.209895 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:43.210246 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
18:26:43.213746 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:43.214566 [debug] [Thread-9  ]: Opening a new connection, currently in state init
18:26:43.214844 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:26:43.216258 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.217586 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:43.217955 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:26:43.219112 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:43.219274 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:43.219631 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:43.219784 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id <> 63
)
select * from final
  );
18:26:43.224439 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:43.227122 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:43.227333 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:26:43.228068 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.229765 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:26:43.229973 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:26:43.230878 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:43.232377 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:43.232597 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:26:43.232983 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:26:43.233137 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
18:26:43.233415 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:26:43.233528 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:26:43.236813 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.0 seconds
18:26:43.239413 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:26:43.237100 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:43.239585 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:26:43.240643 [debug] [Thread-6  ]: finished collecting timing info
18:26:43.241049 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
18:26:43.241219 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
18:26:43.242656 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:43.245482 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb4c7d550>]}
18:26:43.245669 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:26:43.245804 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.246153 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
18:26:43.248316 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:26:43.248921 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:26:43.248547 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:43.250137 [debug] [Thread-8  ]: finished collecting timing info
18:26:43.250328 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:26:43.250601 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
18:26:43.253007 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb03d1d00>]}
18:26:43.253390 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.06s]
18:26:43.253755 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:26:43.253998 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:43.255935 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:26:43.256087 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:26:43.256191 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
18:26:43.262583 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
18:26:43.265509 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
18:26:43.265703 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:26:43.274366 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.01 seconds
18:26:43.275610 [debug] [Thread-9  ]: finished collecting timing info
18:26:43.275838 [debug] [Thread-9  ]: On model.first_project.customers2: Close
18:26:43.277552 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1dc6edf7-e005-4108-9dc1-60de3e3ae829', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb0419a90>]}
18:26:43.278011 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
18:26:43.278815 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
18:26:43.280711 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:43.280917 [debug] [MainThread]: Using postgres connection "master"
18:26:43.281013 [debug] [MainThread]: On master: BEGIN
18:26:43.281131 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:43.290025 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:43.290281 [debug] [MainThread]: On master: COMMIT
18:26:43.290382 [debug] [MainThread]: Using postgres connection "master"
18:26:43.290469 [debug] [MainThread]: On master: COMMIT
18:26:43.290644 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:43.290783 [debug] [MainThread]: On master: Close
18:26:43.291198 [info ] [MainThread]: 
18:26:43.291496 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.44s.
18:26:43.291680 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:43.291764 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:26:43.291840 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:26:43.291916 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:26:43.292565 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
18:26:43.292660 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:26:43.292737 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:26:43.292866 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:26:43.299533 [info ] [MainThread]: 
18:26:43.299783 [info ] [MainThread]: [32mCompleted successfully[0m
18:26:43.299984 [info ] [MainThread]: 
18:26:43.300131 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:26:43.300356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb04492e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb04255b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6eb04255e0>]}


============================== 2022-06-04 18:26:51.630632 | ff318e69-1087-4b98-a5af-8290d9302bec ==============================
18:26:51.630659 [info ] [MainThread]: Running with dbt=1.1.0
18:26:51.631265 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
18:26:51.631418 [debug] [MainThread]: Tracking: tracking
18:26:51.635363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abe99070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abe99040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abe992b0>]}
18:26:51.667214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
18:26:51.667688 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
18:26:51.677980 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
18:26:51.698181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ab90c0d0>]}
18:26:51.703712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abe8de20>]}
18:26:51.704109 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:26:51.704502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ad6a5250>]}
18:26:51.706289 [info ] [MainThread]: 
18:26:51.706895 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:51.708104 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
18:26:51.729072 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
18:26:51.729344 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
18:26:51.729504 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:26:51.746587 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.02 seconds
18:26:51.747852 [debug] [ThreadPool]: On list_erp_oltp: Close
18:26:51.749270 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:26:51.754269 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:51.754660 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:26:51.754891 [debug] [ThreadPool]: Opening a new connection, currently in state closed
18:26:51.759943 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:26:51.760172 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:26:51.760271 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:26:51.762165 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:26:51.763257 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:26:51.763487 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:26:51.800112 [debug] [MainThread]: Using postgres connection "master"
18:26:51.800414 [debug] [MainThread]: On master: BEGIN
18:26:51.800605 [debug] [MainThread]: Opening a new connection, currently in state init
18:26:51.807634 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:51.807957 [debug] [MainThread]: Using postgres connection "master"
18:26:51.808113 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:26:51.832534 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
18:26:51.834934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abe84040>]}
18:26:51.835417 [debug] [MainThread]: On master: ROLLBACK
18:26:51.835927 [debug] [MainThread]: Using postgres connection "master"
18:26:51.836200 [debug] [MainThread]: On master: BEGIN
18:26:51.836754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:26:51.837020 [debug] [MainThread]: On master: COMMIT
18:26:51.837223 [debug] [MainThread]: Using postgres connection "master"
18:26:51.837412 [debug] [MainThread]: On master: COMMIT
18:26:51.837741 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:51.837960 [debug] [MainThread]: On master: Close
18:26:51.838568 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:26:51.839072 [info ] [MainThread]: 
18:26:51.881096 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
18:26:51.881488 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
18:26:51.881938 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
18:26:51.882150 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
18:26:51.882332 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
18:26:51.884927 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
18:26:51.885187 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
18:26:51.886051 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
18:26:51.886804 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
18:26:51.887006 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
18:26:51.887210 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
18:26:51.885362 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
18:26:51.891412 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
18:26:51.892512 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
18:26:51.892714 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
18:26:51.892884 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
18:26:51.894539 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
18:26:51.895039 [debug] [Thread-3  ]: finished collecting timing info
18:26:51.895272 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
18:26:51.885564 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
18:26:51.904848 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
18:26:51.905607 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
18:26:51.905817 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
18:26:51.905998 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
18:26:51.907873 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
18:26:51.908459 [debug] [Thread-4  ]: finished collecting timing info
18:26:51.908740 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
18:26:51.890836 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
18:26:51.928070 [debug] [Thread-2  ]: finished collecting timing info
18:26:51.928479 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
18:26:51.909100 [debug] [Thread-1  ]: finished collecting timing info
18:26:51.955285 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
18:26:51.955050 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
18:26:51.968897 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:51.969088 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
18:26:51.969192 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:26:51.971248 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
18:26:51.971653 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:51.971806 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
18:26:51.971906 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:26:51.954496 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
18:26:51.972649 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:51.972788 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
18:26:51.972882 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:26:51.982475 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
18:26:51.982998 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:51.983181 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
18:26:51.983278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:26:51.994596 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
18:26:51.994894 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:51.995027 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
18:26:51.995489 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
18:26:51.995657 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:51.995753 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
18:26:51.999852 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:52.007084 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:52.008652 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
18:26:52.011515 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:52.011668 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
18:26:52.011831 [debug] [Thread-4  ]: SQL status: BEGIN in 0.04 seconds
18:26:52.011945 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:52.012038 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
18:26:52.012178 [debug] [Thread-1  ]: SQL status: BEGIN in 0.03 seconds
18:26:52.012302 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.015879 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:52.016512 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
18:26:52.012435 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:52.016193 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:52.019228 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:52.019424 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
18:26:52.016954 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
18:26:52.020358 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.022925 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:52.023105 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
18:26:52.023374 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
18:26:52.026099 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:52.026323 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
18:26:52.009361 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
18:26:52.026670 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.033471 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:52.033726 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:52.036247 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:52.033898 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.02 seconds
18:26:52.036447 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
18:26:52.034047 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
18:26:52.040179 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:52.037728 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:52.040477 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
18:26:52.040793 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.042413 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:52.041036 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:52.042566 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:52.043101 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
18:26:52.042759 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.042909 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
18:26:52.034270 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:52.049501 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
18:26:52.049207 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:52.049721 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:52.049840 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
18:26:52.059510 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
18:26:52.064791 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
18:26:52.065016 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
18:26:52.068865 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
18:26:52.070346 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
18:26:52.070507 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
18:26:52.070658 [debug] [Thread-4  ]: SQL status: COMMIT in 0.02 seconds
18:26:52.070788 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
18:26:52.072289 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
18:26:52.074672 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
18:26:52.074926 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
18:26:52.075100 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
18:26:52.075216 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:52.076358 [debug] [Thread-2  ]: finished collecting timing info
18:26:52.076542 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
18:26:52.077164 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ab87d2b0>]}
18:26:52.078207 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.19s]
18:26:52.078694 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
18:26:52.082059 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
18:26:52.083177 [debug] [Thread-3  ]: finished collecting timing info
18:26:52.083349 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
18:26:52.083738 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abd98ca0>]}
18:26:52.084030 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.19s]
18:26:52.084466 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
18:26:52.085064 [debug] [Thread-6  ]: Began running node model.first_project.customers2
18:26:52.085277 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
18:26:52.085641 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
18:26:52.085774 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
18:26:52.085875 [debug] [Thread-6  ]: Compiling model.first_project.customers2
18:26:52.088075 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
18:26:52.088497 [debug] [Thread-6  ]: finished collecting timing info
18:26:52.088641 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
18:26:52.093407 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
18:26:52.093663 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
18:26:52.094959 [debug] [Thread-1  ]: finished collecting timing info
18:26:52.095143 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
18:26:52.095577 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8a8046910>]}
18:26:52.097940 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.21s]
18:26:52.093812 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
18:26:52.099249 [debug] [Thread-4  ]: finished collecting timing info
18:26:52.099459 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
18:26:52.099739 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
18:26:52.109658 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8ab894ca0>]}
18:26:52.110059 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.20s]
18:26:52.110422 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
18:26:52.110579 [debug] [Thread-4  ]: Began running node model.first_project.my_second_dbt_model
18:26:52.116627 [info ] [Thread-4  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
18:26:52.117122 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
18:26:52.117488 [debug] [Thread-4  ]: Began compiling node model.first_project.my_second_dbt_model
18:26:52.117677 [debug] [Thread-4  ]: Compiling model.first_project.my_second_dbt_model
18:26:52.119953 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
18:26:52.120533 [debug] [Thread-4  ]: finished collecting timing info
18:26:52.116175 [debug] [Thread-8  ]: Began running node model.first_project.customers
18:26:52.122170 [info ] [Thread-8  ]: 7 of 7 START view model public.customers ....................................... [RUN]
18:26:52.122629 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
18:26:52.122761 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
18:26:52.122862 [debug] [Thread-8  ]: Compiling model.first_project.customers
18:26:52.095770 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:52.125859 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
18:26:52.125572 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
18:26:52.126035 [debug] [Thread-6  ]: Opening a new connection, currently in state init
18:26:52.126599 [debug] [Thread-8  ]: finished collecting timing info
18:26:52.120716 [debug] [Thread-4  ]: Began executing node model.first_project.my_second_dbt_model
18:26:52.127396 [debug] [Thread-8  ]: Began executing node model.first_project.customers
18:26:52.135721 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
18:26:52.138014 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
18:26:52.138609 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:52.141379 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: BEGIN
18:26:52.141544 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
18:26:52.142177 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:52.142385 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
18:26:52.142516 [debug] [Thread-8  ]: Opening a new connection, currently in state init
18:26:52.145069 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
18:26:52.145245 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:52.145338 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
18:26:52.147472 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.0 seconds
18:26:52.149633 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:52.149775 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
18:26:52.150157 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.151900 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:52.152045 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
18:26:52.152397 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.157531 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:26:52.161213 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:52.161411 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
18:26:52.162093 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
18:26:52.162270 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:52.162393 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
18:26:52.162677 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
18:26:52.162862 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:52.163101 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
18:26:52.164598 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:52.167345 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:52.167568 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.0 seconds
18:26:52.167743 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
18:26:52.169760 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:52.170077 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
18:26:52.170604 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.171742 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:52.171927 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
18:26:52.172186 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:52.174198 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:26:52.174445 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
18:26:52.176612 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
18:26:52.174859 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:52.174664 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: COMMIT
18:26:52.176803 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
18:26:52.177035 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
18:26:52.186538 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
18:26:52.188347 [debug] [Thread-4  ]: Using postgres connection "model.first_project.my_second_dbt_model"
18:26:52.188562 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
18:26:52.188964 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:52.189986 [debug] [Thread-4  ]: finished collecting timing info
18:26:52.190163 [debug] [Thread-4  ]: On model.first_project.my_second_dbt_model: Close
18:26:52.192336 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc880fee340>]}
18:26:52.192866 [info ] [Thread-4  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
18:26:52.193532 [debug] [Thread-4  ]: Finished running node model.first_project.my_second_dbt_model
18:26:52.194683 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.02 seconds
18:26:52.195932 [debug] [Thread-6  ]: finished collecting timing info
18:26:52.196117 [debug] [Thread-6  ]: On model.first_project.customers2: Close
18:26:52.196252 [debug] [Thread-8  ]: SQL status: COMMIT in 0.02 seconds
18:26:52.198049 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
18:26:52.198204 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
18:26:52.198565 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc880fb6fd0>]}
18:26:52.198980 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.11s]
18:26:52.199153 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
18:26:52.199616 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
18:26:52.200550 [debug] [Thread-8  ]: finished collecting timing info
18:26:52.200913 [debug] [Thread-8  ]: On model.first_project.customers: Close
18:26:52.201273 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ff318e69-1087-4b98-a5af-8290d9302bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc880fae8e0>]}
18:26:52.201569 [info ] [Thread-8  ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
18:26:52.202934 [debug] [Thread-8  ]: Finished running node model.first_project.customers
18:26:52.205920 [debug] [MainThread]: Acquiring new postgres connection "master"
18:26:52.206208 [debug] [MainThread]: Using postgres connection "master"
18:26:52.206349 [debug] [MainThread]: On master: BEGIN
18:26:52.206486 [debug] [MainThread]: Opening a new connection, currently in state closed
18:26:52.211956 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:26:52.212266 [debug] [MainThread]: On master: COMMIT
18:26:52.212407 [debug] [MainThread]: Using postgres connection "master"
18:26:52.212525 [debug] [MainThread]: On master: COMMIT
18:26:52.213021 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:26:52.213303 [debug] [MainThread]: On master: Close
18:26:52.214620 [info ] [MainThread]: 
18:26:52.215009 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.51s.
18:26:52.215204 [debug] [MainThread]: Connection 'master' was properly closed.
18:26:52.215303 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
18:26:52.215399 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
18:26:52.215556 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
18:26:52.215739 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
18:26:52.215853 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
18:26:52.215943 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
18:26:52.229831 [info ] [MainThread]: 
18:26:52.230189 [info ] [MainThread]: [32mCompleted successfully[0m
18:26:52.230419 [info ] [MainThread]: 
18:26:52.230610 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
18:26:52.230868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abe4a430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8abd82e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc8adffd0a0>]}


============================== 2022-06-04 18:27:04.057447 | 6e747e06-cd1f-4068-92dc-472633543760 ==============================
18:27:04.057467 [info ] [MainThread]: Running with dbt=1.1.0
18:27:04.058082 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'indirect_selection': 'eager', 'which': 'test', 'rpc_method': 'test'}
18:27:04.058234 [debug] [MainThread]: Tracking: tracking
18:27:04.062361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f447ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f4478e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f447be0>]}
18:27:04.092177 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
18:27:04.092546 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
18:27:04.099569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6e747e06-cd1f-4068-92dc-472633543760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f3750d0>]}
18:27:04.106599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6e747e06-cd1f-4068-92dc-472633543760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f3ca5e0>]}
18:27:04.106954 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 0 seed files, 1 source, 0 exposures, 0 metrics
18:27:04.107265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e747e06-cd1f-4068-92dc-472633543760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f3ca670>]}
18:27:04.108771 [info ] [MainThread]: 
18:27:04.109277 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:04.110885 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
18:27:04.119460 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:04.119987 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
18:27:04.120144 [debug] [ThreadPool]: Opening a new connection, currently in state init
18:27:04.132184 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
18:27:04.132460 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
18:27:04.132619 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
18:27:04.134560 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
18:27:04.136291 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
18:27:04.136695 [debug] [ThreadPool]: On list_erp_oltp_public: Close
18:27:04.140434 [debug] [MainThread]: Using postgres connection "master"
18:27:04.140609 [debug] [MainThread]: On master: BEGIN
18:27:04.140695 [debug] [MainThread]: Opening a new connection, currently in state init
18:27:04.145944 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:27:04.146169 [debug] [MainThread]: Using postgres connection "master"
18:27:04.146265 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
18:27:04.158435 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
18:27:04.159685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6e747e06-cd1f-4068-92dc-472633543760', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f3ca220>]}
18:27:04.159969 [debug] [MainThread]: On master: ROLLBACK
18:27:04.160234 [debug] [MainThread]: Using postgres connection "master"
18:27:04.160367 [debug] [MainThread]: On master: BEGIN
18:27:04.160661 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
18:27:04.160791 [debug] [MainThread]: On master: COMMIT
18:27:04.160915 [debug] [MainThread]: Using postgres connection "master"
18:27:04.160998 [debug] [MainThread]: On master: COMMIT
18:27:04.161168 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:04.161279 [debug] [MainThread]: On master: Close
18:27:04.161700 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
18:27:04.161981 [info ] [MainThread]: 
18:27:04.165796 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:04.165991 [info ] [Thread-1  ]: 1 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
18:27:04.166451 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:04.166601 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:04.166722 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:04.175612 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:04.175874 [debug] [Thread-3  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:27:04.178461 [info ] [Thread-3  ]: 3 of 5 START test relationships_stg_orders_customer_id__customer_id__ref_customers_  [RUN]
18:27:04.178849 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:27:04.176247 [info ] [Thread-2  ]: 2 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
18:27:04.179369 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:04.178968 [debug] [Thread-3  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:27:04.179709 [debug] [Thread-3  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:27:04.176118 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:04.187040 [info ] [Thread-5  ]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
18:27:04.179536 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:04.176021 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:04.189356 [info ] [Thread-4  ]: 4 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
18:27:04.186755 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:27:04.187420 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:04.189128 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:04.178196 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:04.189723 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:04.194704 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:04.194392 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:04.194823 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:04.190055 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:04.234631 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:04.235050 [debug] [Thread-3  ]: finished collecting timing info
18:27:04.235326 [debug] [Thread-2  ]: finished collecting timing info
18:27:04.235602 [debug] [Thread-1  ]: finished collecting timing info
18:27:04.240807 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:04.241447 [debug] [Thread-3  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:27:04.241640 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:04.256534 [debug] [Thread-2  ]: Writing runtime SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:04.244050 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:04.254984 [debug] [Thread-3  ]: Writing runtime SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:27:04.243795 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:04.258200 [debug] [Thread-1  ]: Writing runtime SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:04.258403 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:04.259193 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: BEGIN
18:27:04.259330 [debug] [Thread-2  ]: Opening a new connection, currently in state init
18:27:04.258630 [debug] [Thread-5  ]: finished collecting timing info
18:27:04.259505 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:04.260622 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:04.262717 [debug] [Thread-5  ]: Writing runtime SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:04.261339 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: BEGIN
18:27:04.261080 [debug] [Thread-4  ]: finished collecting timing info
18:27:04.262990 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
18:27:04.263634 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:04.264569 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: BEGIN
18:27:04.265292 [debug] [Thread-5  ]: Opening a new connection, currently in state init
18:27:04.263811 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:27:04.266246 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: BEGIN
18:27:04.266653 [debug] [Thread-3  ]: Opening a new connection, currently in state init
18:27:04.266527 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
18:27:04.266861 [debug] [Thread-2  ]: Using postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
18:27:04.266960 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_second_dbt_model"
where id is null



      
    ) dbt_internal_test
18:27:04.263964 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:04.269566 [debug] [Thread-4  ]: Writing runtime SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:04.269889 [debug] [Thread-2  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:04.271744 [debug] [Thread-2  ]: finished collecting timing info
18:27:04.271909 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: ROLLBACK
18:27:04.272450 [debug] [Thread-2  ]: On test.first_project.not_null_my_second_dbt_model_id.151b76d778: Close
18:27:04.273097 [info ] [Thread-2  ]: 2 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.09s]
18:27:04.273681 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
18:27:04.274428 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:04.274632 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: BEGIN
18:27:04.274787 [debug] [Thread-4  ]: Opening a new connection, currently in state init
18:27:04.281462 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
18:27:04.281710 [debug] [Thread-1  ]: Using postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
18:27:04.281823 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from "erp_oltp"."public"."my_first_dbt_model"
where id is null



      
    ) dbt_internal_test
18:27:04.282571 [debug] [Thread-1  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:04.283954 [debug] [Thread-1  ]: finished collecting timing info
18:27:04.284161 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: ROLLBACK
18:27:04.287661 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
18:27:04.287964 [debug] [Thread-4  ]: Using postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
18:27:04.288076 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_first_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:27:04.289261 [debug] [Thread-1  ]: On test.first_project.not_null_my_first_dbt_model_id.5fb22c2710: Close
18:27:04.289844 [error] [Thread-1  ]: 1 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.12s]
18:27:04.290103 [debug] [Thread-4  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:04.291823 [debug] [Thread-4  ]: finished collecting timing info
18:27:04.292143 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
18:27:04.290484 [debug] [Thread-5  ]: SQL status: BEGIN in 0.03 seconds
18:27:04.293139 [debug] [Thread-5  ]: Using postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
18:27:04.293277 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from "erp_oltp"."public"."my_second_dbt_model"
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
18:27:04.292511 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: ROLLBACK
18:27:04.293560 [debug] [Thread-4  ]: On test.first_project.unique_my_first_dbt_model_id.16e066b321: Close
18:27:04.294022 [info ] [Thread-4  ]: 4 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.10s]
18:27:04.294413 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
18:27:04.295430 [debug] [Thread-5  ]: SQL status: SELECT 1 in 0.0 seconds
18:27:04.296747 [debug] [Thread-5  ]: finished collecting timing info
18:27:04.296936 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: ROLLBACK
18:27:04.297843 [debug] [Thread-5  ]: On test.first_project.unique_my_second_dbt_model_id.57a0f8c493: Close
18:27:04.298257 [info ] [Thread-5  ]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.11s]
18:27:04.298614 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
18:27:04.303160 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
18:27:04.303406 [debug] [Thread-3  ]: Using postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
18:27:04.303525 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select customer_id as from_field
    from "erp_oltp"."public"."stg_orders"
    where customer_id is not null
),

parent as (
    select customer_id as to_field
    from "erp_oltp"."public"."customers"
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
18:27:04.321600 [debug] [Thread-3  ]: SQL status: SELECT 1 in 0.02 seconds
18:27:04.323149 [debug] [Thread-3  ]: finished collecting timing info
18:27:04.323377 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: ROLLBACK
18:27:04.323684 [debug] [Thread-3  ]: On test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf: Close
18:27:04.324129 [error] [Thread-3  ]: 3 of 5 FAIL 20 relationships_stg_orders_customer_id__customer_id__ref_customers_  [[31mFAIL 20[0m in 0.15s]
18:27:04.324604 [debug] [Thread-3  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
18:27:04.326217 [debug] [MainThread]: Acquiring new postgres connection "master"
18:27:04.326405 [debug] [MainThread]: Using postgres connection "master"
18:27:04.326515 [debug] [MainThread]: On master: BEGIN
18:27:04.326608 [debug] [MainThread]: Opening a new connection, currently in state closed
18:27:04.332155 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
18:27:04.332452 [debug] [MainThread]: On master: COMMIT
18:27:04.332629 [debug] [MainThread]: Using postgres connection "master"
18:27:04.332755 [debug] [MainThread]: On master: COMMIT
18:27:04.333023 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
18:27:04.333201 [debug] [MainThread]: On master: Close
18:27:04.333597 [info ] [MainThread]: 
18:27:04.333879 [info ] [MainThread]: Finished running 5 tests in 0.22s.
18:27:04.334131 [debug] [MainThread]: Connection 'master' was properly closed.
18:27:04.334229 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
18:27:04.334317 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
18:27:04.334402 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
18:27:04.334486 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
18:27:04.334570 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
18:27:04.339360 [info ] [MainThread]: 
18:27:04.339696 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
18:27:04.339937 [info ] [MainThread]: 
18:27:04.340117 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
18:27:04.340309 [error] [MainThread]:   Got 1 result, configured to fail if != 0
18:27:04.340525 [info ] [MainThread]: 
18:27:04.340697 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
18:27:04.340943 [info ] [MainThread]: 
18:27:04.341118 [error] [MainThread]: [31mFailure in test relationships_stg_orders_customer_id__customer_id__ref_customers_ (models/erp/schema.yml)[0m
18:27:04.341294 [error] [MainThread]:   Got 20 results, configured to fail if != 0
18:27:04.341467 [info ] [MainThread]: 
18:27:04.341621 [info ] [MainThread]:   compiled SQL at target/compiled/first_project/models/erp/schema.yml/relationships_stg_orders_ea624a80826c8a7f9bd15b85fd5d6316.sql
18:27:04.343527 [info ] [MainThread]: 
18:27:04.343801 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
18:27:04.344188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f375520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f3ca100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7faf6f2bfc70>]}


============================== 2022-06-04 18:31:51.883856 | 0f71b93f-007a-48ac-8a5e-b69a89c66ad8 ==============================
18:31:51.883868 [info ] [MainThread]: Running with dbt=1.1.0
18:31:51.884280 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'target': 'prod', 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
18:31:51.884403 [debug] [MainThread]: Tracking: tracking
18:31:51.887848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a7905fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a79050a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a7905d90>]}
18:31:51.953651 [debug] [MainThread]: Executing "git --help"
18:31:51.985274 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
18:31:51.985734 [debug] [MainThread]: STDERR: "b''"
18:31:51.986358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a6072c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a60910a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2a6091d90>]}


============================== 2022-06-04 20:29:29.704719 | 159d487b-c223-47b5-b110-a2d205c7aa74 ==============================
20:29:29.704738 [info ] [MainThread]: Running with dbt=1.1.0
20:29:29.713546 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:29:29.713708 [debug] [MainThread]: Tracking: tracking
20:29:29.717502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8e43f100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8e43fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8e43fe20>]}
20:29:29.733096 [info ] [MainThread]: Unable to do partial parsing because profile has changed
20:29:29.733447 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8e450b80>]}
20:29:29.742784 [debug] [MainThread]: Parsing macros/catalog.sql
20:29:29.746307 [debug] [MainThread]: Parsing macros/relations.sql
20:29:29.748062 [debug] [MainThread]: Parsing macros/adapters.sql
20:29:29.767175 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
20:29:29.768794 [debug] [MainThread]: Parsing macros/materializations/configs.sql
20:29:29.770786 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
20:29:29.774603 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
20:29:29.784290 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
20:29:29.798117 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
20:29:29.813250 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
20:29:29.817384 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
20:29:29.818765 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
20:29:29.819903 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
20:29:29.821895 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
20:29:29.824237 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
20:29:29.830056 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
20:29:29.836065 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
20:29:29.838546 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
20:29:29.852890 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
20:29:29.858178 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
20:29:29.859765 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
20:29:29.863652 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
20:29:29.865198 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
20:29:29.875722 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
20:29:29.890485 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
20:29:29.900187 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
20:29:29.901922 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
20:29:29.903986 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
20:29:29.905278 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
20:29:29.906490 [debug] [MainThread]: Parsing macros/adapters/columns.sql
20:29:29.914997 [debug] [MainThread]: Parsing macros/adapters/relation.sql
20:29:29.923061 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
20:29:29.925569 [debug] [MainThread]: Parsing macros/adapters/schema.sql
20:29:29.927499 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
20:29:29.929759 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
20:29:29.935655 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
20:29:29.939392 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
20:29:29.940215 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
20:29:29.940955 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
20:29:29.941522 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
20:29:29.942661 [debug] [MainThread]: Parsing macros/etc/datetime.sql
20:29:29.950458 [debug] [MainThread]: Parsing macros/etc/statement.sql
20:29:29.955664 [debug] [MainThread]: Parsing tests/generic/builtin.sql
20:29:30.133656 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
20:29:30.144159 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
20:29:30.147479 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
20:29:30.150580 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
20:29:30.153124 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
20:29:30.155240 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
20:29:30.157101 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
20:29:30.234575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8df06130>]}
20:29:30.239104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8e43fe20>]}
20:29:30.239367 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:29:30.239597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8e3d1fa0>]}
20:29:30.240996 [info ] [MainThread]: 
20:29:30.241441 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:30.242456 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:29:30.254263 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:29:30.254504 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:29:30.254607 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:29:30.261058 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:29:30.262288 [debug] [ThreadPool]: On list_erp_oltp: Close
20:29:30.263744 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:29:30.270798 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:30.271001 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:29:30.271093 [debug] [ThreadPool]: Opening a new connection, currently in state closed
20:29:30.276105 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
20:29:30.276319 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:29:30.276430 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:29:30.290783 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.01 seconds
20:29:30.291916 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:29:30.292217 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:29:30.296125 [debug] [MainThread]: Using postgres connection "master"
20:29:30.296317 [debug] [MainThread]: On master: BEGIN
20:29:30.296441 [debug] [MainThread]: Opening a new connection, currently in state init
20:29:30.301845 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:29:30.302025 [debug] [MainThread]: Using postgres connection "master"
20:29:30.302122 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:29:30.318077 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
20:29:30.319565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8df060a0>]}
20:29:30.319907 [debug] [MainThread]: On master: ROLLBACK
20:29:30.320275 [debug] [MainThread]: Using postgres connection "master"
20:29:30.320440 [debug] [MainThread]: On master: BEGIN
20:29:30.320783 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:30.320910 [debug] [MainThread]: On master: COMMIT
20:29:30.321008 [debug] [MainThread]: Using postgres connection "master"
20:29:30.321096 [debug] [MainThread]: On master: COMMIT
20:29:30.321278 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:30.321397 [debug] [MainThread]: On master: Close
20:29:30.321838 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:29:30.322154 [info ] [MainThread]: 
20:29:30.326298 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:29:30.326639 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:29:30.327052 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:29:30.327209 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:29:30.327333 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:29:30.330315 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:29:30.330627 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:29:30.330841 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:29:30.331437 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
20:29:30.331184 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:29:30.331832 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:29:30.332624 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:29:30.332747 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:29:30.332402 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:29:30.335310 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:29:30.335447 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:29:30.337376 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:29:30.337705 [debug] [Thread-2  ]: finished collecting timing info
20:29:30.338084 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:29:30.330985 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:29:30.350529 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:29:30.351364 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:29:30.351593 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:29:30.351762 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:29:30.333872 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:29:30.354073 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:29:30.334472 [debug] [Thread-1  ]: finished collecting timing info
20:29:30.363083 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:29:30.368482 [debug] [Thread-4  ]: finished collecting timing info
20:29:30.368757 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:29:30.372756 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:29:30.373209 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:30.373325 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:29:30.373401 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:29:30.374022 [debug] [Thread-3  ]: finished collecting timing info
20:29:30.373914 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:29:30.385787 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:29:30.386401 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:30.393606 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:29:30.395952 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:29:30.396218 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:29:30.396621 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:30.396832 [debug] [Thread-2  ]: Opening a new connection, currently in state init
20:29:30.396999 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:29:30.397236 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:29:30.397824 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:30.397931 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:29:30.398007 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:29:30.400364 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
20:29:30.400499 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:30.400631 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
20:29:30.403218 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:29:30.403399 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:30.403631 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:29:30.408339 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
20:29:30.413631 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:30.413880 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
20:29:30.414015 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
20:29:30.416281 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:30.416408 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:29:30.414452 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:30.414354 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
20:29:30.416687 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:30.416560 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
20:29:30.416782 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
20:29:30.414195 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:29:30.416979 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.418626 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:30.418756 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:29:30.420019 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.425257 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:30.425423 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
20:29:30.427538 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:30.425647 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
20:29:30.427668 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:29:30.425515 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
20:29:30.430851 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:30.429277 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:30.430990 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.432640 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:30.432793 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:29:30.431077 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:29:30.431200 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:29:30.425802 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:30.433102 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:29:30.433369 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.433532 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.437607 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:30.439399 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:30.439987 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:29:30.439699 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:30.439533 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
20:29:30.440144 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:29:30.441219 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:30.442007 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:30.441640 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
20:29:30.442126 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:29:30.441398 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.446678 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:29:30.447820 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:29:30.447982 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:29:30.448146 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:30.448584 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:29:30.450071 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:29:30.451808 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:29:30.451985 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:29:30.456415 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
20:29:30.457923 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:29:30.458067 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:29:30.458173 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
20:29:30.460327 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:29:30.460466 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:29:30.465760 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
20:29:30.466702 [debug] [Thread-4  ]: finished collecting timing info
20:29:30.466915 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:29:30.469665 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8c625a00>]}
20:29:30.469948 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.12s]
20:29:30.470234 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:29:30.472481 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
20:29:30.473800 [debug] [Thread-2  ]: finished collecting timing info
20:29:30.473953 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
20:29:30.474170 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:29:30.474991 [debug] [Thread-1  ]: finished collecting timing info
20:29:30.475273 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:29:30.475645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8deccc40>]}
20:29:30.475911 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.15s]
20:29:30.476765 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8c64a7f0>]}
20:29:30.476998 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.14s]
20:29:30.477392 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:29:30.477775 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:29:30.477909 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
20:29:30.478092 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:29:30.478351 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:29:30.478435 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
20:29:30.478509 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
20:29:30.479931 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:29:30.480180 [debug] [Thread-6  ]: finished collecting timing info
20:29:30.480288 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
20:29:30.484001 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:29:30.484317 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.03 seconds
20:29:30.485714 [debug] [Thread-3  ]: finished collecting timing info
20:29:30.485858 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:29:30.486044 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:30.486162 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
20:29:30.486239 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:29:30.487779 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8c5ebcd0>]}
20:29:30.488057 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.16s]
20:29:30.488439 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:29:30.488879 [debug] [Thread-8  ]: Began running node model.first_project.customers
20:29:30.489138 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
20:29:30.489604 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
20:29:30.489744 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
20:29:30.489884 [debug] [Thread-8  ]: Compiling model.first_project.customers
20:29:30.492774 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
20:29:30.493086 [debug] [Thread-9  ]: Began running node model.first_project.customers2
20:29:30.493431 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
20:29:30.493943 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
20:29:30.494081 [debug] [Thread-8  ]: finished collecting timing info
20:29:30.494198 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
20:29:30.494347 [debug] [Thread-8  ]: Began executing node model.first_project.customers
20:29:30.494471 [debug] [Thread-9  ]: Compiling model.first_project.customers2
20:29:30.496660 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
20:29:30.499447 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:29:30.499558 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
20:29:30.499640 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:29:30.499022 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
20:29:30.500106 [debug] [Thread-9  ]: finished collecting timing info
20:29:30.500243 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
20:29:30.502862 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
20:29:30.503260 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:29:30.503384 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
20:29:30.503463 [debug] [Thread-9  ]: Opening a new connection, currently in state init
20:29:30.506935 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
20:29:30.507141 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:29:30.507240 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
20:29:30.507571 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
20:29:30.507730 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:30.507838 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:29:30.510286 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
20:29:30.513833 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:30.514068 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
20:29:30.514248 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:29:30.516363 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:29:30.516851 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:29:30.517190 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.518278 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:30.518437 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:30.518564 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.519789 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
20:29:30.521239 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:29:30.521538 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:29:30.521658 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
20:29:30.522117 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
20:29:30.522254 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:29:30.522345 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
20:29:30.527530 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
20:29:30.529150 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:29:30.529301 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:29:30.529616 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:30.530661 [debug] [Thread-6  ]: finished collecting timing info
20:29:30.530825 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
20:29:30.533021 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8c5c81c0>]}
20:29:30.533370 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.05s]
20:29:30.533751 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
20:29:30.535535 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
20:29:30.536800 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
20:29:30.536929 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:29:30.537207 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
20:29:30.538142 [debug] [Thread-8  ]: finished collecting timing info
20:29:30.538291 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.02 seconds
20:29:30.538480 [debug] [Thread-8  ]: On model.first_project.customers: Close
20:29:30.541191 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:29:30.541449 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
20:29:30.541846 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
20:29:30.543306 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:29:30.543433 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
20:29:30.543765 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8c5b09a0>]}
20:29:30.545165 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
20:29:30.549575 [debug] [Thread-8  ]: Finished running node model.first_project.customers
20:29:30.549951 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.01 seconds
20:29:30.551668 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
20:29:30.551831 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:29:30.551918 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
20:29:30.558063 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
20:29:30.563747 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
20:29:30.564022 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
20:29:30.574202 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.01 seconds
20:29:30.575456 [debug] [Thread-9  ]: finished collecting timing info
20:29:30.575648 [debug] [Thread-9  ]: On model.first_project.customers2: Close
20:29:30.576917 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '159d487b-c223-47b5-b110-a2d205c7aa74', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8c576cd0>]}
20:29:30.577240 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
20:29:30.577654 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
20:29:30.581152 [debug] [MainThread]: Acquiring new postgres connection "master"
20:29:30.581603 [debug] [MainThread]: Using postgres connection "master"
20:29:30.581864 [debug] [MainThread]: On master: BEGIN
20:29:30.582052 [debug] [MainThread]: Opening a new connection, currently in state closed
20:29:30.586909 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:29:30.587083 [debug] [MainThread]: On master: COMMIT
20:29:30.587169 [debug] [MainThread]: Using postgres connection "master"
20:29:30.587246 [debug] [MainThread]: On master: COMMIT
20:29:30.587443 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:29:30.587566 [debug] [MainThread]: On master: Close
20:29:30.587987 [info ] [MainThread]: 
20:29:30.588195 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.35s.
20:29:30.588330 [debug] [MainThread]: Connection 'master' was properly closed.
20:29:30.588400 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:29:30.588464 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:29:30.588583 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:29:30.588687 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:29:30.588750 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:29:30.588807 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:29:30.588864 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:29:30.597361 [info ] [MainThread]: 
20:29:30.599193 [info ] [MainThread]: [32mCompleted successfully[0m
20:29:30.599400 [info ] [MainThread]: 
20:29:30.599536 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:29:30.599757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8e388e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8de8a8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fac8de8a880>]}


============================== 2022-06-04 20:30:59.885182 | dbb0fe87-ac92-45cf-8c50-d8376817aac4 ==============================
20:30:59.885204 [info ] [MainThread]: Running with dbt=1.1.0
20:30:59.885744 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
20:30:59.885875 [debug] [MainThread]: Tracking: tracking
20:30:59.889411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ae03c4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ae03cd00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ae03c6d0>]}
20:30:59.914203 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:30:59.914446 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:30:59.921145 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0adef7f40>]}
20:30:59.926425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0adfcc940>]}
20:30:59.926745 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:30:59.926992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0adfcc9d0>]}
20:30:59.928460 [info ] [MainThread]: 
20:30:59.928905 [debug] [MainThread]: Acquiring new postgres connection "master"
20:30:59.929861 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:30:59.938049 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:30:59.938278 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:30:59.938386 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:30:59.945475 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:30:59.947509 [debug] [ThreadPool]: On list_erp_oltp: Close
20:30:59.948998 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:30:59.953968 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:30:59.954185 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:30:59.954282 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:30:59.961473 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:30:59.961721 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:30:59.961822 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:30:59.963667 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:30:59.964896 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:30:59.965182 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:30:59.968611 [debug] [MainThread]: Using postgres connection "master"
20:30:59.968840 [debug] [MainThread]: On master: BEGIN
20:30:59.968958 [debug] [MainThread]: Opening a new connection, currently in state init
20:30:59.974330 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:30:59.974511 [debug] [MainThread]: Using postgres connection "master"
20:30:59.974604 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:30:59.988958 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:30:59.990161 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ae03c6d0>]}
20:30:59.990466 [debug] [MainThread]: On master: ROLLBACK
20:30:59.990791 [debug] [MainThread]: Using postgres connection "master"
20:30:59.990925 [debug] [MainThread]: On master: BEGIN
20:30:59.991201 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:30:59.991319 [debug] [MainThread]: On master: COMMIT
20:30:59.991407 [debug] [MainThread]: Using postgres connection "master"
20:30:59.991485 [debug] [MainThread]: On master: COMMIT
20:30:59.991641 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:30:59.991752 [debug] [MainThread]: On master: Close
20:30:59.992095 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:30:59.992490 [info ] [MainThread]: 
20:30:59.996243 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
20:30:59.996551 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
20:30:59.996725 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
20:30:59.997096 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
20:30:59.997751 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
20:30:59.997915 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
20:30:59.997575 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
20:31:00.001028 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
20:31:00.001149 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
20:31:00.001237 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
20:31:00.002906 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
20:31:00.003262 [debug] [Thread-2  ]: finished collecting timing info
20:31:00.003417 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
20:30:59.997364 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
20:31:00.009687 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
20:31:00.010135 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
20:31:00.010254 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
20:31:00.010346 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
20:30:59.997269 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
20:30:59.999972 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
20:31:00.058505 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
20:31:00.058259 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
20:31:00.060973 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
20:31:00.061707 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
20:31:00.061833 [debug] [Thread-1  ]: finished collecting timing info
20:31:00.062147 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
20:31:00.062322 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
20:31:00.062512 [debug] [Thread-4  ]: finished collecting timing info
20:31:00.062674 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
20:31:00.070463 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
20:31:00.086115 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
20:31:00.087327 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
20:31:00.090292 [debug] [Thread-3  ]: finished collecting timing info
20:31:00.089740 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
20:31:00.090511 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
20:31:00.093275 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
20:31:00.087537 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:31:00.093625 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:31:00.093922 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:31:00.094391 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
20:31:00.094254 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
20:31:00.094079 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
20:31:00.094793 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:31:00.094632 [debug] [Thread-4  ]: Opening a new connection, currently in state init
20:31:00.094509 [debug] [Thread-3  ]: Opening a new connection, currently in state init
20:31:00.097008 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:31:00.097186 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
20:31:00.097424 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:00.104641 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:31:00.105089 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:31:00.105390 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
20:31:00.107696 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:31:00.107888 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:31:00.108032 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
20:31:00.108412 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
20:31:00.108584 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
20:31:00.108695 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:31:00.114601 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
20:31:00.114866 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
20:31:00.121427 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:31:00.121711 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
20:31:00.122360 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:31:00.122440 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
20:31:00.122077 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:31:00.122595 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
20:31:00.122254 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
20:31:00.123559 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
20:31:00.123740 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.125714 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:31:00.125986 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.130604 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:31:00.127865 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
20:31:00.127982 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
20:31:00.127656 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:31:00.132259 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:31:00.132757 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
20:31:00.130737 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
20:31:00.132963 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.132599 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
20:31:00.134888 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.134538 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:31:00.137115 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:31:00.137636 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
20:31:00.137356 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
20:31:00.138106 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.137485 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.134699 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.143460 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
20:31:00.144509 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:31:00.145460 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:31:00.150504 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:31:00.151528 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:31:00.151734 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:31:00.151900 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:31:00.152036 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:31:00.152191 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:31:00.152323 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
20:31:00.152460 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
20:31:00.152625 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
20:31:00.152757 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
20:31:00.158378 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
20:31:00.163189 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
20:31:00.163351 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
20:31:00.165012 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:31:00.165210 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
20:31:00.167670 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
20:31:00.166442 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
20:31:00.165327 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
20:31:00.169114 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
20:31:00.169235 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
20:31:00.168121 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
20:31:00.167880 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
20:31:00.171054 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
20:31:00.171961 [debug] [Thread-3  ]: finished collecting timing info
20:31:00.172097 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
20:31:00.172449 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0b021ca00>]}
20:31:00.172735 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.11s]
20:31:00.173101 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
20:31:00.173422 [debug] [Thread-6  ]: Began running node model.first_project.customers2
20:31:00.173620 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
20:31:00.173918 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
20:31:00.174020 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
20:31:00.174106 [debug] [Thread-6  ]: Compiling model.first_project.customers2
20:31:00.175777 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
20:31:00.176024 [debug] [Thread-6  ]: finished collecting timing info
20:31:00.176127 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
20:31:00.178378 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
20:31:00.178605 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
20:31:00.179566 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
20:31:00.180447 [debug] [Thread-1  ]: finished collecting timing info
20:31:00.180663 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:31:00.181948 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
20:31:00.181750 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
20:31:00.182102 [debug] [Thread-6  ]: Opening a new connection, currently in state init
20:31:00.181508 [debug] [Thread-2  ]: finished collecting timing info
20:31:00.184943 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0afe3c340>]}
20:31:00.186108 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.19s]
20:31:00.186435 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
20:31:00.185116 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
20:31:00.186972 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
20:31:00.188155 [info ] [Thread-8  ]: 6 of 7 START view model public.my_second_dbt_model ............................. [RUN]
20:31:00.188476 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
20:31:00.188617 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
20:31:00.188707 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
20:31:00.187845 [debug] [Thread-4  ]: finished collecting timing info
20:31:00.192267 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
20:31:00.191964 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
20:31:00.185778 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
20:31:00.192802 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac660160>]}
20:31:00.195150 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.18s]
20:31:00.195753 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac656f40>]}
20:31:00.196252 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.19s]
20:31:00.196566 [debug] [Thread-8  ]: finished collecting timing info
20:31:00.196872 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
20:31:00.197103 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
20:31:00.197791 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
20:31:00.198060 [debug] [Thread-10 ]: Began running node model.first_project.customers
20:31:00.202186 [info ] [Thread-10 ]: 7 of 7 START view model public.customers ....................................... [RUN]
20:31:00.202544 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
20:31:00.202680 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
20:31:00.202773 [debug] [Thread-10 ]: Compiling model.first_project.customers
20:31:00.200405 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
20:31:00.204835 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
20:31:00.205506 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
20:31:00.205650 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:31:00.205793 [debug] [Thread-10 ]: finished collecting timing info
20:31:00.205916 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
20:31:00.206076 [debug] [Thread-10 ]: Began executing node model.first_project.customers
20:31:00.211691 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
20:31:00.211983 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:31:00.212146 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: BEGIN
20:31:00.212309 [debug] [Thread-8  ]: Opening a new connection, currently in state init
20:31:00.212593 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:31:00.212715 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
20:31:00.212809 [debug] [Thread-10 ]: Opening a new connection, currently in state init
20:31:00.213730 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.01 seconds
20:31:00.215464 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:31:00.215811 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
20:31:00.217624 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.220912 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:31:00.221171 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
20:31:00.221524 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.222696 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
20:31:00.222914 [debug] [Thread-10 ]: SQL status: BEGIN in 0.01 seconds
20:31:00.223126 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:31:00.223313 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
20:31:00.223423 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:31:00.223669 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:31:00.223910 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
20:31:00.223783 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
20:31:00.223566 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
20:31:00.226375 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
20:31:00.229375 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:31:00.229522 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
20:31:00.230113 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.231333 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
20:31:00.231475 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:31:00.235045 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
20:31:00.235297 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
20:31:00.241167 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:31:00.241990 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
20:31:00.242386 [debug] [Thread-6  ]: SQL status: COMMIT in 0.02 seconds
20:31:00.243145 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
20:31:00.245540 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
20:31:00.247044 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
20:31:00.247246 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
20:31:00.247460 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:31:00.248395 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: COMMIT
20:31:00.248604 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
20:31:00.251036 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
20:31:00.251266 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
20:31:00.251753 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
20:31:00.252981 [debug] [Thread-10 ]: finished collecting timing info
20:31:00.253153 [debug] [Thread-10 ]: On model.first_project.customers: Close
20:31:00.255400 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac595be0>]}
20:31:00.255757 [info ] [Thread-10 ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.05s]
20:31:00.256318 [debug] [Thread-10 ]: Finished running node model.first_project.customers
20:31:00.256467 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
20:31:00.257642 [debug] [Thread-6  ]: finished collecting timing info
20:31:00.257812 [debug] [Thread-6  ]: On model.first_project.customers2: Close
20:31:00.258319 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac5fb730>]}
20:31:00.258829 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.08s]
20:31:00.259192 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
20:31:00.260607 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
20:31:00.261912 [debug] [Thread-8  ]: Using postgres connection "model.first_project.my_second_dbt_model"
20:31:00.262050 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
20:31:00.265350 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
20:31:00.266953 [debug] [Thread-8  ]: finished collecting timing info
20:31:00.267371 [debug] [Thread-8  ]: On model.first_project.my_second_dbt_model: Close
20:31:00.268279 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dbb0fe87-ac92-45cf-8c50-d8376817aac4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0ac66ca00>]}
20:31:00.269467 [info ] [Thread-8  ]: 6 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
20:31:00.269965 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
20:31:00.271515 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:00.271679 [debug] [MainThread]: Using postgres connection "master"
20:31:00.271778 [debug] [MainThread]: On master: BEGIN
20:31:00.271862 [debug] [MainThread]: Opening a new connection, currently in state closed
20:31:00.277439 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:31:00.277668 [debug] [MainThread]: On master: COMMIT
20:31:00.277769 [debug] [MainThread]: Using postgres connection "master"
20:31:00.277859 [debug] [MainThread]: On master: COMMIT
20:31:00.278037 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:00.279425 [debug] [MainThread]: On master: Close
20:31:00.280067 [info ] [MainThread]: 
20:31:00.280437 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.35s.
20:31:00.280674 [debug] [MainThread]: Connection 'master' was properly closed.
20:31:00.280921 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
20:31:00.281007 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
20:31:00.281101 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
20:31:00.281188 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
20:31:00.281265 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
20:31:00.281340 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
20:31:00.281414 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
20:31:00.286136 [info ] [MainThread]: 
20:31:00.286462 [info ] [MainThread]: [32mCompleted successfully[0m
20:31:00.286726 [info ] [MainThread]: 
20:31:00.286915 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
20:31:00.287188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0adfcc4c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0adfcc6a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff0adec8580>]}


============================== 2022-06-04 20:31:18.357630 | 18eec42e-3eff-48eb-9c27-c5a4d6829a3f ==============================
20:31:18.357648 [info ] [MainThread]: Running with dbt=1.1.0
20:31:18.358220 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:31:18.358375 [debug] [MainThread]: Tracking: tracking
20:31:18.362001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca510f0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca510ff10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca510f0d0>]}
20:31:18.388539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
20:31:18.388842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
20:31:18.394700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18eec42e-3eff-48eb-9c27-c5a4d6829a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca4fc30d0>]}
20:31:18.400039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18eec42e-3eff-48eb-9c27-c5a4d6829a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca50878b0>]}
20:31:18.400373 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 1 seed file, 1 source, 0 exposures, 0 metrics
20:31:18.400732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18eec42e-3eff-48eb-9c27-c5a4d6829a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca5087940>]}
20:31:18.402163 [info ] [MainThread]: 
20:31:18.402687 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:18.403551 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:31:18.413804 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:31:18.414022 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:31:18.414593 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:18.424269 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:31:18.425842 [debug] [ThreadPool]: On list_erp_oltp: Close
20:31:18.428943 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:31:18.433713 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:18.433898 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:31:18.433994 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:31:18.440369 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:31:18.440604 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:31:18.440705 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:31:18.442862 [debug] [ThreadPool]: SQL status: SELECT 15 in 0.0 seconds
20:31:18.444014 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:31:18.444337 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:31:18.448160 [debug] [MainThread]: Using postgres connection "master"
20:31:18.448404 [debug] [MainThread]: On master: BEGIN
20:31:18.448500 [debug] [MainThread]: Opening a new connection, currently in state init
20:31:18.455640 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:31:18.455996 [debug] [MainThread]: Using postgres connection "master"
20:31:18.456154 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:31:18.469327 [debug] [MainThread]: SQL status: SELECT 6 in 0.01 seconds
20:31:18.470559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18eec42e-3eff-48eb-9c27-c5a4d6829a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca50874f0>]}
20:31:18.470859 [debug] [MainThread]: On master: ROLLBACK
20:31:18.471182 [debug] [MainThread]: Using postgres connection "master"
20:31:18.471320 [debug] [MainThread]: On master: BEGIN
20:31:18.471715 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:31:18.472047 [debug] [MainThread]: On master: COMMIT
20:31:18.472249 [debug] [MainThread]: Using postgres connection "master"
20:31:18.472451 [debug] [MainThread]: On master: COMMIT
20:31:18.472752 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:18.472911 [debug] [MainThread]: On master: Close
20:31:18.473424 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:31:18.473644 [info ] [MainThread]: 
20:31:18.477014 [debug] [Thread-1  ]: Began running node seed.first_project.code-country
20:31:18.477270 [info ] [Thread-1  ]: 1 of 1 START seed file public.code-country ..................................... [RUN]
20:31:18.477623 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:31:18.477746 [debug] [Thread-1  ]: Began compiling node seed.first_project.code-country
20:31:18.477861 [debug] [Thread-1  ]: finished collecting timing info
20:31:18.477953 [debug] [Thread-1  ]: Began executing node seed.first_project.code-country
20:31:18.514135 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:18.514323 [debug] [Thread-1  ]: On seed.first_project.code-country: BEGIN
20:31:18.514428 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:31:18.519300 [debug] [Thread-1  ]: SQL status: BEGIN in 0.0 seconds
20:31:18.519513 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:18.519609 [debug] [Thread-1  ]: On seed.first_project.code-country: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.code-country"} */

    create table "erp_oltp"."public"."code-country" ("Name" text,"Code" text)
  
20:31:18.547447 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.03 seconds
20:31:18.683436 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:18.683756 [debug] [Thread-1  ]: On seed.first_project.code-country: 
          insert into "erp_oltp"."public"."code-country" ("Name", "Code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
20:31:18.689378 [debug] [Thread-1  ]: SQL status: INSERT 0 249 in 0.01 seconds
20:31:18.693129 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.first_project.code-country"
20:31:18.702348 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:18.702540 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.code-country"
20:31:18.702642 [debug] [Thread-1  ]: On seed.first_project.code-country: COMMIT
20:31:18.708736 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:31:18.709453 [debug] [Thread-1  ]: finished collecting timing info
20:31:18.709684 [debug] [Thread-1  ]: On seed.first_project.code-country: Close
20:31:18.711689 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '18eec42e-3eff-48eb-9c27-c5a4d6829a3f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca4fc3610>]}
20:31:18.711949 [info ] [Thread-1  ]: 1 of 1 OK loaded seed file public.code-country ................................. [[32mINSERT 249[0m in 0.23s]
20:31:18.712286 [debug] [Thread-1  ]: Finished running node seed.first_project.code-country
20:31:18.713538 [debug] [MainThread]: Acquiring new postgres connection "master"
20:31:18.713706 [debug] [MainThread]: Using postgres connection "master"
20:31:18.713795 [debug] [MainThread]: On master: BEGIN
20:31:18.713871 [debug] [MainThread]: Opening a new connection, currently in state closed
20:31:18.719905 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:31:18.720152 [debug] [MainThread]: On master: COMMIT
20:31:18.720248 [debug] [MainThread]: Using postgres connection "master"
20:31:18.720342 [debug] [MainThread]: On master: COMMIT
20:31:18.720602 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:31:18.720829 [debug] [MainThread]: On master: Close
20:31:18.721275 [info ] [MainThread]: 
20:31:18.721484 [info ] [MainThread]: Finished running 1 seed in 0.32s.
20:31:18.721768 [debug] [MainThread]: Connection 'master' was properly closed.
20:31:18.721865 [debug] [MainThread]: Connection 'list_erp_oltp' was properly closed.
20:31:18.721938 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
20:31:18.726449 [info ] [MainThread]: 
20:31:18.726672 [info ] [MainThread]: [32mCompleted successfully[0m
20:31:18.726845 [info ] [MainThread]: 
20:31:18.726971 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
20:31:18.727171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca4faabb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca4faaf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4ca4faa4f0>]}


============================== 2022-06-04 20:35:04.788675 | e5cdc39a-5653-410a-9214-ad7767040795 ==============================
20:35:04.788694 [info ] [MainThread]: Running with dbt=1.1.0
20:35:04.789219 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'show': False, 'which': 'seed', 'rpc_method': 'seed', 'indirect_selection': 'eager'}
20:35:04.789346 [debug] [MainThread]: Tracking: tracking
20:35:04.793135 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d1874d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d1874040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d1874070>]}
20:35:04.820151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
20:35:04.820570 [debug] [MainThread]: Partial parsing: added file: first_project://seeds/alunos.csv
20:35:04.854122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e5cdc39a-5653-410a-9214-ad7767040795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d16f70d0>]}
20:35:04.859475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e5cdc39a-5653-410a-9214-ad7767040795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d176afd0>]}
20:35:04.859827 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
20:35:04.860090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5cdc39a-5653-410a-9214-ad7767040795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d176acd0>]}
20:35:04.861555 [info ] [MainThread]: 
20:35:04.861993 [debug] [MainThread]: Acquiring new postgres connection "master"
20:35:04.862878 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
20:35:04.872389 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
20:35:04.872680 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
20:35:04.872799 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:35:04.879460 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
20:35:04.882291 [debug] [ThreadPool]: On list_erp_oltp: Close
20:35:04.885344 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
20:35:04.920744 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:35:04.920974 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
20:35:04.921086 [debug] [ThreadPool]: Opening a new connection, currently in state init
20:35:04.926456 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
20:35:04.926676 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
20:35:04.926778 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
20:35:04.928599 [debug] [ThreadPool]: SQL status: SELECT 16 in 0.0 seconds
20:35:04.929790 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
20:35:04.930055 [debug] [ThreadPool]: On list_erp_oltp_public: Close
20:35:04.933862 [debug] [MainThread]: Using postgres connection "master"
20:35:04.934032 [debug] [MainThread]: On master: BEGIN
20:35:04.934134 [debug] [MainThread]: Opening a new connection, currently in state init
20:35:04.939216 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:35:04.939408 [debug] [MainThread]: Using postgres connection "master"
20:35:04.939507 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
20:35:04.955813 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
20:35:04.957175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e5cdc39a-5653-410a-9214-ad7767040795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d1874d90>]}
20:35:04.957519 [debug] [MainThread]: On master: ROLLBACK
20:35:04.957931 [debug] [MainThread]: Using postgres connection "master"
20:35:04.958082 [debug] [MainThread]: On master: BEGIN
20:35:04.958435 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
20:35:04.958591 [debug] [MainThread]: On master: COMMIT
20:35:04.958703 [debug] [MainThread]: Using postgres connection "master"
20:35:04.958800 [debug] [MainThread]: On master: COMMIT
20:35:04.959015 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:35:04.959150 [debug] [MainThread]: On master: Close
20:35:04.959510 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
20:35:04.959827 [info ] [MainThread]: 
20:35:04.965419 [debug] [Thread-1  ]: Began running node seed.first_project.alunos
20:35:04.965733 [info ] [Thread-1  ]: 1 of 2 START seed file public.alunos ........................................... [RUN]
20:35:04.966168 [debug] [Thread-1  ]: Acquiring new postgres connection "seed.first_project.alunos"
20:35:04.966305 [debug] [Thread-1  ]: Began compiling node seed.first_project.alunos
20:35:04.966430 [debug] [Thread-1  ]: finished collecting timing info
20:35:04.966538 [debug] [Thread-1  ]: Began executing node seed.first_project.alunos
20:35:04.975019 [debug] [Thread-2  ]: Began running node seed.first_project.code-country
20:35:04.984269 [info ] [Thread-2  ]: 2 of 2 START seed file public.code-country ..................................... [RUN]
20:35:04.991336 [debug] [Thread-2  ]: Acquiring new postgres connection "seed.first_project.code-country"
20:35:04.991541 [debug] [Thread-2  ]: Began compiling node seed.first_project.code-country
20:35:04.991668 [debug] [Thread-2  ]: finished collecting timing info
20:35:04.991893 [debug] [Thread-2  ]: Began executing node seed.first_project.code-country
20:35:05.013897 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.alunos"
20:35:05.016971 [debug] [Thread-1  ]: On seed.first_project.alunos: BEGIN
20:35:05.016576 [debug] [Thread-2  ]: Using postgres connection "seed.first_project.code-country"
20:35:05.017707 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
20:35:05.017939 [debug] [Thread-2  ]: On seed.first_project.code-country: BEGIN
20:35:05.018278 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
20:35:05.024341 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
20:35:05.024599 [debug] [Thread-2  ]: Using postgres connection "seed.first_project.code-country"
20:35:05.024706 [debug] [Thread-2  ]: On seed.first_project.code-country: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.code-country"} */
truncate table "erp_oltp"."public"."code-country"
20:35:05.024907 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
20:35:05.025058 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.alunos"
20:35:05.025150 [debug] [Thread-1  ]: On seed.first_project.alunos: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "seed.first_project.alunos"} */

    create table "erp_oltp"."public"."alunos" ("nome;idade" text)
  
20:35:05.049009 [debug] [Thread-2  ]: SQL status: TRUNCATE TABLE in 0.02 seconds
20:35:05.067930 [debug] [Thread-1  ]: SQL status: CREATE TABLE in 0.04 seconds
20:35:05.070229 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.alunos"
20:35:05.075672 [debug] [Thread-1  ]: On seed.first_project.alunos: 
          insert into "erp_oltp"."public"."alunos" ("nome;idade") values
          (%s),(%s),(%s)
      ...
20:35:05.092405 [debug] [Thread-1  ]: SQL status: INSERT 0 3 in 0.01 seconds
20:35:05.114675 [debug] [Thread-1  ]: Writing runtime SQL for node "seed.first_project.alunos"
20:35:05.150544 [debug] [Thread-1  ]: On seed.first_project.alunos: COMMIT
20:35:05.157841 [debug] [Thread-1  ]: Using postgres connection "seed.first_project.alunos"
20:35:05.163492 [debug] [Thread-1  ]: On seed.first_project.alunos: COMMIT
20:35:05.183397 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
20:35:05.191956 [debug] [Thread-1  ]: finished collecting timing info
20:35:05.192224 [debug] [Thread-1  ]: On seed.first_project.alunos: Close
20:35:05.195860 [debug] [Thread-2  ]: Using postgres connection "seed.first_project.code-country"
20:35:05.196247 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5cdc39a-5653-410a-9214-ad7767040795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d3090100>]}
20:35:05.196697 [info ] [Thread-1  ]: 1 of 2 OK loaded seed file public.alunos ....................................... [[32mINSERT 3[0m in 0.23s]
20:35:05.197046 [debug] [Thread-1  ]: Finished running node seed.first_project.alunos
20:35:05.196441 [debug] [Thread-2  ]: On seed.first_project.code-country: 
          insert into "erp_oltp"."public"."code-country" ("Name", "Code") values
          (%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,%s),(%s,...
20:35:05.198514 [debug] [Thread-2  ]: SQL status: INSERT 0 249 in 0.0 seconds
20:35:05.198797 [debug] [Thread-2  ]: Writing runtime SQL for node "seed.first_project.code-country"
20:35:05.200237 [debug] [Thread-2  ]: On seed.first_project.code-country: COMMIT
20:35:05.200369 [debug] [Thread-2  ]: Using postgres connection "seed.first_project.code-country"
20:35:05.200474 [debug] [Thread-2  ]: On seed.first_project.code-country: COMMIT
20:35:05.209141 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
20:35:05.209694 [debug] [Thread-2  ]: finished collecting timing info
20:35:05.209892 [debug] [Thread-2  ]: On seed.first_project.code-country: Close
20:35:05.218841 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e5cdc39a-5653-410a-9214-ad7767040795', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d1672250>]}
20:35:05.219257 [info ] [Thread-2  ]: 2 of 2 OK loaded seed file public.code-country ................................. [[32mINSERT 249[0m in 0.22s]
20:35:05.219595 [debug] [Thread-2  ]: Finished running node seed.first_project.code-country
20:35:05.221472 [debug] [MainThread]: Acquiring new postgres connection "master"
20:35:05.221948 [debug] [MainThread]: Using postgres connection "master"
20:35:05.222287 [debug] [MainThread]: On master: BEGIN
20:35:05.222552 [debug] [MainThread]: Opening a new connection, currently in state closed
20:35:05.228091 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
20:35:05.228344 [debug] [MainThread]: On master: COMMIT
20:35:05.228445 [debug] [MainThread]: Using postgres connection "master"
20:35:05.228537 [debug] [MainThread]: On master: COMMIT
20:35:05.228710 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
20:35:05.228845 [debug] [MainThread]: On master: Close
20:35:05.229200 [info ] [MainThread]: 
20:35:05.229417 [info ] [MainThread]: Finished running 2 seeds in 0.37s.
20:35:05.229574 [debug] [MainThread]: Connection 'master' was properly closed.
20:35:05.229656 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
20:35:05.229732 [debug] [MainThread]: Connection 'seed.first_project.alunos' was properly closed.
20:35:05.233400 [info ] [MainThread]: 
20:35:05.233625 [info ] [MainThread]: [32mCompleted successfully[0m
20:35:05.233824 [info ] [MainThread]: 
20:35:05.233981 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
20:35:05.234236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d372e100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d176ae20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f61d39f1d00>]}


============================== 2022-06-06 22:24:58.098137 | a1a673d4-679e-4abc-9196-47bf6145bf4a ==============================
22:24:58.098156 [info ] [MainThread]: Running with dbt=1.1.0
22:24:58.099416 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'config_dir': False, 'which': 'debug', 'indirect_selection': 'eager'}
22:24:58.099559 [debug] [MainThread]: Tracking: tracking
22:24:58.102770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9e58c280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9e58cf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9e58c250>]}
22:24:58.227940 [debug] [MainThread]: Executing "git --help"
22:24:58.232848 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone             Clone a repository into a new directory\n   init              Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add               Add file contents to the index\n   mv                Move or rename a file, a directory, or a symlink\n   restore           Restore working tree files\n   rm                Remove files from the working tree and from the index\n   sparse-checkout   Initialize and modify the sparse-checkout\n\nexamine the history and state (see also: git help revisions)\n   bisect            Use binary search to find the commit that introduced a bug\n   diff              Show changes between commits, commit and working tree, etc\n   grep              Print lines matching a pattern\n   log               Show commit logs\n   show              Show various types of objects\n   status            Show the working tree status\n\ngrow, mark and tweak your common history\n   branch            List, create, or delete branches\n   commit            Record changes to the repository\n   merge             Join two or more development histories together\n   rebase            Reapply commits on top of another base tip\n   reset             Reset current HEAD to the specified state\n   switch            Switch branches\n   tag               Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch             Download objects and refs from another repository\n   pull              Fetch from and integrate with another repository or a local branch\n   push              Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
22:24:58.233380 [debug] [MainThread]: STDERR: "b''"
22:24:58.238412 [debug] [MainThread]: Acquiring new postgres connection "debug"
22:24:58.239161 [debug] [MainThread]: Using postgres connection "debug"
22:24:58.239352 [debug] [MainThread]: On debug: select 1 as id
22:24:58.239496 [debug] [MainThread]: Opening a new connection, currently in state init
22:24:58.295845 [debug] [MainThread]: SQL status: SELECT 1 in 0.06 seconds
22:24:58.297213 [debug] [MainThread]: On debug: Close
22:24:58.297740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9ccfe820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9ccfe2b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7f9ccfebb0>]}
22:24:58.893157 [debug] [MainThread]: Connection 'debug' was properly closed.


============================== 2022-06-06 22:50:58.106346 | 6652bae3-92ec-445c-81d0-93c7e3981288 ==============================
22:50:58.106372 [info ] [MainThread]: Running with dbt=1.1.0
22:50:58.107337 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
22:50:58.107524 [debug] [MainThread]: Tracking: tracking
22:50:58.111805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa137e35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa137e3070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa137e3580>]}
22:50:58.143158 [info ] [MainThread]: Unable to do partial parsing because profile has changed
22:50:58.143641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6652bae3-92ec-445c-81d0-93c7e3981288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa137e6e80>]}
22:50:58.168264 [debug] [MainThread]: Parsing macros/catalog.sql
22:50:58.174085 [debug] [MainThread]: Parsing macros/relations.sql
22:50:58.175795 [debug] [MainThread]: Parsing macros/adapters.sql
22:50:58.201821 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
22:50:58.203819 [debug] [MainThread]: Parsing macros/materializations/configs.sql
22:50:58.206202 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
22:50:58.210312 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
22:50:58.221545 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
22:50:58.238752 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
22:50:58.258279 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
22:50:58.264199 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
22:50:58.266922 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
22:50:58.269345 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
22:50:58.272309 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
22:50:58.275347 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
22:50:58.283402 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
22:50:58.291787 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
22:50:58.295244 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
22:50:58.314176 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
22:50:58.322177 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
22:50:58.324446 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
22:50:58.329683 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
22:50:58.332099 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
22:50:58.346621 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
22:50:58.365929 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
22:50:58.377837 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
22:50:58.379908 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
22:50:58.383098 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
22:50:58.385093 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
22:50:58.386903 [debug] [MainThread]: Parsing macros/adapters/columns.sql
22:50:58.397878 [debug] [MainThread]: Parsing macros/adapters/relation.sql
22:50:58.411177 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
22:50:58.414992 [debug] [MainThread]: Parsing macros/adapters/schema.sql
22:50:58.417909 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
22:50:58.421845 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
22:50:58.430209 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
22:50:58.435720 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
22:50:58.436840 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
22:50:58.437851 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
22:50:58.438715 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
22:50:58.440380 [debug] [MainThread]: Parsing macros/etc/datetime.sql
22:50:58.449955 [debug] [MainThread]: Parsing macros/etc/statement.sql
22:50:58.455079 [debug] [MainThread]: Parsing tests/generic/builtin.sql
22:50:58.701619 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
22:50:58.715991 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
22:50:58.718754 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
22:50:58.721602 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
22:50:58.724705 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
22:50:58.727619 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
22:50:58.730126 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
22:50:58.835691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6652bae3-92ec-445c-81d0-93c7e3981288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa132be940>]}
22:50:58.841510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6652bae3-92ec-445c-81d0-93c7e3981288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa137e3b20>]}
22:50:58.841895 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
22:50:58.842177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6652bae3-92ec-445c-81d0-93c7e3981288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa150b4e50>]}
22:50:58.843941 [info ] [MainThread]: 
22:50:58.844438 [debug] [MainThread]: Acquiring new postgres connection "master"
22:50:58.845781 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
22:50:58.857721 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:50:58.858027 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
22:50:58.858157 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:58.867739 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:50:58.868091 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
22:50:58.868258 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
22:50:58.886351 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.02 seconds
22:50:58.888003 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
22:50:58.888469 [debug] [ThreadPool]: On list_erp_oltp_public: Close
22:50:58.892940 [debug] [MainThread]: Using postgres connection "master"
22:50:58.893172 [debug] [MainThread]: On master: BEGIN
22:50:58.893279 [debug] [MainThread]: Opening a new connection, currently in state init
22:50:58.899121 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
22:50:58.899363 [debug] [MainThread]: Using postgres connection "master"
22:50:58.899467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
22:50:58.928749 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
22:50:58.930190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6652bae3-92ec-445c-81d0-93c7e3981288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa13851bb0>]}
22:50:58.930499 [debug] [MainThread]: On master: ROLLBACK
22:50:58.930892 [debug] [MainThread]: On master: Close
22:50:58.931463 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
22:50:58.931765 [info ] [MainThread]: 
22:50:58.936901 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
22:50:58.937299 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
22:50:58.937475 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
22:50:58.937615 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
22:50:58.940286 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
22:50:58.940687 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
22:50:58.940914 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
22:50:58.942040 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
22:50:58.942212 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
22:50:58.942328 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
22:50:58.943541 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
22:50:58.941634 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
22:50:58.943950 [debug] [Thread-3  ]: finished collecting timing info
22:50:58.941306 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
22:50:58.944987 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
22:50:58.945123 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
22:50:58.944279 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
22:50:58.944508 [debug] [Thread-1  ]: finished collecting timing info
22:50:58.945237 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
22:50:58.946853 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
22:50:58.947019 [debug] [Thread-6  ]: finished collecting timing info
22:50:58.947210 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
22:50:58.945453 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
22:50:58.947333 [debug] [Thread-6  ]: finished collecting timing info
22:50:58.941192 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
22:50:58.953091 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
22:50:58.953403 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
22:50:58.953665 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
22:50:58.949948 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
22:50:58.941070 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
22:50:58.956609 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
22:50:58.956773 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
22:50:58.955955 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
22:50:58.957138 [debug] [Thread-5  ]: finished collecting timing info
22:50:58.957327 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
22:50:58.957530 [debug] [Thread-5  ]: finished collecting timing info
22:50:58.958128 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
22:50:58.944691 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
22:50:58.958667 [debug] [Thread-3  ]: finished collecting timing info
22:50:58.950499 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
22:50:58.958392 [debug] [Thread-2  ]: finished collecting timing info
22:50:58.961556 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
22:50:58.956899 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
22:50:58.959073 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
22:50:58.945641 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
22:50:58.964344 [debug] [Thread-1  ]: finished collecting timing info
22:50:58.963801 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
22:50:58.965362 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
22:50:58.961791 [debug] [Thread-2  ]: finished collecting timing info
22:50:58.965985 [debug] [Thread-8  ]: Began running node model.first_project.customers2
22:50:58.966741 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
22:50:58.966905 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
22:50:58.967621 [debug] [Thread-8  ]: Compiling model.first_project.customers2
22:50:58.967157 [debug] [Thread-4  ]: finished collecting timing info
22:50:58.966437 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
22:50:58.970461 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
22:50:58.971508 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
22:50:58.971679 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
22:50:58.971803 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
22:50:58.970908 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
22:50:58.974344 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
22:50:58.970595 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:58.970257 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
22:50:58.975612 [debug] [Thread-10 ]: finished collecting timing info
22:50:58.974664 [debug] [Thread-4  ]: finished collecting timing info
22:50:58.975119 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:50:58.976549 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:58.975769 [debug] [Thread-8  ]: finished collecting timing info
22:50:58.975928 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
22:50:58.976339 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
22:50:58.976678 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:58.970707 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:58.986609 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:50:58.976998 [debug] [Thread-10 ]: finished collecting timing info
22:50:58.987673 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
22:50:58.976826 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
22:50:58.987990 [debug] [Thread-8  ]: finished collecting timing info
22:50:58.988384 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
22:50:58.986899 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:58.986087 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
22:50:58.988614 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:58.987115 [debug] [Thread-3  ]: Began running node model.first_project.customers
22:50:58.989234 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:58.989519 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:58.996661 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
22:50:58.997216 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.customers"
22:50:58.997682 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:50:58.998050 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:50:58.999274 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:58.998604 [debug] [Thread-5  ]: finished collecting timing info
22:50:58.998905 [debug] [Thread-3  ]: Began compiling node model.first_project.customers
22:50:58.999110 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:58.999458 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:59.003526 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
22:50:58.999646 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:58.999849 [debug] [Thread-3  ]: Compiling model.first_project.customers
22:50:59.000005 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:58.998208 [debug] [Thread-7  ]: finished collecting timing info
22:50:59.005137 [debug] [Thread-5  ]: finished collecting timing info
22:50:59.008785 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.customers"
22:50:59.012574 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
22:50:59.013111 [debug] [Thread-6  ]: finished collecting timing info
22:50:59.014832 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:59.013811 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
22:50:59.014467 [debug] [Thread-1  ]: finished collecting timing info
22:50:59.014678 [debug] [Thread-3  ]: finished collecting timing info
22:50:59.013333 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:59.015093 [debug] [Thread-6  ]: finished collecting timing info
22:50:59.015399 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:59.015602 [debug] [Thread-3  ]: Began executing node model.first_project.customers
22:50:59.015773 [debug] [Thread-7  ]: finished collecting timing info
22:50:59.016199 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
22:50:59.016484 [debug] [Thread-1  ]: finished collecting timing info
22:50:59.016723 [debug] [Thread-3  ]: finished collecting timing info
22:50:59.017128 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
22:50:59.017672 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
22:50:59.018120 [debug] [Thread-3  ]: Finished running node model.first_project.customers
22:50:59.019010 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:59.019415 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:50:59.019574 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:59.019742 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:59.025215 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
22:50:59.025705 [debug] [Thread-4  ]: finished collecting timing info
22:50:59.025928 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:59.026058 [debug] [Thread-4  ]: finished collecting timing info
22:50:59.026440 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
22:50:59.028011 [debug] [MainThread]: Connection 'master' was properly closed.
22:50:59.028178 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
22:50:59.028282 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
22:50:59.028377 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
22:50:59.028469 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
22:50:59.028563 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
22:50:59.028654 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
22:50:59.028745 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
22:50:59.028838 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
22:50:59.028930 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
22:50:59.033979 [info ] [MainThread]: Done.
22:50:59.053061 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
22:50:59.053311 [info ] [MainThread]: Building catalog
22:50:59.055548 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
22:50:59.063276 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:50:59.063577 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
22:50:59.063745 [debug] [ThreadPool]: Opening a new connection, currently in state init
22:50:59.072380 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
22:50:59.072921 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
22:50:59.073762 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
22:50:59.095902 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.02 seconds
22:50:59.107402 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
22:50:59.108099 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
22:50:59.120299 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
22:50:59.120887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa137e35b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa101b99d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ffa101b9910>]}
22:50:59.693279 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
22:50:59.693746 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 22:52:37.644318 | df78615e-c60d-4055-8598-8adbaf97d9d5 ==============================
22:52:37.644339 [info ] [MainThread]: Running with dbt=1.1.0
22:52:37.644966 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
22:52:37.645197 [debug] [MainThread]: Tracking: tracking
22:52:37.649581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fdad325e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fdad32fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5fdad32250>]}
22:52:37.652467 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
22:52:37.652816 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
22:52:37.653028 [info ] [MainThread]: 
22:52:37.653209 [info ] [MainThread]: 
22:52:37.653487 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:04:06.478209 | e2a9ed00-c59f-4afb-a1f3-2109136d1a8d ==============================
23:04:06.478244 [info ] [MainThread]: Running with dbt=1.1.0
23:04:06.482793 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:04:06.483020 [debug] [MainThread]: Tracking: tracking
23:04:06.490956 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c10589d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c10589040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c10589070>]}
23:04:06.546907 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:04:06.547255 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:04:06.558362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2a9ed00-c59f-4afb-a1f3-2109136d1a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1043cfd0>]}
23:04:06.566663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2a9ed00-c59f-4afb-a1f3-2109136d1a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1051ac70>]}
23:04:06.567131 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:04:06.567439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a9ed00-c59f-4afb-a1f3-2109136d1a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1051abe0>]}
23:04:06.569754 [info ] [MainThread]: 
23:04:06.570455 [debug] [MainThread]: Acquiring new postgres connection "master"
23:04:06.571956 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:04:06.583303 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:04:06.583652 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:04:06.583828 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:04:06.593871 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:04:06.594215 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:04:06.594355 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:04:06.599413 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:04:06.602468 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:04:06.602989 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:04:06.609411 [debug] [MainThread]: Using postgres connection "master"
23:04:06.609683 [debug] [MainThread]: On master: BEGIN
23:04:06.609819 [debug] [MainThread]: Opening a new connection, currently in state init
23:04:06.617051 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:04:06.617339 [debug] [MainThread]: Using postgres connection "master"
23:04:06.617498 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:04:06.644037 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
23:04:06.646040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2a9ed00-c59f-4afb-a1f3-2109136d1a8d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c1051a490>]}
23:04:06.646505 [debug] [MainThread]: On master: ROLLBACK
23:04:06.646874 [debug] [MainThread]: On master: Close
23:04:06.647547 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:04:06.647902 [info ] [MainThread]: 
23:04:06.656248 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:04:06.656934 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:04:06.657183 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:04:06.657383 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:04:06.663083 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:04:06.663634 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:04:06.665345 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:04:06.665557 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:04:06.665701 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:04:06.664622 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
23:04:06.664748 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
23:04:06.669700 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:04:06.663946 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:04:06.670385 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:04:06.670540 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:04:06.670718 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:04:06.669940 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
23:04:06.674183 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
23:04:06.664451 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:04:06.668659 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:04:06.715668 [debug] [Thread-2  ]: finished collecting timing info
23:04:06.715920 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:04:06.714199 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:04:06.716304 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:04:06.716437 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:04:06.717564 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:04:06.716085 [debug] [Thread-2  ]: finished collecting timing info
23:04:06.718270 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:04:06.715158 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
23:04:06.673847 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:04:06.719778 [debug] [Thread-3  ]: finished collecting timing info
23:04:06.718837 [debug] [Thread-4  ]: finished collecting timing info
23:04:06.719140 [debug] [Thread-1  ]: finished collecting timing info
23:04:06.669256 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
23:04:06.720278 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:04:06.720822 [debug] [Thread-4  ]: finished collecting timing info
23:04:06.721255 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:04:06.720085 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:04:06.720471 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:04:06.720634 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
23:04:06.721491 [debug] [Thread-3  ]: finished collecting timing info
23:04:06.722316 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:04:06.719365 [debug] [Thread-6  ]: finished collecting timing info
23:04:06.721742 [debug] [Thread-1  ]: finished collecting timing info
23:04:06.721893 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
23:04:06.722665 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
23:04:06.722980 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:04:06.723230 [debug] [Thread-9  ]: Began running node model.first_project.customers2
23:04:06.724848 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
23:04:06.726030 [debug] [Thread-5  ]: finished collecting timing info
23:04:06.725115 [debug] [Thread-6  ]: finished collecting timing info
23:04:06.725486 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:04:06.725837 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
23:04:06.726204 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
23:04:06.727301 [debug] [Thread-5  ]: finished collecting timing info
23:04:06.726633 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
23:04:06.726850 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:04:06.727109 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
23:04:06.727731 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
23:04:06.723622 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:04:06.728024 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:04:06.728317 [debug] [Thread-9  ]: Compiling model.first_project.customers2
23:04:06.732105 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:04:06.734955 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
23:04:06.735817 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
23:04:06.736746 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:04:06.736998 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
23:04:06.737191 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
23:04:06.736016 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:06.736194 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:06.741054 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:04:06.742208 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:06.741424 [debug] [Thread-9  ]: finished collecting timing info
23:04:06.742830 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
23:04:06.742398 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:06.740514 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:04:06.742636 [debug] [Thread-8  ]: finished collecting timing info
23:04:06.741888 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:04:06.760257 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:06.759242 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:04:06.759708 [debug] [Thread-7  ]: finished collecting timing info
23:04:06.760428 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:06.743077 [debug] [Thread-9  ]: finished collecting timing info
23:04:06.760051 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:04:06.770153 [debug] [Thread-8  ]: finished collecting timing info
23:04:06.769640 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
23:04:06.768698 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:04:06.770667 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:04:06.760809 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
23:04:06.771807 [debug] [Thread-7  ]: finished collecting timing info
23:04:06.771596 [debug] [Thread-10 ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:06.769908 [debug] [Thread-2  ]: finished collecting timing info
23:04:06.772981 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:06.772739 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:04:06.772299 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
23:04:06.773795 [debug] [Thread-4  ]: finished collecting timing info
23:04:06.773485 [debug] [Thread-10 ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:06.773268 [debug] [Thread-2  ]: finished collecting timing info
23:04:06.774268 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:06.775912 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:04:06.774760 [debug] [Thread-1  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:06.776683 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:04:06.776069 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:06.777097 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:06.774461 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:06.776911 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:06.782503 [debug] [Thread-1  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:06.775092 [debug] [Thread-10 ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:06.781933 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:04:06.775580 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:04:06.782321 [debug] [Thread-4  ]: finished collecting timing info
23:04:06.786639 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:04:06.801259 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:04:06.803937 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:04:06.805007 [debug] [Thread-10 ]: finished collecting timing info
23:04:06.805240 [debug] [Thread-5  ]: finished collecting timing info
23:04:06.805466 [debug] [Thread-10 ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:06.805691 [debug] [Thread-1  ]: finished collecting timing info
23:04:06.806472 [debug] [Thread-1  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:06.806204 [debug] [Thread-10 ]: finished collecting timing info
23:04:06.805973 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:06.807719 [debug] [Thread-5  ]: finished collecting timing info
23:04:06.807385 [debug] [Thread-10 ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:04:06.806649 [debug] [Thread-1  ]: finished collecting timing info
23:04:06.809003 [debug] [Thread-1  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:04:06.808266 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:04:06.810682 [debug] [MainThread]: Connection 'master' was properly closed.
23:04:06.810957 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:04:06.811197 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:04:06.811352 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:04:06.811462 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
23:04:06.811564 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
23:04:06.811663 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:04:06.811761 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:04:06.811963 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:04:06.812066 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:04:06.812173 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:04:06.819394 [info ] [MainThread]: Done.
23:04:06.824479 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:04:06.824706 [info ] [MainThread]: Building catalog
23:04:06.827652 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:04:06.836220 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:04:06.836519 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:04:06.836656 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:04:06.843368 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:04:06.843629 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:04:06.843764 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:04:06.847559 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:04:06.858919 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:04:06.859535 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:04:06.869712 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:04:06.870688 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c10589d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c10473340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9c104735b0>]}
23:04:07.480388 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:04:07.481003 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:04:16.011181 | 13cc4925-e364-4e36-a78e-94d1319ecdc0 ==============================
23:04:16.011207 [info ] [MainThread]: Running with dbt=1.1.0
23:04:16.012363 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:04:16.012571 [debug] [MainThread]: Tracking: tracking
23:04:16.018629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa338e0e5e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa338e0efa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa338e0e250>]}
23:04:16.022769 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:04:16.023287 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:04:16.023530 [info ] [MainThread]: 
23:04:16.023739 [info ] [MainThread]: 
23:04:16.024016 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:34:00.502732 | 98d87df9-c46d-4e60-94c7-713b9e773e07 ==============================
23:34:00.502767 [info ] [MainThread]: Running with dbt=1.1.0
23:34:00.505585 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:34:00.505799 [debug] [MainThread]: Tracking: tracking
23:34:00.511709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f4587520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f4587c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f45875e0>]}
23:34:00.540847 [info ] [MainThread]: Unable to do partial parsing because profile has changed
23:34:00.541344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f4589160>]}
23:34:00.558234 [debug] [MainThread]: Parsing macros/catalog.sql
23:34:00.562177 [debug] [MainThread]: Parsing macros/relations.sql
23:34:00.563981 [debug] [MainThread]: Parsing macros/adapters.sql
23:34:00.598896 [debug] [MainThread]: Parsing macros/materializations/snapshot_merge.sql
23:34:00.601525 [debug] [MainThread]: Parsing macros/materializations/configs.sql
23:34:00.604965 [debug] [MainThread]: Parsing macros/materializations/hooks.sql
23:34:00.610699 [debug] [MainThread]: Parsing macros/materializations/models/incremental/incremental.sql
23:34:00.624701 [debug] [MainThread]: Parsing macros/materializations/models/incremental/on_schema_change.sql
23:34:00.647444 [debug] [MainThread]: Parsing macros/materializations/models/incremental/merge.sql
23:34:00.670892 [debug] [MainThread]: Parsing macros/materializations/models/incremental/column_helpers.sql
23:34:00.677617 [debug] [MainThread]: Parsing macros/materializations/models/incremental/is_incremental.sql
23:34:00.679693 [debug] [MainThread]: Parsing macros/materializations/models/view/helpers.sql
23:34:00.681650 [debug] [MainThread]: Parsing macros/materializations/models/view/create_view_as.sql
23:34:00.684705 [debug] [MainThread]: Parsing macros/materializations/models/view/create_or_replace_view.sql
23:34:00.688209 [debug] [MainThread]: Parsing macros/materializations/models/view/view.sql
23:34:00.696751 [debug] [MainThread]: Parsing macros/materializations/models/table/table.sql
23:34:00.708055 [debug] [MainThread]: Parsing macros/materializations/models/table/create_table_as.sql
23:34:00.712106 [debug] [MainThread]: Parsing macros/materializations/seeds/helpers.sql
23:34:00.733156 [debug] [MainThread]: Parsing macros/materializations/seeds/seed.sql
23:34:00.741976 [debug] [MainThread]: Parsing macros/materializations/tests/helpers.sql
23:34:00.744725 [debug] [MainThread]: Parsing macros/materializations/tests/test.sql
23:34:00.750483 [debug] [MainThread]: Parsing macros/materializations/tests/where_subquery.sql
23:34:00.753388 [debug] [MainThread]: Parsing macros/materializations/snapshots/helpers.sql
23:34:00.770271 [debug] [MainThread]: Parsing macros/materializations/snapshots/strategies.sql
23:34:00.792924 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot.sql
23:34:00.811336 [debug] [MainThread]: Parsing macros/materializations/snapshots/snapshot_merge.sql
23:34:00.813678 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_schema.sql
23:34:00.816988 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_database.sql
23:34:00.819134 [debug] [MainThread]: Parsing macros/get_custom_name/get_custom_alias.sql
23:34:00.821116 [debug] [MainThread]: Parsing macros/adapters/columns.sql
23:34:00.833253 [debug] [MainThread]: Parsing macros/adapters/relation.sql
23:34:00.846498 [debug] [MainThread]: Parsing macros/adapters/freshness.sql
23:34:00.850948 [debug] [MainThread]: Parsing macros/adapters/schema.sql
23:34:00.855648 [debug] [MainThread]: Parsing macros/adapters/indexes.sql
23:34:00.859292 [debug] [MainThread]: Parsing macros/adapters/metadata.sql
23:34:00.868597 [debug] [MainThread]: Parsing macros/adapters/persist_docs.sql
23:34:00.875022 [debug] [MainThread]: Parsing macros/generic_test_sql/not_null.sql
23:34:00.876321 [debug] [MainThread]: Parsing macros/generic_test_sql/relationships.sql
23:34:00.877428 [debug] [MainThread]: Parsing macros/generic_test_sql/unique.sql
23:34:00.878521 [debug] [MainThread]: Parsing macros/generic_test_sql/accepted_values.sql
23:34:00.880264 [debug] [MainThread]: Parsing macros/etc/datetime.sql
23:34:00.891767 [debug] [MainThread]: Parsing macros/etc/statement.sql
23:34:00.897648 [debug] [MainThread]: Parsing tests/generic/builtin.sql
23:34:01.173148 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers2.sql
23:34:01.187346 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_orders.sql
23:34:01.190267 [debug] [MainThread]: 1699: static parser successfully parsed erp/stg_customers.sql
23:34:01.193297 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
23:34:01.196089 [debug] [MainThread]: 1699: static parser successfully parsed example/my_first_dbt_model.sql
23:34:01.198948 [debug] [MainThread]: 1699: static parser successfully parsed example/my_second_dbt_model.sql
23:34:01.201646 [debug] [MainThread]: 1699: static parser successfully parsed postgres_sample_source/postgres_sample_source_customers.sql
23:34:01.310358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f405ef40>]}
23:34:01.315562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f45870a0>]}
23:34:01.315873 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:34:01.316097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f5e55dc0>]}
23:34:01.317592 [info ] [MainThread]: 
23:34:01.318055 [debug] [MainThread]: Acquiring new postgres connection "master"
23:34:01.319554 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
23:34:01.330026 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
23:34:01.330237 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
23:34:01.330349 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:34:01.337845 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
23:34:01.341451 [debug] [ThreadPool]: On list_erp_oltp: Close
23:34:01.345130 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:34:01.351274 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:34:01.351497 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:34:01.351612 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:34:01.357378 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:34:01.357646 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:34:01.357814 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:34:01.362600 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:34:01.364041 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:34:01.364419 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:34:01.368605 [debug] [MainThread]: Using postgres connection "master"
23:34:01.368792 [debug] [MainThread]: On master: BEGIN
23:34:01.368897 [debug] [MainThread]: Opening a new connection, currently in state init
23:34:01.374886 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:34:01.375145 [debug] [MainThread]: Using postgres connection "master"
23:34:01.375256 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:34:01.395824 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
23:34:01.397338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f405e6d0>]}
23:34:01.397687 [debug] [MainThread]: On master: ROLLBACK
23:34:01.398074 [debug] [MainThread]: Using postgres connection "master"
23:34:01.398268 [debug] [MainThread]: On master: BEGIN
23:34:01.401420 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:34:01.401658 [debug] [MainThread]: On master: COMMIT
23:34:01.401784 [debug] [MainThread]: Using postgres connection "master"
23:34:01.401898 [debug] [MainThread]: On master: COMMIT
23:34:01.402167 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:34:01.402343 [debug] [MainThread]: On master: Close
23:34:01.402983 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:34:01.403394 [info ] [MainThread]: 
23:34:01.408104 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:34:01.408473 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
23:34:01.408976 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:34:01.409132 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:34:01.409272 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:34:01.413822 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:34:01.414131 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:34:01.414977 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
23:34:01.414385 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:34:01.414680 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:34:01.416373 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
23:34:01.415899 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
23:34:01.418326 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:34:01.418479 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:34:01.418602 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:34:01.420556 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:34:01.420952 [debug] [Thread-3  ]: finished collecting timing info
23:34:01.421147 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:34:01.417418 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:34:01.439932 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:34:01.440501 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:34:01.442428 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:34:01.417845 [debug] [Thread-1  ]: finished collecting timing info
23:34:01.415542 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:34:01.443434 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:34:01.443686 [debug] [Thread-4  ]: finished collecting timing info
23:34:01.456233 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:34:01.455793 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
23:34:01.466341 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:34:01.477618 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:34:01.483102 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
23:34:01.486362 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
23:34:01.486801 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:34:01.489513 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:34:01.490161 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
23:34:01.490618 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:34:01.491369 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:34:01.491786 [debug] [Thread-3  ]: Opening a new connection, currently in state init
23:34:01.492026 [debug] [Thread-2  ]: finished collecting timing info
23:34:01.492728 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:34:01.492377 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
23:34:01.492201 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
23:34:01.496542 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:34:01.496322 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:34:01.496057 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
23:34:01.498403 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:34:01.498565 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
23:34:01.498678 [debug] [Thread-2  ]: Opening a new connection, currently in state init
23:34:01.500508 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
23:34:01.500731 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:34:01.500854 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
23:34:01.512814 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
23:34:01.513306 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
23:34:01.518795 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
23:34:01.521756 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:34:01.519189 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:34:01.522129 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
23:34:01.521943 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
23:34:01.521474 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:34:01.519019 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
23:34:01.522815 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:34:01.522973 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
23:34:01.522530 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
23:34:01.524574 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.527639 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:34:01.527894 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
23:34:01.528085 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
23:34:01.531202 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:34:01.531759 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
23:34:01.531968 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
23:34:01.534636 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:34:01.534862 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
23:34:01.535054 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
23:34:01.535540 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.537784 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:34:01.546583 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
23:34:01.538452 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.546269 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:34:01.538253 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
23:34:01.549424 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:34:01.549657 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.549901 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:34:01.553010 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:34:01.553698 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
23:34:01.557038 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:34:01.557327 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:34:01.557654 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
23:34:01.557959 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
23:34:01.558347 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.559160 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.566939 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:34:01.565571 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:34:01.567518 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:34:01.567166 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
23:34:01.567333 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:34:01.564856 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.01 seconds
23:34:01.567657 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:34:01.574650 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:34:01.574944 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:34:01.576483 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:34:01.577555 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:34:01.577684 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:34:01.577147 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
23:34:01.586507 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
23:34:01.588787 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:34:01.589060 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
23:34:01.591346 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
23:34:01.593115 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:34:01.593354 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
23:34:01.593592 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
23:34:01.595185 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:34:01.595465 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
23:34:01.600121 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.02 seconds
23:34:01.601246 [debug] [Thread-3  ]: finished collecting timing info
23:34:01.601454 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
23:34:01.603663 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec757e80>]}
23:34:01.604373 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.19s]
23:34:01.604580 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
23:34:01.606693 [debug] [Thread-2  ]: finished collecting timing info
23:34:01.605196 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:34:01.604717 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
23:34:01.606945 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
23:34:01.609114 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec740fa0>]}
23:34:01.608512 [debug] [Thread-6  ]: Began running node model.first_project.customers2
23:34:01.608189 [debug] [Thread-1  ]: finished collecting timing info
23:34:01.609525 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.19s]
23:34:01.609819 [info ] [Thread-6  ]: 5 of 7 START table model public.customers2 ..................................... [RUN]
23:34:01.610164 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
23:34:01.612064 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
23:34:01.613598 [debug] [Thread-4  ]: finished collecting timing info
23:34:01.613820 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
23:34:01.615743 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec740ac0>]}
23:34:01.616202 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.20s]
23:34:01.616635 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:34:01.616945 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers2"
23:34:01.617437 [debug] [Thread-6  ]: Began compiling node model.first_project.customers2
23:34:01.617552 [debug] [Thread-6  ]: Compiling model.first_project.customers2
23:34:01.617232 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87effbce20>]}
23:34:01.620370 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers2"
23:34:01.621645 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.21s]
23:34:01.622063 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:34:01.623563 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:34:01.627092 [debug] [Thread-6  ]: finished collecting timing info
23:34:01.627649 [debug] [Thread-6  ]: Began executing node model.first_project.customers2
23:34:01.631898 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.customers2"
23:34:01.633355 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:34:01.633827 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
23:34:01.634435 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:34:01.638554 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:34:01.638309 [debug] [Thread-9  ]: Began running node model.first_project.my_second_dbt_model
23:34:01.638802 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:34:01.639499 [info ] [Thread-9  ]: 7 of 7 START view model public.my_second_dbt_model ............................. [RUN]
23:34:01.643562 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:34:01.644854 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:34:01.645169 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
23:34:01.645564 [debug] [Thread-9  ]: Began compiling node model.first_project.my_second_dbt_model
23:34:01.646101 [debug] [Thread-8  ]: finished collecting timing info
23:34:01.646308 [debug] [Thread-6  ]: On model.first_project.customers2: BEGIN
23:34:01.646517 [debug] [Thread-9  ]: Compiling model.first_project.my_second_dbt_model
23:34:01.647049 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:34:01.647284 [debug] [Thread-6  ]: Opening a new connection, currently in state init
23:34:01.651793 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:34:01.654798 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
23:34:01.656324 [debug] [Thread-9  ]: finished collecting timing info
23:34:01.656528 [debug] [Thread-9  ]: Began executing node model.first_project.my_second_dbt_model
23:34:01.659500 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
23:34:01.659856 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:34:01.660117 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
23:34:01.660291 [debug] [Thread-8  ]: Opening a new connection, currently in state init
23:34:01.660623 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:34:01.661399 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: BEGIN
23:34:01.662103 [debug] [Thread-9  ]: Opening a new connection, currently in state init
23:34:01.664885 [debug] [Thread-6  ]: SQL status: BEGIN in 0.02 seconds
23:34:01.665128 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
23:34:01.665273 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
23:34:01.669225 [debug] [Thread-9  ]: SQL status: BEGIN in 0.01 seconds
23:34:01.669452 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:34:01.669572 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
23:34:01.672160 [debug] [Thread-9  ]: SQL status: CREATE VIEW in 0.0 seconds
23:34:01.676194 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:34:01.676679 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
23:34:01.677357 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.683217 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
23:34:01.683843 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
23:34:01.684097 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:34:01.684952 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
23:34:01.684634 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:34:01.684419 [debug] [Thread-6  ]: SQL status: SELECT 100 in 0.02 seconds
23:34:01.685252 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: COMMIT
23:34:01.688382 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
23:34:01.689234 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
23:34:01.689924 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.693693 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
23:34:01.693899 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
23:34:01.694422 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.696438 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
23:34:01.696622 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
23:34:01.696831 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
23:34:01.701307 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:34:01.704269 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
23:34:01.703982 [debug] [Thread-9  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:34:01.697037 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
23:34:01.704592 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
23:34:01.704800 [debug] [Thread-6  ]: On model.first_project.customers2: COMMIT
23:34:01.705544 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
23:34:01.706199 [debug] [Thread-9  ]: SQL status: DROP VIEW in 0.0 seconds
23:34:01.708123 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:34:01.709981 [debug] [Thread-9  ]: finished collecting timing info
23:34:01.710296 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:34:01.710611 [debug] [Thread-9  ]: On model.first_project.my_second_dbt_model: Close
23:34:01.711251 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:34:01.714360 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
23:34:01.716787 [debug] [Thread-6  ]: Using postgres connection "model.first_project.customers2"
23:34:01.717027 [debug] [Thread-6  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
23:34:01.717603 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec6ef610>]}
23:34:01.718221 [info ] [Thread-9  ]: 7 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
23:34:01.719861 [debug] [Thread-9  ]: Finished running node model.first_project.my_second_dbt_model
23:34:01.720128 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
23:34:01.723649 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:34:01.723958 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
23:34:01.724608 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
23:34:01.726158 [debug] [Thread-8  ]: finished collecting timing info
23:34:01.726792 [debug] [Thread-8  ]: On model.first_project.customers: Close
23:34:01.727469 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec68bbb0>]}
23:34:01.727902 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
23:34:01.728386 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:34:01.732446 [debug] [Thread-6  ]: SQL status: DROP TABLE in 0.01 seconds
23:34:01.733883 [debug] [Thread-6  ]: finished collecting timing info
23:34:01.734113 [debug] [Thread-6  ]: On model.first_project.customers2: Close
23:34:01.735650 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '98d87df9-c46d-4e60-94c7-713b9e773e07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec72cdf0>]}
23:34:01.736086 [info ] [Thread-6  ]: 5 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.12s]
23:34:01.737249 [debug] [Thread-6  ]: Finished running node model.first_project.customers2
23:34:01.743671 [debug] [MainThread]: Acquiring new postgres connection "master"
23:34:01.744003 [debug] [MainThread]: Using postgres connection "master"
23:34:01.744225 [debug] [MainThread]: On master: BEGIN
23:34:01.744368 [debug] [MainThread]: Opening a new connection, currently in state closed
23:34:01.756527 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:34:01.756851 [debug] [MainThread]: On master: COMMIT
23:34:01.756998 [debug] [MainThread]: Using postgres connection "master"
23:34:01.757204 [debug] [MainThread]: On master: COMMIT
23:34:01.757608 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:34:01.757885 [debug] [MainThread]: On master: Close
23:34:01.758593 [info ] [MainThread]: 
23:34:01.758993 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.44s.
23:34:01.759243 [debug] [MainThread]: Connection 'master' was properly closed.
23:34:01.759361 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
23:34:01.759501 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
23:34:01.759609 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
23:34:01.759715 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
23:34:01.759819 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:34:01.760048 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:34:01.760161 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:34:01.766565 [info ] [MainThread]: 
23:34:01.767067 [info ] [MainThread]: [32mCompleted successfully[0m
23:34:01.767416 [info ] [MainThread]: 
23:34:01.767642 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
23:34:01.768044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f5e55dc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87f405e820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f87ec6d16a0>]}


============================== 2022-06-06 23:34:20.380562 | 50644388-deaa-47e6-8c8e-820c775b4918 ==============================
23:34:20.380588 [info ] [MainThread]: Running with dbt=1.1.0
23:34:20.381263 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:34:20.381443 [debug] [MainThread]: Tracking: tracking
23:34:20.386121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b13ad580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b13adca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b13ad130>]}
23:34:20.418394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:34:20.418681 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:34:20.429661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50644388-deaa-47e6-8c8e-820c775b4918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b125ff40>]}
23:34:20.436461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50644388-deaa-47e6-8c8e-820c775b4918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b133db80>]}
23:34:20.436849 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:34:20.437197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50644388-deaa-47e6-8c8e-820c775b4918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b133dbb0>]}
23:34:20.439382 [info ] [MainThread]: 
23:34:20.440019 [debug] [MainThread]: Acquiring new postgres connection "master"
23:34:20.441624 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:34:20.454152 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:34:20.454490 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:34:20.454802 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:34:20.466420 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:34:20.466756 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:34:20.466894 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:34:20.469185 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:34:20.471241 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:34:20.471580 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:34:20.478009 [debug] [MainThread]: Using postgres connection "master"
23:34:20.478297 [debug] [MainThread]: On master: BEGIN
23:34:20.478420 [debug] [MainThread]: Opening a new connection, currently in state init
23:34:20.485760 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:34:20.486033 [debug] [MainThread]: Using postgres connection "master"
23:34:20.486181 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:34:20.512333 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
23:34:20.513998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50644388-deaa-47e6-8c8e-820c775b4918', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b133d370>]}
23:34:20.514389 [debug] [MainThread]: On master: ROLLBACK
23:34:20.514781 [debug] [MainThread]: On master: Close
23:34:20.515413 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:34:20.515706 [info ] [MainThread]: 
23:34:20.521623 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:34:20.522166 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:34:20.522368 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:34:20.522533 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:34:20.525476 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:34:20.525963 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:34:20.526795 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:34:20.526999 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:34:20.527205 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:34:20.529863 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:34:20.530272 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:34:20.530530 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:34:20.532232 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:34:20.532408 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:34:20.532543 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:34:20.531402 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
23:34:20.535100 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:34:20.535297 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
23:34:20.535430 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
23:34:20.531209 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
23:34:20.579541 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
23:34:20.579776 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
23:34:20.579893 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
23:34:20.580873 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
23:34:20.581066 [debug] [Thread-5  ]: finished collecting timing info
23:34:20.579042 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
23:34:20.534526 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:34:20.581712 [debug] [Thread-4  ]: finished collecting timing info
23:34:20.581192 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
23:34:20.531778 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:34:20.530881 [debug] [Thread-2  ]: finished collecting timing info
23:34:20.531009 [debug] [Thread-1  ]: finished collecting timing info
23:34:20.581916 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:34:20.581371 [debug] [Thread-6  ]: finished collecting timing info
23:34:20.582335 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:34:20.583247 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:34:20.582518 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:34:20.582738 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:34:20.582925 [debug] [Thread-4  ]: finished collecting timing info
23:34:20.584263 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:34:20.585517 [debug] [Thread-3  ]: finished collecting timing info
23:34:20.585682 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:34:20.584448 [debug] [Thread-2  ]: finished collecting timing info
23:34:20.584626 [debug] [Thread-1  ]: finished collecting timing info
23:34:20.585156 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:34:20.585796 [debug] [Thread-3  ]: finished collecting timing info
23:34:20.587290 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:34:20.582116 [debug] [Thread-5  ]: finished collecting timing info
23:34:20.586186 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:34:20.586679 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:34:20.583117 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
23:34:20.587679 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:34:20.589313 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:34:20.588117 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
23:34:20.588657 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
23:34:20.589840 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:34:20.588902 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:34:20.590322 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:34:20.590481 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:34:20.590641 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:34:20.587810 [debug] [Thread-9  ]: Began running node model.first_project.customers2
23:34:20.600929 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
23:34:20.601107 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
23:34:20.601220 [debug] [Thread-9  ]: Compiling model.first_project.customers2
23:34:20.589963 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
23:34:20.600311 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:34:20.589459 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:34:20.588786 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:34:20.603726 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
23:34:20.603537 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
23:34:20.589026 [debug] [Thread-6  ]: finished collecting timing info
23:34:20.604189 [debug] [Thread-3  ]: finished collecting timing info
23:34:20.604646 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:34:20.604993 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:34:20.607863 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:34:20.612231 [debug] [Thread-7  ]: finished collecting timing info
23:34:20.608996 [debug] [Thread-9  ]: finished collecting timing info
23:34:20.612567 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
23:34:20.611613 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:34:20.611839 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:34:20.612389 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
23:34:20.613318 [debug] [Thread-7  ]: finished collecting timing info
23:34:20.612720 [debug] [Thread-9  ]: finished collecting timing info
23:34:20.614129 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
23:34:20.612938 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:34:20.613162 [debug] [Thread-8  ]: finished collecting timing info
23:34:20.613702 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
23:34:20.608689 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
23:34:20.609272 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:34:20.622452 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:34:20.622884 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:34:20.623545 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:34:20.624974 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:34:20.623887 [debug] [Thread-3  ]: finished collecting timing info
23:34:20.625108 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:34:20.625763 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:34:20.624668 [debug] [Thread-8  ]: finished collecting timing info
23:34:20.629660 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:34:20.629194 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:34:20.623715 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:34:20.625563 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:34:20.630174 [debug] [Thread-10 ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:34:20.630496 [debug] [Thread-4  ]: finished collecting timing info
23:34:20.630699 [debug] [Thread-2  ]: finished collecting timing info
23:34:20.631811 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:34:20.631472 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:34:20.631639 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:34:20.632067 [debug] [Thread-10 ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:34:20.632381 [debug] [Thread-10 ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:34:20.631952 [debug] [Thread-2  ]: finished collecting timing info
23:34:20.639999 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:34:20.632229 [debug] [Thread-4  ]: finished collecting timing info
23:34:20.639478 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:34:20.630999 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:34:20.642027 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:34:20.642237 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:34:20.641687 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:34:20.646113 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:34:20.646361 [debug] [Thread-10 ]: finished collecting timing info
23:34:20.646929 [debug] [Thread-10 ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:34:20.647161 [debug] [Thread-10 ]: finished collecting timing info
23:34:20.647616 [debug] [Thread-10 ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:34:20.647815 [debug] [Thread-6  ]: finished collecting timing info
23:34:20.648041 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:34:20.648174 [debug] [Thread-6  ]: finished collecting timing info
23:34:20.648528 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:34:20.650018 [debug] [MainThread]: Connection 'master' was properly closed.
23:34:20.650156 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
23:34:20.650264 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:34:20.650432 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:34:20.650527 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:34:20.650618 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:34:20.650737 [debug] [MainThread]: Connection 'seed.first_project.alunos' was properly closed.
23:34:20.650844 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:34:20.650945 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:34:20.651045 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:34:20.651262 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:34:20.659594 [info ] [MainThread]: Done.
23:34:20.661992 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:34:20.662221 [info ] [MainThread]: Building catalog
23:34:20.664709 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:34:20.673622 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:34:20.675489 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:34:20.675648 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:34:20.683937 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:34:20.684253 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:34:20.684395 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:34:20.688089 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:34:20.699025 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:34:20.699924 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:34:20.715098 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:34:20.715958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b13ad580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b359ce80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f77b019c850>]}
23:34:21.551836 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:34:21.552615 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:34:29.960493 | 4ef4c97f-1377-4442-9e21-b6e37ea69f21 ==============================
23:34:29.960515 [info ] [MainThread]: Running with dbt=1.1.0
23:34:29.961221 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:34:29.961403 [debug] [MainThread]: Tracking: tracking
23:34:29.966127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a64abd340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a64abdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1a64abd1f0>]}
23:34:29.969101 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:34:29.969810 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:34:29.970325 [info ] [MainThread]: 
23:34:29.970885 [info ] [MainThread]: 
23:34:29.971323 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:36:46.547504 | 38df38f3-6f19-460c-b1a3-8069d35861a3 ==============================
23:36:46.547549 [info ] [MainThread]: Running with dbt=1.1.0
23:36:46.548303 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:36:46.548509 [debug] [MainThread]: Tracking: tracking
23:36:46.559756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c471580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c471ca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c471130>]}
23:36:46.600609 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:36:46.601387 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
23:36:46.616235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c34d0d0>]}
23:36:46.624397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c369f70>]}
23:36:46.624869 [info ] [MainThread]: Found 7 models, 5 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:36:46.625244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c369e80>]}
23:36:46.627407 [info ] [MainThread]: 
23:36:46.628030 [debug] [MainThread]: Acquiring new postgres connection "master"
23:36:46.629518 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
23:36:46.644035 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
23:36:46.644295 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
23:36:46.644432 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:36:46.656997 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
23:36:46.658547 [debug] [ThreadPool]: On list_erp_oltp: Close
23:36:46.660153 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:36:46.670286 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:36:46.670601 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:36:46.670734 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:36:46.676585 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:36:46.676806 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:36:46.676919 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:36:46.679015 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:36:46.680666 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:36:46.681170 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:36:46.720305 [debug] [MainThread]: Using postgres connection "master"
23:36:46.721498 [debug] [MainThread]: On master: BEGIN
23:36:46.721763 [debug] [MainThread]: Opening a new connection, currently in state init
23:36:46.728288 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:36:46.728567 [debug] [MainThread]: Using postgres connection "master"
23:36:46.728688 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:36:46.755228 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
23:36:46.757610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c475130>]}
23:36:46.758050 [debug] [MainThread]: On master: ROLLBACK
23:36:46.758468 [debug] [MainThread]: Using postgres connection "master"
23:36:46.758635 [debug] [MainThread]: On master: BEGIN
23:36:46.759067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:36:46.759248 [debug] [MainThread]: On master: COMMIT
23:36:46.759389 [debug] [MainThread]: Using postgres connection "master"
23:36:46.759500 [debug] [MainThread]: On master: COMMIT
23:36:46.759734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:36:46.759901 [debug] [MainThread]: On master: Close
23:36:46.761411 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:36:46.761829 [info ] [MainThread]: 
23:36:46.766948 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:36:46.767477 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
23:36:46.768046 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:36:46.768227 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:36:46.768368 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:36:46.770794 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:36:46.771147 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:36:46.771374 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:36:46.775521 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
23:36:46.776056 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:36:46.776205 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:36:46.776325 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:36:46.777799 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:36:46.778431 [debug] [Thread-3  ]: finished collecting timing info
23:36:46.778688 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:36:46.771910 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:36:46.800299 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
23:36:46.772206 [debug] [Thread-1  ]: finished collecting timing info
23:36:46.802471 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:36:46.771726 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
23:36:46.837322 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:36:46.842977 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:36:46.843298 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:36:46.844724 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:36:46.845274 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:36:46.869133 [debug] [Thread-4  ]: finished collecting timing info
23:36:46.876969 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:36:46.879809 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
23:36:46.876706 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:36:46.873374 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
23:36:46.880146 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:36:46.880518 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:36:46.883079 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:36:46.883577 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:36:46.884180 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
23:36:46.884418 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:36:46.884880 [debug] [Thread-2  ]: finished collecting timing info
23:36:46.885117 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:36:46.883831 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
23:36:46.888530 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:36:46.888246 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
23:36:46.876389 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
23:36:46.890425 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:36:46.890793 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
23:36:46.891056 [debug] [Thread-3  ]: Opening a new connection, currently in state init
23:36:46.891267 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:36:46.891654 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
23:36:46.891986 [debug] [Thread-2  ]: Opening a new connection, currently in state init
23:36:46.900508 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
23:36:46.900790 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:36:46.900999 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
23:36:46.902343 [debug] [Thread-3  ]: SQL status: BEGIN in 0.01 seconds
23:36:46.902555 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:36:46.902671 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
23:36:46.902863 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
23:36:46.902993 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:36:46.903100 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
23:36:46.904067 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.0 seconds
23:36:46.914010 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
23:36:46.917034 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:36:46.917288 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
23:36:46.917503 [debug] [Thread-2  ]: SQL status: BEGIN in 0.03 seconds
23:36:46.917867 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
23:36:46.922127 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:36:46.923086 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
23:36:46.918104 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:36:46.922596 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:36:46.923405 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
23:36:46.923825 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:46.924179 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
23:36:46.924373 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:46.930199 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:36:46.930411 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
23:36:46.931442 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.0 seconds
23:36:46.931197 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
23:36:46.927424 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:36:46.934251 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:36:46.938589 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:36:46.938924 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
23:36:46.939498 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
23:36:46.939307 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
23:36:46.939734 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
23:36:46.957281 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:46.956552 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:46.956213 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:36:46.957489 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:46.961756 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:36:46.964379 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
23:36:46.963955 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:36:46.964695 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:36:46.964841 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:36:46.962454 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:36:46.965618 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:36:46.965282 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:46.959214 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:36:46.967377 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:36:46.967825 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:36:46.968118 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:36:46.968319 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:36:46.968520 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:36:46.973461 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
23:36:46.978986 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:36:46.979307 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
23:36:46.979443 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
23:36:46.979592 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
23:36:46.979835 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
23:36:46.981592 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:36:46.987199 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
23:36:46.985858 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:36:46.987770 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
23:36:46.984214 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:36:46.988098 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
23:36:46.996196 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
23:36:46.997520 [debug] [Thread-4  ]: finished collecting timing info
23:36:46.997727 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
23:36:46.999465 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c314730>]}
23:36:46.999881 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.16s]
23:36:47.000471 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:36:47.001814 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
23:36:47.003130 [debug] [Thread-2  ]: finished collecting timing info
23:36:47.003351 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.02 seconds
23:36:47.003632 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
23:36:47.004748 [debug] [Thread-1  ]: finished collecting timing info
23:36:47.005085 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
23:36:47.007197 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29182472e0>]}
23:36:47.007620 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c305fd0>]}
23:36:47.008029 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.16s]
23:36:47.008419 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.24s]
23:36:47.009064 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:36:47.009425 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:36:47.010051 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
23:36:47.010320 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
23:36:47.010710 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:36:47.010846 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
23:36:47.010963 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
23:36:47.013419 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:36:47.013928 [debug] [Thread-6  ]: finished collecting timing info
23:36:47.014186 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
23:36:47.026012 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.04 seconds
23:36:47.027611 [debug] [Thread-3  ]: finished collecting timing info
23:36:47.027877 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
23:36:47.028455 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291dd04970>]}
23:36:47.028850 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.25s]
23:36:47.029343 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:36:47.030125 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
23:36:47.030623 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:36:47.030928 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
23:36:47.031423 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:36:47.031577 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:36:47.031702 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:36:47.037101 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:36:47.037468 [debug] [Thread-9  ]: Began running node model.first_project.customers2
23:36:47.038341 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
23:36:47.038798 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
23:36:47.037959 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:36:47.038971 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
23:36:47.039205 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
23:36:47.039437 [debug] [Thread-9  ]: Compiling model.first_project.customers2
23:36:47.039620 [debug] [Thread-6  ]: Opening a new connection, currently in state init
23:36:47.042521 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
23:36:47.043244 [debug] [Thread-9  ]: finished collecting timing info
23:36:47.044088 [debug] [Thread-8  ]: finished collecting timing info
23:36:47.044313 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
23:36:47.044530 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:36:47.053782 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
23:36:47.054364 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:36:47.062091 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
23:36:47.069034 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
23:36:47.069294 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
23:36:47.069432 [debug] [Thread-9  ]: Opening a new connection, currently in state init
23:36:47.063190 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
23:36:47.071180 [debug] [Thread-8  ]: Opening a new connection, currently in state init
23:36:47.075346 [debug] [Thread-6  ]: SQL status: BEGIN in 0.04 seconds
23:36:47.075692 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:36:47.075893 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
23:36:47.078090 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
23:36:47.081142 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:36:47.081355 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
23:36:47.082394 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:47.084243 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
23:36:47.084477 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:36:47.084616 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
23:36:47.090884 [debug] [Thread-8  ]: SQL status: BEGIN in 0.02 seconds
23:36:47.091224 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:36:47.091378 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
23:36:47.092336 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
23:36:47.094537 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:36:47.094714 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
23:36:47.095227 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
23:36:47.096502 [debug] [Thread-6  ]: finished collecting timing info
23:36:47.096717 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
23:36:47.099780 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f29181e5ca0>]}
23:36:47.101605 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.09s]
23:36:47.104092 [debug] [Thread-9  ]: SQL status: BEGIN in 0.03 seconds
23:36:47.104329 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
23:36:47.104504 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
23:36:47.105122 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
23:36:47.111271 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.02 seconds
23:36:47.113768 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:36:47.113954 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
23:36:47.114741 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:47.116582 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:36:47.116845 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:36:47.117066 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:36:47.118648 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.01 seconds
23:36:47.122854 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
23:36:47.123282 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
23:36:47.126095 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
23:36:47.128571 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:36:47.128848 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.01 seconds
23:36:47.129039 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
23:36:47.132374 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
23:36:47.131748 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
23:36:47.134064 [debug] [Thread-8  ]: finished collecting timing info
23:36:47.134764 [debug] [Thread-8  ]: On model.first_project.customers: Close
23:36:47.134451 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
23:36:47.138453 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2918222880>]}
23:36:47.139250 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
23:36:47.139795 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.11s]
23:36:47.141895 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
23:36:47.142475 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
23:36:47.142897 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:36:47.143141 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
23:36:47.155450 [debug] [Thread-9  ]: SQL status: COMMIT in 0.01 seconds
23:36:47.157301 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
23:36:47.157500 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
23:36:47.164863 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.01 seconds
23:36:47.166271 [debug] [Thread-9  ]: finished collecting timing info
23:36:47.166547 [debug] [Thread-9  ]: On model.first_project.customers2: Close
23:36:47.167379 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '38df38f3-6f19-460c-b1a3-8069d35861a3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291821e490>]}
23:36:47.167767 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.13s]
23:36:47.168145 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
23:36:47.170540 [debug] [MainThread]: Acquiring new postgres connection "master"
23:36:47.170771 [debug] [MainThread]: Using postgres connection "master"
23:36:47.170884 [debug] [MainThread]: On master: BEGIN
23:36:47.170980 [debug] [MainThread]: Opening a new connection, currently in state closed
23:36:47.178311 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:36:47.178598 [debug] [MainThread]: On master: COMMIT
23:36:47.178720 [debug] [MainThread]: Using postgres connection "master"
23:36:47.178828 [debug] [MainThread]: On master: COMMIT
23:36:47.179344 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:36:47.179569 [debug] [MainThread]: On master: Close
23:36:47.180076 [info ] [MainThread]: 
23:36:47.180356 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.55s.
23:36:47.180540 [debug] [MainThread]: Connection 'master' was properly closed.
23:36:47.180637 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
23:36:47.180738 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
23:36:47.180825 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
23:36:47.180910 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
23:36:47.180994 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:36:47.181079 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:36:47.181164 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:36:47.189432 [info ] [MainThread]: 
23:36:47.190066 [info ] [MainThread]: [32mCompleted successfully[0m
23:36:47.190389 [info ] [MainThread]: 
23:36:47.190604 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
23:36:47.190957 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291e329bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291c2a0cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f291e5d1910>]}


============================== 2022-06-06 23:38:20.218007 | 4b943682-d701-49de-8230-41e037884b0a ==============================
23:38:20.218030 [info ] [MainThread]: Running with dbt=1.1.0
23:38:20.218674 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:38:20.218846 [debug] [MainThread]: Tracking: tracking
23:38:20.237849 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4818c2520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4818c2c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4818c25e0>]}
23:38:20.275475 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:38:20.276070 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
23:38:20.346650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc481766f40>]}
23:38:20.390793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc483a9f2b0>]}
23:38:20.391165 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:38:20.391476 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc483a9f4f0>]}
23:38:20.393081 [info ] [MainThread]: 
23:38:20.393616 [debug] [MainThread]: Acquiring new postgres connection "master"
23:38:20.395038 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
23:38:20.407497 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
23:38:20.407769 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
23:38:20.407893 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:38:20.422052 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
23:38:20.423655 [debug] [ThreadPool]: On list_erp_oltp: Close
23:38:20.425237 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:38:20.430605 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:38:20.430818 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:38:20.433043 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:38:20.439575 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:38:20.439864 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:38:20.439997 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:38:20.442340 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:38:20.443865 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:38:20.444196 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:38:20.450861 [debug] [MainThread]: Using postgres connection "master"
23:38:20.451074 [debug] [MainThread]: On master: BEGIN
23:38:20.451253 [debug] [MainThread]: Opening a new connection, currently in state init
23:38:20.457715 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:38:20.457938 [debug] [MainThread]: Using postgres connection "master"
23:38:20.458055 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:38:20.481291 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
23:38:20.483266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc483a9f610>]}
23:38:20.483738 [debug] [MainThread]: On master: ROLLBACK
23:38:20.484153 [debug] [MainThread]: Using postgres connection "master"
23:38:20.484320 [debug] [MainThread]: On master: BEGIN
23:38:20.484719 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:38:20.484886 [debug] [MainThread]: On master: COMMIT
23:38:20.485018 [debug] [MainThread]: Using postgres connection "master"
23:38:20.485139 [debug] [MainThread]: On master: COMMIT
23:38:20.485434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:38:20.485685 [debug] [MainThread]: On master: Close
23:38:20.486339 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:38:20.486757 [info ] [MainThread]: 
23:38:20.492937 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:38:20.493357 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
23:38:20.494269 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:38:20.494530 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:38:20.494768 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:38:20.499302 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:38:20.499626 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:38:20.499844 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:38:20.501881 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
23:38:20.501469 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
23:38:20.502428 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:38:20.503350 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:38:20.503145 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:38:20.503810 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:38:20.503971 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:38:20.500092 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:38:20.510171 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
23:38:20.510766 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:38:20.510933 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:38:20.509412 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:38:20.503624 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:38:20.502605 [debug] [Thread-1  ]: finished collecting timing info
23:38:20.512584 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:38:20.511134 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:38:20.520615 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:38:20.513040 [debug] [Thread-2  ]: finished collecting timing info
23:38:20.521757 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:38:20.521120 [debug] [Thread-4  ]: finished collecting timing info
23:38:20.533812 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:38:20.516641 [debug] [Thread-3  ]: finished collecting timing info
23:38:20.513296 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:38:20.553653 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:38:20.573869 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
23:38:20.586925 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
23:38:20.589928 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
23:38:20.604200 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
23:38:20.605142 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:38:20.605366 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:38:20.605754 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
23:38:20.605974 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
23:38:20.606718 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:38:20.607395 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
23:38:20.607166 [debug] [Thread-3  ]: Opening a new connection, currently in state init
23:38:20.606934 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:38:20.607638 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:38:20.608556 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
23:38:20.608701 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:38:20.607801 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
23:38:20.619237 [debug] [Thread-4  ]: SQL status: BEGIN in 0.01 seconds
23:38:20.619507 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:38:20.619634 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
23:38:20.622100 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
23:38:20.622420 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:38:20.622554 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
23:38:20.622774 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
23:38:20.623025 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:38:20.623155 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
23:38:20.624526 [debug] [Thread-3  ]: SQL status: BEGIN in 0.02 seconds
23:38:20.624696 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:38:20.624804 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
23:38:20.637107 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.02 seconds
23:38:20.637415 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
23:38:20.642968 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.02 seconds
23:38:20.643270 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.02 seconds
23:38:20.645807 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:38:20.648084 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:38:20.653626 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
23:38:20.653167 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:38:20.653912 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
23:38:20.650195 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:38:20.654147 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
23:38:20.653427 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
23:38:20.654678 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.654868 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.659750 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:38:20.659912 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
23:38:20.657786 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:38:20.660540 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
23:38:20.660951 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.655021 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.655106 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.671020 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:38:20.675829 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:38:20.675421 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:38:20.675615 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.02 seconds
23:38:20.677240 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:38:20.677399 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:38:20.676129 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
23:38:20.673295 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:38:20.677776 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
23:38:20.675971 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:38:20.678325 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.677561 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:38:20.678496 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.679729 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:38:20.682071 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:38:20.682187 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:38:20.681894 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:38:20.682431 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:38:20.682545 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:38:20.686267 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
23:38:20.692642 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:38:20.692901 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
23:38:20.693138 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
23:38:20.696448 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:38:20.696606 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
23:38:20.694972 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:38:20.696868 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
23:38:20.693296 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
23:38:20.693423 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
23:38:20.699622 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:38:20.701047 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
23:38:20.705887 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.01 seconds
23:38:20.707361 [debug] [Thread-2  ]: finished collecting timing info
23:38:20.707586 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
23:38:20.708089 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48069afd0>]}
23:38:20.708492 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.21s]
23:38:20.708898 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:38:20.712944 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
23:38:20.714185 [debug] [Thread-1  ]: finished collecting timing info
23:38:20.714420 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.02 seconds
23:38:20.714644 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
23:38:20.715723 [debug] [Thread-3  ]: finished collecting timing info
23:38:20.716010 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
23:38:20.718256 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48183a160>]}
23:38:20.718788 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4806c1850>]}
23:38:20.719830 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.22s]
23:38:20.719201 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.22s]
23:38:20.721424 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
23:38:20.721825 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:38:20.724022 [debug] [Thread-4  ]: finished collecting timing info
23:38:20.724380 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:38:20.724786 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
23:38:20.725106 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
23:38:20.727672 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
23:38:20.728355 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:38:20.728574 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
23:38:20.728753 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
23:38:20.725672 [debug] [Thread-8  ]: Began running node model.first_project.customers2
23:38:20.734598 [info ] [Thread-8  ]: 6 of 7 START table model public.customers2 ..................................... [RUN]
23:38:20.733534 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:38:20.736560 [debug] [Thread-6  ]: finished collecting timing info
23:38:20.736806 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
23:38:20.735231 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
23:38:20.743139 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
23:38:20.743367 [debug] [Thread-8  ]: Compiling model.first_project.customers2
23:38:20.746206 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
23:38:20.746768 [debug] [Thread-8  ]: finished collecting timing info
23:38:20.746972 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
23:38:20.749980 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers2"
23:38:20.735740 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48175c9a0>]}
23:38:20.751333 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.23s]
23:38:20.751786 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
23:38:20.752424 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:38:20.754420 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
23:38:20.754814 [debug] [Thread-8  ]: On model.first_project.customers2: BEGIN
23:38:20.755664 [debug] [Thread-10 ]: Began running node model.first_project.customers
23:38:20.756381 [info ] [Thread-10 ]: 7 of 7 START view model public.customers ....................................... [RUN]
23:38:20.756910 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
23:38:20.757067 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
23:38:20.757204 [debug] [Thread-10 ]: Compiling model.first_project.customers
23:38:20.755899 [debug] [Thread-8  ]: Opening a new connection, currently in state init
23:38:20.761214 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
23:38:20.762743 [debug] [Thread-10 ]: finished collecting timing info
23:38:20.763558 [debug] [Thread-10 ]: Began executing node model.first_project.customers
23:38:20.767266 [debug] [Thread-10 ]: Writing runtime SQL for node "model.first_project.customers"
23:38:20.763261 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:38:20.772884 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
23:38:20.779947 [debug] [Thread-6  ]: Opening a new connection, currently in state init
23:38:20.782628 [debug] [Thread-8  ]: SQL status: BEGIN in 0.03 seconds
23:38:20.783666 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
23:38:20.784230 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
23:38:20.784569 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
23:38:20.785049 [debug] [Thread-10 ]: On model.first_project.customers: BEGIN
23:38:20.785486 [debug] [Thread-10 ]: Opening a new connection, currently in state init
23:38:20.789710 [debug] [Thread-8  ]: SQL status: SELECT 100 in 0.0 seconds
23:38:20.792890 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
23:38:20.793219 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
23:38:20.793526 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
23:38:20.793761 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:38:20.793901 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
23:38:20.794610 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.797289 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
23:38:20.797570 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
23:38:20.797794 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
23:38:20.802308 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:38:20.802944 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
23:38:20.803330 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.805350 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
23:38:20.806518 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.806853 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
23:38:20.808877 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
23:38:20.809179 [debug] [Thread-10 ]: SQL status: BEGIN in 0.02 seconds
23:38:20.809380 [debug] [Thread-8  ]: On model.first_project.customers2: COMMIT
23:38:20.809837 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
23:38:20.810105 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
23:38:20.809668 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:38:20.810368 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
23:38:20.814005 [debug] [Thread-10 ]: SQL status: CREATE VIEW in 0.0 seconds
23:38:20.817028 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
23:38:20.817413 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
23:38:20.817730 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
23:38:20.822201 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers2"
23:38:20.823289 [debug] [Thread-8  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
23:38:20.823538 [debug] [Thread-10 ]: SQL status: ALTER TABLE in 0.0 seconds
23:38:20.825379 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
23:38:20.825606 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
23:38:20.825777 [debug] [Thread-10 ]: On model.first_project.customers: COMMIT
23:38:20.825978 [debug] [Thread-6  ]: SQL status: COMMIT in 0.02 seconds
23:38:20.827805 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:38:20.827994 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
23:38:20.828458 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
23:38:20.829742 [debug] [Thread-6  ]: finished collecting timing info
23:38:20.829956 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
23:38:20.831758 [debug] [Thread-8  ]: SQL status: DROP TABLE in 0.01 seconds
23:38:20.833246 [debug] [Thread-8  ]: finished collecting timing info
23:38:20.833831 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4818d40d0>]}
23:38:20.834112 [debug] [Thread-8  ]: On model.first_project.customers2: Close
23:38:20.834597 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.11s]
23:38:20.835403 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
23:38:20.837653 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc48067aac0>]}
23:38:20.838106 [info ] [Thread-8  ]: 6 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.10s]
23:38:20.838566 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
23:38:20.840135 [debug] [Thread-10 ]: SQL status: COMMIT in 0.01 seconds
23:38:20.842853 [debug] [Thread-10 ]: Using postgres connection "model.first_project.customers"
23:38:20.843131 [debug] [Thread-10 ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
23:38:20.843593 [debug] [Thread-10 ]: SQL status: DROP VIEW in 0.0 seconds
23:38:20.844920 [debug] [Thread-10 ]: finished collecting timing info
23:38:20.845147 [debug] [Thread-10 ]: On model.first_project.customers: Close
23:38:20.847850 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b943682-d701-49de-8230-41e037884b0a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc481710fd0>]}
23:38:20.848823 [info ] [Thread-10 ]: 7 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.09s]
23:38:20.849366 [debug] [Thread-10 ]: Finished running node model.first_project.customers
23:38:20.852408 [debug] [MainThread]: Acquiring new postgres connection "master"
23:38:20.852634 [debug] [MainThread]: Using postgres connection "master"
23:38:20.852759 [debug] [MainThread]: On master: BEGIN
23:38:20.852868 [debug] [MainThread]: Opening a new connection, currently in state closed
23:38:20.861963 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:38:20.862266 [debug] [MainThread]: On master: COMMIT
23:38:20.862411 [debug] [MainThread]: Using postgres connection "master"
23:38:20.862520 [debug] [MainThread]: On master: COMMIT
23:38:20.862787 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:38:20.862965 [debug] [MainThread]: On master: Close
23:38:20.863529 [info ] [MainThread]: 
23:38:20.863802 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.47s.
23:38:20.864001 [debug] [MainThread]: Connection 'master' was properly closed.
23:38:20.864103 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
23:38:20.864198 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
23:38:20.864297 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
23:38:20.864401 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
23:38:20.864491 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:38:20.864580 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:38:20.864670 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:38:20.871760 [info ] [MainThread]: 
23:38:20.872247 [info ] [MainThread]: [32mCompleted successfully[0m
23:38:20.872602 [info ] [MainThread]: 
23:38:20.872820 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
23:38:20.873156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4817952b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4836c10d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc4817df250>]}


============================== 2022-06-06 23:38:32.671330 | a395dfd2-8f74-4703-ba22-9873f56a3f6d ==============================
23:38:32.671354 [info ] [MainThread]: Running with dbt=1.1.0
23:38:32.672164 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:38:32.672378 [debug] [MainThread]: Tracking: tracking
23:38:32.678347 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834e4dd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834e4d040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834e4d070>]}
23:38:32.720021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:38:32.720357 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:38:32.728958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a395dfd2-8f74-4703-ba22-9873f56a3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834d050d0>]}
23:38:32.737143 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a395dfd2-8f74-4703-ba22-9873f56a3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834d55340>]}
23:38:32.737601 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:38:32.738270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a395dfd2-8f74-4703-ba22-9873f56a3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834d55280>]}
23:38:32.741044 [info ] [MainThread]: 
23:38:32.741838 [debug] [MainThread]: Acquiring new postgres connection "master"
23:38:32.743717 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:38:32.759744 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:38:32.760039 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:38:32.760188 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:38:32.777600 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
23:38:32.778025 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:38:32.778223 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:38:32.781895 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:38:32.784645 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:38:32.785225 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:38:32.791512 [debug] [MainThread]: Using postgres connection "master"
23:38:32.791797 [debug] [MainThread]: On master: BEGIN
23:38:32.791940 [debug] [MainThread]: Opening a new connection, currently in state init
23:38:32.799591 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:38:32.799914 [debug] [MainThread]: Using postgres connection "master"
23:38:32.800047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:38:32.823455 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
23:38:32.825140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a395dfd2-8f74-4703-ba22-9873f56a3f6d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834ddeaf0>]}
23:38:32.825516 [debug] [MainThread]: On master: ROLLBACK
23:38:32.825896 [debug] [MainThread]: On master: Close
23:38:32.826447 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:38:32.826789 [info ] [MainThread]: 
23:38:32.833152 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:38:32.833568 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:38:32.835042 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:38:32.834236 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:38:32.835787 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:38:32.833783 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:38:32.836377 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:38:32.836556 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:38:32.836701 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:38:32.835991 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:38:32.842538 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:38:32.835573 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
23:38:32.834520 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:38:32.835259 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:38:32.845240 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:38:32.835435 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
23:38:32.848139 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
23:38:32.848318 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
23:38:32.848446 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
23:38:32.843226 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:38:32.890333 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
23:38:32.890568 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
23:38:32.839833 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:38:32.892282 [debug] [Thread-3  ]: finished collecting timing info
23:38:32.892480 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:38:32.892616 [debug] [Thread-3  ]: finished collecting timing info
23:38:32.891689 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
23:38:32.843631 [debug] [Thread-1  ]: finished collecting timing info
23:38:32.894501 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:38:32.894645 [debug] [Thread-1  ]: finished collecting timing info
23:38:32.847654 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:38:32.894044 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
23:38:32.894282 [debug] [Thread-6  ]: finished collecting timing info
23:38:32.895659 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
23:38:32.895775 [debug] [Thread-6  ]: finished collecting timing info
23:38:32.894985 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:38:32.895265 [debug] [Thread-5  ]: finished collecting timing info
23:38:32.895469 [debug] [Thread-2  ]: finished collecting timing info
23:38:32.893041 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:38:32.844979 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:38:32.896105 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
23:38:32.896559 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
23:38:32.897891 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:38:32.898019 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
23:38:32.898127 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
23:38:32.897064 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:38:32.897395 [debug] [Thread-1  ]: Began running node model.first_project.customers2
23:38:32.902105 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
23:38:32.896913 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
23:38:32.896690 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:38:32.902722 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:38:32.902860 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:38:32.901788 [debug] [Thread-2  ]: finished collecting timing info
23:38:32.902277 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
23:38:32.903542 [debug] [Thread-1  ]: Compiling model.first_project.customers2
23:38:32.902438 [debug] [Thread-5  ]: finished collecting timing info
23:38:32.896785 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:38:32.907778 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:38:32.902979 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:38:32.903365 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:38:32.897534 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:38:32.906178 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
23:38:32.920577 [debug] [Thread-1  ]: finished collecting timing info
23:38:32.920777 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
23:38:32.920898 [debug] [Thread-1  ]: finished collecting timing info
23:38:32.918569 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:38:32.901471 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:38:32.921263 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
23:38:32.907921 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:38:32.922737 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:38:32.920116 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:38:32.922355 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:38:32.907433 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
23:38:32.928389 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:38:32.929036 [debug] [Thread-8  ]: finished collecting timing info
23:38:32.929659 [debug] [Thread-4  ]: finished collecting timing info
23:38:32.929872 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
23:38:32.930125 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:38:32.930358 [debug] [Thread-8  ]: finished collecting timing info
23:38:32.931823 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
23:38:32.930574 [debug] [Thread-10 ]: finished collecting timing info
23:38:32.931379 [debug] [Thread-9  ]: finished collecting timing info
23:38:32.931273 [debug] [Thread-4  ]: finished collecting timing info
23:38:32.932298 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:38:32.932471 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:38:32.933737 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:38:32.933886 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:38:32.933999 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:38:32.933428 [debug] [Thread-10 ]: finished collecting timing info
23:38:32.932603 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:38:32.938272 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:38:32.938425 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:38:32.937531 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:38:32.938991 [debug] [Thread-3  ]: finished collecting timing info
23:38:32.938540 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:38:32.942522 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:38:32.942850 [debug] [Thread-7  ]: finished collecting timing info
23:38:32.939181 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:38:32.943632 [debug] [Thread-3  ]: finished collecting timing info
23:38:32.933204 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:38:32.944049 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:38:32.943036 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:38:32.932820 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:38:32.945334 [debug] [Thread-9  ]: finished collecting timing info
23:38:32.944675 [debug] [Thread-2  ]: Began running node model.first_project.customers
23:38:32.946308 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
23:38:32.945857 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:38:32.937986 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:38:32.946583 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
23:38:32.947206 [debug] [Thread-2  ]: Compiling model.first_project.customers
23:38:32.949932 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
23:38:32.945083 [debug] [Thread-7  ]: finished collecting timing info
23:38:32.950393 [debug] [Thread-2  ]: finished collecting timing info
23:38:32.952048 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:38:32.952464 [debug] [Thread-2  ]: Began executing node model.first_project.customers
23:38:32.953121 [debug] [Thread-2  ]: finished collecting timing info
23:38:32.953854 [debug] [Thread-2  ]: Finished running node model.first_project.customers
23:38:32.954732 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:38:32.954877 [debug] [Thread-8  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:38:32.955806 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:38:32.955953 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:38:32.954981 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:38:32.955185 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:38:32.956260 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:38:32.956691 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:38:32.956802 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:38:32.956538 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:38:32.965107 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:38:32.965266 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
23:38:32.964881 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:38:32.956067 [debug] [Thread-8  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:38:32.955508 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:38:32.975576 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:38:32.975225 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:38:32.976185 [debug] [Thread-8  ]: finished collecting timing info
23:38:32.976398 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:38:32.976565 [debug] [Thread-8  ]: finished collecting timing info
23:38:32.968377 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:38:32.977427 [debug] [Thread-4  ]: finished collecting timing info
23:38:32.977029 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:38:32.975757 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:38:32.977738 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:38:32.991172 [debug] [Thread-4  ]: finished collecting timing info
23:38:32.991921 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:38:32.992240 [debug] [Thread-6  ]: finished collecting timing info
23:38:32.992549 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:38:32.992706 [debug] [Thread-6  ]: finished collecting timing info
23:38:32.993093 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:38:32.996102 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:38:32.996566 [debug] [Thread-5  ]: finished collecting timing info
23:38:32.996754 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:38:32.996884 [debug] [Thread-5  ]: finished collecting timing info
23:38:32.997229 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:38:32.998760 [debug] [MainThread]: Connection 'master' was properly closed.
23:38:32.998902 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:38:32.999054 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:38:32.999160 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:38:32.999259 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:38:32.999386 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
23:38:32.999479 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:38:32.999577 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:38:32.999665 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:38:32.999754 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:38:32.999843 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:38:33.004941 [info ] [MainThread]: Done.
23:38:33.007933 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:38:33.008144 [info ] [MainThread]: Building catalog
23:38:33.010490 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:38:33.024143 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:38:33.024431 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:38:33.024568 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:38:33.031401 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:38:33.031658 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:38:33.031782 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:38:33.036148 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:38:33.046424 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:38:33.049384 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:38:33.063052 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:38:33.063623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f88398d9f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8834c849d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8836c4b640>]}
23:38:38.660771 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:38:38.662183 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:38:43.504295 | 2b7a2aa5-3f63-44fc-8ef2-2774f006e687 ==============================
23:38:43.504318 [info ] [MainThread]: Running with dbt=1.1.0
23:38:43.504931 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:38:43.505134 [debug] [MainThread]: Tracking: tracking
23:38:43.509946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f5218340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f5218f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb2f52181f0>]}
23:38:43.512720 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:38:43.513076 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:38:43.513286 [info ] [MainThread]: 
23:38:43.513696 [info ] [MainThread]: 
23:38:43.514082 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:40:35.496573 | 8396c1a6-4f83-4c7b-b972-ec1868ab3288 ==============================
23:40:35.496608 [info ] [MainThread]: Running with dbt=1.1.0
23:40:35.497556 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
23:40:35.497866 [debug] [MainThread]: Tracking: tracking
23:40:35.505049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd4144d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd4144040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd4144070>]}
23:40:35.551745 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
23:40:35.552691 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
23:40:35.566909 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
23:40:35.677856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd59be490>]}
23:40:35.684243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd41551c0>]}
23:40:35.684619 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:40:35.684898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd4155700>]}
23:40:35.686555 [info ] [MainThread]: 
23:40:35.687202 [debug] [MainThread]: Acquiring new postgres connection "master"
23:40:35.688497 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
23:40:35.704556 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
23:40:35.704852 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
23:40:35.704978 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:40:35.714136 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
23:40:35.715629 [debug] [ThreadPool]: On list_erp_oltp: Close
23:40:35.717344 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:40:35.725819 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:40:35.726076 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:40:35.726189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
23:40:35.733113 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:40:35.733476 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:40:35.733617 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:40:35.735925 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:40:35.737428 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:40:35.737729 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:40:35.742272 [debug] [MainThread]: Using postgres connection "master"
23:40:35.742512 [debug] [MainThread]: On master: BEGIN
23:40:35.742987 [debug] [MainThread]: Opening a new connection, currently in state init
23:40:35.749308 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:40:35.749549 [debug] [MainThread]: Using postgres connection "master"
23:40:35.749707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:40:35.769135 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
23:40:35.770691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd59bef40>]}
23:40:35.771082 [debug] [MainThread]: On master: ROLLBACK
23:40:35.771425 [debug] [MainThread]: Using postgres connection "master"
23:40:35.771573 [debug] [MainThread]: On master: BEGIN
23:40:35.771952 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
23:40:35.772161 [debug] [MainThread]: On master: COMMIT
23:40:35.772275 [debug] [MainThread]: Using postgres connection "master"
23:40:35.772374 [debug] [MainThread]: On master: COMMIT
23:40:35.772577 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:40:35.772730 [debug] [MainThread]: On master: Close
23:40:35.773150 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:40:35.773581 [info ] [MainThread]: 
23:40:35.778046 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:40:35.778407 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
23:40:35.778993 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:40:35.779197 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:40:35.779385 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:40:35.779624 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:40:35.779850 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:40:35.787477 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
23:40:35.780257 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
23:40:35.779977 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:40:35.788287 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
23:40:35.789177 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:40:35.789764 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:40:35.789569 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:40:35.789921 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:40:35.793141 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:40:35.790213 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:40:35.791864 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:40:35.800162 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:40:35.802024 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:40:35.799740 [debug] [Thread-3  ]: finished collecting timing info
23:40:35.801787 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:40:35.803231 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:40:35.803488 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:40:35.784045 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:40:35.813004 [debug] [Thread-1  ]: finished collecting timing info
23:40:35.813404 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:40:35.805781 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:40:35.806220 [debug] [Thread-4  ]: finished collecting timing info
23:40:35.852408 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:40:35.863405 [debug] [Thread-2  ]: finished collecting timing info
23:40:35.879998 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:40:35.905323 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
23:40:35.908918 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
23:40:35.909996 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
23:40:35.915674 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
23:40:35.916781 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:40:35.917070 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:40:35.917540 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
23:40:35.917881 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
23:40:35.918105 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:40:35.918794 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
23:40:35.918576 [debug] [Thread-4  ]: Opening a new connection, currently in state init
23:40:35.918357 [debug] [Thread-2  ]: Opening a new connection, currently in state init
23:40:35.919166 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:40:35.920196 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
23:40:35.920374 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
23:40:35.919349 [debug] [Thread-3  ]: Opening a new connection, currently in state init
23:40:35.933975 [debug] [Thread-2  ]: SQL status: BEGIN in 0.02 seconds
23:40:35.934471 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:40:35.934656 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
23:40:35.936805 [debug] [Thread-4  ]: SQL status: BEGIN in 0.02 seconds
23:40:35.937047 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:40:35.937233 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
23:40:35.937474 [debug] [Thread-1  ]: SQL status: BEGIN in 0.02 seconds
23:40:35.937655 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:40:35.937771 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
23:40:35.939956 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
23:40:35.948685 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.01 seconds
23:40:35.951366 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:40:35.951594 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
23:40:35.954265 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:40:35.951770 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
23:40:35.954444 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
23:40:35.954605 [debug] [Thread-3  ]: SQL status: BEGIN in 0.04 seconds
23:40:35.955076 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:40:35.955227 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
23:40:35.955464 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:35.957562 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:40:35.958214 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
23:40:35.958785 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.0 seconds
23:40:35.962242 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:40:35.962454 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
23:40:35.958901 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:35.958629 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:40:35.964941 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:40:35.965176 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:35.965359 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
23:40:35.965525 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
23:40:35.965716 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
23:40:35.967853 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:40:35.976058 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:40:35.976549 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:35.976833 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
23:40:35.977006 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:35.977204 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:40:35.982438 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:40:35.985110 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:40:35.985943 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
23:40:35.985585 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
23:40:35.985750 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:40:35.985431 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:35.988449 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:40:35.987213 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
23:40:35.987035 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:35.996637 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:40:35.995182 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:40:35.997490 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
23:40:35.997258 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:40:35.996995 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
23:40:35.997830 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
23:40:36.004207 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
23:40:36.004601 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
23:40:36.014328 [debug] [Thread-1  ]: SQL status: COMMIT in 0.02 seconds
23:40:36.016169 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
23:40:36.016332 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
23:40:36.021075 [debug] [Thread-2  ]: SQL status: COMMIT in 0.02 seconds
23:40:36.021347 [debug] [Thread-3  ]: SQL status: COMMIT in 0.02 seconds
23:40:36.024059 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.02 seconds
23:40:36.023857 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
23:40:36.029491 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
23:40:36.026334 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
23:40:36.029669 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
23:40:36.029307 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
23:40:36.030823 [debug] [Thread-1  ]: finished collecting timing info
23:40:36.031337 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
23:40:36.031961 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd40be310>]}
23:40:36.032318 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.25s]
23:40:36.032810 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:40:36.028406 [debug] [Thread-4  ]: finished collecting timing info
23:40:36.033025 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
23:40:36.033597 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd3b6d100>]}
23:40:36.034085 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.24s]
23:40:36.034707 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:40:36.036188 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
23:40:36.036570 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
23:40:36.037024 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:40:36.037172 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
23:40:36.037405 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
23:40:36.039613 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:40:36.039976 [debug] [Thread-6  ]: finished collecting timing info
23:40:36.040125 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
23:40:36.043053 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
23:40:36.043509 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:40:36.043645 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
23:40:36.043741 [debug] [Thread-6  ]: Opening a new connection, currently in state init
23:40:36.045030 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
23:40:36.046678 [debug] [Thread-2  ]: finished collecting timing info
23:40:36.046927 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
23:40:36.047475 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd5f41e80>]}
23:40:36.048341 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.26s]
23:40:36.048952 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:40:36.055028 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
23:40:36.055271 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:40:36.055394 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
23:40:36.057034 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
23:40:36.059765 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:40:36.060001 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.03 seconds
23:40:36.060471 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
23:40:36.061738 [debug] [Thread-3  ]: finished collecting timing info
23:40:36.062189 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
23:40:36.062880 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd3b6d2e0>]}
23:40:36.063521 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.27s]
23:40:36.065031 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:36.067258 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
23:40:36.067575 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:40:36.067778 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
23:40:36.072790 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:40:36.074030 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:40:36.074657 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
23:40:36.075238 [debug] [Thread-3  ]: Began running node model.first_project.customers2
23:40:36.075887 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:40:36.076336 [info ] [Thread-3  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
23:40:36.076678 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:40:36.077331 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.customers2"
23:40:36.077628 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:40:36.077890 [debug] [Thread-3  ]: Began compiling node model.first_project.customers2
23:40:36.081744 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:40:36.082242 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
23:40:36.083473 [debug] [Thread-3  ]: Compiling model.first_project.customers2
23:40:36.086149 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
23:40:36.090162 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
23:40:36.089745 [debug] [Thread-8  ]: finished collecting timing info
23:40:36.090786 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:40:36.089324 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.customers2"
23:40:36.097572 [debug] [Thread-3  ]: finished collecting timing info
23:40:36.097073 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.01 seconds
23:40:36.099682 [debug] [Thread-6  ]: finished collecting timing info
23:40:36.097826 [debug] [Thread-3  ]: Began executing node model.first_project.customers2
23:40:36.099978 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
23:40:36.105057 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd0267fd0>]}
23:40:36.104259 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.customers2"
23:40:36.105852 [debug] [Thread-3  ]: Using postgres connection "model.first_project.customers2"
23:40:36.106029 [debug] [Thread-3  ]: On model.first_project.customers2: BEGIN
23:40:36.106150 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
23:40:36.108006 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.07s]
23:40:36.108515 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
23:40:36.096713 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
23:40:36.109752 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:40:36.109917 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
23:40:36.110032 [debug] [Thread-8  ]: Opening a new connection, currently in state init
23:40:36.118341 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
23:40:36.118645 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:40:36.118785 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
23:40:36.131778 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
23:40:36.132134 [debug] [Thread-3  ]: Using postgres connection "model.first_project.customers2"
23:40:36.132298 [debug] [Thread-3  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
23:40:36.132808 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
23:40:36.136944 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:40:36.137198 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
23:40:36.139345 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:36.141061 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:40:36.141264 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:40:36.141395 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
23:40:36.141823 [debug] [Thread-3  ]: SQL status: SELECT 100 in 0.01 seconds
23:40:36.144583 [debug] [Thread-3  ]: Using postgres connection "model.first_project.customers2"
23:40:36.144842 [debug] [Thread-3  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
23:40:36.145416 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
23:40:36.147895 [debug] [Thread-3  ]: Using postgres connection "model.first_project.customers2"
23:40:36.148092 [debug] [Thread-3  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
23:40:36.148355 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
23:40:36.149980 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
23:40:36.150215 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
23:40:36.150662 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
23:40:36.153017 [debug] [Thread-8  ]: finished collecting timing info
23:40:36.153358 [debug] [Thread-8  ]: On model.first_project.customers: Close
23:40:36.156606 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd025ed90>]}
23:40:36.157233 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
23:40:36.157771 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:40:36.158262 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.01 seconds
23:40:36.171763 [debug] [Thread-3  ]: On model.first_project.customers2: COMMIT
23:40:36.172119 [debug] [Thread-3  ]: Using postgres connection "model.first_project.customers2"
23:40:36.172358 [debug] [Thread-3  ]: On model.first_project.customers2: COMMIT
23:40:36.181280 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
23:40:36.183297 [debug] [Thread-3  ]: Using postgres connection "model.first_project.customers2"
23:40:36.183541 [debug] [Thread-3  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
23:40:36.190488 [debug] [Thread-3  ]: SQL status: DROP TABLE in 0.01 seconds
23:40:36.192386 [debug] [Thread-3  ]: finished collecting timing info
23:40:36.192677 [debug] [Thread-3  ]: On model.first_project.customers2: Close
23:40:36.193870 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8396c1a6-4f83-4c7b-b972-ec1868ab3288', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd030d5e0>]}
23:40:36.194487 [info ] [Thread-3  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.12s]
23:40:36.195345 [debug] [Thread-3  ]: Finished running node model.first_project.customers2
23:40:36.198193 [debug] [MainThread]: Acquiring new postgres connection "master"
23:40:36.198492 [debug] [MainThread]: Using postgres connection "master"
23:40:36.198639 [debug] [MainThread]: On master: BEGIN
23:40:36.198759 [debug] [MainThread]: Opening a new connection, currently in state closed
23:40:36.213299 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:40:36.213711 [debug] [MainThread]: On master: COMMIT
23:40:36.213873 [debug] [MainThread]: Using postgres connection "master"
23:40:36.214024 [debug] [MainThread]: On master: COMMIT
23:40:36.214319 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
23:40:36.214495 [debug] [MainThread]: On master: Close
23:40:36.215108 [info ] [MainThread]: 
23:40:36.215477 [info ] [MainThread]: Finished running 2 table models, 5 view models in 0.53s.
23:40:36.215756 [debug] [MainThread]: Connection 'master' was properly closed.
23:40:36.215870 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
23:40:36.215975 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:40:36.216075 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
23:40:36.216176 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
23:40:36.216284 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:40:36.216384 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:40:36.235749 [info ] [MainThread]: 
23:40:36.236104 [info ] [MainThread]: [32mCompleted successfully[0m
23:40:36.236363 [info ] [MainThread]: 
23:40:36.236639 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
23:40:36.237025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd3ba0bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd4016850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6fd4016400>]}


============================== 2022-06-06 23:40:49.982400 | 3619e480-d2ec-4e8c-81b6-e5824c803564 ==============================
23:40:49.982424 [info ] [MainThread]: Running with dbt=1.1.0
23:40:49.983225 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:40:49.983418 [debug] [MainThread]: Tracking: tracking
23:40:49.987947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8981ccb340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8981ccb4f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8981ccb5b0>]}
23:40:49.990789 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:40:49.991231 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:40:49.991498 [info ] [MainThread]: 
23:40:49.991737 [info ] [MainThread]: 
23:40:49.992002 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:41:02.305352 | 0fe04d6d-18fb-4746-b950-5fbc6c40a98d ==============================
23:41:02.305390 [info ] [MainThread]: Running with dbt=1.1.0
23:41:02.306354 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:41:02.306679 [debug] [MainThread]: Tracking: tracking
23:41:02.313189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37447eb580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37447ebca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37447eb130>]}
23:41:02.366037 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
23:41:02.366761 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
23:41:02.377486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0fe04d6d-18fb-4746-b950-5fbc6c40a98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37446a40d0>]}
23:41:02.394975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0fe04d6d-18fb-4746-b950-5fbc6c40a98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37446f4310>]}
23:41:02.395417 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:41:02.395739 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fe04d6d-18fb-4746-b950-5fbc6c40a98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37446f4250>]}
23:41:02.398035 [info ] [MainThread]: 
23:41:02.398681 [debug] [MainThread]: Acquiring new postgres connection "master"
23:41:02.400255 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:41:02.411297 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:41:02.411577 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:41:02.411724 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:41:02.424431 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:41:02.424761 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:41:02.424888 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:41:02.427847 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:41:02.429867 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:41:02.430240 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:41:02.435858 [debug] [MainThread]: Using postgres connection "master"
23:41:02.436662 [debug] [MainThread]: On master: BEGIN
23:41:02.437049 [debug] [MainThread]: Opening a new connection, currently in state init
23:41:02.453451 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
23:41:02.453717 [debug] [MainThread]: Using postgres connection "master"
23:41:02.453828 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:41:02.476660 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
23:41:02.478479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0fe04d6d-18fb-4746-b950-5fbc6c40a98d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374477d9d0>]}
23:41:02.478828 [debug] [MainThread]: On master: ROLLBACK
23:41:02.479215 [debug] [MainThread]: On master: Close
23:41:02.479737 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:41:02.480154 [info ] [MainThread]: 
23:41:02.486583 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:41:02.487240 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:41:02.487502 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:41:02.487686 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:41:02.490521 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:41:02.491020 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:41:02.491540 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:41:02.491697 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:41:02.491819 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:41:02.494422 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:41:02.495113 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:41:02.496248 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:41:02.496471 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:41:02.496687 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:41:02.498864 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:41:02.495359 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:41:02.501634 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:41:02.502470 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:41:02.495637 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
23:41:02.501934 [debug] [Thread-2  ]: finished collecting timing info
23:41:02.495507 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
23:41:02.504127 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
23:41:02.503182 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:41:02.503428 [debug] [Thread-3  ]: finished collecting timing info
23:41:02.504921 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:41:02.502680 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:41:02.504349 [debug] [Thread-1  ]: finished collecting timing info
23:41:02.504539 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
23:41:02.504737 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
23:41:02.556032 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
23:41:02.557071 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
23:41:02.557216 [debug] [Thread-6  ]: finished collecting timing info
23:41:02.557332 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
23:41:02.555772 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
23:41:02.505100 [debug] [Thread-3  ]: finished collecting timing info
23:41:02.503736 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:41:02.559207 [debug] [Thread-2  ]: finished collecting timing info
23:41:02.559619 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:41:02.557440 [debug] [Thread-6  ]: finished collecting timing info
23:41:02.558489 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
23:41:02.558981 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:41:02.554514 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:41:02.561258 [debug] [Thread-1  ]: finished collecting timing info
23:41:02.561753 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:41:02.560337 [debug] [Thread-5  ]: finished collecting timing info
23:41:02.555545 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:41:02.560141 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
23:41:02.562057 [debug] [Thread-8  ]: Began running node model.first_project.customers2
23:41:02.563298 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
23:41:02.563509 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
23:41:02.563710 [debug] [Thread-8  ]: Compiling model.first_project.customers2
23:41:02.566450 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
23:41:02.562429 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
23:41:02.566926 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:41:02.562560 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:41:02.567523 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:41:02.562757 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
23:41:02.562667 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:41:02.567126 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
23:41:02.563829 [debug] [Thread-4  ]: finished collecting timing info
23:41:02.567730 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:41:02.568817 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:41:02.567902 [debug] [Thread-5  ]: finished collecting timing info
23:41:02.579962 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
23:41:02.568533 [debug] [Thread-8  ]: finished collecting timing info
23:41:02.568239 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:41:02.568684 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:41:02.568403 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
23:41:02.585372 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:41:02.586235 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:41:02.589125 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:41:02.586463 [debug] [Thread-4  ]: finished collecting timing info
23:41:02.588688 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:41:02.586038 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
23:41:02.598192 [debug] [Thread-8  ]: finished collecting timing info
23:41:02.597056 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:41:02.597739 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:41:02.594495 [debug] [Thread-7  ]: finished collecting timing info
23:41:02.598667 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
23:41:02.598910 [debug] [Thread-10 ]: finished collecting timing info
23:41:02.599580 [debug] [Thread-1  ]: Began running node model.first_project.customers
23:41:02.601494 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
23:41:02.600008 [debug] [Thread-2  ]: finished collecting timing info
23:41:02.600401 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
23:41:02.601705 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
23:41:02.602240 [debug] [Thread-1  ]: Compiling model.first_project.customers
23:41:02.602073 [debug] [Thread-10 ]: finished collecting timing info
23:41:02.605378 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
23:41:02.601915 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:41:02.604859 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
23:41:02.599812 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:41:02.606464 [debug] [Thread-7  ]: finished collecting timing info
23:41:02.605978 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:41:02.607264 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:41:02.605699 [debug] [Thread-2  ]: finished collecting timing info
23:41:02.607888 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:41:02.606903 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:41:02.607427 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:41:02.609388 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:41:02.606138 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:41:02.615461 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:41:02.614925 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:41:02.615641 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:41:02.616079 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:41:02.609029 [debug] [Thread-1  ]: finished collecting timing info
23:41:02.620127 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:41:02.621526 [debug] [Thread-1  ]: Began executing node model.first_project.customers
23:41:02.621837 [debug] [Thread-1  ]: finished collecting timing info
23:41:02.622374 [debug] [Thread-1  ]: Finished running node model.first_project.customers
23:41:02.621244 [debug] [Thread-3  ]: finished collecting timing info
23:41:02.623012 [debug] [Thread-4  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:41:02.623232 [debug] [Thread-9  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:41:02.624927 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:41:02.623614 [debug] [Thread-8  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:41:02.625536 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:41:02.625725 [debug] [Thread-8  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:41:02.624527 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:41:02.625085 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:41:02.625880 [debug] [Thread-8  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:41:02.626054 [debug] [Thread-4  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:41:02.638204 [debug] [Thread-4  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:41:02.626426 [debug] [Thread-9  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:41:02.623933 [debug] [Thread-10 ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:41:02.655332 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:41:02.655549 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:41:02.623371 [debug] [Thread-6  ]: finished collecting timing info
23:41:02.655912 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:41:02.656117 [debug] [Thread-6  ]: finished collecting timing info
23:41:02.656588 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:41:02.655689 [debug] [Thread-10 ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
23:41:02.623778 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:41:02.654515 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:41:02.637695 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:41:02.661988 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:41:02.668425 [debug] [Thread-9  ]: finished collecting timing info
23:41:02.667572 [debug] [Thread-3  ]: finished collecting timing info
23:41:02.668643 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:41:02.669943 [debug] [Thread-9  ]: finished collecting timing info
23:41:02.671359 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:41:02.668861 [debug] [Thread-10 ]: finished collecting timing info
23:41:02.667120 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:41:02.670114 [debug] [Thread-8  ]: finished collecting timing info
23:41:02.671735 [debug] [Thread-10 ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:41:02.672307 [debug] [Thread-10 ]: finished collecting timing info
23:41:02.672746 [debug] [Thread-10 ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:41:02.669576 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:41:02.672083 [debug] [Thread-8  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:41:02.672931 [debug] [Thread-4  ]: finished collecting timing info
23:41:02.673313 [debug] [Thread-8  ]: finished collecting timing info
23:41:02.673568 [debug] [Thread-4  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:41:02.674184 [debug] [Thread-8  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:41:02.675094 [debug] [Thread-4  ]: finished collecting timing info
23:41:02.675760 [debug] [Thread-4  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:41:02.677365 [debug] [MainThread]: Connection 'master' was properly closed.
23:41:02.677537 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:41:02.677646 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:41:02.677742 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:41:02.677839 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:41:02.677936 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:41:02.678045 [debug] [MainThread]: Connection 'seed.first_project.alunos' was properly closed.
23:41:02.678139 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:41:02.678231 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
23:41:02.678322 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:41:02.678468 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:41:02.685401 [info ] [MainThread]: Done.
23:41:02.688618 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:41:02.688852 [info ] [MainThread]: Building catalog
23:41:02.692917 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:41:02.723825 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:41:02.724209 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:41:02.724381 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:41:02.744619 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
23:41:02.744930 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:41:02.745069 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:41:02.749627 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:41:02.763807 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:41:02.764433 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:41:02.775742 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:41:02.776496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f374059db80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37405a9d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f37405a9250>]}
23:41:03.387843 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:41:03.388293 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:41:08.786186 | 87fb2b12-4d69-4697-a91c-1957f8b640bd ==============================
23:41:08.786213 [info ] [MainThread]: Running with dbt=1.1.0
23:41:08.786829 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:41:08.787047 [debug] [MainThread]: Tracking: tracking
23:41:08.792026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21948d5f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21948d50a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21948d5f10>]}
23:41:08.796143 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:41:08.796591 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:41:08.796811 [info ] [MainThread]: 
23:41:08.797205 [info ] [MainThread]: 
23:41:08.798521 [info ] [MainThread]: Press Ctrl+C to exit.
23:41:08.799200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21948d52b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21948d5160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f21948d5340>]}


============================== 2022-06-06 23:41:26.383092 | b5d0acdf-4ba0-4dff-be4a-3926ec175073 ==============================
23:41:26.383141 [info ] [MainThread]: Running with dbt=1.1.0
23:41:26.384621 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:41:26.384877 [debug] [MainThread]: Tracking: tracking
23:41:26.392607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88880b8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88880b1f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88880bbe0>]}
23:41:26.396617 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:41:26.397148 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:41:26.397580 [info ] [MainThread]: 
23:41:26.397847 [info ] [MainThread]: 
23:41:26.398295 [info ] [MainThread]: Press Ctrl+C to exit.
23:41:26.398966 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88880bac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88880b610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa88880b8e0>]}


============================== 2022-06-06 23:42:00.757019 | 741a1c78-c4b6-47e0-8afe-bb457e7a8528 ==============================
23:42:00.757044 [info ] [MainThread]: Running with dbt=1.1.0
23:42:00.757683 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:42:00.757861 [debug] [MainThread]: Tracking: tracking
23:42:00.762249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23c3e4f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23c3e40a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fe23c3e4f10>]}
23:42:00.765124 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:42:00.765487 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:42:00.765725 [info ] [MainThread]: 
23:42:00.765976 [info ] [MainThread]: 
23:42:00.766188 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:53:49.249367 | bda62090-f582-4938-b097-50dca9530d65 ==============================
23:53:49.249391 [info ] [MainThread]: Running with dbt=1.1.0
23:53:49.250095 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:53:49.250301 [debug] [MainThread]: Tracking: tracking
23:53:49.255351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff223993d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff223993040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff223993070>]}
23:53:49.294339 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
23:53:49.294911 [debug] [MainThread]: Partial parsing: added file: first_project://models/erp/docs.md
23:53:49.306548 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bda62090-f582-4938-b097-50dca9530d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff22385f0d0>]}
23:53:49.314191 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bda62090-f582-4938-b097-50dca9530d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff223891a60>]}
23:53:49.314701 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:53:49.315054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bda62090-f582-4938-b097-50dca9530d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff223891f40>]}
23:53:49.317308 [info ] [MainThread]: 
23:53:49.317925 [debug] [MainThread]: Acquiring new postgres connection "master"
23:53:49.319673 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:53:49.333658 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:53:49.333974 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:53:49.334119 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:53:49.343697 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:53:49.343963 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:53:49.344116 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:53:49.346462 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:53:49.348332 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:53:49.348691 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:53:49.353516 [debug] [MainThread]: Using postgres connection "master"
23:53:49.353770 [debug] [MainThread]: On master: BEGIN
23:53:49.353951 [debug] [MainThread]: Opening a new connection, currently in state init
23:53:49.364211 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:53:49.364504 [debug] [MainThread]: Using postgres connection "master"
23:53:49.364637 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:53:49.388846 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
23:53:49.390591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bda62090-f582-4938-b097-50dca9530d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2239917c0>]}
23:53:49.390960 [debug] [MainThread]: On master: ROLLBACK
23:53:49.391427 [debug] [MainThread]: On master: Close
23:53:49.392195 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:53:49.392557 [info ] [MainThread]: 
23:53:49.398952 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:53:49.399339 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:53:49.403116 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:53:49.401210 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:53:49.404318 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:53:49.404600 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:53:49.404879 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:53:49.406360 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:53:49.403382 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:53:49.406655 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:53:49.402342 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
23:53:49.402585 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
23:53:49.399824 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:53:49.452326 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:53:49.448736 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
23:53:49.452725 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:53:49.453808 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
23:53:49.453071 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:53:49.453267 [debug] [Thread-3  ]: finished collecting timing info
23:53:49.453621 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
23:53:49.402091 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:53:49.453992 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
23:53:49.456570 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
23:53:49.454491 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:53:49.454727 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
23:53:49.455211 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:53:49.458455 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:53:49.456760 [debug] [Thread-6  ]: finished collecting timing info
23:53:49.458800 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
23:53:49.457002 [debug] [Thread-3  ]: finished collecting timing info
23:53:49.458234 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
23:53:49.458600 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:53:49.461333 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:53:49.461693 [debug] [Thread-4  ]: finished collecting timing info
23:53:49.458987 [debug] [Thread-6  ]: finished collecting timing info
23:53:49.459556 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:53:49.459768 [debug] [Thread-5  ]: finished collecting timing info
23:53:49.461944 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:53:49.454266 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:53:49.465600 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:53:49.462419 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
23:53:49.462720 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
23:53:49.455364 [debug] [Thread-2  ]: finished collecting timing info
23:53:49.463423 [debug] [Thread-4  ]: finished collecting timing info
23:53:49.463233 [debug] [Thread-8  ]: Began running node model.first_project.customers2
23:53:49.467537 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
23:53:49.466413 [debug] [Thread-1  ]: finished collecting timing info
23:53:49.467888 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:53:49.468055 [debug] [Thread-1  ]: finished collecting timing info
23:53:49.467698 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
23:53:49.468624 [debug] [Thread-8  ]: Compiling model.first_project.customers2
23:53:49.467155 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:53:49.468432 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:53:49.466635 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:53:49.466020 [debug] [Thread-5  ]: finished collecting timing info
23:53:49.471885 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
23:53:49.472564 [debug] [Thread-10 ]: Began running node model.first_project.customers
23:53:49.473829 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
23:53:49.474029 [debug] [Thread-3  ]: Began running node model.first_project.my_second_dbt_model
23:53:49.475471 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:53:49.474273 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:53:49.476141 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:53:49.476312 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:53:49.473085 [debug] [Thread-2  ]: finished collecting timing info
23:53:49.475757 [debug] [Thread-3  ]: Began compiling node model.first_project.my_second_dbt_model
23:53:49.474923 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
23:53:49.477650 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
23:53:49.477798 [debug] [Thread-10 ]: Compiling model.first_project.customers
23:53:49.477017 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:53:49.477210 [debug] [Thread-8  ]: finished collecting timing info
23:53:49.477456 [debug] [Thread-3  ]: Compiling model.first_project.my_second_dbt_model
23:53:49.474427 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:53:49.484081 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:53:49.484273 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:53:49.484429 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:53:49.483663 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:53:49.476461 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:53:49.497764 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:53:49.481246 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
23:53:49.510522 [debug] [Thread-8  ]: finished collecting timing info
23:53:49.509462 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:53:49.509932 [debug] [Thread-3  ]: finished collecting timing info
23:53:49.511761 [debug] [Thread-3  ]: Began executing node model.first_project.my_second_dbt_model
23:53:49.510717 [debug] [Thread-6  ]: finished collecting timing info
23:53:49.511345 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
23:53:49.512033 [debug] [Thread-3  ]: finished collecting timing info
23:53:49.513337 [debug] [Thread-3  ]: Finished running node model.first_project.my_second_dbt_model
23:53:49.512366 [debug] [Thread-9  ]: finished collecting timing info
23:53:49.512625 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:53:49.480651 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
23:53:49.514430 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:53:49.515537 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:53:49.514652 [debug] [Thread-1  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:53:49.514950 [debug] [Thread-6  ]: finished collecting timing info
23:53:49.517091 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:53:49.515836 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:53:49.516104 [debug] [Thread-10 ]: finished collecting timing info
23:53:49.517651 [debug] [Thread-10 ]: Began executing node model.first_project.customers
23:53:49.514077 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:53:49.517356 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:53:49.516517 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:53:49.523481 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:53:49.523636 [debug] [Thread-1  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:53:49.522788 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:53:49.517841 [debug] [Thread-10 ]: finished collecting timing info
23:53:49.518193 [debug] [Thread-9  ]: finished collecting timing info
23:53:49.527609 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:53:49.528447 [debug] [Thread-10 ]: Finished running node model.first_project.customers
23:53:49.528801 [debug] [Thread-7  ]: finished collecting timing info
23:53:49.531456 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:53:49.531699 [debug] [Thread-7  ]: finished collecting timing info
23:53:49.529436 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:53:49.531934 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:53:49.533772 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:53:49.533979 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:53:49.534111 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:53:49.533031 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:53:49.533189 [debug] [Thread-1  ]: finished collecting timing info
23:53:49.549812 [debug] [Thread-1  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:53:49.532344 [debug] [Thread-8  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:53:49.550550 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:53:49.550762 [debug] [Thread-8  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:53:49.550902 [debug] [Thread-8  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:53:49.550075 [debug] [Thread-1  ]: finished collecting timing info
23:53:49.561252 [debug] [Thread-1  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:53:49.532212 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:53:49.532463 [debug] [Thread-3  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:53:49.562259 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:53:49.560556 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:53:49.561697 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:53:49.562721 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:53:49.562894 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:53:49.562447 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:53:49.548827 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:53:49.566913 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:53:49.567275 [debug] [Thread-3  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
23:53:49.572042 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:53:49.572822 [debug] [Thread-2  ]: finished collecting timing info
23:53:49.573363 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:53:49.573548 [debug] [Thread-3  ]: finished collecting timing info
23:53:49.573741 [debug] [Thread-2  ]: finished collecting timing info
23:53:49.574051 [debug] [Thread-3  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:53:49.574274 [debug] [Thread-8  ]: finished collecting timing info
23:53:49.575827 [debug] [Thread-8  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:53:49.575357 [debug] [Thread-3  ]: finished collecting timing info
23:53:49.576650 [debug] [Thread-3  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:53:49.574908 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:53:49.576113 [debug] [Thread-8  ]: finished collecting timing info
23:53:49.575582 [debug] [Thread-5  ]: finished collecting timing info
23:53:49.577527 [debug] [Thread-8  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:53:49.577791 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:53:49.578256 [debug] [Thread-5  ]: finished collecting timing info
23:53:49.578666 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:53:49.581699 [debug] [MainThread]: Connection 'master' was properly closed.
23:53:49.582061 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:53:49.582236 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:53:49.582382 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
23:53:49.582522 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:53:49.582660 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:53:49.582798 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
23:53:49.582937 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:53:49.583109 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
23:53:49.583253 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:53:49.583515 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:53:49.589567 [info ] [MainThread]: Done.
23:53:49.593706 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:53:49.593952 [info ] [MainThread]: Building catalog
23:53:49.596613 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:53:49.609750 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:53:49.610250 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:53:49.610410 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:53:49.617272 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:53:49.617581 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:53:49.617716 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:53:49.622295 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:53:49.635543 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:53:49.636147 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:53:49.647553 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:53:49.648263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff223993d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2265e42b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff2238994f0>]}
23:53:50.254626 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:53:50.255070 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:53:55.505279 | 9f664176-f4f7-4ebf-9fde-8357efe72795 ==============================
23:53:55.505304 [info ] [MainThread]: Running with dbt=1.1.0
23:53:55.506079 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:53:55.506305 [debug] [MainThread]: Tracking: tracking
23:53:55.511420 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fec648b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fec641f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb3fec64be0>]}
23:53:55.514351 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:53:55.514809 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:53:55.515322 [info ] [MainThread]: 
23:53:55.515757 [info ] [MainThread]: 
23:53:55.517980 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-06 23:57:30.234766 | 4e4ea0e4-fc18-45be-b6eb-b7ca0010c202 ==============================
23:57:30.234792 [info ] [MainThread]: Running with dbt=1.1.0
23:57:30.235500 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
23:57:30.235676 [debug] [MainThread]: Tracking: tracking
23:57:30.240655 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419aa580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419aaca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419aa130>]}
23:57:30.279218 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
23:57:30.280157 [debug] [MainThread]: Partial parsing: update schema file: first_project://models/erp/schema.yml
23:57:30.280509 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/docs.md
23:57:30.294591 [debug] [MainThread]: 1699: static parser successfully parsed erp/customers.sql
23:57:30.405270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4e4ea0e4-fc18-45be-b6eb-b7ca0010c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419ad040>]}
23:57:30.411388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4e4ea0e4-fc18-45be-b6eb-b7ca0010c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419acf10>]}
23:57:30.411736 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
23:57:30.412017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e4ea0e4-fc18-45be-b6eb-b7ca0010c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419acf70>]}
23:57:30.413793 [info ] [MainThread]: 
23:57:30.414302 [debug] [MainThread]: Acquiring new postgres connection "master"
23:57:30.415633 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
23:57:30.425338 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:57:30.425572 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
23:57:30.425707 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:30.435008 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:57:30.435398 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
23:57:30.435582 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
23:57:30.438096 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
23:57:30.440492 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
23:57:30.440833 [debug] [ThreadPool]: On list_erp_oltp_public: Close
23:57:30.447645 [debug] [MainThread]: Using postgres connection "master"
23:57:30.447885 [debug] [MainThread]: On master: BEGIN
23:57:30.448003 [debug] [MainThread]: Opening a new connection, currently in state init
23:57:30.455491 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
23:57:30.455764 [debug] [MainThread]: Using postgres connection "master"
23:57:30.455882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
23:57:30.481206 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
23:57:30.483166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4e4ea0e4-fc18-45be-b6eb-b7ca0010c202', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419aeb50>]}
23:57:30.483576 [debug] [MainThread]: On master: ROLLBACK
23:57:30.484024 [debug] [MainThread]: On master: Close
23:57:30.484686 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
23:57:30.485016 [info ] [MainThread]: 
23:57:30.491887 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
23:57:30.492665 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
23:57:30.492901 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
23:57:30.493076 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
23:57:30.495978 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
23:57:30.496270 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
23:57:30.496543 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
23:57:30.496835 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
23:57:30.497500 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
23:57:30.497789 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
23:57:30.498386 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
23:57:30.498902 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
23:57:30.507208 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
23:57:30.505693 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
23:57:30.506532 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
23:57:30.506909 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
23:57:30.504931 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
23:57:30.508766 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
23:57:30.507683 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
23:57:30.508084 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
23:57:30.509290 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
23:57:30.508546 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
23:57:30.508933 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
23:57:30.507397 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
23:57:30.509096 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
23:57:30.510811 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
23:57:30.523933 [debug] [Thread-6  ]: finished collecting timing info
23:57:30.518491 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
23:57:30.520101 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
23:57:30.521578 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
23:57:30.523605 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
23:57:30.524164 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
23:57:30.525592 [debug] [Thread-6  ]: finished collecting timing info
23:57:30.524918 [debug] [Thread-5  ]: finished collecting timing info
23:57:30.526614 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
23:57:30.525433 [debug] [Thread-3  ]: finished collecting timing info
23:57:30.525817 [debug] [Thread-4  ]: finished collecting timing info
23:57:30.526363 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
23:57:30.508330 [debug] [Thread-1  ]: finished collecting timing info
23:57:30.526788 [debug] [Thread-5  ]: finished collecting timing info
23:57:30.528201 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
23:57:30.525087 [debug] [Thread-2  ]: finished collecting timing info
23:57:30.527256 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
23:57:30.527677 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
23:57:30.528961 [debug] [Thread-1  ]: finished collecting timing info
23:57:30.528670 [debug] [Thread-4  ]: finished collecting timing info
23:57:30.529885 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
23:57:30.526986 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
23:57:30.530231 [debug] [Thread-3  ]: finished collecting timing info
23:57:30.530818 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
23:57:30.529425 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
23:57:30.528469 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
23:57:30.531657 [debug] [Thread-2  ]: finished collecting timing info
23:57:30.531858 [debug] [Thread-8  ]: Began running node model.first_project.customers
23:57:30.532056 [debug] [Thread-9  ]: Began running node model.first_project.customers2
23:57:30.532492 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
23:57:30.532675 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
23:57:30.533118 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
23:57:30.533336 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:30.535349 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:57:30.535505 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:30.535633 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:30.534918 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
23:57:30.533840 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
23:57:30.534698 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
23:57:30.546760 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
23:57:30.546015 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
23:57:30.546297 [debug] [Thread-8  ]: Compiling model.first_project.customers
23:57:30.546554 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
23:57:30.546921 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
23:57:30.534080 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:30.549415 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
23:57:30.549689 [debug] [Thread-9  ]: Compiling model.first_project.customers2
23:57:30.552437 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
23:57:30.552679 [debug] [Thread-7  ]: finished collecting timing info
23:57:30.556571 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:30.555833 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
23:57:30.556216 [debug] [Thread-8  ]: finished collecting timing info
23:57:30.553115 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:57:30.557490 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:30.557168 [debug] [Thread-8  ]: Began executing node model.first_project.customers
23:57:30.557920 [debug] [Thread-8  ]: finished collecting timing info
23:57:30.557680 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:30.556792 [debug] [Thread-7  ]: finished collecting timing info
23:57:30.558445 [debug] [Thread-8  ]: Finished running node model.first_project.customers
23:57:30.557309 [debug] [Thread-10 ]: finished collecting timing info
23:57:30.558599 [debug] [Thread-9  ]: finished collecting timing info
23:57:30.565087 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
23:57:30.565937 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
23:57:30.567426 [debug] [Thread-10 ]: finished collecting timing info
23:57:30.566400 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
23:57:30.566781 [debug] [Thread-4  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:30.566974 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:30.568677 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:57:30.567241 [debug] [Thread-5  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:57:30.569215 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:57:30.569353 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:57:30.567971 [debug] [Thread-9  ]: finished collecting timing info
23:57:30.568281 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:57:30.568831 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:30.570299 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:30.567766 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
23:57:30.565636 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
23:57:30.569468 [debug] [Thread-5  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
23:57:30.569580 [debug] [Thread-6  ]: finished collecting timing info
23:57:30.569943 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
23:57:30.570120 [debug] [Thread-4  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:30.573664 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
23:57:30.567118 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:30.574221 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:30.578709 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:57:30.578846 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:30.577733 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:30.578016 [debug] [Thread-4  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:30.578385 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:57:30.574341 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:30.578951 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:30.577444 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
23:57:30.579225 [debug] [Thread-3  ]: finished collecting timing info
23:57:30.592535 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:30.587228 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
23:57:30.587620 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:30.587958 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:57:30.592146 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
23:57:30.579487 [debug] [Thread-6  ]: finished collecting timing info
23:57:30.594648 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
23:57:30.592761 [debug] [Thread-3  ]: finished collecting timing info
23:57:30.593296 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:30.593542 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:30.604776 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:30.594091 [debug] [Thread-8  ]: finished collecting timing info
23:57:30.592977 [debug] [Thread-5  ]: finished collecting timing info
23:57:30.609029 [debug] [Thread-5  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:57:30.604415 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
23:57:30.593934 [debug] [Thread-4  ]: finished collecting timing info
23:57:30.608523 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
23:57:30.608825 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:30.609184 [debug] [Thread-5  ]: finished collecting timing info
23:57:30.611651 [debug] [Thread-5  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
23:57:30.595182 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
23:57:30.609801 [debug] [Thread-8  ]: finished collecting timing info
23:57:30.612334 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
23:57:30.610215 [debug] [Thread-2  ]: finished collecting timing info
23:57:30.609486 [debug] [Thread-4  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:30.612821 [debug] [Thread-4  ]: finished collecting timing info
23:57:30.612590 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:30.613199 [debug] [Thread-4  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
23:57:30.610020 [debug] [Thread-1  ]: finished collecting timing info
23:57:30.613395 [debug] [Thread-2  ]: finished collecting timing info
23:57:30.613701 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:30.614112 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
23:57:30.614321 [debug] [Thread-1  ]: finished collecting timing info
23:57:30.615040 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
23:57:30.616239 [debug] [MainThread]: Connection 'master' was properly closed.
23:57:30.616376 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
23:57:30.616468 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
23:57:30.616552 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
23:57:30.616633 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
23:57:30.616726 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
23:57:30.616808 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
23:57:30.616887 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
23:57:30.616965 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
23:57:30.617045 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
23:57:30.617123 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
23:57:30.621844 [info ] [MainThread]: Done.
23:57:30.624273 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
23:57:30.624486 [info ] [MainThread]: Building catalog
23:57:30.626782 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
23:57:30.633821 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:57:30.634118 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
23:57:30.634274 [debug] [ThreadPool]: Opening a new connection, currently in state init
23:57:30.641438 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
23:57:30.641717 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
23:57:30.641823 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
23:57:30.645285 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
23:57:30.655410 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
23:57:30.657147 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
23:57:30.668477 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
23:57:30.669140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67419aa580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6740394b50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f674196a610>]}
23:57:31.729450 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
23:57:31.730015 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-06 23:57:52.248107 | cf48e6ca-f3df-4cf5-83bf-39e6ff413043 ==============================
23:57:52.248134 [info ] [MainThread]: Running with dbt=1.1.0
23:57:52.248817 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
23:57:52.249076 [debug] [MainThread]: Tracking: tracking
23:57:52.255331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6095fb88b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6095fb81f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f6095fb8be0>]}
23:57:52.258514 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
23:57:52.258874 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
23:57:52.259085 [info ] [MainThread]: 
23:57:52.259313 [info ] [MainThread]: 
23:57:52.259505 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:06:07.373390 | acb10887-2314-4fe9-9695-41654feaed8a ==============================
00:06:07.373416 [info ] [MainThread]: Running with dbt=1.1.0
00:06:07.374089 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:06:07.374266 [debug] [MainThread]: Tracking: tracking
00:06:07.378977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93484a5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93484a5c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93484a55e0>]}
00:06:07.413764 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
00:06:07.414301 [debug] [MainThread]: Partial parsing: added file: first_project://models/overview.md
00:06:07.427349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'acb10887-2314-4fe9-9695-41654feaed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9348379fd0>]}
00:06:07.435126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'acb10887-2314-4fe9-9695-41654feaed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93484a2670>]}
00:06:07.435689 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:06:07.436170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb10887-2314-4fe9-9695-41654feaed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93484a7b20>]}
00:06:07.438571 [info ] [MainThread]: 
00:06:07.439295 [debug] [MainThread]: Acquiring new postgres connection "master"
00:06:07.440750 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:06:07.451943 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:06:07.452244 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:06:07.452391 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:06:07.463046 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:06:07.463362 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:06:07.463524 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:06:07.466718 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:06:07.469075 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:06:07.469740 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:06:07.475171 [debug] [MainThread]: Using postgres connection "master"
00:06:07.475435 [debug] [MainThread]: On master: BEGIN
00:06:07.475569 [debug] [MainThread]: Opening a new connection, currently in state init
00:06:07.483586 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:06:07.483896 [debug] [MainThread]: Using postgres connection "master"
00:06:07.484048 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:06:07.511322 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
00:06:07.512965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'acb10887-2314-4fe9-9695-41654feaed8a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93483ad0d0>]}
00:06:07.513343 [debug] [MainThread]: On master: ROLLBACK
00:06:07.513731 [debug] [MainThread]: On master: Close
00:06:07.514298 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:06:07.514717 [info ] [MainThread]: 
00:06:07.521394 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:06:07.522129 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:06:07.522337 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:06:07.522503 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:06:07.525885 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:06:07.526385 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:06:07.526655 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:06:07.526858 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:06:07.527082 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:06:07.527221 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:06:07.570958 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:06:07.571133 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:06:07.569575 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:06:07.570065 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:06:07.570577 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:06:07.571257 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:06:07.573094 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:06:07.573276 [debug] [Thread-6  ]: finished collecting timing info
00:06:07.571518 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:06:07.571706 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:06:07.571863 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:06:07.573415 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:06:07.574060 [debug] [Thread-6  ]: finished collecting timing info
00:06:07.574460 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:06:07.573576 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:06:07.573738 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:06:07.573884 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:06:07.528186 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:06:07.578553 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:06:07.575801 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:06:07.577210 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:06:07.578334 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:06:07.578707 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:06:07.581414 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:06:07.579122 [debug] [Thread-5  ]: finished collecting timing info
00:06:07.527730 [debug] [Thread-1  ]: finished collecting timing info
00:06:07.581629 [debug] [Thread-3  ]: finished collecting timing info
00:06:07.581941 [debug] [Thread-4  ]: finished collecting timing info
00:06:07.582282 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:06:07.582591 [debug] [Thread-2  ]: finished collecting timing info
00:06:07.583596 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:06:07.583053 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:06:07.583247 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:06:07.583422 [debug] [Thread-5  ]: finished collecting timing info
00:06:07.583806 [debug] [Thread-2  ]: finished collecting timing info
00:06:07.585052 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:06:07.583961 [debug] [Thread-3  ]: finished collecting timing info
00:06:07.584127 [debug] [Thread-4  ]: finished collecting timing info
00:06:07.584596 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:06:07.582788 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:06:07.585610 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:06:07.586072 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:06:07.586461 [debug] [Thread-1  ]: finished collecting timing info
00:06:07.586965 [debug] [Thread-8  ]: Began running node model.first_project.customers2
00:06:07.587429 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:06:07.587649 [debug] [Thread-10 ]: Began running node model.first_project.customers
00:06:07.588657 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
00:06:07.588808 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
00:06:07.588922 [debug] [Thread-10 ]: Compiling model.first_project.customers
00:06:07.588005 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
00:06:07.591435 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
00:06:07.591694 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
00:06:07.592426 [debug] [Thread-8  ]: Compiling model.first_project.customers2
00:06:07.591975 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:07.592125 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:07.591858 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
00:06:07.596210 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:06:07.595230 [debug] [Thread-10 ]: finished collecting timing info
00:06:07.596613 [debug] [Thread-10 ]: Began executing node model.first_project.customers
00:06:07.595878 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:06:07.596414 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
00:06:07.597059 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
00:06:07.596904 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:07.599569 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:07.596777 [debug] [Thread-10 ]: finished collecting timing info
00:06:07.594932 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
00:06:07.599301 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:06:07.595583 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:06:07.615076 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:07.615224 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:07.614640 [debug] [Thread-8  ]: finished collecting timing info
00:06:07.614832 [debug] [Thread-6  ]: finished collecting timing info
00:06:07.611697 [debug] [Thread-10 ]: Finished running node model.first_project.customers
00:06:07.614009 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:06:07.624494 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:06:07.624758 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
00:06:07.624998 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
00:06:07.626771 [debug] [Thread-6  ]: finished collecting timing info
00:06:07.625873 [debug] [Thread-9  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:07.626049 [debug] [Thread-7  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:07.626275 [debug] [Thread-1  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:06:07.629601 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:06:07.629859 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:06:07.627325 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
00:06:07.627579 [debug] [Thread-2  ]: finished collecting timing info
00:06:07.628214 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:06:07.630992 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:07.629113 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:06:07.631486 [debug] [Thread-7  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:07.625668 [debug] [Thread-4  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:07.632060 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:06:07.630584 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:07.631264 [debug] [Thread-9  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:07.630073 [debug] [Thread-1  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:06:07.628510 [debug] [Thread-5  ]: finished collecting timing info
00:06:07.631641 [debug] [Thread-7  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:07.626521 [debug] [Thread-8  ]: finished collecting timing info
00:06:07.653595 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
00:06:07.632240 [debug] [Thread-4  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:07.653975 [debug] [Thread-4  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:07.632842 [debug] [Thread-2  ]: finished collecting timing info
00:06:07.638252 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:06:07.643576 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:06:07.643991 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:07.652914 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:06:07.632596 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:07.673883 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:06:07.674094 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:07.674272 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:07.632430 [debug] [Thread-10 ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:07.678411 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:06:07.678568 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:07.678679 [debug] [Thread-10 ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:07.673313 [debug] [Thread-5  ]: finished collecting timing info
00:06:07.672633 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:06:07.677837 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:06:07.673063 [debug] [Thread-9  ]: finished collecting timing info
00:06:07.670044 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:06:07.671297 [debug] [Thread-1  ]: finished collecting timing info
00:06:07.681996 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:06:07.682559 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:06:07.682976 [debug] [Thread-7  ]: finished collecting timing info
00:06:07.683404 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:07.685610 [debug] [Thread-9  ]: finished collecting timing info
00:06:07.686016 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:06:07.684752 [debug] [Thread-10 ]: finished collecting timing info
00:06:07.686391 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:07.686589 [debug] [Thread-10 ]: finished collecting timing info
00:06:07.683913 [debug] [Thread-1  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:06:07.687463 [debug] [Thread-1  ]: finished collecting timing info
00:06:07.684955 [debug] [Thread-7  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:07.685366 [debug] [Thread-4  ]: finished collecting timing info
00:06:07.687152 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:06:07.687854 [debug] [Thread-1  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:06:07.684436 [debug] [Thread-3  ]: finished collecting timing info
00:06:07.688077 [debug] [Thread-7  ]: finished collecting timing info
00:06:07.688255 [debug] [Thread-4  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:07.689423 [debug] [Thread-4  ]: finished collecting timing info
00:06:07.689219 [debug] [Thread-7  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:06:07.689753 [debug] [Thread-4  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:06:07.688834 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:07.690153 [debug] [Thread-3  ]: finished collecting timing info
00:06:07.690511 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:06:07.692388 [debug] [MainThread]: Connection 'master' was properly closed.
00:06:07.692545 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:06:07.692663 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:06:07.692780 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:06:07.692871 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:06:07.692960 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:06:07.693047 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:06:07.693133 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:06:07.693219 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:06:07.693303 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:06:07.693387 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:06:07.698258 [info ] [MainThread]: Done.
00:06:07.701483 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:06:07.701953 [info ] [MainThread]: Building catalog
00:06:07.706904 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:06:07.716830 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:06:07.717083 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:06:07.717203 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:06:07.726533 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:06:07.726850 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:06:07.727071 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:06:07.730930 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
00:06:07.743214 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:06:07.743742 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:06:07.755855 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:06:07.756516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93484a5520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f93482fdf40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f9349d24310>]}
00:06:08.342456 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:06:08.343047 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:06:16.101605 | 38b296ff-757c-41df-9d73-e0618d7aca76 ==============================
00:06:16.101631 [info ] [MainThread]: Running with dbt=1.1.0
00:06:16.102261 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:06:16.102459 [debug] [MainThread]: Tracking: tracking
00:06:16.107824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b8e6e340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b8e6ef40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f67b8e6e1f0>]}
00:06:16.111103 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:06:16.111621 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:06:16.111853 [info ] [MainThread]: 
00:06:16.112467 [info ] [MainThread]: 
00:06:16.112822 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:30:35.226066 | 71aa387e-3fdb-4952-acba-43685bbc7a33 ==============================
00:30:35.226099 [info ] [MainThread]: Running with dbt=1.1.0
00:30:35.226986 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'which': 'run', 'rpc_method': 'run', 'indirect_selection': 'eager'}
00:30:35.227253 [debug] [MainThread]: Tracking: tracking
00:30:35.232525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1141a520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1141ac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1141a5e0>]}
00:30:35.271972 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:30:35.272877 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:30:35.286597 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:30:35.303387 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:30:35.407794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1141f100>]}
00:30:35.414255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1141cc70>]}
00:30:35.414606 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:30:35.415026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1141a5e0>]}
00:30:35.416731 [info ] [MainThread]: 
00:30:35.417294 [debug] [MainThread]: Acquiring new postgres connection "master"
00:30:35.418510 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp"
00:30:35.430237 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp"
00:30:35.430485 [debug] [ThreadPool]: On list_erp_oltp: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp"} */

    select distinct nspname from pg_namespace
  
00:30:35.430656 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:30:35.442033 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.01 seconds
00:30:35.443632 [debug] [ThreadPool]: On list_erp_oltp: Close
00:30:35.446598 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:30:35.452157 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:30:35.452768 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:30:35.454208 [debug] [ThreadPool]: Opening a new connection, currently in state closed
00:30:35.461912 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:30:35.462168 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:30:35.462277 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:30:35.464199 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:30:35.465465 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:30:35.465781 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:30:35.469810 [debug] [MainThread]: Using postgres connection "master"
00:30:35.469998 [debug] [MainThread]: On master: BEGIN
00:30:35.470099 [debug] [MainThread]: Opening a new connection, currently in state init
00:30:35.476842 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:30:35.477131 [debug] [MainThread]: Using postgres connection "master"
00:30:35.477242 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:30:35.496403 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:30:35.497876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e113d9640>]}
00:30:35.498228 [debug] [MainThread]: On master: ROLLBACK
00:30:35.498605 [debug] [MainThread]: Using postgres connection "master"
00:30:35.498746 [debug] [MainThread]: On master: BEGIN
00:30:35.499145 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
00:30:35.499315 [debug] [MainThread]: On master: COMMIT
00:30:35.499421 [debug] [MainThread]: Using postgres connection "master"
00:30:35.499515 [debug] [MainThread]: On master: COMMIT
00:30:35.499757 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:30:35.499908 [debug] [MainThread]: On master: Close
00:30:35.500911 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:30:35.501190 [info ] [MainThread]: 
00:30:35.505758 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:30:35.506214 [info ] [Thread-1  ]: 1 of 7 START table model public.my_first_dbt_model ............................. [RUN]
00:30:35.506802 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:30:35.507099 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:30:35.507331 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:30:35.510374 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:30:35.511505 [debug] [Thread-1  ]: finished collecting timing info
00:30:35.511954 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:30:35.512789 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:30:35.517480 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:30:35.536207 [info ] [Thread-3  ]: 3 of 7 START view model public.stg_customers ................................... [RUN]
00:30:35.535765 [info ] [Thread-2  ]: 2 of 7 START view model public.postgres_sample_source_customers ................ [RUN]
00:30:35.557608 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:30:35.548303 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:30:35.558095 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:30:35.557857 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:30:35.558584 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:30:35.558363 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:30:35.556586 [debug] [Thread-1  ]: Writing runtime SQL for node "model.first_project.my_first_dbt_model"
00:30:35.517727 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:30:35.561964 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:30:35.563641 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:30:35.564159 [info ] [Thread-4  ]: 4 of 7 START view model public.stg_orders ...................................... [RUN]
00:30:35.564732 [debug] [Thread-2  ]: finished collecting timing info
00:30:35.564908 [debug] [Thread-3  ]: finished collecting timing info
00:30:35.567750 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:30:35.567446 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:30:35.565577 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:30:35.568013 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:30:35.591204 [debug] [Thread-3  ]: Writing runtime SQL for node "model.first_project.stg_customers"
00:30:35.594604 [debug] [Thread-2  ]: Writing runtime SQL for node "model.first_project.postgres_sample_source_customers"
00:30:35.595099 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:30:35.595415 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: BEGIN
00:30:35.600745 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:30:35.601577 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:30:35.602224 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:30:35.604572 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: BEGIN
00:30:35.604269 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:30:35.605293 [debug] [Thread-4  ]: finished collecting timing info
00:30:35.604828 [debug] [Thread-2  ]: Opening a new connection, currently in state init
00:30:35.602498 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
00:30:35.605501 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:30:35.610187 [debug] [Thread-4  ]: Writing runtime SQL for node "model.first_project.stg_orders"
00:30:35.610693 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:30:35.610890 [debug] [Thread-4  ]: On model.first_project.stg_orders: BEGIN
00:30:35.611001 [debug] [Thread-4  ]: Opening a new connection, currently in state init
00:30:35.602715 [debug] [Thread-3  ]: On model.first_project.stg_customers: BEGIN
00:30:35.611640 [debug] [Thread-3  ]: Opening a new connection, currently in state init
00:30:35.616641 [debug] [Thread-1  ]: SQL status: BEGIN in 0.01 seconds
00:30:35.616874 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:30:35.617023 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */


  create  table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp"
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
00:30:35.617647 [debug] [Thread-2  ]: SQL status: BEGIN in 0.01 seconds
00:30:35.617831 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:30:35.617989 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */

  create view "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" as (
    with source_customers as (
  select * from "erp_oltp"."public"."clientes"
),
final as (
  select * from source_customers
)
select * from final
  );
00:30:35.619262 [debug] [Thread-1  ]: SQL status: SELECT 2 in 0.0 seconds
00:30:35.628727 [debug] [Thread-2  ]: SQL status: CREATE VIEW in 0.01 seconds
00:30:35.635043 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:30:35.637268 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers" rename to "postgres_sample_source_customers__dbt_backup"
00:30:35.636993 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:30:35.637980 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
00:30:35.637678 [debug] [Thread-4  ]: SQL status: BEGIN in 0.03 seconds
00:30:35.638413 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:30:35.638599 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */

  create view "erp_oltp"."public"."stg_orders__dbt_tmp" as (
    with orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
)
select * from orders
  );
00:30:35.638820 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.642971 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:30:35.643430 [debug] [Thread-3  ]: SQL status: BEGIN in 0.03 seconds
00:30:35.644405 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:30:35.643980 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.01 seconds
00:30:35.647426 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:30:35.644658 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */

  create view "erp_oltp"."public"."stg_customers__dbt_tmp" as (
    with customers as (
  select
    codigo_cliente as customer_id,
    nome as first_name,
    sobrenome as last_name,
    codigo_regiao as region_code,
    estado        as state
  from erp_oltp.public.clientes
)
select * from customers
  );
00:30:35.643740 [debug] [Thread-4  ]: SQL status: CREATE VIEW in 0.01 seconds
00:30:35.644158 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
alter table "erp_oltp"."public"."postgres_sample_source_customers__dbt_tmp" rename to "postgres_sample_source_customers"
00:30:35.647662 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
alter table "erp_oltp"."public"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
00:30:35.651907 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:30:35.652628 [debug] [Thread-1  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.652794 [debug] [Thread-2  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.669531 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
00:30:35.669748 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:30:35.667929 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
00:30:35.654285 [debug] [Thread-3  ]: SQL status: CREATE VIEW in 0.01 seconds
00:30:35.654507 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders" rename to "stg_orders__dbt_backup"
00:30:35.669908 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: COMMIT
00:30:35.670253 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:30:35.674813 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:30:35.676059 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.676460 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: COMMIT
00:30:35.676898 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers" rename to "stg_customers__dbt_backup"
00:30:35.679820 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:30:35.680717 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.681230 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
alter table "erp_oltp"."public"."stg_orders__dbt_tmp" rename to "stg_orders"
00:30:35.683711 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:30:35.684445 [debug] [Thread-2  ]: SQL status: COMMIT in 0.01 seconds
00:30:35.684700 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
alter table "erp_oltp"."public"."stg_customers__dbt_tmp" rename to "stg_customers"
00:30:35.690129 [debug] [Thread-4  ]: SQL status: ALTER TABLE in 0.01 seconds
00:30:35.692005 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
00:30:35.692672 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:30:35.692415 [debug] [Thread-2  ]: Using postgres connection "model.first_project.postgres_sample_source_customers"
00:30:35.690311 [debug] [Thread-1  ]: SQL status: COMMIT in 0.01 seconds
00:30:35.692903 [debug] [Thread-3  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.693028 [debug] [Thread-4  ]: On model.first_project.stg_orders: COMMIT
00:30:35.693203 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.postgres_sample_source_customers"} */
drop view if exists "erp_oltp"."public"."postgres_sample_source_customers__dbt_backup" cascade
00:30:35.694933 [debug] [Thread-1  ]: Using postgres connection "model.first_project.my_first_dbt_model"
00:30:35.696316 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
00:30:35.697714 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_first_dbt_model"} */
drop table if exists "erp_oltp"."public"."my_first_dbt_model__dbt_backup" cascade
00:30:35.697904 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:30:35.699027 [debug] [Thread-3  ]: On model.first_project.stg_customers: COMMIT
00:30:35.706022 [debug] [Thread-4  ]: SQL status: COMMIT in 0.01 seconds
00:30:35.708231 [debug] [Thread-4  ]: Using postgres connection "model.first_project.stg_orders"
00:30:35.708691 [debug] [Thread-4  ]: On model.first_project.stg_orders: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_orders"} */
drop view if exists "erp_oltp"."public"."stg_orders__dbt_backup" cascade
00:30:35.712255 [debug] [Thread-1  ]: SQL status: DROP TABLE in 0.01 seconds
00:30:35.712560 [debug] [Thread-2  ]: SQL status: DROP VIEW in 0.02 seconds
00:30:35.712790 [debug] [Thread-3  ]: SQL status: COMMIT in 0.01 seconds
00:30:35.717213 [debug] [Thread-3  ]: Using postgres connection "model.first_project.stg_customers"
00:30:35.715675 [debug] [Thread-2  ]: finished collecting timing info
00:30:35.717785 [debug] [Thread-2  ]: On model.first_project.postgres_sample_source_customers: Close
00:30:35.717561 [debug] [Thread-3  ]: On model.first_project.stg_customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.stg_customers"} */
drop view if exists "erp_oltp"."public"."stg_customers__dbt_backup" cascade
00:30:35.719539 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e10219af0>]}
00:30:35.719929 [info ] [Thread-2  ]: 2 of 7 OK created view model public.postgres_sample_source_customers ........... [[32mCREATE VIEW[0m in 0.16s]
00:30:35.720341 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:30:35.720536 [debug] [Thread-4  ]: SQL status: DROP VIEW in 0.01 seconds
00:30:35.714308 [debug] [Thread-1  ]: finished collecting timing info
00:30:35.721724 [debug] [Thread-4  ]: finished collecting timing info
00:30:35.722066 [debug] [Thread-1  ]: On model.first_project.my_first_dbt_model: Close
00:30:35.722287 [debug] [Thread-4  ]: On model.first_project.stg_orders: Close
00:30:35.726012 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1021c100>]}
00:30:35.726701 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e132172b0>]}
00:30:35.727408 [info ] [Thread-4  ]: 4 of 7 OK created view model public.stg_orders ................................. [[32mCREATE VIEW[0m in 0.16s]
00:30:35.727912 [info ] [Thread-1  ]: 1 of 7 OK created table model public.my_first_dbt_model ........................ [[32mSELECT 2[0m in 0.22s]
00:30:35.728619 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:30:35.729358 [debug] [Thread-3  ]: SQL status: DROP VIEW in 0.01 seconds
00:30:35.730593 [debug] [Thread-3  ]: finished collecting timing info
00:30:35.730793 [debug] [Thread-3  ]: On model.first_project.stg_customers: Close
00:30:35.731298 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e11420b20>]}
00:30:35.731708 [info ] [Thread-3  ]: 3 of 7 OK created view model public.stg_customers .............................. [[32mCREATE VIEW[0m in 0.18s]
00:30:35.734718 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:30:35.735470 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
00:30:35.735732 [info ] [Thread-6  ]: 5 of 7 START view model public.my_second_dbt_model ............................. [RUN]
00:30:35.736163 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:30:35.736305 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
00:30:35.736469 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
00:30:35.738890 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:30:35.739717 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:30:35.741392 [debug] [Thread-8  ]: Began running node model.first_project.customers
00:30:35.742305 [info ] [Thread-8  ]: 6 of 7 START view model public.customers ....................................... [RUN]
00:30:35.743486 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
00:30:35.743795 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
00:30:35.744053 [debug] [Thread-9  ]: Began running node model.first_project.customers2
00:30:35.744434 [debug] [Thread-8  ]: Compiling model.first_project.customers
00:30:35.744828 [info ] [Thread-9  ]: 7 of 7 START table model public.customers2 ..................................... [RUN]
00:30:35.748589 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
00:30:35.752732 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
00:30:35.753091 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
00:30:35.753279 [debug] [Thread-9  ]: Compiling model.first_project.customers2
00:30:35.756072 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
00:30:35.756545 [debug] [Thread-8  ]: finished collecting timing info
00:30:35.756780 [debug] [Thread-6  ]: finished collecting timing info
00:30:35.757540 [debug] [Thread-8  ]: Began executing node model.first_project.customers
00:30:35.757757 [debug] [Thread-9  ]: finished collecting timing info
00:30:35.757951 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
00:30:35.765240 [debug] [Thread-8  ]: Writing runtime SQL for node "model.first_project.customers"
00:30:35.765758 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
00:30:35.768668 [debug] [Thread-6  ]: Writing runtime SQL for node "model.first_project.my_second_dbt_model"
00:30:35.773802 [debug] [Thread-9  ]: Writing runtime SQL for node "model.first_project.customers2"
00:30:35.774648 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:30:35.774914 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:30:35.775187 [debug] [Thread-9  ]: On model.first_project.customers2: BEGIN
00:30:35.775385 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: BEGIN
00:30:35.776178 [debug] [Thread-6  ]: Opening a new connection, currently in state init
00:30:35.775950 [debug] [Thread-9  ]: Opening a new connection, currently in state init
00:30:35.775718 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:30:35.778191 [debug] [Thread-8  ]: On model.first_project.customers: BEGIN
00:30:35.778518 [debug] [Thread-8  ]: Opening a new connection, currently in state init
00:30:35.786634 [debug] [Thread-6  ]: SQL status: BEGIN in 0.01 seconds
00:30:35.786965 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:30:35.787142 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */

  create view "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "erp_oltp"."public"."my_first_dbt_model"
where id = 1
  );
00:30:35.787895 [debug] [Thread-8  ]: SQL status: BEGIN in 0.01 seconds
00:30:35.788134 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:30:35.788246 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */

  create view "erp_oltp"."public"."customers__dbt_tmp" as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
   select * from "erp_oltp"."public"."stg_orders"
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders,
    customers.state
from customers
  left join customer_orders using (customer_id)
  WHERE customers.customer_id != 63
)
select * from final
  );
00:30:35.788620 [debug] [Thread-6  ]: SQL status: CREATE VIEW in 0.0 seconds
00:30:35.792019 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:30:35.792237 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
alter table "erp_oltp"."public"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
00:30:35.792417 [debug] [Thread-9  ]: SQL status: BEGIN in 0.02 seconds
00:30:35.792747 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:30:35.792882 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */


  create  table "erp_oltp"."public"."customers2__dbt_tmp"
  as (
    

with customers as (
   select * from "erp_oltp"."public"."stg_customers"
),
orders as (
  select
    numero_pedidos as order_id,
    codigo_cliente as customer_id,
    data_pedido as order_date
    from erp_oltp.public.pedidos
),
customer_orders as (
  select
    customer_id,
    min(order_date) as first_order_date,
    max(order_date) as most_recent_order_date,
    count(order_id) as number_of_orders
  from orders
  group by 1
),
final as (
  select
    customers.customer_id,
    customers.first_name,
    customers.last_name,
    customer_orders.first_order_date,
    customer_orders.most_recent_order_date,
    coalesce(customer_orders.number_of_orders, 0) as number_of_orders
from customers
  left join customer_orders using (customer_id)
)
select * from final
  );
00:30:35.793397 [debug] [Thread-6  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.794823 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
00:30:35.795100 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:30:35.795269 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: COMMIT
00:30:35.796235 [debug] [Thread-9  ]: SQL status: SELECT 100 in 0.0 seconds
00:30:35.798505 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:30:35.798700 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2" rename to "customers2__dbt_backup"
00:30:35.798888 [debug] [Thread-8  ]: SQL status: CREATE VIEW in 0.01 seconds
00:30:35.802084 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:30:35.802356 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.802562 [debug] [Thread-6  ]: SQL status: COMMIT in 0.01 seconds
00:30:35.802721 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
alter table "erp_oltp"."public"."customers__dbt_tmp" rename to "customers"
00:30:35.805113 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:30:35.808158 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
alter table "erp_oltp"."public"."customers2__dbt_tmp" rename to "customers2"
00:30:35.807650 [debug] [Thread-6  ]: Using postgres connection "model.first_project.my_second_dbt_model"
00:30:35.808555 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.my_second_dbt_model"} */
drop view if exists "erp_oltp"."public"."my_second_dbt_model__dbt_backup" cascade
00:30:35.809404 [debug] [Thread-9  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.809628 [debug] [Thread-8  ]: SQL status: ALTER TABLE in 0.0 seconds
00:30:35.812100 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
00:30:35.813805 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
00:30:35.814429 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:30:35.814217 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:30:35.814567 [debug] [Thread-8  ]: On model.first_project.customers: COMMIT
00:30:35.813987 [debug] [Thread-6  ]: SQL status: DROP VIEW in 0.0 seconds
00:30:35.814738 [debug] [Thread-9  ]: On model.first_project.customers2: COMMIT
00:30:35.816167 [debug] [Thread-6  ]: finished collecting timing info
00:30:35.817084 [debug] [Thread-6  ]: On model.first_project.my_second_dbt_model: Close
00:30:35.817602 [debug] [Thread-6  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e114202b0>]}
00:30:35.817996 [info ] [Thread-6  ]: 5 of 7 OK created view model public.my_second_dbt_model ........................ [[32mCREATE VIEW[0m in 0.08s]
00:30:35.818412 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
00:30:35.822788 [debug] [Thread-8  ]: SQL status: COMMIT in 0.01 seconds
00:30:35.824819 [debug] [Thread-8  ]: Using postgres connection "model.first_project.customers"
00:30:35.825104 [debug] [Thread-8  ]: On model.first_project.customers: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers"} */
drop view if exists "erp_oltp"."public"."customers__dbt_backup" cascade
00:30:35.825845 [debug] [Thread-8  ]: SQL status: DROP VIEW in 0.0 seconds
00:30:35.827257 [debug] [Thread-8  ]: finished collecting timing info
00:30:35.827480 [debug] [Thread-8  ]: On model.first_project.customers: Close
00:30:35.828012 [debug] [Thread-8  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1019c5e0>]}
00:30:35.828396 [info ] [Thread-8  ]: 6 of 7 OK created view model public.customers .................................. [[32mCREATE VIEW[0m in 0.08s]
00:30:35.828833 [debug] [Thread-8  ]: Finished running node model.first_project.customers
00:30:35.831996 [debug] [Thread-9  ]: SQL status: COMMIT in 0.02 seconds
00:30:35.834196 [debug] [Thread-9  ]: Using postgres connection "model.first_project.customers2"
00:30:35.834382 [debug] [Thread-9  ]: On model.first_project.customers2: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "node_id": "model.first_project.customers2"} */
drop table if exists "erp_oltp"."public"."customers2__dbt_backup" cascade
00:30:35.843913 [debug] [Thread-9  ]: SQL status: DROP TABLE in 0.01 seconds
00:30:35.851954 [debug] [Thread-9  ]: finished collecting timing info
00:30:35.852371 [debug] [Thread-9  ]: On model.first_project.customers2: Close
00:30:35.853795 [debug] [Thread-9  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '71aa387e-3fdb-4952-acba-43685bbc7a33', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1019cc10>]}
00:30:35.854439 [info ] [Thread-9  ]: 7 of 7 OK created table model public.customers2 ................................ [[32mSELECT 100[0m in 0.10s]
00:30:35.855465 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
00:30:35.858032 [debug] [MainThread]: Acquiring new postgres connection "master"
00:30:35.858257 [debug] [MainThread]: Using postgres connection "master"
00:30:35.858371 [debug] [MainThread]: On master: BEGIN
00:30:35.858465 [debug] [MainThread]: Opening a new connection, currently in state closed
00:30:35.865899 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:30:35.866202 [debug] [MainThread]: On master: COMMIT
00:30:35.866331 [debug] [MainThread]: Using postgres connection "master"
00:30:35.866435 [debug] [MainThread]: On master: COMMIT
00:30:35.866697 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
00:30:35.866864 [debug] [MainThread]: On master: Close
00:30:35.867542 [info ] [MainThread]: 
00:30:35.867899 [info ] [MainThread]: Finished running 5 view models, 2 table models in 0.45s.
00:30:35.868185 [debug] [MainThread]: Connection 'master' was properly closed.
00:30:35.868331 [debug] [MainThread]: Connection 'model.first_project.my_first_dbt_model' was properly closed.
00:30:35.868468 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
00:30:35.868597 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
00:30:35.868729 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
00:30:35.868861 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:30:35.868993 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:30:35.869124 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:30:35.874815 [info ] [MainThread]: 
00:30:35.875240 [info ] [MainThread]: [32mCompleted successfully[0m
00:30:35.875626 [info ] [MainThread]: 
00:30:35.875914 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
00:30:35.876959 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e1130e760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e112fec10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f8e112f8700>]}


============================== 2022-06-07 00:31:17.802677 | e0cc6eaa-1888-47c4-94fb-8a37503110d9 ==============================
00:31:17.802702 [info ] [MainThread]: Running with dbt=1.1.0
00:31:17.803565 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:31:17.803770 [debug] [MainThread]: Tracking: tracking
00:31:17.808804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b36f4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b36f4040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b36f4070>]}
00:31:17.851014 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:31:17.851331 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:31:17.858367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0cc6eaa-1888-47c4-94fb-8a37503110d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b35ad0d0>]}
00:31:17.866015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0cc6eaa-1888-47c4-94fb-8a37503110d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b3685760>]}
00:31:17.866672 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:31:17.867386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0cc6eaa-1888-47c4-94fb-8a37503110d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b36856a0>]}
00:31:17.870378 [info ] [MainThread]: 
00:31:17.871078 [debug] [MainThread]: Acquiring new postgres connection "master"
00:31:17.872631 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:31:17.885311 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:31:17.885593 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:31:17.885731 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:31:17.896743 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:31:17.897180 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:31:17.897351 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:31:17.900142 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:31:17.902091 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:31:17.902526 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:31:17.909870 [debug] [MainThread]: Using postgres connection "master"
00:31:17.910377 [debug] [MainThread]: On master: BEGIN
00:31:17.911451 [debug] [MainThread]: Opening a new connection, currently in state init
00:31:17.918625 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:31:17.918930 [debug] [MainThread]: Using postgres connection "master"
00:31:17.919091 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:31:17.946483 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
00:31:17.948305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0cc6eaa-1888-47c4-94fb-8a37503110d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b36853d0>]}
00:31:17.948717 [debug] [MainThread]: On master: ROLLBACK
00:31:17.949204 [debug] [MainThread]: On master: Close
00:31:17.949792 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:31:17.950066 [info ] [MainThread]: 
00:31:17.955772 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:31:17.956205 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:31:17.956405 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:31:17.956601 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:31:17.959502 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:31:17.959872 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:31:17.960190 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:31:17.962947 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:31:17.963163 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:31:17.963310 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:31:17.964634 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:31:17.962353 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:31:17.964959 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:31:17.965177 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:31:17.960490 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:31:17.973337 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:31:17.973550 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:31:17.973697 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:31:17.972609 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:31:17.960364 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:31:18.016969 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:31:17.961345 [debug] [Thread-1  ]: finished collecting timing info
00:31:18.017484 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:31:18.017703 [debug] [Thread-1  ]: finished collecting timing info
00:31:18.018117 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:31:18.015570 [debug] [Thread-3  ]: finished collecting timing info
00:31:18.017165 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:31:18.018509 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:31:17.960804 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:31:18.020068 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:31:18.020218 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:31:18.020333 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:31:18.019627 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:31:18.021865 [debug] [Thread-2  ]: finished collecting timing info
00:31:18.022125 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:31:18.022303 [debug] [Thread-2  ]: finished collecting timing info
00:31:18.022719 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:31:18.018308 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:31:18.023647 [debug] [Thread-3  ]: finished collecting timing info
00:31:18.024257 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:31:18.023209 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
00:31:18.025124 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:31:18.025264 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
00:31:18.025370 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
00:31:18.023800 [debug] [Thread-4  ]: finished collecting timing info
00:31:18.021330 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:31:18.028422 [debug] [Thread-6  ]: finished collecting timing info
00:31:18.016469 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:31:18.028904 [debug] [Thread-5  ]: finished collecting timing info
00:31:18.029104 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:31:18.027852 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:31:18.028120 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:31:18.028639 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:31:18.024818 [debug] [Thread-1  ]: Began running node model.first_project.customers2
00:31:18.029238 [debug] [Thread-5  ]: finished collecting timing info
00:31:18.030928 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:31:18.023360 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:31:18.029544 [debug] [Thread-4  ]: finished collecting timing info
00:31:18.029852 [debug] [Thread-8  ]: finished collecting timing info
00:31:18.030447 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
00:31:18.032372 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
00:31:18.023499 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:31:18.031447 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:31:18.031885 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:31:18.032502 [debug] [Thread-1  ]: Compiling model.first_project.customers2
00:31:18.030104 [debug] [Thread-6  ]: finished collecting timing info
00:31:18.032209 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
00:31:18.032902 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:31:18.033115 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:31:18.037846 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:31:18.033587 [debug] [Thread-7  ]: Began running node model.first_project.customers
00:31:18.052031 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.customers"
00:31:18.037441 [debug] [Thread-8  ]: finished collecting timing info
00:31:18.037668 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:31:18.053002 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:31:18.051501 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:31:18.052229 [debug] [Thread-7  ]: Began compiling node model.first_project.customers
00:31:18.060443 [debug] [Thread-7  ]: Compiling model.first_project.customers
00:31:18.052753 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
00:31:18.036425 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
00:31:18.059770 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:31:18.037134 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:31:18.063074 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.customers"
00:31:18.064062 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:31:18.068699 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:31:18.068945 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:31:18.069090 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:31:18.068008 [debug] [Thread-1  ]: finished collecting timing info
00:31:18.064248 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:31:18.074777 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:31:18.073501 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:31:18.075446 [debug] [Thread-2  ]: finished collecting timing info
00:31:18.074098 [debug] [Thread-7  ]: finished collecting timing info
00:31:18.074363 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
00:31:18.076596 [debug] [Thread-1  ]: finished collecting timing info
00:31:18.074946 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:31:18.076132 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:31:18.077840 [debug] [Thread-2  ]: finished collecting timing info
00:31:18.076351 [debug] [Thread-7  ]: Began executing node model.first_project.customers
00:31:18.077167 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
00:31:18.073733 [debug] [Thread-10 ]: finished collecting timing info
00:31:18.077509 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:31:18.073918 [debug] [Thread-9  ]: finished collecting timing info
00:31:18.083348 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:31:18.078539 [debug] [Thread-7  ]: finished collecting timing info
00:31:18.078897 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:31:18.083032 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:31:18.083576 [debug] [Thread-9  ]: finished collecting timing info
00:31:18.085057 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:31:18.084129 [debug] [Thread-7  ]: Finished running node model.first_project.customers
00:31:18.084437 [debug] [Thread-10 ]: finished collecting timing info
00:31:18.086490 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:31:18.085469 [debug] [Thread-5  ]: finished collecting timing info
00:31:18.078313 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:31:18.086691 [debug] [Thread-3  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:31:18.087994 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:31:18.087023 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:31:18.087186 [debug] [Thread-6  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:31:18.087481 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:31:18.086829 [debug] [Thread-8  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:31:18.089581 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:31:18.088585 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:31:18.088927 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:31:18.089108 [debug] [Thread-5  ]: finished collecting timing info
00:31:18.089773 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:31:18.088206 [debug] [Thread-3  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:31:18.091273 [debug] [Thread-3  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:31:18.090306 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:31:18.090764 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:31:18.090964 [debug] [Thread-8  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:31:18.090021 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:31:18.103198 [debug] [Thread-6  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:31:18.106032 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:31:18.112596 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:31:18.112831 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:31:18.116244 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:31:18.116769 [debug] [Thread-3  ]: finished collecting timing info
00:31:18.122917 [debug] [Thread-6  ]: finished collecting timing info
00:31:18.123160 [debug] [Thread-3  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:31:18.126296 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:31:18.126653 [debug] [Thread-6  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:31:18.127309 [debug] [Thread-6  ]: finished collecting timing info
00:31:18.127068 [debug] [Thread-3  ]: finished collecting timing info
00:31:18.127780 [debug] [Thread-6  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:31:18.126816 [debug] [Thread-8  ]: finished collecting timing info
00:31:18.128367 [debug] [Thread-3  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:31:18.128794 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:31:18.129322 [debug] [Thread-8  ]: finished collecting timing info
00:31:18.130012 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:31:18.130399 [debug] [Thread-4  ]: finished collecting timing info
00:31:18.130611 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:31:18.130792 [debug] [Thread-4  ]: finished collecting timing info
00:31:18.131427 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:31:18.133282 [debug] [MainThread]: Connection 'master' was properly closed.
00:31:18.133567 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:31:18.133708 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:31:18.133819 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:31:18.133921 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:31:18.134021 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:31:18.134123 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:31:18.134223 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:31:18.134321 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:31:18.134419 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:31:18.134520 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:31:18.141462 [info ] [MainThread]: Done.
00:31:18.144976 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:31:18.145325 [info ] [MainThread]: Building catalog
00:31:18.147581 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:31:18.157843 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:31:18.158110 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:31:18.159033 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:31:18.166043 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:31:18.166390 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:31:18.166570 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:31:18.173037 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
00:31:18.183575 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:31:18.184177 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:31:18.193984 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:31:18.194645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b36f4d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b3615040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff3b3615940>]}
00:31:18.780337 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:31:18.781178 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:31:25.923226 | a5e10246-96f8-490e-984e-68f75a24056e ==============================
00:31:25.923257 [info ] [MainThread]: Running with dbt=1.1.0
00:31:25.924145 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:31:25.924355 [debug] [MainThread]: Tracking: tracking
00:31:25.930327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69a0228b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69a0221f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fb69a022be0>]}
00:31:25.934212 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:31:25.934642 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:31:25.935077 [info ] [MainThread]: 
00:31:25.935529 [info ] [MainThread]: 
00:31:25.935835 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:41:16.163390 | 8b61c084-f79e-41e8-a17a-9b6a04cd9df4 ==============================
00:41:16.163418 [info ] [MainThread]: Running with dbt=1.1.0
00:41:16.164142 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
00:41:16.164321 [debug] [MainThread]: Tracking: tracking
00:41:16.169304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd78520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd78c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd785e0>]}
00:41:16.205926 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:41:16.207305 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:41:16.221177 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:41:16.238709 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:41:16.329503 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8b61c084-f79e-41e8-a17a-9b6a04cd9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd7d100>]}
00:41:16.336072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8b61c084-f79e-41e8-a17a-9b6a04cd9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd7ab20>]}
00:41:16.336476 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:41:16.336779 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b61c084-f79e-41e8-a17a-9b6a04cd9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd785e0>]}
00:41:16.338594 [info ] [MainThread]: 
00:41:16.339163 [debug] [MainThread]: Acquiring new postgres connection "master"
00:41:16.340545 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:41:16.353235 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:16.353515 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:41:16.353644 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:41:16.362309 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:41:16.362680 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:16.362815 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:41:16.365391 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:41:16.367287 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:41:16.367638 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:41:16.374192 [debug] [MainThread]: Using postgres connection "master"
00:41:16.374411 [debug] [MainThread]: On master: BEGIN
00:41:16.374525 [debug] [MainThread]: Opening a new connection, currently in state init
00:41:16.382616 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:41:16.382871 [debug] [MainThread]: Using postgres connection "master"
00:41:16.383024 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:41:16.404329 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:41:16.406049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8b61c084-f79e-41e8-a17a-9b6a04cd9df4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd37820>]}
00:41:16.406510 [debug] [MainThread]: On master: ROLLBACK
00:41:16.407103 [debug] [MainThread]: On master: Close
00:41:16.407968 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:41:16.408408 [info ] [MainThread]: 
00:41:16.417008 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:41:16.417603 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:41:16.417839 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:41:16.418008 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:41:16.422237 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:41:16.422588 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:41:16.422829 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:41:16.423139 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:41:16.423326 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:41:16.425243 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:41:16.423810 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:41:16.424254 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:41:16.425793 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:41:16.424868 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:41:16.425415 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:41:16.426283 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:41:16.425601 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:41:16.425936 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:41:16.433067 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:41:16.426109 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:41:16.424476 [debug] [Thread-1  ]: finished collecting timing info
00:41:16.434308 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:41:16.434488 [debug] [Thread-1  ]: finished collecting timing info
00:41:16.428550 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:41:16.438545 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:41:16.434040 [debug] [Thread-3  ]: finished collecting timing info
00:41:16.433567 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:41:16.428265 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:41:16.440753 [debug] [Thread-5  ]: finished collecting timing info
00:41:16.423468 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:41:16.438968 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:41:16.440359 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:41:16.435302 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:41:16.441317 [debug] [Thread-2  ]: finished collecting timing info
00:41:16.441508 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:41:16.441984 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:41:16.442201 [debug] [Thread-3  ]: finished collecting timing info
00:41:16.442763 [debug] [Thread-4  ]: finished collecting timing info
00:41:16.444734 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:41:16.443338 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
00:41:16.445259 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:41:16.445433 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
00:41:16.445574 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
00:41:16.443929 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:41:16.450945 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:41:16.444515 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:41:16.442974 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:41:16.443603 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:16.454521 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:16.454677 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:16.450544 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:41:16.453185 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:41:16.444903 [debug] [Thread-4  ]: finished collecting timing info
00:41:16.455708 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:41:16.454096 [debug] [Thread-1  ]: Began running node model.first_project.customers2
00:41:16.454802 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:16.443492 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:16.443759 [debug] [Thread-5  ]: finished collecting timing info
00:41:16.465863 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:41:16.455138 [debug] [Thread-6  ]: finished collecting timing info
00:41:16.466179 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:41:16.466338 [debug] [Thread-6  ]: finished collecting timing info
00:41:16.464127 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:16.464860 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:16.467193 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:16.467371 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:16.466726 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:41:16.455877 [debug] [Thread-8  ]: finished collecting timing info
00:41:16.456269 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
00:41:16.453794 [debug] [Thread-2  ]: finished collecting timing info
00:41:16.479670 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:41:16.465334 [debug] [Thread-3  ]: Began running node model.first_project.customers
00:41:16.475171 [debug] [Thread-10 ]: finished collecting timing info
00:41:16.480348 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:16.480578 [debug] [Thread-10 ]: finished collecting timing info
00:41:16.480998 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:16.480089 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.customers"
00:41:16.474872 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
00:41:16.479040 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
00:41:16.478679 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:16.481906 [debug] [Thread-3  ]: Began compiling node model.first_project.customers
00:41:16.482162 [debug] [Thread-8  ]: finished collecting timing info
00:41:16.482368 [debug] [Thread-1  ]: Compiling model.first_project.customers2
00:41:16.482786 [debug] [Thread-3  ]: Compiling model.first_project.customers
00:41:16.483434 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
00:41:16.489011 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
00:41:16.489222 [debug] [Thread-9  ]: finished collecting timing info
00:41:16.494306 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.customers"
00:41:16.495564 [debug] [Thread-4  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:16.496000 [debug] [Thread-5  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:16.498635 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:16.498161 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:16.498831 [debug] [Thread-5  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:16.499432 [debug] [Thread-5  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:16.496336 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:16.499206 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:16.504175 [debug] [Thread-4  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:16.503503 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:16.503737 [debug] [Thread-3  ]: finished collecting timing info
00:41:16.499053 [debug] [Thread-1  ]: finished collecting timing info
00:41:16.509225 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
00:41:16.508146 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:16.509852 [debug] [Thread-4  ]: finished collecting timing info
00:41:16.509010 [debug] [Thread-5  ]: finished collecting timing info
00:41:16.510275 [debug] [Thread-5  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:16.510476 [debug] [Thread-5  ]: finished collecting timing info
00:41:16.503978 [debug] [Thread-9  ]: finished collecting timing info
00:41:16.508647 [debug] [Thread-3  ]: Began executing node model.first_project.customers
00:41:16.512109 [debug] [Thread-3  ]: finished collecting timing info
00:41:16.511093 [debug] [Thread-5  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:16.511707 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:16.509500 [debug] [Thread-1  ]: finished collecting timing info
00:41:16.512652 [debug] [Thread-3  ]: Finished running node model.first_project.customers
00:41:16.510068 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:16.514146 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
00:41:16.514771 [debug] [Thread-4  ]: finished collecting timing info
00:41:16.514986 [debug] [Thread-6  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:16.516762 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:16.515294 [debug] [Thread-10 ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:16.517293 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:16.516905 [debug] [Thread-6  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:16.517630 [debug] [Thread-6  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:16.527613 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:16.517464 [debug] [Thread-10 ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:16.528574 [debug] [Thread-10 ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:16.515153 [debug] [Thread-2  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:16.516456 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:16.528264 [debug] [Thread-6  ]: finished collecting timing info
00:41:16.515881 [debug] [Thread-8  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:16.538008 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:16.538450 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:16.539731 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:16.539876 [debug] [Thread-2  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:16.543311 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:16.539419 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:41:16.544040 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:16.543743 [debug] [Thread-2  ]: finished collecting timing info
00:41:16.539064 [debug] [Thread-6  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:16.544651 [debug] [Thread-6  ]: finished collecting timing info
00:41:16.544415 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:16.544214 [debug] [Thread-8  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:16.544791 [debug] [Thread-10 ]: finished collecting timing info
00:41:16.545166 [debug] [Thread-6  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:16.545496 [debug] [Thread-2  ]: finished collecting timing info
00:41:16.549228 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:41:16.549494 [debug] [Thread-10 ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:16.550426 [debug] [Thread-10 ]: finished collecting timing info
00:41:16.550812 [debug] [Thread-10 ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:16.550113 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:16.551348 [debug] [Thread-8  ]: finished collecting timing info
00:41:16.551621 [debug] [Thread-8  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:16.551752 [debug] [Thread-8  ]: finished collecting timing info
00:41:16.552162 [debug] [Thread-8  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:16.553583 [debug] [MainThread]: Connection 'master' was properly closed.
00:41:16.553720 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:41:16.553811 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:41:16.553894 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:41:16.553977 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:41:16.554060 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:41:16.554141 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:41:16.554222 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:41:16.554302 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:41:16.554382 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:41:16.561896 [info ] [MainThread]: Done.
00:41:16.562453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760cd7ebe0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760c3313d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f760c331f70>]}


============================== 2022-06-07 00:41:38.978619 | 6d7c6436-e83c-4b61-90da-14504f6a858e ==============================
00:41:38.978642 [info ] [MainThread]: Running with dbt=1.1.0
00:41:38.979311 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:41:38.979487 [debug] [MainThread]: Tracking: tracking
00:41:38.983964 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa335796d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa335796040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa335796070>]}
00:41:39.023721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:41:39.024124 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:41:39.032661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d7c6436-e83c-4b61-90da-14504f6a858e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa33564f0d0>]}
00:41:39.040433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d7c6436-e83c-4b61-90da-14504f6a858e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa335727760>]}
00:41:39.040863 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:41:39.041292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7c6436-e83c-4b61-90da-14504f6a858e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3357276a0>]}
00:41:39.043787 [info ] [MainThread]: 
00:41:39.044378 [debug] [MainThread]: Acquiring new postgres connection "master"
00:41:39.045965 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:41:39.063377 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:39.063682 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:41:39.063897 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:41:39.073898 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:41:39.074185 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:41:39.074335 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:41:39.076868 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:41:39.078895 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:41:39.079264 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:41:39.085922 [debug] [MainThread]: Using postgres connection "master"
00:41:39.086239 [debug] [MainThread]: On master: BEGIN
00:41:39.086396 [debug] [MainThread]: Opening a new connection, currently in state init
00:41:39.095335 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:41:39.095646 [debug] [MainThread]: Using postgres connection "master"
00:41:39.095796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:41:39.117005 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:41:39.119152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d7c6436-e83c-4b61-90da-14504f6a858e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa3357273d0>]}
00:41:39.119566 [debug] [MainThread]: On master: ROLLBACK
00:41:39.119988 [debug] [MainThread]: On master: Close
00:41:39.120483 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:41:39.120856 [info ] [MainThread]: 
00:41:39.125655 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:41:39.126079 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:41:39.126241 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:41:39.126373 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:41:39.128670 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:41:39.129200 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:41:39.129414 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:41:39.132353 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:41:39.132525 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:41:39.132643 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:41:39.131958 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:41:39.134058 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:41:39.134221 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:41:39.129972 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:41:39.133745 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:41:39.129613 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:41:39.139698 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:41:39.137353 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:41:39.140657 [debug] [Thread-2  ]: finished collecting timing info
00:41:39.140824 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:41:39.140974 [debug] [Thread-2  ]: finished collecting timing info
00:41:39.129777 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:41:39.140244 [debug] [Thread-3  ]: finished collecting timing info
00:41:39.141988 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:41:39.138949 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:41:39.142321 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:41:39.141378 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:41:39.141717 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:41:39.142733 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:41:39.142175 [debug] [Thread-3  ]: finished collecting timing info
00:41:39.142444 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:41:39.139838 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:41:39.177765 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:41:39.142841 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:41:39.143244 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:41:39.139228 [debug] [Thread-1  ]: finished collecting timing info
00:41:39.178992 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:41:39.180047 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:41:39.181478 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:41:39.181736 [debug] [Thread-8  ]: Began running node model.first_project.customers2
00:41:39.181907 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:41:39.182196 [debug] [Thread-5  ]: finished collecting timing info
00:41:39.182466 [debug] [Thread-4  ]: finished collecting timing info
00:41:39.183669 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:41:39.183132 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
00:41:39.183312 [debug] [Thread-1  ]: finished collecting timing info
00:41:39.183503 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:41:39.183846 [debug] [Thread-4  ]: finished collecting timing info
00:41:39.185335 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:41:39.184072 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
00:41:39.184636 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:41:39.184891 [debug] [Thread-5  ]: finished collecting timing info
00:41:39.182747 [debug] [Thread-6  ]: finished collecting timing info
00:41:39.185698 [debug] [Thread-10 ]: Began running node model.first_project.customers
00:41:39.187244 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
00:41:39.187371 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
00:41:39.186553 [debug] [Thread-2  ]: Began running node model.first_project.my_second_dbt_model
00:41:39.187702 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:41:39.186808 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:39.186937 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:41:39.187466 [debug] [Thread-10 ]: Compiling model.first_project.customers
00:41:39.185831 [debug] [Thread-8  ]: Compiling model.first_project.customers2
00:41:39.193677 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
00:41:39.187839 [debug] [Thread-2  ]: Began compiling node model.first_project.my_second_dbt_model
00:41:39.193934 [debug] [Thread-2  ]: Compiling model.first_project.my_second_dbt_model
00:41:39.188084 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:39.188240 [debug] [Thread-6  ]: finished collecting timing info
00:41:39.186383 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:41:39.191698 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
00:41:39.186670 [debug] [Thread-3  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:39.195571 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:41:39.195816 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:39.196223 [debug] [Thread-8  ]: finished collecting timing info
00:41:39.197854 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
00:41:39.197140 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:39.198112 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:39.198226 [debug] [Thread-3  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:39.197694 [debug] [Thread-2  ]: finished collecting timing info
00:41:39.205127 [debug] [Thread-2  ]: Began executing node model.first_project.my_second_dbt_model
00:41:39.209907 [debug] [Thread-2  ]: finished collecting timing info
00:41:39.210330 [debug] [Thread-2  ]: Finished running node model.first_project.my_second_dbt_model
00:41:39.197485 [debug] [Thread-10 ]: finished collecting timing info
00:41:39.210682 [debug] [Thread-10 ]: Began executing node model.first_project.customers
00:41:39.210816 [debug] [Thread-10 ]: finished collecting timing info
00:41:39.197385 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:39.209672 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:41:39.221878 [debug] [Thread-3  ]: finished collecting timing info
00:41:39.222182 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:39.222339 [debug] [Thread-3  ]: finished collecting timing info
00:41:39.216598 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:39.216980 [debug] [Thread-1  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:39.223545 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:39.197984 [debug] [Thread-8  ]: finished collecting timing info
00:41:39.224399 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
00:41:39.211160 [debug] [Thread-10 ]: Finished running node model.first_project.customers
00:41:39.223222 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:39.225048 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:39.225176 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:39.223703 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:39.196648 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:41:39.230724 [debug] [Thread-6  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:39.222794 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:41:39.229805 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:41:39.230140 [debug] [Thread-1  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:39.230400 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:39.221290 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:41:39.231312 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:39.231498 [debug] [Thread-2  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:39.236932 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:39.237086 [debug] [Thread-2  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:39.235785 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:39.236349 [debug] [Thread-9  ]: finished collecting timing info
00:41:39.236532 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:39.237733 [debug] [Thread-6  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:39.237228 [debug] [Thread-2  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:39.231630 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:39.235390 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:41:39.237393 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:39.237574 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:39.236642 [debug] [Thread-7  ]: finished collecting timing info
00:41:39.253950 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:39.252426 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:41:39.254282 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:39.254399 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:39.253443 [debug] [Thread-1  ]: finished collecting timing info
00:41:39.253691 [debug] [Thread-9  ]: finished collecting timing info
00:41:39.252926 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:39.254137 [debug] [Thread-7  ]: finished collecting timing info
00:41:39.274630 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:41:39.252032 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:41:39.258702 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:41:39.259163 [debug] [Thread-1  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:39.275307 [debug] [Thread-1  ]: finished collecting timing info
00:41:39.273335 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:41:39.241222 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:41:39.275763 [debug] [Thread-1  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:41:39.260290 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:41:39.275995 [debug] [Thread-4  ]: finished collecting timing info
00:41:39.276200 [debug] [Thread-2  ]: finished collecting timing info
00:41:39.276872 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:39.277236 [debug] [Thread-6  ]: finished collecting timing info
00:41:39.278219 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:39.278374 [debug] [Thread-6  ]: finished collecting timing info
00:41:39.278012 [debug] [Thread-4  ]: finished collecting timing info
00:41:39.278747 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:41:39.277790 [debug] [Thread-2  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:39.279592 [debug] [Thread-2  ]: finished collecting timing info
00:41:39.279266 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:41:39.277582 [debug] [Thread-5  ]: finished collecting timing info
00:41:39.281237 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:39.281391 [debug] [Thread-5  ]: finished collecting timing info
00:41:39.281724 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:41:39.280005 [debug] [Thread-2  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:41:39.283302 [debug] [MainThread]: Connection 'master' was properly closed.
00:41:39.283449 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:41:39.283547 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:41:39.283650 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:41:39.283738 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:41:39.283842 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:41:39.283953 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:41:39.284110 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:41:39.284250 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:41:39.284388 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:41:39.284510 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:41:39.291390 [info ] [MainThread]: Done.
00:41:39.294210 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:41:39.294576 [info ] [MainThread]: Building catalog
00:41:39.297082 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:41:39.304875 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:41:39.305083 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:41:39.305292 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:41:39.314592 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:41:39.314977 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:41:39.315226 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:41:39.321576 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
00:41:39.337531 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:41:39.338242 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:41:39.349562 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:41:39.350193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa335796d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa334563a30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa334563790>]}
00:41:39.916610 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:41:39.917495 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:42:08.100992 | 5b116759-b5bd-49b2-9e3e-63295db6c3c2 ==============================
00:42:08.101020 [info ] [MainThread]: Running with dbt=1.1.0
00:42:08.101836 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:42:08.102023 [debug] [MainThread]: Tracking: tracking
00:42:08.106859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff146615340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1466154f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ff1466155b0>]}
00:42:08.110099 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:42:08.110764 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:42:08.111241 [info ] [MainThread]: 
00:42:08.112459 [info ] [MainThread]: 
00:42:08.115082 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:43:22.614003 | be6a9f84-e462-4c5c-a620-ea6f7b83b7cd ==============================
00:43:22.614027 [info ] [MainThread]: Running with dbt=1.1.0
00:43:22.614581 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
00:43:22.614725 [debug] [MainThread]: Tracking: tracking
00:43:22.619025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3faca7c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3faca220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3faca9d0>]}
00:43:22.656400 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:43:22.657071 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:43:22.671953 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:43:22.689783 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:43:22.779348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be6a9f84-e462-4c5c-a620-ea6f7b83b7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef413464c0>]}
00:43:22.785233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be6a9f84-e462-4c5c-a620-ea6f7b83b7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3fad0340>]}
00:43:22.785625 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:43:22.785979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be6a9f84-e462-4c5c-a620-ea6f7b83b7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3fad0fa0>]}
00:43:22.787851 [info ] [MainThread]: 
00:43:22.788358 [debug] [MainThread]: Acquiring new postgres connection "master"
00:43:22.789606 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:43:22.803419 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:43:22.803717 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:43:22.803864 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:43:22.814595 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:43:22.814896 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:43:22.815159 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:43:22.818580 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:43:22.820543 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:43:22.821201 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:43:22.830818 [debug] [MainThread]: Using postgres connection "master"
00:43:22.831284 [debug] [MainThread]: On master: BEGIN
00:43:22.831512 [debug] [MainThread]: Opening a new connection, currently in state init
00:43:22.838572 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:43:22.838868 [debug] [MainThread]: Using postgres connection "master"
00:43:22.838999 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:43:22.862154 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:43:22.864507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be6a9f84-e462-4c5c-a620-ea6f7b83b7cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3f9d3f10>]}
00:43:22.865160 [debug] [MainThread]: On master: ROLLBACK
00:43:22.865736 [debug] [MainThread]: On master: Close
00:43:22.866467 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:43:22.866989 [info ] [MainThread]: 
00:43:22.874123 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:43:22.874911 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:43:22.875196 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:43:22.875443 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:43:22.876916 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:43:22.875791 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:43:22.882016 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:43:22.882208 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:43:22.876570 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:43:22.875622 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:43:22.882977 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:43:22.883177 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:43:22.883309 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:43:22.875924 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:43:22.882565 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:43:22.876046 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:43:22.889740 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:43:22.889927 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:43:22.890055 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:43:22.889070 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:43:22.891703 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:43:22.891862 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:43:22.893119 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:43:22.891462 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:43:22.894071 [debug] [Thread-6  ]: finished collecting timing info
00:43:22.893403 [debug] [Thread-5  ]: finished collecting timing info
00:43:22.882346 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:43:22.889342 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:43:22.894266 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:43:22.898715 [debug] [Thread-6  ]: finished collecting timing info
00:43:22.888427 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:43:22.894469 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:43:22.895851 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:43:22.899968 [debug] [Thread-3  ]: finished collecting timing info
00:43:22.899236 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:43:22.881516 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:43:22.900981 [debug] [Thread-1  ]: finished collecting timing info
00:43:22.901211 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:43:22.901419 [debug] [Thread-1  ]: finished collecting timing info
00:43:22.900519 [debug] [Thread-4  ]: finished collecting timing info
00:43:22.899634 [debug] [Thread-5  ]: finished collecting timing info
00:43:22.905966 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:43:22.898397 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:43:22.905154 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:43:22.906475 [debug] [Thread-4  ]: finished collecting timing info
00:43:22.900278 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:43:22.904757 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:43:22.907007 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:43:22.907311 [debug] [Thread-2  ]: finished collecting timing info
00:43:22.907902 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:43:22.908121 [debug] [Thread-2  ]: finished collecting timing info
00:43:22.908540 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:43:22.907481 [debug] [Thread-3  ]: finished collecting timing info
00:43:22.909335 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:43:22.909912 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
00:43:22.911409 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:43:22.911595 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
00:43:22.911730 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
00:43:22.914292 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:43:22.915269 [debug] [Thread-8  ]: finished collecting timing info
00:43:22.915495 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:22.916566 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:43:22.916721 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:22.915938 [debug] [Thread-5  ]: Began running node model.first_project.customers2
00:43:22.915623 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:22.917672 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:43:22.917858 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:22.918003 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:22.917246 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers2"
00:43:22.916843 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:22.915765 [debug] [Thread-6  ]: Began running node model.first_project.customers
00:43:22.936620 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.customers"
00:43:22.925401 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:43:22.925716 [debug] [Thread-5  ]: Began compiling node model.first_project.customers2
00:43:22.916189 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
00:43:22.938118 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:43:22.938422 [debug] [Thread-6  ]: Began compiling node model.first_project.customers
00:43:22.939808 [debug] [Thread-6  ]: Compiling model.first_project.customers
00:43:22.939336 [debug] [Thread-8  ]: finished collecting timing info
00:43:22.939497 [debug] [Thread-10 ]: finished collecting timing info
00:43:22.945304 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:22.944009 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.customers"
00:43:22.944485 [debug] [Thread-9  ]: finished collecting timing info
00:43:22.945491 [debug] [Thread-10 ]: finished collecting timing info
00:43:22.946707 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:22.938968 [debug] [Thread-5  ]: Compiling model.first_project.customers2
00:43:22.949954 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers2"
00:43:22.945092 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
00:43:22.946226 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:22.950395 [debug] [Thread-9  ]: finished collecting timing info
00:43:22.945948 [debug] [Thread-6  ]: finished collecting timing info
00:43:22.951827 [debug] [Thread-6  ]: Began executing node model.first_project.customers
00:43:22.951623 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:22.952051 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:22.951170 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:22.952190 [debug] [Thread-6  ]: finished collecting timing info
00:43:22.952553 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:43:22.953000 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:43:22.953154 [debug] [Thread-5  ]: finished collecting timing info
00:43:22.953782 [debug] [Thread-6  ]: Finished running node model.first_project.customers
00:43:22.954011 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:22.954235 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:22.954442 [debug] [Thread-5  ]: Began executing node model.first_project.customers2
00:43:22.955069 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:22.955239 [debug] [Thread-7  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:22.955391 [debug] [Thread-4  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:22.955504 [debug] [Thread-10 ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:22.964499 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:43:22.964705 [debug] [Thread-10 ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:22.964853 [debug] [Thread-10 ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:22.962975 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:43:22.963611 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:43:22.964103 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:43:22.955667 [debug] [Thread-8  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:22.975956 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:43:22.956123 [debug] [Thread-5  ]: finished collecting timing info
00:43:22.974396 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:43:22.974946 [debug] [Thread-7  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:22.975430 [debug] [Thread-4  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:22.977366 [debug] [Thread-4  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:22.976126 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:22.976791 [debug] [Thread-5  ]: Finished running node model.first_project.customers2
00:43:22.977112 [debug] [Thread-7  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:22.955876 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:22.983387 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:43:22.983876 [debug] [Thread-8  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:22.984106 [debug] [Thread-1  ]: finished collecting timing info
00:43:22.993594 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:43:22.993841 [debug] [Thread-10 ]: finished collecting timing info
00:43:23.004052 [debug] [Thread-10 ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:23.004236 [debug] [Thread-10 ]: finished collecting timing info
00:43:23.003256 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:23.005078 [debug] [Thread-1  ]: finished collecting timing info
00:43:23.005658 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:22.998466 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:43:23.004704 [debug] [Thread-10 ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:23.003694 [debug] [Thread-4  ]: finished collecting timing info
00:43:23.006566 [debug] [Thread-4  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:23.005852 [debug] [Thread-2  ]: finished collecting timing info
00:43:23.002828 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:43:23.007459 [debug] [Thread-8  ]: finished collecting timing info
00:43:23.007649 [debug] [Thread-8  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:23.007122 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:23.007784 [debug] [Thread-8  ]: finished collecting timing info
00:43:23.008488 [debug] [Thread-8  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:23.006743 [debug] [Thread-4  ]: finished collecting timing info
00:43:23.008018 [debug] [Thread-2  ]: finished collecting timing info
00:43:23.009045 [debug] [Thread-4  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:23.006907 [debug] [Thread-7  ]: finished collecting timing info
00:43:23.009550 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:23.009899 [debug] [Thread-7  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:23.010212 [debug] [Thread-7  ]: finished collecting timing info
00:43:23.010684 [debug] [Thread-7  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:23.012764 [debug] [MainThread]: Connection 'master' was properly closed.
00:43:23.012967 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:43:23.013074 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:43:23.013166 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:43:23.013257 [debug] [MainThread]: Connection 'model.first_project.stg_customers' was properly closed.
00:43:23.013346 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:43:23.013434 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:43:23.013523 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:43:23.013612 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:43:23.013698 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:43:23.013786 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:43:23.019112 [info ] [MainThread]: Done.
00:43:23.019489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3c0769d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3c06f160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fef3c06f190>]}


============================== 2022-06-07 00:43:32.059902 | 4ce339aa-8678-4eaa-8be8-961f19b1ab2f ==============================
00:43:32.059928 [info ] [MainThread]: Running with dbt=1.1.0
00:43:32.060794 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:43:32.061016 [debug] [MainThread]: Tracking: tracking
00:43:32.066426 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6bcf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6bcfca0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6bcf130>]}
00:43:32.117279 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:43:32.117586 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:43:32.125307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ce339aa-8678-4eaa-8be8-961f19b1ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6a890d0>]}
00:43:32.133584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ce339aa-8678-4eaa-8be8-961f19b1ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6b49700>]}
00:43:32.134027 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:43:32.134479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ce339aa-8678-4eaa-8be8-961f19b1ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6b49640>]}
00:43:32.136911 [info ] [MainThread]: 
00:43:32.137692 [debug] [MainThread]: Acquiring new postgres connection "master"
00:43:32.139372 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:43:32.162606 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:43:32.165992 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:43:32.167991 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:43:32.196913 [debug] [ThreadPool]: SQL status: BEGIN in 0.03 seconds
00:43:32.197187 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:43:32.197306 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:43:32.200095 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:43:32.202216 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:43:32.202756 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:43:32.209800 [debug] [MainThread]: Using postgres connection "master"
00:43:32.210091 [debug] [MainThread]: On master: BEGIN
00:43:32.210241 [debug] [MainThread]: Opening a new connection, currently in state init
00:43:32.224712 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:43:32.224980 [debug] [MainThread]: Using postgres connection "master"
00:43:32.225105 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:43:32.247903 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:43:32.249700 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ce339aa-8678-4eaa-8be8-961f19b1ab2f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6bca820>]}
00:43:32.250042 [debug] [MainThread]: On master: ROLLBACK
00:43:32.250404 [debug] [MainThread]: On master: Close
00:43:32.250941 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:43:32.251417 [info ] [MainThread]: 
00:43:32.257635 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:43:32.258315 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:43:32.258570 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:43:32.258777 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:43:32.261827 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:43:32.262429 [debug] [Thread-1  ]: finished collecting timing info
00:43:32.262651 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:43:32.262820 [debug] [Thread-1  ]: finished collecting timing info
00:43:32.263702 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:43:32.263927 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
00:43:32.264234 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:43:32.264397 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:43:32.264528 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
00:43:32.267033 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:43:32.267479 [debug] [Thread-1  ]: finished collecting timing info
00:43:32.268612 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
00:43:32.269523 [debug] [Thread-3  ]: Began running node model.first_project.stg_orders
00:43:32.270011 [debug] [Thread-4  ]: Began running node seed.first_project.alunos
00:43:32.271246 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
00:43:32.271506 [debug] [Thread-5  ]: Began running node seed.first_project.code-country
00:43:32.276637 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:43:32.276807 [debug] [Thread-5  ]: Began compiling node seed.first_project.code-country
00:43:32.276961 [debug] [Thread-5  ]: Compiling seed.first_project.code-country
00:43:32.278280 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.code-country"
00:43:32.274867 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:43:32.275657 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:43:32.276143 [debug] [Thread-1  ]: finished collecting timing info
00:43:32.278473 [debug] [Thread-5  ]: finished collecting timing info
00:43:32.320006 [debug] [Thread-5  ]: Began executing node seed.first_project.code-country
00:43:32.320253 [debug] [Thread-5  ]: finished collecting timing info
00:43:32.320792 [debug] [Thread-5  ]: Finished running node seed.first_project.code-country
00:43:32.271937 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:32.279380 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_orders
00:43:32.321636 [debug] [Thread-3  ]: Compiling model.first_project.stg_orders
00:43:32.319727 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
00:43:32.322773 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:43:32.271704 [debug] [Thread-6  ]: Began running node model.first_project.my_second_dbt_model
00:43:32.323300 [debug] [Thread-6  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:43:32.323816 [debug] [Thread-6  ]: Began compiling node model.first_project.my_second_dbt_model
00:43:32.324026 [debug] [Thread-6  ]: Compiling model.first_project.my_second_dbt_model
00:43:32.326021 [debug] [Thread-6  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:43:32.273997 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:43:32.326293 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
00:43:32.321278 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:43:32.326649 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:32.326431 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
00:43:32.327961 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:43:32.319073 [debug] [Thread-4  ]: Began compiling node seed.first_project.alunos
00:43:32.328462 [debug] [Thread-4  ]: Compiling seed.first_project.alunos
00:43:32.273415 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:32.328176 [debug] [Thread-3  ]: finished collecting timing info
00:43:32.330961 [debug] [Thread-3  ]: Began executing node model.first_project.stg_orders
00:43:32.329753 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.alunos"
00:43:32.329940 [debug] [Thread-2  ]: finished collecting timing info
00:43:32.331718 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
00:43:32.331855 [debug] [Thread-2  ]: finished collecting timing info
00:43:32.331155 [debug] [Thread-3  ]: finished collecting timing info
00:43:32.331375 [debug] [Thread-6  ]: finished collecting timing info
00:43:32.331543 [debug] [Thread-4  ]: finished collecting timing info
00:43:32.332334 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
00:43:32.330330 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:43:32.333494 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:32.332764 [debug] [Thread-3  ]: Finished running node model.first_project.stg_orders
00:43:32.333011 [debug] [Thread-6  ]: Began executing node model.first_project.my_second_dbt_model
00:43:32.333222 [debug] [Thread-4  ]: Began executing node seed.first_project.alunos
00:43:32.326865 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:32.347490 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:43:32.334057 [debug] [Thread-10 ]: Began running node model.first_project.customers2
00:43:32.348091 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers2"
00:43:32.348273 [debug] [Thread-10 ]: Began compiling node model.first_project.customers2
00:43:32.334711 [debug] [Thread-6  ]: finished collecting timing info
00:43:32.333641 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:32.334524 [debug] [Thread-5  ]: Began running node model.first_project.customers
00:43:32.355722 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
00:43:32.348409 [debug] [Thread-10 ]: Compiling model.first_project.customers2
00:43:32.349159 [debug] [Thread-6  ]: Finished running node model.first_project.my_second_dbt_model
00:43:32.355257 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:43:32.334899 [debug] [Thread-4  ]: finished collecting timing info
00:43:32.359802 [debug] [Thread-4  ]: Finished running node seed.first_project.alunos
00:43:32.358257 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers2"
00:43:32.359161 [debug] [Thread-2  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:32.360537 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:43:32.355912 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
00:43:32.361298 [debug] [Thread-5  ]: Compiling model.first_project.customers
00:43:32.360695 [debug] [Thread-2  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:32.365223 [debug] [Thread-2  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:32.359309 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:32.360060 [debug] [Thread-7  ]: finished collecting timing info
00:43:32.364921 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
00:43:32.371588 [debug] [Thread-5  ]: finished collecting timing info
00:43:32.369284 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:43:32.369832 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:43:32.370164 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:32.371092 [debug] [Thread-10 ]: finished collecting timing info
00:43:32.371786 [debug] [Thread-5  ]: Began executing node model.first_project.customers
00:43:32.372890 [debug] [Thread-5  ]: finished collecting timing info
00:43:32.372096 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:32.372287 [debug] [Thread-2  ]: finished collecting timing info
00:43:32.373734 [debug] [Thread-2  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:32.373882 [debug] [Thread-2  ]: finished collecting timing info
00:43:32.373561 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:32.373387 [debug] [Thread-5  ]: Finished running node model.first_project.customers
00:43:32.361062 [debug] [Thread-8  ]: finished collecting timing info
00:43:32.374291 [debug] [Thread-2  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:43:32.372650 [debug] [Thread-10 ]: Began executing node model.first_project.customers2
00:43:32.380005 [debug] [Thread-10 ]: finished collecting timing info
00:43:32.378170 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:43:32.381429 [debug] [Thread-9  ]: finished collecting timing info
00:43:32.379393 [debug] [Thread-1  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:32.381976 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:43:32.382130 [debug] [Thread-1  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:32.382271 [debug] [Thread-1  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:32.380473 [debug] [Thread-10 ]: Finished running node model.first_project.customers2
00:43:32.372511 [debug] [Thread-7  ]: finished collecting timing info
00:43:32.379521 [debug] [Thread-6  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:32.379718 [debug] [Thread-3  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:32.379622 [debug] [Thread-4  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:32.397172 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:43:32.397320 [debug] [Thread-4  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:32.397437 [debug] [Thread-4  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:32.381660 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:32.407880 [debug] [Thread-9  ]: finished collecting timing info
00:43:32.408443 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:43:32.396427 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:43:32.409065 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:32.409250 [debug] [Thread-6  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:32.406997 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:43:32.379033 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:32.413782 [debug] [Thread-8  ]: finished collecting timing info
00:43:32.396835 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:43:32.414459 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:32.413345 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:43:32.395993 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:43:32.414256 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:43:32.414725 [debug] [Thread-4  ]: finished collecting timing info
00:43:32.414885 [debug] [Thread-3  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:32.394921 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:43:32.415483 [debug] [Thread-4  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:32.415724 [debug] [Thread-6  ]: finished collecting timing info
00:43:32.419232 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:43:32.419508 [debug] [Thread-4  ]: finished collecting timing info
00:43:32.419700 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:32.419930 [debug] [Thread-1  ]: finished collecting timing info
00:43:32.420474 [debug] [Thread-4  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:43:32.420688 [debug] [Thread-6  ]: finished collecting timing info
00:43:32.420869 [debug] [Thread-1  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:32.421706 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:43:32.421923 [debug] [Thread-1  ]: finished collecting timing info
00:43:32.422596 [debug] [Thread-1  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:43:32.422111 [debug] [Thread-3  ]: finished collecting timing info
00:43:32.422829 [debug] [Thread-3  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:32.422985 [debug] [Thread-3  ]: finished collecting timing info
00:43:32.423355 [debug] [Thread-3  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:43:32.424766 [debug] [MainThread]: Connection 'master' was properly closed.
00:43:32.424946 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:43:32.425050 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:43:32.425141 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:43:32.425229 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:43:32.425318 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:43:32.425457 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:43:32.425606 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:43:32.425701 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:43:32.425787 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:43:32.425873 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:43:32.430933 [info ] [MainThread]: Done.
00:43:32.433520 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:43:32.433917 [info ] [MainThread]: Building catalog
00:43:32.435882 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:43:32.442656 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:43:32.442868 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:43:32.442983 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:43:32.453101 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:43:32.453408 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:43:32.453535 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:43:32.456872 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
00:43:32.468123 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:43:32.468679 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:43:32.482570 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:43:32.483127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6bcf580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6bca100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fc1a6bca280>]}
00:43:33.080588 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:43:33.081439 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:43:38.263376 | 14b775c0-c80e-4f53-ac13-e3c249999ad7 ==============================
00:43:38.263404 [info ] [MainThread]: Running with dbt=1.1.0
00:43:38.263996 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:43:38.264143 [debug] [MainThread]: Tracking: tracking
00:43:38.268694 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32455d1f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32455d10a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f32455d1f10>]}
00:43:38.271781 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:43:38.272441 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:43:38.272802 [info ] [MainThread]: 
00:43:38.273000 [info ] [MainThread]: 
00:43:38.273226 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:44:44.187637 | d76340d7-9774-47da-b551-ef7b720f0c61 ==============================
00:44:44.187660 [info ] [MainThread]: Running with dbt=1.1.0
00:44:44.188379 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:44:44.188577 [debug] [MainThread]: Tracking: tracking
00:44:44.193846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90d24f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90d24fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90d24eb0>]}
00:44:44.230231 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:44:44.231009 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:44:44.250952 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:44:44.271805 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:44:44.377818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd76340d7-9774-47da-b551-ef7b720f0c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90d27040>]}
00:44:44.384661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd76340d7-9774-47da-b551-ef7b720f0c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90d28fa0>]}
00:44:44.385068 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:44:44.385494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd76340d7-9774-47da-b551-ef7b720f0c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90d283d0>]}
00:44:44.387632 [info ] [MainThread]: 
00:44:44.388242 [debug] [MainThread]: Acquiring new postgres connection "master"
00:44:44.389726 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:44:44.403270 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:44:44.403579 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:44:44.403723 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:44:44.424736 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:44:44.425155 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:44:44.425348 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:44:44.427988 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:44:44.430219 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:44:44.430836 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:44:44.444155 [debug] [MainThread]: Using postgres connection "master"
00:44:44.444501 [debug] [MainThread]: On master: BEGIN
00:44:44.444775 [debug] [MainThread]: Opening a new connection, currently in state init
00:44:44.453283 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:44:44.453593 [debug] [MainThread]: Using postgres connection "master"
00:44:44.453732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:44:44.477027 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:44:44.478663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd76340d7-9774-47da-b551-ef7b720f0c61', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90ce35e0>]}
00:44:44.479147 [debug] [MainThread]: On master: ROLLBACK
00:44:44.479496 [debug] [MainThread]: On master: Close
00:44:44.479972 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:44:44.480339 [info ] [MainThread]: 
00:44:44.486100 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:44:44.486720 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:44:44.486908 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:44:44.487111 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:44:44.489543 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:44:44.489946 [debug] [Thread-1  ]: finished collecting timing info
00:44:44.490187 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:44:44.492508 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:44:44.492671 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:44:44.492803 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:44:44.491843 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:44:44.497391 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:44:44.497617 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:44:44.497753 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:44:44.491647 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:44:44.499517 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:44:44.499685 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:44:44.499804 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:44:44.501269 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:44:44.501796 [debug] [Thread-4  ]: finished collecting timing info
00:44:44.502056 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:44:44.502204 [debug] [Thread-4  ]: finished collecting timing info
00:44:44.502706 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:44:44.492031 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:44:44.503236 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:44:44.503404 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:44:44.503523 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:44:44.504783 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:44:44.504996 [debug] [Thread-6  ]: finished collecting timing info
00:44:44.505255 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:44:44.505387 [debug] [Thread-6  ]: finished collecting timing info
00:44:44.505809 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:44:44.491436 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:44:44.506286 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:44:44.506460 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:44:44.506636 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:44:44.508460 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:44:44.508952 [debug] [Thread-3  ]: finished collecting timing info
00:44:44.498947 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:44:44.511751 [debug] [Thread-5  ]: finished collecting timing info
00:44:44.511984 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:44:44.512217 [debug] [Thread-5  ]: finished collecting timing info
00:44:44.512938 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:44:44.511275 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:44:44.513297 [debug] [Thread-3  ]: finished collecting timing info
00:44:44.513893 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:44:44.490444 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:44:44.514227 [debug] [Thread-1  ]: finished collecting timing info
00:44:44.514801 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:44:44.496717 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:44:44.515390 [debug] [Thread-2  ]: finished collecting timing info
00:44:44.515626 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:44:44.515771 [debug] [Thread-2  ]: finished collecting timing info
00:44:44.516123 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:44:44.522275 [debug] [Thread-8  ]: Began running node model.first_project.customers
00:44:44.522836 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers"
00:44:44.523036 [debug] [Thread-8  ]: Began compiling node model.first_project.customers
00:44:44.523178 [debug] [Thread-8  ]: Compiling model.first_project.customers
00:44:44.528647 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers"
00:44:44.528957 [debug] [Thread-9  ]: Began running node model.first_project.customers2
00:44:44.535280 [debug] [Thread-9  ]: Acquiring new postgres connection "model.first_project.customers2"
00:44:44.535496 [debug] [Thread-9  ]: Began compiling node model.first_project.customers2
00:44:44.529536 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:44.535640 [debug] [Thread-9  ]: Compiling model.first_project.customers2
00:44:44.539807 [debug] [Thread-9  ]: Writing injected SQL for node "model.first_project.customers2"
00:44:44.529332 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:44.536158 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:44:44.536509 [debug] [Thread-8  ]: finished collecting timing info
00:44:44.540897 [debug] [Thread-8  ]: Began executing node model.first_project.customers
00:44:44.541184 [debug] [Thread-8  ]: finished collecting timing info
00:44:44.540640 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:44.529180 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
00:44:44.542442 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:44:44.542630 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
00:44:44.541960 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:44.540337 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:44:44.541671 [debug] [Thread-8  ]: Finished running node model.first_project.customers
00:44:44.542770 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
00:44:44.558420 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:44:44.553436 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:44.559114 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:44.555137 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:44:44.577489 [debug] [Thread-4  ]: finished collecting timing info
00:44:44.577698 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:44.577851 [debug] [Thread-4  ]: finished collecting timing info
00:44:44.578342 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:44.542902 [debug] [Thread-9  ]: finished collecting timing info
00:44:44.578593 [debug] [Thread-9  ]: Began executing node model.first_project.customers2
00:44:44.578743 [debug] [Thread-9  ]: finished collecting timing info
00:44:44.579178 [debug] [Thread-9  ]: Finished running node model.first_project.customers2
00:44:44.565277 [debug] [Thread-5  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:44.579565 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:44:44.579725 [debug] [Thread-5  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:44.579854 [debug] [Thread-5  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:44.576794 [debug] [Thread-10 ]: finished collecting timing info
00:44:44.576087 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:44:44.565460 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:44.565598 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:44.565780 [debug] [Thread-2  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:44.588478 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
00:44:44.592298 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:44:44.593146 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:44:44.593594 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:44:44.594032 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:44:44.594281 [debug] [Thread-10 ]: finished collecting timing info
00:44:44.594654 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:44.594906 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:44.596552 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:44.595351 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:44.595948 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
00:44:44.596194 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:44.613527 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:44:44.595184 [debug] [Thread-7  ]: finished collecting timing info
00:44:44.606878 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:44:44.607202 [debug] [Thread-2  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:44.607898 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:44.618331 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:44:44.596353 [debug] [Thread-5  ]: finished collecting timing info
00:44:44.618973 [debug] [Thread-5  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:44.617866 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:44:44.608171 [debug] [Thread-6  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:44.619872 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:44:44.620038 [debug] [Thread-6  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:44.614007 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:44.620535 [debug] [Thread-7  ]: finished collecting timing info
00:44:44.620891 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:44.619186 [debug] [Thread-5  ]: finished collecting timing info
00:44:44.618545 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:44.620358 [debug] [Thread-2  ]: finished collecting timing info
00:44:44.620201 [debug] [Thread-6  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:44.618807 [debug] [Thread-3  ]: finished collecting timing info
00:44:44.619405 [debug] [Thread-1  ]: finished collecting timing info
00:44:44.621398 [debug] [Thread-5  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:44.621606 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:44.621776 [debug] [Thread-2  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:44.626477 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:44:44.626882 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:44.627235 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:44.633002 [debug] [Thread-2  ]: finished collecting timing info
00:44:44.634463 [debug] [Thread-2  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:44.633478 [debug] [Thread-3  ]: finished collecting timing info
00:44:44.633756 [debug] [Thread-6  ]: finished collecting timing info
00:44:44.635179 [debug] [Thread-6  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:44.635332 [debug] [Thread-6  ]: finished collecting timing info
00:44:44.634974 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:44.635811 [debug] [Thread-6  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:44.632632 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:44:44.636443 [debug] [Thread-8  ]: finished collecting timing info
00:44:44.636668 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:44.636799 [debug] [Thread-8  ]: finished collecting timing info
00:44:44.637152 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:44.633983 [debug] [Thread-1  ]: finished collecting timing info
00:44:44.637622 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:44.639056 [debug] [MainThread]: Connection 'master' was properly closed.
00:44:44.639231 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:44:44.639359 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:44:44.639448 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:44:44.639532 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:44:44.639616 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:44:44.639699 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:44:44.639781 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:44:44.639862 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:44:44.639946 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:44:44.640030 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:44:44.645407 [info ] [MainThread]: Done.
00:44:44.647972 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:44:44.648329 [info ] [MainThread]: Building catalog
00:44:44.650612 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:44:44.661469 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:44:44.661784 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:44:44.661936 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:44:44.669050 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:44:44.669341 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:44:44.669463 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:44:44.682722 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.01 seconds
00:44:44.696223 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:44:44.696844 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:44:44.711485 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:44:44.712735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90d24f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90b687c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fba90b68490>]}
00:44:45.285001 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:44:45.286228 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:44:50.853702 | a06f63a1-e6de-46aa-99f8-b1c685caeabe ==============================
00:44:50.853730 [info ] [MainThread]: Running with dbt=1.1.0
00:44:50.854342 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
00:44:50.854514 [debug] [MainThread]: Tracking: tracking
00:44:50.859056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7078eeb520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7078eebc40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7078eeb5e0>]}
00:44:50.893644 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:44:50.893962 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:44:50.900843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a06f63a1-e6de-46aa-99f8-b1c685caeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7078da50d0>]}
00:44:50.910913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a06f63a1-e6de-46aa-99f8-b1c685caeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7078df4730>]}
00:44:50.911655 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:44:50.912623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06f63a1-e6de-46aa-99f8-b1c685caeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7078df4670>]}
00:44:50.916366 [info ] [MainThread]: 
00:44:50.920557 [debug] [MainThread]: Acquiring new postgres connection "master"
00:44:50.927549 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:44:50.946700 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:44:50.947021 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:44:50.947206 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:44:50.971486 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:44:50.971846 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:44:50.971992 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:44:50.974936 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:44:50.977357 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:44:50.977913 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:44:50.987428 [debug] [MainThread]: Using postgres connection "master"
00:44:50.987708 [debug] [MainThread]: On master: BEGIN
00:44:50.987845 [debug] [MainThread]: Opening a new connection, currently in state init
00:44:50.998030 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:44:50.998337 [debug] [MainThread]: Using postgres connection "master"
00:44:50.998481 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:44:51.019425 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:44:51.021709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a06f63a1-e6de-46aa-99f8-b1c685caeabe', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f7078df4280>]}
00:44:51.022013 [debug] [MainThread]: On master: ROLLBACK
00:44:51.022433 [debug] [MainThread]: On master: Close
00:44:51.022907 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:44:51.023215 [info ] [MainThread]: 
00:44:51.027609 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:44:51.028015 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:44:51.028176 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:44:51.028310 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:44:51.030745 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:44:51.031146 [debug] [Thread-1  ]: finished collecting timing info
00:44:51.031326 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:44:51.031457 [debug] [Thread-1  ]: finished collecting timing info
00:44:51.031816 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:44:51.031971 [debug] [Thread-1  ]: Began running node model.first_project.postgres_sample_source_customers
00:44:51.032200 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:44:51.032313 [debug] [Thread-1  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:44:51.032409 [debug] [Thread-1  ]: Compiling model.first_project.postgres_sample_source_customers
00:44:51.034316 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:44:51.034616 [debug] [Thread-1  ]: finished collecting timing info
00:44:51.035625 [debug] [Thread-1  ]: Began executing node model.first_project.postgres_sample_source_customers
00:44:51.035807 [debug] [Thread-2  ]: Began running node model.first_project.stg_customers
00:44:51.036461 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:44:51.036590 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_customers
00:44:51.036691 [debug] [Thread-2  ]: Compiling model.first_project.stg_customers
00:44:51.038461 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:44:51.038896 [debug] [Thread-2  ]: finished collecting timing info
00:44:51.039193 [debug] [Thread-2  ]: Began executing node model.first_project.stg_customers
00:44:51.039320 [debug] [Thread-2  ]: finished collecting timing info
00:44:51.039699 [debug] [Thread-2  ]: Finished running node model.first_project.stg_customers
00:44:51.039876 [debug] [Thread-2  ]: Began running node model.first_project.stg_orders
00:44:51.040112 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:44:51.040239 [debug] [Thread-2  ]: Began compiling node model.first_project.stg_orders
00:44:51.040345 [debug] [Thread-2  ]: Compiling model.first_project.stg_orders
00:44:51.036146 [debug] [Thread-1  ]: finished collecting timing info
00:44:51.083345 [debug] [Thread-3  ]: Began running node seed.first_project.alunos
00:44:51.084039 [debug] [Thread-1  ]: Finished running node model.first_project.postgres_sample_source_customers
00:44:51.084297 [debug] [Thread-4  ]: Began running node seed.first_project.code-country
00:44:51.087189 [debug] [Thread-4  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:44:51.087465 [debug] [Thread-4  ]: Began compiling node seed.first_project.code-country
00:44:51.087598 [debug] [Thread-4  ]: Compiling seed.first_project.code-country
00:44:51.086085 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:51.086320 [debug] [Thread-8  ]: Began running node model.first_project.customers2
00:44:51.089520 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
00:44:51.089668 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
00:44:51.089787 [debug] [Thread-8  ]: Compiling model.first_project.customers2
00:44:51.085773 [debug] [Thread-5  ]: Began running node model.first_project.my_second_dbt_model
00:44:51.085917 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:51.093334 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:44:51.086682 [debug] [Thread-3  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:44:51.093703 [debug] [Thread-3  ]: Began compiling node seed.first_project.alunos
00:44:51.092400 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
00:44:51.085364 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:44:51.092891 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:44:51.094744 [debug] [Thread-5  ]: Began compiling node model.first_project.my_second_dbt_model
00:44:51.093513 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:51.095301 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:51.093862 [debug] [Thread-3  ]: Compiling seed.first_project.alunos
00:44:51.094464 [debug] [Thread-8  ]: finished collecting timing info
00:44:51.124949 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
00:44:51.125252 [debug] [Thread-8  ]: finished collecting timing info
00:44:51.095143 [debug] [Thread-2  ]: finished collecting timing info
00:44:51.088777 [debug] [Thread-4  ]: Writing injected SQL for node "seed.first_project.code-country"
00:44:51.126693 [debug] [Thread-4  ]: finished collecting timing info
00:44:51.124599 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:44:51.125987 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
00:44:51.089179 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:44:51.127593 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:51.126373 [debug] [Thread-2  ]: Began executing node model.first_project.stg_orders
00:44:51.126856 [debug] [Thread-4  ]: Began executing node seed.first_project.code-country
00:44:51.128415 [debug] [Thread-4  ]: finished collecting timing info
00:44:51.129339 [debug] [Thread-4  ]: Finished running node seed.first_project.code-country
00:44:51.094977 [debug] [Thread-5  ]: Compiling model.first_project.my_second_dbt_model
00:44:51.128150 [debug] [Thread-2  ]: finished collecting timing info
00:44:51.114807 [debug] [Thread-3  ]: Writing injected SQL for node "seed.first_project.alunos"
00:44:51.128676 [debug] [Thread-6  ]: finished collecting timing info
00:44:51.131996 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:44:51.127934 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:51.132668 [debug] [Thread-2  ]: Finished running node model.first_project.stg_orders
00:44:51.132989 [debug] [Thread-3  ]: finished collecting timing info
00:44:51.133215 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:51.141454 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:44:51.142322 [debug] [Thread-3  ]: Began executing node seed.first_project.alunos
00:44:51.142879 [debug] [Thread-5  ]: finished collecting timing info
00:44:51.143292 [debug] [Thread-10 ]: Began running node model.first_project.customers
00:44:51.143725 [debug] [Thread-6  ]: finished collecting timing info
00:44:51.144093 [debug] [Thread-3  ]: finished collecting timing info
00:44:51.144393 [debug] [Thread-5  ]: Began executing node model.first_project.my_second_dbt_model
00:44:51.145114 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
00:44:51.145897 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:51.146763 [debug] [Thread-3  ]: Finished running node seed.first_project.alunos
00:44:51.146949 [debug] [Thread-7  ]: finished collecting timing info
00:44:51.147210 [debug] [Thread-5  ]: finished collecting timing info
00:44:51.147430 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
00:44:51.148744 [debug] [Thread-10 ]: Compiling model.first_project.customers
00:44:51.148490 [debug] [Thread-5  ]: Finished running node model.first_project.my_second_dbt_model
00:44:51.152920 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
00:44:51.147938 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:51.153692 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:51.153874 [debug] [Thread-8  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:51.154137 [debug] [Thread-10 ]: finished collecting timing info
00:44:51.154333 [debug] [Thread-7  ]: finished collecting timing info
00:44:51.154679 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:44:51.155054 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:44:51.155293 [debug] [Thread-10 ]: Began executing node model.first_project.customers
00:44:51.156103 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:51.156370 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:51.156575 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:51.156786 [debug] [Thread-10 ]: finished collecting timing info
00:44:51.157143 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:51.157388 [debug] [Thread-8  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:51.166637 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:44:51.163048 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:44:51.157848 [debug] [Thread-10 ]: Finished running node model.first_project.customers
00:44:51.167362 [debug] [Thread-1  ]: finished collecting timing info
00:44:51.167534 [debug] [Thread-8  ]: finished collecting timing info
00:44:51.167979 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:51.168369 [debug] [Thread-2  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:51.168542 [debug] [Thread-9  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:51.169982 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:44:51.168837 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:51.169025 [debug] [Thread-3  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:51.169554 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:44:51.171919 [debug] [Thread-2  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:51.170193 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:51.172475 [debug] [Thread-9  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:51.171388 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:44:51.171732 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:44:51.172068 [debug] [Thread-2  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:51.169199 [debug] [Thread-1  ]: finished collecting timing info
00:44:51.168702 [debug] [Thread-8  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:51.176559 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:44:51.176836 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:51.177070 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:51.192532 [debug] [Thread-3  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:51.190202 [debug] [Thread-8  ]: finished collecting timing info
00:44:51.189785 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:51.192028 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:51.192301 [debug] [Thread-9  ]: finished collecting timing info
00:44:51.205027 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:51.205284 [debug] [Thread-9  ]: finished collecting timing info
00:44:51.196714 [debug] [Thread-8  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:51.204747 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:44:51.205742 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:51.196183 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:44:51.206968 [debug] [Thread-3  ]: finished collecting timing info
00:44:51.207185 [debug] [Thread-3  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:51.207316 [debug] [Thread-3  ]: finished collecting timing info
00:44:51.207707 [debug] [Thread-3  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:51.191638 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:44:51.208161 [debug] [Thread-2  ]: finished collecting timing info
00:44:51.208607 [debug] [Thread-2  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:51.208749 [debug] [Thread-2  ]: finished collecting timing info
00:44:51.209156 [debug] [Thread-2  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:51.208474 [debug] [Thread-6  ]: finished collecting timing info
00:44:51.209470 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:51.209607 [debug] [Thread-6  ]: finished collecting timing info
00:44:51.209934 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:51.212199 [debug] [MainThread]: Connection 'master' was properly closed.
00:44:51.212424 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:44:51.212529 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:44:51.212625 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:44:51.212711 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
00:44:51.212798 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:44:51.212881 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:44:51.212965 [debug] [MainThread]: Connection 'model.first_project.my_second_dbt_model' was properly closed.
00:44:51.213090 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:44:51.213196 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:44:51.213280 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:44:51.218510 [info ] [MainThread]: Done.
00:44:51.219115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707b0dba30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707b0db7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f707850fca0>]}


============================== 2022-06-07 00:44:56.531710 | 2d04f8d3-1be4-4cb6-afe3-3063b06a8f4b ==============================
00:44:56.531744 [info ] [MainThread]: Running with dbt=1.1.0
00:44:56.532689 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:44:56.532974 [debug] [MainThread]: Tracking: tracking
00:44:56.538963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a2a9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a2a9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a2a9eb0>]}
00:44:56.589871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:44:56.590319 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:44:56.601698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2d04f8d3-1be4-4cb6-afe3-3063b06a8f4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a1630d0>]}
00:44:56.614417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2d04f8d3-1be4-4cb6-afe3-3063b06a8f4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a2236d0>]}
00:44:56.615028 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:44:56.615540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d04f8d3-1be4-4cb6-afe3-3063b06a8f4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a223610>]}
00:44:56.626409 [info ] [MainThread]: 
00:44:56.631683 [debug] [MainThread]: Acquiring new postgres connection "master"
00:44:56.638507 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:44:56.657275 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:44:56.672734 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:44:56.673109 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:44:56.685896 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:44:56.686371 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:44:56.686610 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:44:56.690709 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:44:56.694374 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:44:56.695253 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:44:56.717644 [debug] [MainThread]: Using postgres connection "master"
00:44:56.717934 [debug] [MainThread]: On master: BEGIN
00:44:56.718074 [debug] [MainThread]: Opening a new connection, currently in state init
00:44:56.728719 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:44:56.729008 [debug] [MainThread]: Using postgres connection "master"
00:44:56.729140 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:44:56.755460 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
00:44:56.757175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2d04f8d3-1be4-4cb6-afe3-3063b06a8f4b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a2b2dc0>]}
00:44:56.757562 [debug] [MainThread]: On master: ROLLBACK
00:44:56.758270 [debug] [MainThread]: On master: Close
00:44:56.759514 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:44:56.759982 [info ] [MainThread]: 
00:44:56.765311 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:44:56.765820 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:44:56.766033 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:44:56.766198 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:44:56.769440 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:44:56.771641 [debug] [Thread-1  ]: finished collecting timing info
00:44:56.769950 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:44:56.772514 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:44:56.772780 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:44:56.772918 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:44:56.774146 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:44:56.774579 [debug] [Thread-3  ]: finished collecting timing info
00:44:56.774815 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:44:56.770370 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:44:56.769706 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:44:56.770263 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:44:56.775583 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:44:56.777610 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:44:56.777859 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:44:56.770113 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:44:56.776064 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:44:56.777334 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:44:56.784256 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:44:56.784885 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:44:56.790340 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:44:56.790579 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:44:56.785200 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:44:56.785464 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:44:56.856361 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:44:56.774982 [debug] [Thread-3  ]: finished collecting timing info
00:44:56.771888 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:44:56.859071 [debug] [Thread-1  ]: finished collecting timing info
00:44:56.856048 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:44:56.862368 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:44:56.857559 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:44:56.858321 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:44:56.859631 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:44:56.855733 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:44:56.862796 [debug] [Thread-2  ]: finished collecting timing info
00:44:56.789961 [debug] [Thread-6  ]: finished collecting timing info
00:44:56.865080 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:44:56.865269 [debug] [Thread-6  ]: finished collecting timing info
00:44:56.865741 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:44:56.864448 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:56.864661 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:56.866601 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:44:56.866131 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:44:56.864297 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
00:44:56.863693 [debug] [Thread-8  ]: Began running node model.first_project.customers2
00:44:56.867804 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
00:44:56.866780 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:56.868314 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:56.866978 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:56.867428 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:44:56.880732 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
00:44:56.880864 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
00:44:56.867974 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
00:44:56.885012 [debug] [Thread-8  ]: Compiling model.first_project.customers2
00:44:56.879226 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:56.863021 [debug] [Thread-5  ]: finished collecting timing info
00:44:56.897441 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:44:56.897695 [debug] [Thread-5  ]: finished collecting timing info
00:44:56.884640 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:44:56.864875 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:44:56.898507 [debug] [Thread-2  ]: finished collecting timing info
00:44:56.897171 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:44:56.898130 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:44:56.880522 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:44:56.868094 [debug] [Thread-4  ]: finished collecting timing info
00:44:56.887661 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
00:44:56.900549 [debug] [Thread-8  ]: finished collecting timing info
00:44:56.899348 [debug] [Thread-10 ]: finished collecting timing info
00:44:56.900017 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:44:56.900173 [debug] [Thread-7  ]: finished collecting timing info
00:44:56.899084 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:44:56.900713 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
00:44:56.901269 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
00:44:56.901390 [debug] [Thread-3  ]: finished collecting timing info
00:44:56.902345 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:56.901755 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:56.902210 [debug] [Thread-10 ]: finished collecting timing info
00:44:56.902075 [debug] [Thread-8  ]: finished collecting timing info
00:44:56.903442 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
00:44:56.901562 [debug] [Thread-4  ]: finished collecting timing info
00:44:56.903022 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
00:44:56.902622 [debug] [Thread-7  ]: finished collecting timing info
00:44:56.904075 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:44:56.902476 [debug] [Thread-3  ]: finished collecting timing info
00:44:56.904656 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:44:56.904949 [debug] [Thread-1  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:56.906138 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:44:56.906285 [debug] [Thread-1  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:56.906397 [debug] [Thread-1  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:56.905067 [debug] [Thread-9  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:56.912821 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:44:56.913028 [debug] [Thread-9  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:56.913161 [debug] [Thread-9  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:56.905402 [debug] [Thread-5  ]: Began running node model.first_project.customers
00:44:56.917045 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers"
00:44:56.917220 [debug] [Thread-5  ]: Began compiling node model.first_project.customers
00:44:56.916611 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:44:56.917753 [debug] [Thread-9  ]: finished collecting timing info
00:44:56.917960 [debug] [Thread-9  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:56.917355 [debug] [Thread-5  ]: Compiling model.first_project.customers
00:44:56.918100 [debug] [Thread-9  ]: finished collecting timing info
00:44:56.922469 [debug] [Thread-9  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:44:56.905702 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:44:56.921916 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers"
00:44:56.912138 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:44:56.923184 [debug] [Thread-5  ]: finished collecting timing info
00:44:56.923572 [debug] [Thread-5  ]: Began executing node model.first_project.customers
00:44:56.923702 [debug] [Thread-5  ]: finished collecting timing info
00:44:56.924153 [debug] [Thread-5  ]: Finished running node model.first_project.customers
00:44:56.924327 [debug] [Thread-1  ]: finished collecting timing info
00:44:56.924877 [debug] [Thread-1  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:56.925221 [debug] [Thread-8  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:56.925442 [debug] [Thread-10 ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:56.926872 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:44:56.925836 [debug] [Thread-6  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:56.927503 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:44:56.927673 [debug] [Thread-6  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:56.927783 [debug] [Thread-6  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:56.927141 [debug] [Thread-10 ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:56.936361 [debug] [Thread-10 ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:56.926318 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:44:56.925672 [debug] [Thread-1  ]: finished collecting timing info
00:44:56.936163 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:44:56.926482 [debug] [Thread-4  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:56.941731 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:44:56.942062 [debug] [Thread-8  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:56.942700 [debug] [Thread-1  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:44:56.943216 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:44:56.943660 [debug] [Thread-8  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:56.944420 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:56.958177 [debug] [Thread-4  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:56.944011 [debug] [Thread-10 ]: finished collecting timing info
00:44:56.964067 [debug] [Thread-10 ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:56.964289 [debug] [Thread-10 ]: finished collecting timing info
00:44:56.963718 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:44:56.957835 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:44:56.943818 [debug] [Thread-6  ]: finished collecting timing info
00:44:56.964712 [debug] [Thread-10 ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:44:56.965514 [debug] [Thread-8  ]: finished collecting timing info
00:44:56.965760 [debug] [Thread-6  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:56.966671 [debug] [Thread-6  ]: finished collecting timing info
00:44:56.966434 [debug] [Thread-4  ]: finished collecting timing info
00:44:56.966188 [debug] [Thread-8  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:56.967211 [debug] [Thread-6  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:44:56.967588 [debug] [Thread-8  ]: finished collecting timing info
00:44:56.968150 [debug] [Thread-8  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:44:56.967413 [debug] [Thread-4  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:56.968415 [debug] [Thread-4  ]: finished collecting timing info
00:44:56.968738 [debug] [Thread-4  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:44:56.970352 [debug] [MainThread]: Connection 'master' was properly closed.
00:44:56.970542 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:44:56.970649 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:44:56.970741 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:44:56.970828 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
00:44:56.970943 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:44:56.971068 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:44:56.971154 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:44:56.971238 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:44:56.971321 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:44:56.971404 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:44:56.976559 [info ] [MainThread]: Done.
00:44:56.979217 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:44:56.979390 [info ] [MainThread]: Building catalog
00:44:56.981676 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:44:56.988985 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:44:56.989315 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:44:56.989432 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:44:57.006275 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:44:57.006574 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:44:57.006694 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:44:57.011543 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
00:44:57.024614 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:44:57.025345 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:44:57.039121 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:44:57.039756 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3a2a9f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3bb3d1c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3d3bb3d970>]}
00:44:57.630117 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:44:57.630837 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:45:03.650172 | 63db2ed7-8c28-4b10-b6fe-ef33d0acd4af ==============================
00:45:03.650199 [info ] [MainThread]: Running with dbt=1.1.0
00:45:03.650772 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:45:03.650913 [debug] [MainThread]: Tracking: tracking
00:45:03.655240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2b0897340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2b08974f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fa2b08975b0>]}
00:45:03.658130 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:45:03.658759 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:45:03.658959 [info ] [MainThread]: 
00:45:03.659136 [info ] [MainThread]: 
00:45:03.659342 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:46:19.149475 | a5662067-b79f-4a0c-ba17-52169fc86ce3 ==============================
00:46:19.149512 [info ] [MainThread]: Running with dbt=1.1.0
00:46:19.150448 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
00:46:19.150708 [debug] [MainThread]: Tracking: tracking
00:46:19.159551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada938d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada938040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada938070>]}
00:46:19.201763 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:46:19.202847 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:46:19.216818 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:46:19.243925 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:46:19.342342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a5662067-b79f-4a0c-ba17-52169fc86ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada947160>]}
00:46:19.348974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a5662067-b79f-4a0c-ba17-52169fc86ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada949cd0>]}
00:46:19.349572 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:46:19.350003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5662067-b79f-4a0c-ba17-52169fc86ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada949bb0>]}
00:46:19.353543 [info ] [MainThread]: 
00:46:19.354476 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:19.356469 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:46:19.371001 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:46:19.371303 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:46:19.371443 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:19.389849 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:46:19.390117 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:46:19.390263 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:46:19.392552 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:46:19.403126 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:46:19.403602 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:46:19.409845 [debug] [MainThread]: Using postgres connection "master"
00:46:19.410061 [debug] [MainThread]: On master: BEGIN
00:46:19.410167 [debug] [MainThread]: Opening a new connection, currently in state init
00:46:19.416452 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:19.416728 [debug] [MainThread]: Using postgres connection "master"
00:46:19.416964 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:46:19.437902 [debug] [MainThread]: SQL status: SELECT 6 in 0.02 seconds
00:46:19.439524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a5662067-b79f-4a0c-ba17-52169fc86ce3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ada9491f0>]}
00:46:19.439854 [debug] [MainThread]: On master: ROLLBACK
00:46:19.440162 [debug] [MainThread]: On master: Close
00:46:19.440625 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:46:19.440913 [info ] [MainThread]: 
00:46:19.445706 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:46:19.446242 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:46:19.446447 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:46:19.446589 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:46:19.449059 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:46:19.449506 [debug] [Thread-1  ]: finished collecting timing info
00:46:19.449800 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:46:19.451880 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:46:19.452043 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:46:19.452167 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:46:19.451267 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:46:19.459702 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:46:19.450014 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:46:19.456861 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:46:19.460783 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:46:19.460938 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:46:19.457147 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:46:19.461474 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:46:19.461070 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:46:19.459894 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:46:19.461652 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:46:19.463770 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:46:19.463325 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:46:19.467046 [debug] [Thread-5  ]: finished collecting timing info
00:46:19.465052 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:46:19.467521 [debug] [Thread-6  ]: finished collecting timing info
00:46:19.463563 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:46:19.469053 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:46:19.469468 [debug] [Thread-4  ]: finished collecting timing info
00:46:19.469736 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:46:19.467698 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:46:19.470106 [debug] [Thread-6  ]: finished collecting timing info
00:46:19.469906 [debug] [Thread-4  ]: finished collecting timing info
00:46:19.471198 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:46:19.451093 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:46:19.467297 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:46:19.472102 [debug] [Thread-5  ]: finished collecting timing info
00:46:19.472553 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:46:19.471858 [debug] [Thread-1  ]: finished collecting timing info
00:46:19.473216 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:46:19.470598 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:46:19.460392 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:46:19.456116 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:46:19.474754 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:19.475234 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:46:19.475410 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:19.475536 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:19.473829 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:46:19.482014 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:46:19.484000 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:46:19.474142 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
00:46:19.482325 [debug] [Thread-2  ]: finished collecting timing info
00:46:19.490746 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:46:19.491001 [debug] [Thread-2  ]: finished collecting timing info
00:46:19.474330 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:19.492011 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:46:19.492325 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:19.491541 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:46:19.484500 [debug] [Thread-3  ]: finished collecting timing info
00:46:19.493172 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:46:19.493344 [debug] [Thread-3  ]: finished collecting timing info
00:46:19.493814 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:46:19.490416 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:46:19.494467 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
00:46:19.494648 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
00:46:19.492497 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:19.497536 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:46:19.492765 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:46:19.497939 [debug] [Thread-4  ]: Began running node model.first_project.customers
00:46:19.498155 [debug] [Thread-5  ]: Began running node model.first_project.customers2
00:46:19.509252 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.customers"
00:46:19.509599 [debug] [Thread-8  ]: finished collecting timing info
00:46:19.513179 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
00:46:19.513456 [debug] [Thread-8  ]: finished collecting timing info
00:46:19.512797 [debug] [Thread-4  ]: Began compiling node model.first_project.customers
00:46:19.512522 [debug] [Thread-5  ]: Acquiring new postgres connection "model.first_project.customers2"
00:46:19.514561 [debug] [Thread-5  ]: Began compiling node model.first_project.customers2
00:46:19.514751 [debug] [Thread-5  ]: Compiling model.first_project.customers2
00:46:19.514186 [debug] [Thread-4  ]: Compiling model.first_project.customers
00:46:19.514368 [debug] [Thread-10 ]: finished collecting timing info
00:46:19.513933 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
00:46:19.518028 [debug] [Thread-5  ]: Writing injected SQL for node "model.first_project.customers2"
00:46:19.525017 [debug] [Thread-5  ]: finished collecting timing info
00:46:19.523254 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.customers"
00:46:19.523671 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:19.524373 [debug] [Thread-6  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:19.526185 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:46:19.526701 [debug] [Thread-6  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:19.526867 [debug] [Thread-6  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:19.525674 [debug] [Thread-10 ]: finished collecting timing info
00:46:19.524543 [debug] [Thread-7  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:19.526428 [debug] [Thread-4  ]: finished collecting timing info
00:46:19.533450 [debug] [Thread-4  ]: Began executing node model.first_project.customers
00:46:19.511994 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:46:19.533136 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:46:19.534062 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:19.534290 [debug] [Thread-7  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:19.525245 [debug] [Thread-5  ]: Began executing node model.first_project.customers2
00:46:19.539211 [debug] [Thread-5  ]: finished collecting timing info
00:46:19.538793 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:46:19.540429 [debug] [Thread-7  ]: finished collecting timing info
00:46:19.540625 [debug] [Thread-7  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:19.539825 [debug] [Thread-5  ]: Finished running node model.first_project.customers2
00:46:19.533702 [debug] [Thread-4  ]: finished collecting timing info
00:46:19.540021 [debug] [Thread-9  ]: finished collecting timing info
00:46:19.541670 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:19.532719 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:19.532063 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:46:19.541329 [debug] [Thread-4  ]: Finished running node model.first_project.customers
00:46:19.540772 [debug] [Thread-7  ]: finished collecting timing info
00:46:19.543402 [debug] [Thread-7  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:19.542959 [debug] [Thread-3  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:19.544394 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:46:19.544575 [debug] [Thread-3  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:19.543849 [debug] [Thread-1  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:19.543678 [debug] [Thread-7  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:19.544711 [debug] [Thread-3  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:19.545655 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:46:19.545108 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:46:19.566215 [debug] [Thread-1  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:19.545279 [debug] [Thread-6  ]: finished collecting timing info
00:46:19.541853 [debug] [Thread-9  ]: finished collecting timing info
00:46:19.567819 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:19.565748 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:46:19.566440 [debug] [Thread-1  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:19.544008 [debug] [Thread-8  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:19.566787 [debug] [Thread-6  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:19.562140 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:19.568798 [debug] [Thread-3  ]: finished collecting timing info
00:46:19.576575 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:46:19.582214 [debug] [Thread-8  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:19.581429 [debug] [Thread-6  ]: finished collecting timing info
00:46:19.581770 [debug] [Thread-7  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:19.582004 [debug] [Thread-3  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:19.587563 [debug] [Thread-3  ]: finished collecting timing info
00:46:19.582373 [debug] [Thread-8  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:19.582890 [debug] [Thread-6  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:19.586861 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:46:19.580354 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:46:19.588282 [debug] [Thread-3  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:19.592325 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:46:19.594012 [debug] [Thread-8  ]: finished collecting timing info
00:46:19.593451 [debug] [Thread-1  ]: finished collecting timing info
00:46:19.594242 [debug] [Thread-8  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:19.595134 [debug] [Thread-8  ]: finished collecting timing info
00:46:19.593187 [debug] [Thread-7  ]: finished collecting timing info
00:46:19.595588 [debug] [Thread-8  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:19.594439 [debug] [Thread-1  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:19.595815 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:19.596146 [debug] [Thread-1  ]: finished collecting timing info
00:46:19.596390 [debug] [Thread-7  ]: finished collecting timing info
00:46:19.597042 [debug] [Thread-1  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:19.597516 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:19.599201 [debug] [MainThread]: Connection 'master' was properly closed.
00:46:19.599354 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:46:19.599458 [debug] [MainThread]: Connection 'model.first_project.postgres_sample_source_customers' was properly closed.
00:46:19.599552 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:46:19.599645 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:46:19.599736 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:46:19.599825 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:46:19.599913 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:46:19.600002 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:46:19.600090 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:46:19.600177 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:46:19.605640 [info ] [MainThread]: Done.
00:46:19.606104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad873be20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad873b040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f2ad86cdbe0>]}


============================== 2022-06-07 00:46:26.444353 | 50bff757-a63a-4b99-9694-30e62c861f56 ==============================
00:46:26.444376 [info ] [MainThread]: Running with dbt=1.1.0
00:46:26.444997 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:46:26.445165 [debug] [MainThread]: Tracking: tracking
00:46:26.450023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf6e7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf6e7c40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf6e75e0>]}
00:46:26.482796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:46:26.483123 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:46:26.489898 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50bff757-a63a-4b99-9694-30e62c861f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf5a30d0>]}
00:46:26.497017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50bff757-a63a-4b99-9694-30e62c861f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf67a760>]}
00:46:26.497428 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:46:26.497720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50bff757-a63a-4b99-9694-30e62c861f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf67a6a0>]}
00:46:26.501202 [info ] [MainThread]: 
00:46:26.502131 [debug] [MainThread]: Acquiring new postgres connection "master"
00:46:26.503860 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:46:26.514820 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:46:26.515096 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:46:26.515240 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:26.523820 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:46:26.524089 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:46:26.524240 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:46:26.526646 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:46:26.528582 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:46:26.528907 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:46:26.533939 [debug] [MainThread]: Using postgres connection "master"
00:46:26.534170 [debug] [MainThread]: On master: BEGIN
00:46:26.534289 [debug] [MainThread]: Opening a new connection, currently in state init
00:46:26.544141 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:46:26.544421 [debug] [MainThread]: Using postgres connection "master"
00:46:26.544556 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:46:26.570770 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
00:46:26.572740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50bff757-a63a-4b99-9694-30e62c861f56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf67a3d0>]}
00:46:26.573187 [debug] [MainThread]: On master: ROLLBACK
00:46:26.573650 [debug] [MainThread]: On master: Close
00:46:26.574230 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:46:26.574643 [info ] [MainThread]: 
00:46:26.582507 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:46:26.583128 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:46:26.583528 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:46:26.583773 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:46:26.584007 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:46:26.587976 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:46:26.588202 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:46:26.588382 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:46:26.585166 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:46:26.590406 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:46:26.590577 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:46:26.584714 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:46:26.593807 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:46:26.594008 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:46:26.593240 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:46:26.587341 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:46:26.584583 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:46:26.598232 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:46:26.598419 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:46:26.594147 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:46:26.597732 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:46:26.584367 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:46:26.648905 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:46:26.649210 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:46:26.647949 [debug] [Thread-2  ]: finished collecting timing info
00:46:26.651391 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:46:26.651588 [debug] [Thread-2  ]: finished collecting timing info
00:46:26.649460 [debug] [Thread-1  ]: finished collecting timing info
00:46:26.652392 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:46:26.652606 [debug] [Thread-1  ]: finished collecting timing info
00:46:26.652051 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:46:26.598561 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:46:26.654557 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:46:26.653019 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:46:26.651142 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:46:26.656495 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:46:26.654748 [debug] [Thread-5  ]: finished collecting timing info
00:46:26.657367 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:46:26.656731 [debug] [Thread-8  ]: Began running node model.first_project.my_second_dbt_model
00:46:26.658202 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:46:26.658398 [debug] [Thread-8  ]: Began compiling node model.first_project.my_second_dbt_model
00:46:26.657182 [debug] [Thread-10 ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:26.659055 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:46:26.659268 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:26.656874 [debug] [Thread-9  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:26.659740 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:46:26.659895 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:26.660010 [debug] [Thread-9  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:26.659409 [debug] [Thread-10 ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:26.590125 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:46:26.657690 [debug] [Thread-5  ]: finished collecting timing info
00:46:26.682525 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:46:26.658529 [debug] [Thread-8  ]: Compiling model.first_project.my_second_dbt_model
00:46:26.658648 [debug] [Thread-4  ]: finished collecting timing info
00:46:26.678630 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:46:26.681648 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:46:26.685108 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:46:26.650511 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:46:26.685531 [debug] [Thread-3  ]: finished collecting timing info
00:46:26.685988 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:46:26.687801 [debug] [Thread-4  ]: finished collecting timing info
00:46:26.687226 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:46:26.688496 [debug] [Thread-3  ]: finished collecting timing info
00:46:26.688259 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:46:26.686609 [debug] [Thread-6  ]: finished collecting timing info
00:46:26.689348 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:46:26.687039 [debug] [Thread-10 ]: finished collecting timing info
00:46:26.689011 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:46:26.687581 [debug] [Thread-8  ]: finished collecting timing info
00:46:26.689534 [debug] [Thread-6  ]: finished collecting timing info
00:46:26.690791 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:46:26.690403 [debug] [Thread-8  ]: Began executing node model.first_project.my_second_dbt_model
00:46:26.689954 [debug] [Thread-10 ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:26.691101 [debug] [Thread-8  ]: finished collecting timing info
00:46:26.692083 [debug] [Thread-8  ]: Finished running node model.first_project.my_second_dbt_model
00:46:26.691294 [debug] [Thread-2  ]: Began running node model.first_project.customers
00:46:26.691528 [debug] [Thread-1  ]: Began running node model.first_project.customers2
00:46:26.691670 [debug] [Thread-10 ]: finished collecting timing info
00:46:26.689785 [debug] [Thread-9  ]: finished collecting timing info
00:46:26.692725 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.customers"
00:46:26.693101 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers2"
00:46:26.694537 [debug] [Thread-1  ]: Began compiling node model.first_project.customers2
00:46:26.693672 [debug] [Thread-10 ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:46:26.693867 [debug] [Thread-4  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:26.694076 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:26.694301 [debug] [Thread-2  ]: Began compiling node model.first_project.customers
00:46:26.694683 [debug] [Thread-1  ]: Compiling model.first_project.customers2
00:46:26.693296 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:26.695143 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:46:26.695906 [debug] [Thread-2  ]: Compiling model.first_project.customers
00:46:26.695745 [debug] [Thread-9  ]: finished collecting timing info
00:46:26.699158 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers2"
00:46:26.699663 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:46:26.700014 [debug] [Thread-4  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:26.704931 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.customers"
00:46:26.706481 [debug] [Thread-1  ]: finished collecting timing info
00:46:26.705963 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:26.706160 [debug] [Thread-4  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:26.710644 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:46:26.706768 [debug] [Thread-1  ]: Began executing node model.first_project.customers2
00:46:26.706936 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:26.705614 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:46:26.711001 [debug] [Thread-4  ]: finished collecting timing info
00:46:26.711304 [debug] [Thread-2  ]: finished collecting timing info
00:46:26.711527 [debug] [Thread-1  ]: finished collecting timing info
00:46:26.715700 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:46:26.716208 [debug] [Thread-4  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:26.716408 [debug] [Thread-2  ]: Began executing node model.first_project.customers
00:46:26.716988 [debug] [Thread-1  ]: Finished running node model.first_project.customers2
00:46:26.717308 [debug] [Thread-4  ]: finished collecting timing info
00:46:26.717567 [debug] [Thread-5  ]: finished collecting timing info
00:46:26.718493 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:26.718315 [debug] [Thread-4  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:46:26.718627 [debug] [Thread-5  ]: finished collecting timing info
00:46:26.719216 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:46:26.717761 [debug] [Thread-2  ]: finished collecting timing info
00:46:26.719718 [debug] [Thread-2  ]: Finished running node model.first_project.customers
00:46:26.720391 [debug] [Thread-6  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:26.720670 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:46:26.720801 [debug] [Thread-6  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:26.720908 [debug] [Thread-6  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:26.728653 [debug] [Thread-7  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:26.728947 [debug] [Thread-8  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:26.735805 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:46:26.736067 [debug] [Thread-3  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:26.737431 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:46:26.736894 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:46:26.737681 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:26.738278 [debug] [Thread-3  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:26.738005 [debug] [Thread-8  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:26.736471 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:46:26.742336 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:46:26.742697 [debug] [Thread-8  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:26.742948 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:26.748654 [debug] [Thread-7  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:26.752705 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:46:26.761021 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:46:26.771334 [debug] [Thread-3  ]: finished collecting timing info
00:46:26.771797 [debug] [Thread-3  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:26.772150 [debug] [Thread-3  ]: finished collecting timing info
00:46:26.772684 [debug] [Thread-7  ]: finished collecting timing info
00:46:26.772899 [debug] [Thread-6  ]: finished collecting timing info
00:46:26.774207 [debug] [Thread-6  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:26.774375 [debug] [Thread-6  ]: finished collecting timing info
00:46:26.773993 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:26.774886 [debug] [Thread-6  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:46:26.773143 [debug] [Thread-8  ]: finished collecting timing info
00:46:26.775532 [debug] [Thread-8  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:26.775169 [debug] [Thread-7  ]: finished collecting timing info
00:46:26.775689 [debug] [Thread-8  ]: finished collecting timing info
00:46:26.773751 [debug] [Thread-3  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:46:26.776137 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:46:26.776726 [debug] [Thread-8  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:46:26.778972 [debug] [MainThread]: Connection 'master' was properly closed.
00:46:26.779195 [debug] [MainThread]: Connection 'model.first_project.customers2' was properly closed.
00:46:26.779315 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:46:26.779419 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:46:26.779522 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:46:26.779667 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:46:26.779774 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:46:26.779878 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:46:26.779979 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:46:26.780080 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:46:26.780179 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:46:26.785900 [info ] [MainThread]: Done.
00:46:26.788809 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:46:26.789403 [info ] [MainThread]: Building catalog
00:46:26.792069 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:46:26.814910 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:46:26.815326 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:46:26.815487 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:46:26.831110 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:46:26.831447 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:46:26.831700 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:46:26.835854 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
00:46:26.848284 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:46:26.848885 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:46:26.861042 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:46:26.861638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbf6e7520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc4646d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fefbc464df0>]}
00:46:27.434389 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:46:27.434985 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:46:32.594684 | 922ac74a-c9fd-4a63-be56-5217b287ee76 ==============================
00:46:32.594710 [info ] [MainThread]: Running with dbt=1.1.0
00:46:32.595410 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:46:32.595579 [debug] [MainThread]: Tracking: tracking
00:46:32.600971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdd9381c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdd9380a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f4cdd938f70>]}
00:46:32.603946 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:46:32.604295 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:46:32.604504 [info ] [MainThread]: 
00:46:32.604690 [info ] [MainThread]: 
00:46:32.604884 [info ] [MainThread]: Press Ctrl+C to exit.


============================== 2022-06-07 00:47:17.873731 | 8fb79dec-6c12-4e9b-adf5-b0265974a239 ==============================
00:47:17.873758 [info ] [MainThread]: Running with dbt=1.1.0
00:47:17.874471 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'parse_only': False, 'which': 'compile', 'rpc_method': 'compile', 'indirect_selection': 'eager'}
00:47:17.874664 [debug] [MainThread]: Tracking: tracking
00:47:17.880400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce850220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce850400>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce850f70>]}
00:47:17.939111 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
00:47:17.939853 [debug] [MainThread]: Partial parsing: updated file: first_project://models/erp/customers.sql
00:47:17.970818 [debug] [MainThread]: 1603: static parser failed on erp/customers.sql
00:47:17.996253 [debug] [MainThread]: 1602: parser fallback to jinja rendering on erp/customers.sql
00:47:18.107565 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fb79dec-6c12-4e9b-adf5-b0265974a239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce84d250>]}
00:47:18.114904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fb79dec-6c12-4e9b-adf5-b0265974a239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce854f40>]}
00:47:18.115343 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:47:18.115772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb79dec-6c12-4e9b-adf5-b0265974a239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce854310>]}
00:47:18.117896 [info ] [MainThread]: 
00:47:18.118494 [debug] [MainThread]: Acquiring new postgres connection "master"
00:47:18.120086 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:47:18.132277 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:18.133400 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:47:18.133631 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:47:18.142146 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:47:18.142483 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:18.142629 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:47:18.145049 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.0 seconds
00:47:18.146957 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:47:18.147296 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:47:18.161504 [debug] [MainThread]: Using postgres connection "master"
00:47:18.161847 [debug] [MainThread]: On master: BEGIN
00:47:18.162004 [debug] [MainThread]: Opening a new connection, currently in state init
00:47:18.170328 [debug] [MainThread]: SQL status: BEGIN in 0.01 seconds
00:47:18.170607 [debug] [MainThread]: Using postgres connection "master"
00:47:18.170742 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:47:18.198860 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
00:47:18.200925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fb79dec-6c12-4e9b-adf5-b0265974a239', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce850f70>]}
00:47:18.201290 [debug] [MainThread]: On master: ROLLBACK
00:47:18.201727 [debug] [MainThread]: On master: Close
00:47:18.202373 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:47:18.202824 [info ] [MainThread]: 
00:47:18.208089 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:47:18.208851 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:47:18.209068 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:47:18.209251 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:47:18.215165 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:47:18.215599 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:47:18.215868 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:47:18.218053 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:47:18.218321 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:47:18.218476 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:47:18.216025 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:47:18.236843 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:47:18.216369 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:47:18.216191 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:47:18.236292 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:47:18.217466 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:47:18.238663 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:47:18.239397 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:47:18.237618 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:47:18.243080 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:47:18.243299 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:47:18.238088 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:47:18.245497 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:47:18.245760 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:47:18.245163 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:47:18.237077 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:47:18.247265 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:47:18.248172 [debug] [Thread-5  ]: finished collecting timing info
00:47:18.247538 [debug] [Thread-3  ]: finished collecting timing info
00:47:18.247776 [debug] [Thread-6  ]: finished collecting timing info
00:47:18.247971 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:47:18.248516 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:47:18.251869 [debug] [Thread-5  ]: finished collecting timing info
00:47:18.248758 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:47:18.252644 [debug] [Thread-3  ]: finished collecting timing info
00:47:18.249730 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:47:18.251546 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:47:18.252430 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:47:18.242641 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:47:18.253072 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:47:18.249411 [debug] [Thread-1  ]: finished collecting timing info
00:47:18.255196 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:47:18.254142 [debug] [Thread-4  ]: finished collecting timing info
00:47:18.255717 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:47:18.255844 [debug] [Thread-4  ]: finished collecting timing info
00:47:18.253294 [debug] [Thread-6  ]: finished collecting timing info
00:47:18.255525 [debug] [Thread-8  ]: Began running node model.first_project.customers2
00:47:18.255376 [debug] [Thread-1  ]: finished collecting timing info
00:47:18.257596 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:47:18.256212 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:47:18.256650 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:47:18.256999 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
00:47:18.258343 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
00:47:18.258485 [debug] [Thread-8  ]: Compiling model.first_project.customers2
00:47:18.254316 [debug] [Thread-2  ]: finished collecting timing info
00:47:18.261658 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
00:47:18.261934 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:47:18.262297 [debug] [Thread-10 ]: Began running node model.first_project.customers
00:47:18.263515 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.customers"
00:47:18.262624 [debug] [Thread-5  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:18.262779 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:18.263105 [debug] [Thread-2  ]: finished collecting timing info
00:47:18.262448 [debug] [Thread-7  ]: Began running node model.first_project.my_second_dbt_model
00:47:18.265430 [debug] [Thread-7  ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:47:18.264113 [debug] [Thread-5  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:18.264467 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:18.265076 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:47:18.263681 [debug] [Thread-10 ]: Began compiling node model.first_project.customers
00:47:18.267961 [debug] [Thread-10 ]: Compiling model.first_project.customers
00:47:18.265709 [debug] [Thread-7  ]: Began compiling node model.first_project.my_second_dbt_model
00:47:18.267334 [debug] [Thread-5  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:18.267610 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:18.273159 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:18.272760 [debug] [Thread-7  ]: Compiling model.first_project.my_second_dbt_model
00:47:18.281811 [debug] [Thread-7  ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:47:18.272963 [debug] [Thread-5  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:18.267056 [debug] [Thread-8  ]: finished collecting timing info
00:47:18.272538 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.customers"
00:47:18.289685 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:18.295508 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
00:47:18.295877 [debug] [Thread-7  ]: finished collecting timing info
00:47:18.297078 [debug] [Thread-7  ]: Began executing node model.first_project.my_second_dbt_model
00:47:18.296801 [debug] [Thread-8  ]: finished collecting timing info
00:47:18.297291 [debug] [Thread-7  ]: finished collecting timing info
00:47:18.298465 [debug] [Thread-7  ]: Finished running node model.first_project.my_second_dbt_model
00:47:18.297849 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
00:47:18.299286 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:18.298819 [debug] [Thread-3  ]: finished collecting timing info
00:47:18.300124 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:18.299684 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:18.300480 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:18.300623 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:18.300294 [debug] [Thread-3  ]: finished collecting timing info
00:47:18.305024 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:18.299847 [debug] [Thread-1  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:18.305417 [debug] [Thread-1  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:18.304415 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:18.305574 [debug] [Thread-1  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:18.306007 [debug] [Thread-1  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:18.309410 [debug] [Thread-1  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:18.298008 [debug] [Thread-10 ]: finished collecting timing info
00:47:18.310042 [debug] [Thread-10 ]: Began executing node model.first_project.customers
00:47:18.309811 [debug] [Thread-8  ]: finished collecting timing info
00:47:18.310418 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:18.310566 [debug] [Thread-8  ]: finished collecting timing info
00:47:18.310227 [debug] [Thread-10 ]: finished collecting timing info
00:47:18.311568 [debug] [Thread-10 ]: Finished running node model.first_project.customers
00:47:18.310983 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:18.296252 [debug] [Thread-5  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:18.312346 [debug] [Thread-1  ]: finished collecting timing info
00:47:18.312618 [debug] [Thread-6  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:18.312801 [debug] [Thread-9  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:18.313004 [debug] [Thread-2  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:18.313376 [debug] [Thread-7  ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:18.315308 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:47:18.314089 [debug] [Thread-6  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:18.315649 [debug] [Thread-6  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:18.315834 [debug] [Thread-6  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:18.314508 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:18.325990 [debug] [Thread-9  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:18.326151 [debug] [Thread-9  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:18.315496 [debug] [Thread-7  ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:18.330721 [debug] [Thread-7  ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:18.314966 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:18.313600 [debug] [Thread-1  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:18.334678 [debug] [Thread-1  ]: finished collecting timing info
00:47:18.330425 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:18.335588 [debug] [Thread-9  ]: finished collecting timing info
00:47:18.334116 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:47:18.334423 [debug] [Thread-2  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:18.336054 [debug] [Thread-2  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:18.335141 [debug] [Thread-1  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:18.335774 [debug] [Thread-9  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:18.325701 [debug] [Thread-6  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:18.345663 [debug] [Thread-6  ]: finished collecting timing info
00:47:18.344079 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:18.344696 [debug] [Thread-7  ]: finished collecting timing info
00:47:18.345182 [debug] [Thread-9  ]: finished collecting timing info
00:47:18.345887 [debug] [Thread-6  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:18.314662 [debug] [Thread-5  ]: finished collecting timing info
00:47:18.346218 [debug] [Thread-7  ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:18.346728 [debug] [Thread-9  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:18.347073 [debug] [Thread-6  ]: finished collecting timing info
00:47:18.347212 [debug] [Thread-2  ]: finished collecting timing info
00:47:18.348392 [debug] [Thread-2  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:18.347581 [debug] [Thread-7  ]: finished collecting timing info
00:47:18.348981 [debug] [Thread-7  ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:18.348541 [debug] [Thread-2  ]: finished collecting timing info
00:47:18.349596 [debug] [Thread-2  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:18.348200 [debug] [Thread-6  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:18.347390 [debug] [Thread-5  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:18.350140 [debug] [Thread-5  ]: finished collecting timing info
00:47:18.350484 [debug] [Thread-5  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:18.352115 [debug] [MainThread]: Connection 'master' was properly closed.
00:47:18.352280 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:47:18.352384 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:47:18.352477 [debug] [MainThread]: Connection 'test.first_project.unique_my_first_dbt_model_id.16e066b321' was properly closed.
00:47:18.352565 [debug] [MainThread]: Connection 'model.first_project.stg_orders' was properly closed.
00:47:18.352653 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:47:18.352759 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:47:18.352878 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:47:18.352964 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:47:18.353051 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:47:18.353138 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:47:18.359641 [info ] [MainThread]: Done.
00:47:18.360159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11cc6045b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11cc645340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f11ce84deb0>]}


============================== 2022-06-07 00:47:30.830656 | 586ba915-bb3b-4a0c-b287-30a907594624 ==============================
00:47:30.830682 [info ] [MainThread]: Running with dbt=1.1.0
00:47:30.831375 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'compile': True, 'which': 'generate', 'rpc_method': 'docs.generate', 'indirect_selection': 'eager'}
00:47:30.831554 [debug] [MainThread]: Tracking: tracking
00:47:30.836792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd573631d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd573631040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd573631070>]}
00:47:30.885961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
00:47:30.887813 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
00:47:30.907853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '586ba915-bb3b-4a0c-b287-30a907594624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5734eb0d0>]}
00:47:30.915219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '586ba915-bb3b-4a0c-b287-30a907594624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5735c2760>]}
00:47:30.915677 [info ] [MainThread]: Found 7 models, 8 tests, 0 snapshots, 0 analyses, 167 macros, 0 operations, 2 seed files, 1 source, 0 exposures, 0 metrics
00:47:30.916012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586ba915-bb3b-4a0c-b287-30a907594624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5735c26a0>]}
00:47:30.918308 [info ] [MainThread]: 
00:47:30.918959 [debug] [MainThread]: Acquiring new postgres connection "master"
00:47:30.921462 [debug] [ThreadPool]: Acquiring new postgres connection "list_erp_oltp_public"
00:47:30.937814 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:30.938241 [debug] [ThreadPool]: On list_erp_oltp_public: BEGIN
00:47:30.938404 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:47:30.959052 [debug] [ThreadPool]: SQL status: BEGIN in 0.02 seconds
00:47:30.959591 [debug] [ThreadPool]: Using postgres connection "list_erp_oltp_public"
00:47:30.959756 [debug] [ThreadPool]: On list_erp_oltp_public: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "list_erp_oltp_public"} */
select
      'erp_oltp' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'public'
    union all
    select
      'erp_oltp' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'public'
  
00:47:30.965619 [debug] [ThreadPool]: SQL status: SELECT 17 in 0.01 seconds
00:47:30.968106 [debug] [ThreadPool]: On list_erp_oltp_public: ROLLBACK
00:47:30.971557 [debug] [ThreadPool]: On list_erp_oltp_public: Close
00:47:30.979390 [debug] [MainThread]: Using postgres connection "master"
00:47:30.980242 [debug] [MainThread]: On master: BEGIN
00:47:30.980553 [debug] [MainThread]: Opening a new connection, currently in state init
00:47:31.000159 [debug] [MainThread]: SQL status: BEGIN in 0.02 seconds
00:47:31.000587 [debug] [MainThread]: Using postgres connection "master"
00:47:31.000772 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
00:47:31.029941 [debug] [MainThread]: SQL status: SELECT 6 in 0.03 seconds
00:47:31.031852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '586ba915-bb3b-4a0c-b287-30a907594624', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5735c23d0>]}
00:47:31.032283 [debug] [MainThread]: On master: ROLLBACK
00:47:31.032772 [debug] [MainThread]: On master: Close
00:47:31.033426 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
00:47:31.033976 [info ] [MainThread]: 
00:47:31.039600 [debug] [Thread-1  ]: Began running node model.first_project.my_first_dbt_model
00:47:31.040335 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.my_first_dbt_model"
00:47:31.040577 [debug] [Thread-1  ]: Began compiling node model.first_project.my_first_dbt_model
00:47:31.040774 [debug] [Thread-1  ]: Compiling model.first_project.my_first_dbt_model
00:47:31.044519 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.my_first_dbt_model"
00:47:31.044774 [debug] [Thread-2  ]: Began running node model.first_project.postgres_sample_source_customers
00:47:31.046574 [debug] [Thread-2  ]: Acquiring new postgres connection "model.first_project.postgres_sample_source_customers"
00:47:31.046816 [debug] [Thread-2  ]: Began compiling node model.first_project.postgres_sample_source_customers
00:47:31.047016 [debug] [Thread-2  ]: Compiling model.first_project.postgres_sample_source_customers
00:47:31.050145 [debug] [Thread-2  ]: Writing injected SQL for node "model.first_project.postgres_sample_source_customers"
00:47:31.044931 [debug] [Thread-3  ]: Began running node model.first_project.stg_customers
00:47:31.058878 [debug] [Thread-3  ]: Acquiring new postgres connection "model.first_project.stg_customers"
00:47:31.059293 [debug] [Thread-3  ]: Began compiling node model.first_project.stg_customers
00:47:31.059485 [debug] [Thread-3  ]: Compiling model.first_project.stg_customers
00:47:31.045128 [debug] [Thread-4  ]: Began running node model.first_project.stg_orders
00:47:31.063159 [debug] [Thread-4  ]: Acquiring new postgres connection "model.first_project.stg_orders"
00:47:31.063390 [debug] [Thread-4  ]: Began compiling node model.first_project.stg_orders
00:47:31.063543 [debug] [Thread-4  ]: Compiling model.first_project.stg_orders
00:47:31.045775 [debug] [Thread-6  ]: Began running node seed.first_project.code-country
00:47:31.112513 [debug] [Thread-6  ]: Acquiring new postgres connection "seed.first_project.code-country"
00:47:31.062466 [debug] [Thread-3  ]: Writing injected SQL for node "model.first_project.stg_customers"
00:47:31.113613 [debug] [Thread-3  ]: finished collecting timing info
00:47:31.111973 [debug] [Thread-2  ]: finished collecting timing info
00:47:31.114193 [debug] [Thread-2  ]: Began executing node model.first_project.postgres_sample_source_customers
00:47:31.114495 [debug] [Thread-2  ]: finished collecting timing info
00:47:31.113052 [debug] [Thread-1  ]: finished collecting timing info
00:47:31.111611 [debug] [Thread-4  ]: Writing injected SQL for node "model.first_project.stg_orders"
00:47:31.113828 [debug] [Thread-3  ]: Began executing node model.first_project.stg_customers
00:47:31.116370 [debug] [Thread-3  ]: finished collecting timing info
00:47:31.116928 [debug] [Thread-3  ]: Finished running node model.first_project.stg_customers
00:47:31.115460 [debug] [Thread-2  ]: Finished running node model.first_project.postgres_sample_source_customers
00:47:31.115784 [debug] [Thread-1  ]: Began executing node model.first_project.my_first_dbt_model
00:47:31.117963 [debug] [Thread-1  ]: finished collecting timing info
00:47:31.118464 [debug] [Thread-1  ]: Finished running node model.first_project.my_first_dbt_model
00:47:31.045542 [debug] [Thread-5  ]: Began running node seed.first_project.alunos
00:47:31.117666 [debug] [Thread-4  ]: finished collecting timing info
00:47:31.118898 [debug] [Thread-5  ]: Acquiring new postgres connection "seed.first_project.alunos"
00:47:31.120332 [debug] [Thread-5  ]: Began compiling node seed.first_project.alunos
00:47:31.120546 [debug] [Thread-5  ]: Compiling seed.first_project.alunos
00:47:31.122045 [debug] [Thread-5  ]: Writing injected SQL for node "seed.first_project.alunos"
00:47:31.119804 [debug] [Thread-7  ]: Began running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:31.122657 [debug] [Thread-7  ]: Acquiring new postgres connection "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:31.120098 [debug] [Thread-4  ]: Began executing node model.first_project.stg_orders
00:47:31.119643 [debug] [Thread-10 ]: Began running node model.first_project.my_second_dbt_model
00:47:31.123613 [debug] [Thread-10 ]: Acquiring new postgres connection "model.first_project.my_second_dbt_model"
00:47:31.123786 [debug] [Thread-10 ]: Began compiling node model.first_project.my_second_dbt_model
00:47:31.123919 [debug] [Thread-10 ]: Compiling model.first_project.my_second_dbt_model
00:47:31.119132 [debug] [Thread-8  ]: Began running node model.first_project.customers2
00:47:31.122282 [debug] [Thread-5  ]: finished collecting timing info
00:47:31.127803 [debug] [Thread-5  ]: Began executing node seed.first_project.alunos
00:47:31.122833 [debug] [Thread-7  ]: Began compiling node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:31.128241 [debug] [Thread-7  ]: Compiling test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:31.112770 [debug] [Thread-6  ]: Began compiling node seed.first_project.code-country
00:47:31.136297 [debug] [Thread-6  ]: Compiling seed.first_project.code-country
00:47:31.137590 [debug] [Thread-6  ]: Writing injected SQL for node "seed.first_project.code-country"
00:47:31.128038 [debug] [Thread-5  ]: finished collecting timing info
00:47:31.138537 [debug] [Thread-5  ]: Finished running node seed.first_project.alunos
00:47:31.123137 [debug] [Thread-4  ]: finished collecting timing info
00:47:31.149808 [debug] [Thread-4  ]: Finished running node model.first_project.stg_orders
00:47:31.127496 [debug] [Thread-8  ]: Acquiring new postgres connection "model.first_project.customers2"
00:47:31.137823 [debug] [Thread-6  ]: finished collecting timing info
00:47:31.151847 [debug] [Thread-6  ]: Began executing node seed.first_project.code-country
00:47:31.150189 [debug] [Thread-8  ]: Began compiling node model.first_project.customers2
00:47:31.126953 [debug] [Thread-10 ]: Writing injected SQL for node "model.first_project.my_second_dbt_model"
00:47:31.149128 [debug] [Thread-7  ]: Writing injected SQL for node "test.first_project.not_null_my_first_dbt_model_id.5fb22c2710"
00:47:31.151650 [debug] [Thread-1  ]: Began running node model.first_project.customers
00:47:31.153139 [debug] [Thread-1  ]: Acquiring new postgres connection "model.first_project.customers"
00:47:31.153375 [debug] [Thread-1  ]: Began compiling node model.first_project.customers
00:47:31.152445 [debug] [Thread-8  ]: Compiling model.first_project.customers2
00:47:31.119935 [debug] [Thread-3  ]: Began running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:31.157003 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:31.157201 [debug] [Thread-3  ]: Began compiling node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:31.157340 [debug] [Thread-3  ]: Compiling test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:31.156549 [debug] [Thread-8  ]: Writing injected SQL for node "model.first_project.customers2"
00:47:31.153530 [debug] [Thread-1  ]: Compiling model.first_project.customers
00:47:31.152057 [debug] [Thread-6  ]: finished collecting timing info
00:47:31.167035 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.unique_my_first_dbt_model_id.16e066b321"
00:47:31.167320 [debug] [Thread-10 ]: finished collecting timing info
00:47:31.174269 [debug] [Thread-10 ]: Began executing node model.first_project.my_second_dbt_model
00:47:31.174468 [debug] [Thread-10 ]: finished collecting timing info
00:47:31.175229 [debug] [Thread-10 ]: Finished running node model.first_project.my_second_dbt_model
00:47:31.173846 [debug] [Thread-8  ]: finished collecting timing info
00:47:31.175935 [debug] [Thread-8  ]: Began executing node model.first_project.customers2
00:47:31.176123 [debug] [Thread-8  ]: finished collecting timing info
00:47:31.176635 [debug] [Thread-8  ]: Finished running node model.first_project.customers2
00:47:31.176860 [debug] [Thread-8  ]: Began running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:31.177311 [debug] [Thread-8  ]: Acquiring new postgres connection "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:31.177799 [debug] [Thread-8  ]: Began compiling node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:31.178267 [debug] [Thread-8  ]: Compiling test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:31.172563 [debug] [Thread-7  ]: finished collecting timing info
00:47:31.186166 [debug] [Thread-7  ]: Began executing node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:31.173373 [debug] [Thread-6  ]: Finished running node seed.first_project.code-country
00:47:31.178114 [debug] [Thread-2  ]: Began running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:31.187831 [debug] [Thread-2  ]: Acquiring new postgres connection "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:31.183588 [debug] [Thread-8  ]: Writing injected SQL for node "test.first_project.not_null_my_second_dbt_model_id.151b76d778"
00:47:31.177608 [debug] [Thread-3  ]: finished collecting timing info
00:47:31.186776 [debug] [Thread-7  ]: finished collecting timing info
00:47:31.172200 [debug] [Thread-1  ]: Writing injected SQL for node "model.first_project.customers"
00:47:31.188096 [debug] [Thread-2  ]: Began compiling node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:31.188633 [debug] [Thread-3  ]: Began executing node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:31.189418 [debug] [Thread-7  ]: Finished running node test.first_project.not_null_my_first_dbt_model_id.5fb22c2710
00:47:31.189838 [debug] [Thread-2  ]: Compiling test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:31.190157 [debug] [Thread-1  ]: finished collecting timing info
00:47:31.197703 [debug] [Thread-1  ]: Began executing node model.first_project.customers
00:47:31.197964 [debug] [Thread-1  ]: finished collecting timing info
00:47:31.197118 [debug] [Thread-2  ]: Writing injected SQL for node "test.first_project.unique_my_second_dbt_model_id.57a0f8c493"
00:47:31.198540 [debug] [Thread-1  ]: Finished running node model.first_project.customers
00:47:31.190478 [debug] [Thread-3  ]: finished collecting timing info
00:47:31.199590 [debug] [Thread-3  ]: Finished running node test.first_project.unique_my_first_dbt_model_id.16e066b321
00:47:31.190874 [debug] [Thread-8  ]: finished collecting timing info
00:47:31.200221 [debug] [Thread-4  ]: Began running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:31.202322 [debug] [Thread-4  ]: Acquiring new postgres connection "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:31.201225 [debug] [Thread-9  ]: Began running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:31.201512 [debug] [Thread-10 ]: Began running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:31.201760 [debug] [Thread-2  ]: finished collecting timing info
00:47:31.202482 [debug] [Thread-4  ]: Began compiling node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:31.203711 [debug] [Thread-4  ]: Compiling test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:31.201974 [debug] [Thread-8  ]: Began executing node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:31.202887 [debug] [Thread-9  ]: Acquiring new postgres connection "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:31.203285 [debug] [Thread-10 ]: Acquiring new postgres connection "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:47:31.220548 [debug] [Thread-10 ]: Began compiling node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:31.220707 [debug] [Thread-10 ]: Compiling test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:31.217797 [debug] [Thread-8  ]: finished collecting timing info
00:47:31.219906 [debug] [Thread-4  ]: Writing injected SQL for node "test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a"
00:47:31.220314 [debug] [Thread-9  ]: Began compiling node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:31.226722 [debug] [Thread-9  ]: Compiling test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:31.200474 [debug] [Thread-3  ]: Began running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:31.236238 [debug] [Thread-3  ]: Acquiring new postgres connection "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:31.226241 [debug] [Thread-8  ]: Finished running node test.first_project.not_null_my_second_dbt_model_id.151b76d778
00:47:31.203511 [debug] [Thread-2  ]: Began executing node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:31.237224 [debug] [Thread-2  ]: finished collecting timing info
00:47:31.225594 [debug] [Thread-10 ]: Writing injected SQL for node "test.first_project.unique_customers_customer_id.c5af1ff4b1"
00:47:31.238106 [debug] [Thread-10 ]: finished collecting timing info
00:47:31.238287 [debug] [Thread-10 ]: Began executing node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:31.238420 [debug] [Thread-10 ]: finished collecting timing info
00:47:31.237718 [debug] [Thread-2  ]: Finished running node test.first_project.unique_my_second_dbt_model_id.57a0f8c493
00:47:31.238769 [debug] [Thread-10 ]: Finished running node test.first_project.unique_customers_customer_id.c5af1ff4b1
00:47:31.236832 [debug] [Thread-3  ]: Began compiling node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:31.239235 [debug] [Thread-3  ]: Compiling test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:31.235772 [debug] [Thread-9  ]: Writing injected SQL for node "test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf"
00:47:31.236622 [debug] [Thread-4  ]: finished collecting timing info
00:47:31.243590 [debug] [Thread-3  ]: Writing injected SQL for node "test.first_project.not_null_customers_customer_id.5c9bf9911d"
00:47:31.243979 [debug] [Thread-4  ]: Began executing node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:31.244212 [debug] [Thread-9  ]: finished collecting timing info
00:47:31.244562 [debug] [Thread-4  ]: finished collecting timing info
00:47:31.244757 [debug] [Thread-9  ]: Began executing node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:31.245297 [debug] [Thread-4  ]: Finished running node test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a
00:47:31.245560 [debug] [Thread-9  ]: finished collecting timing info
00:47:31.246307 [debug] [Thread-9  ]: Finished running node test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf
00:47:31.245686 [debug] [Thread-3  ]: finished collecting timing info
00:47:31.246513 [debug] [Thread-3  ]: Began executing node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:31.246698 [debug] [Thread-3  ]: finished collecting timing info
00:47:31.247066 [debug] [Thread-3  ]: Finished running node test.first_project.not_null_customers_customer_id.5c9bf9911d
00:47:31.248535 [debug] [MainThread]: Connection 'master' was properly closed.
00:47:31.248702 [debug] [MainThread]: Connection 'model.first_project.customers' was properly closed.
00:47:31.248808 [debug] [MainThread]: Connection 'test.first_project.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
00:47:31.248903 [debug] [MainThread]: Connection 'test.first_project.not_null_customers_customer_id.5c9bf9911d' was properly closed.
00:47:31.248993 [debug] [MainThread]: Connection 'test.first_project.accepted_values_customers_state__PR__SC__RS__RJ__AL__BA__SP__RO__MT__GO__DF__PA.297969771a' was properly closed.
00:47:31.249084 [debug] [MainThread]: Connection 'seed.first_project.code-country' was properly closed.
00:47:31.249175 [debug] [MainThread]: Connection 'seed.first_project.alunos' was properly closed.
00:47:31.249271 [debug] [MainThread]: Connection 'test.first_project.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
00:47:31.249401 [debug] [MainThread]: Connection 'test.first_project.unique_customers_customer_id.c5af1ff4b1' was properly closed.
00:47:31.249590 [debug] [MainThread]: Connection 'test.first_project.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
00:47:31.249796 [debug] [MainThread]: Connection 'test.first_project.relationships_stg_orders_customer_id__customer_id__ref_customers_.ce85de0fbf' was properly closed.
00:47:31.256265 [info ] [MainThread]: Done.
00:47:31.259834 [debug] [MainThread]: Acquiring new postgres connection "generate_catalog"
00:47:31.260225 [info ] [MainThread]: Building catalog
00:47:31.262457 [debug] [ThreadPool]: Acquiring new postgres connection "erp_oltp.information_schema"
00:47:31.270818 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:47:31.271086 [debug] [ThreadPool]: On erp_oltp.information_schema: BEGIN
00:47:31.271339 [debug] [ThreadPool]: Opening a new connection, currently in state init
00:47:31.278851 [debug] [ThreadPool]: SQL status: BEGIN in 0.01 seconds
00:47:31.279158 [debug] [ThreadPool]: Using postgres connection "erp_oltp.information_schema"
00:47:31.279287 [debug] [ThreadPool]: On erp_oltp.information_schema: /* {"app": "dbt", "dbt_version": "1.1.0", "profile_name": "first_project", "target_name": "dev", "connection_name": "erp_oltp.information_schema"} */

    
    

    select
        'erp_oltp' as table_database,
        sch.nspname as table_schema,
        tbl.relname as table_name,
        case tbl.relkind
            when 'v' then 'VIEW'
            else 'BASE TABLE'
        end as table_type,
        tbl_desc.description as table_comment,
        col.attname as column_name,
        col.attnum as column_index,
        pg_catalog.format_type(col.atttypid, col.atttypmod) as column_type,
        col_desc.description as column_comment,
        pg_get_userbyid(tbl.relowner) as table_owner

    from pg_catalog.pg_namespace sch
    join pg_catalog.pg_class tbl on tbl.relnamespace = sch.oid
    join pg_catalog.pg_attribute col on col.attrelid = tbl.oid
    left outer join pg_catalog.pg_description tbl_desc on (tbl_desc.objoid = tbl.oid and tbl_desc.objsubid = 0)
    left outer join pg_catalog.pg_description col_desc on (col_desc.objoid = tbl.oid and col_desc.objsubid = col.attnum)

    where (upper(sch.nspname) = upper('public'))
      and not pg_is_other_temp_schema(sch.oid) -- not a temporary schema belonging to another session
      and tbl.relpersistence in ('p', 'u') -- [p]ermanent table or [u]nlogged table. Exclude [t]emporary tables
      and tbl.relkind in ('r', 'v', 'f', 'p') -- o[r]dinary table, [v]iew, [f]oreign table, [p]artitioned table. Other values are [i]ndex, [S]equence, [c]omposite type, [t]OAST table, [m]aterialized view
      and col.attnum > 0 -- negative numbers are used for system columns such as oid
      and not col.attisdropped -- column as not been dropped

    order by
        sch.nspname,
        tbl.relname,
        col.attnum
00:47:31.283572 [debug] [ThreadPool]: SQL status: SELECT 78 in 0.0 seconds
00:47:31.297707 [debug] [ThreadPool]: On erp_oltp.information_schema: ROLLBACK
00:47:31.299005 [debug] [ThreadPool]: On erp_oltp.information_schema: Close
00:47:31.311840 [info ] [MainThread]: Catalog written to /home/ambientelivre/hacks/first_project_dbt/target/catalog.json
00:47:31.312564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd573631d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd576279a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd5757a3460>]}
00:47:31.890441 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
00:47:31.890966 [debug] [MainThread]: Connection 'erp_oltp.information_schema' was properly closed.


============================== 2022-06-07 00:47:38.280160 | 2f451b69-6929-44df-ad48-73463c333122 ==============================
00:47:38.280194 [info ] [MainThread]: Running with dbt=1.1.0
00:47:38.280974 [debug] [MainThread]: running dbt with arguments {'write_json': True, 'use_colors': True, 'printer_width': 80, 'version_check': True, 'partial_parse': True, 'static_parser': True, 'profiles_dir': '/home/ambientelivre/.dbt', 'send_anonymous_usage_stats': True, 'event_buffer_size': 100000, 'quiet': False, 'no_print': False, 'port': 8080, 'open_browser': True, 'which': 'serve', 'indirect_selection': 'eager'}
00:47:38.281157 [debug] [MainThread]: Tracking: tracking
00:47:38.286573 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c5186340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c5186f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f59c51861f0>]}
00:47:38.289843 [info ] [MainThread]: Serving docs at 0.0.0.0:8080
00:47:38.290269 [info ] [MainThread]: To access from your browser, navigate to:  http://localhost:8080
00:47:38.290854 [info ] [MainThread]: 
00:47:38.291310 [info ] [MainThread]: 
00:47:38.291569 [info ] [MainThread]: Press Ctrl+C to exit.
